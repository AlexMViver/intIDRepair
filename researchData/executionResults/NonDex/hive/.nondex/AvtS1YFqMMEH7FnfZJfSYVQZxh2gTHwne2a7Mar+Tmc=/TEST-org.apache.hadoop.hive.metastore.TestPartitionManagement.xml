<?xml version="1.0" encoding="UTF-8"?>
<testsuite xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://maven.apache.org/surefire/maven-surefire-plugin/xsd/surefire-test-report-3.0.xsd" version="3.0" name="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="211.272" tests="15" errors="5" skipped="0" failures="7">
  <properties>
    <property name="sun.desktop" value="gnome"/>
    <property name="awt.toolkit" value="sun.awt.X11.XToolkit"/>
    <property name="file.encoding.pkg" value="sun.io"/>
    <property name="nondexStart" value="0"/>
    <property name="java.specification.version" value="1.8"/>
    <property name="sun.cpu.isalist" value=""/>
    <property name="sun.jnu.encoding" value="UTF-8"/>
    <property name="java.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.3.4/error_prone_annotations-2.3.4.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.6.1/protobuf-java-2.6.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.2/httpclient-4.5.2.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/alex/.m2/repository/commons-io/commons-io/2.5/commons-io-2.5.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.19.v20170502/jetty-server-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.19.v20170502/jetty-http-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.19.v20170502/jetty-io-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.19.v20170502/jetty-util-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.19.v20170502/jetty-servlet-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.19.v20170502/jetty-security-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.19.v20170502/jetty-webapp-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.19.v20170502/jetty-xml-9.3.19.v20170502.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.2/jackson-core-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.2/jackson-mapper-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.7.7/avro-1.7.7.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar:/home/alex/.m2/repository/org/tukaani/xz/1.0/xz-1.0.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-distcp/3.1.0/hadoop-distcp-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/org/skyscreamer/jsonassert/1.4.0/jsonassert-1.4.0.jar:/home/alex/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-integ/1.5.7/apacheds-server-integ-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-interceptor-kerberos/1.5.7/apacheds-interceptor-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core/1.5.7/apacheds-core-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-api/1.5.7/apacheds-core-api-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-entry/1.5.7/apacheds-core-entry-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-constants/1.5.7/apacheds-core-constants-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-utils/1.5.7/apacheds-utils-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-kerberos-shared/1.5.7/apacheds-kerberos-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-jndi/1.5.7/apacheds-core-jndi-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-shared/1.5.7/apacheds-protocol-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-integ/1.5.7/apacheds-core-integ-1.5.7.jar:/home/alex/.m2/repository/ldapsdk/ldapsdk/4.1/ldapsdk-4.1.jar:/home/alex/.m2/repository/org/apache/directory/client/ldap/ldap-client-api/0.1/ldap-client-api-0.1.jar:/home/alex/.m2/repository/commons-pool/commons-pool/1.5.4/commons-pool-1.5.4.jar:/home/alex/.m2/repository/org/apache/mina/mina-core/2.0.0-RC1/mina-core-2.0.0-RC1.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap/0.9.19/shared-ldap-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-i18n/0.9.19/shared-i18n-0.9.19.jar:/home/alex/.m2/repository/antlr/antlr/2.7.7/antlr-2.7.7.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema/0.9.19/shared-ldap-schema-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-loader/0.9.19/shared-ldap-schema-loader-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-manager/0.9.19/shared-ldap-schema-manager-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-cursor/0.9.19/shared-cursor-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-jndi/0.9.19/shared-ldap-jndi-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1-codec/0.9.19/shared-asn1-codec-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1/0.9.19/shared-asn1-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-constants/0.9.19/shared-ldap-constants-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-converter/0.9.19/shared-ldap-converter-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-dao/0.9.19/shared-ldap-schema-dao-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldif/0.9.19/shared-ldif-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-dsml-parser/0.9.19/shared-dsml-parser-0.9.19.jar:/home/alex/.m2/repository/dom4j/dom4j/1.6.1/dom4j-1.6.1.jar:/home/alex/.m2/repository/xml-apis/xml-apis/1.0.b2/xml-apis-1.0.b2.jar:/home/alex/.m2/repository/xpp3/xpp3/1.1.4c/xpp3-1.1.4c.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-test-framework/1.5.7/apacheds-test-framework-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-i18n/1.5.7/apacheds-i18n-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-annotations/1.5.7/apacheds-server-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-annotations/1.5.7/apacheds-core-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-partition/1.5.7/apacheds-jdbm-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-store/1.5.7/apacheds-jdbm-store-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm/1.5.7/apacheds-jdbm-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-avl/1.5.7/apacheds-core-avl-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-search/1.5.7/apacheds-xdbm-search-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-ldif-partition/1.5.7/apacheds-ldif-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-avl-partition/1.5.7/apacheds-avl-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-mock/1.5.7/apacheds-core-mock-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-ldap/1.5.7/apacheds-protocol-ldap-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-tools/1.5.7/apacheds-xdbm-tools-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-base/1.5.7/apacheds-xdbm-base-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-kerberos/1.5.7/apacheds-protocol-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.3.3/mockito-core-3.3.3.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.5/byte-buddy-1.10.5.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.5/byte-buddy-agent-1.10.5.jar:/home/alex/.m2/repository/org/objenesis/objenesis/2.6/objenesis-2.6.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/src/test/resources:"/>
    <property name="java.vm.vendor" value="Private Build"/>
    <property name="nondexPrintstack" value="false"/>
    <property name="sun.arch.data.model" value="64"/>
    <property name="java.vendor.url" value="http://java.oracle.com/"/>
    <property name="user.timezone" value="Europe/Lisbon"/>
    <property name="user.country.format" value="PT"/>
    <property name="os.name" value="Linux"/>
    <property name="test.tmp.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp"/>
    <property name="java.vm.specification.version" value="1.8"/>
    <property name="sun.java.launcher" value="SUN_STANDARD"/>
    <property name="user.country" value="US"/>
    <property name="sun.boot.library.path" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64"/>
    <property name="sun.java.command" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire/surefirebooter4649986247241161907.jar /home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire 2024-04-23T21-59-46_173-jvmRun1 surefire5505206676996315976tmp surefire_11415750716766295948297tmp"/>
    <property name="nondexLogging" value="CONFIG"/>
    <property name="surefire.test.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/classes:/home/alex/Repositories/hive/standalone-metastore/metastore-common/target/classes:/home/alex/.m2/repository/org/antlr/ST4/4.0.4/ST4-4.0.4.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper/3.5.5/zookeeper-3.5.5.jar:/home/alex/.m2/repository/org/apache/zookeeper/zookeeper-jute/3.5.5/zookeeper-jute-3.5.5.jar:/home/alex/.m2/repository/org/apache/yetus/audience-annotations/0.5.0/audience-annotations-0.5.0.jar:/home/alex/.m2/repository/com/github/ben-manes/caffeine/caffeine/2.8.4/caffeine-2.8.4.jar:/home/alex/.m2/repository/org/checkerframework/checker-qual/3.4.0/checker-qual-3.4.0.jar:/home/alex/.m2/repository/com/google/errorprone/error_prone_annotations/2.3.4/error_prone_annotations-2.3.4.jar:/home/alex/.m2/repository/org/apache/curator/curator-recipes/4.2.0/curator-recipes-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-framework/4.2.0/curator-framework-4.2.0.jar:/home/alex/.m2/repository/org/apache/curator/curator-client/4.2.0/curator-client-4.2.0.jar:/home/alex/.m2/repository/org/slf4j/slf4j-api/1.7.30/slf4j-api-1.7.30.jar:/home/alex/.m2/repository/org/apache/orc/orc-core/1.6.9/orc-core-1.6.9.jar:/home/alex/.m2/repository/org/apache/orc/orc-shims/1.6.9/orc-shims-1.6.9.jar:/home/alex/.m2/repository/io/airlift/aircompressor/0.19/aircompressor-0.19.jar:/home/alex/.m2/repository/javax/xml/bind/jaxb-api/2.2.11/jaxb-api-2.2.11.jar:/home/alex/.m2/repository/org/jetbrains/annotations/17.0.0/annotations-17.0.0.jar:/home/alex/.m2/repository/org/threeten/threeten-extra/1.5.0/threeten-extra-1.5.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.12.0/jackson-databind-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.12.0/jackson-annotations-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.12.0/jackson-core-2.12.0.jar:/home/alex/.m2/repository/com/github/joshelser/dropwizard-metrics-hadoop-metrics2-reporter/0.1.2/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar:/home/alex/.m2/repository/com/google/guava/guava/19.0/guava-19.0.jar:/home/alex/.m2/repository/com/google/protobuf/protobuf-java/2.6.1/protobuf-java-2.6.1.jar:/home/alex/.m2/repository/com/zaxxer/HikariCP/2.6.1/HikariCP-2.6.1.jar:/home/alex/.m2/repository/org/apache/commons/commons-dbcp2/2.7.0/commons-dbcp2-2.7.0.jar:/home/alex/.m2/repository/org/apache/commons/commons-pool2/2.7.0/commons-pool2-2.7.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-core/3.1.0/metrics-core-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-jvm/3.1.0/metrics-jvm-3.1.0.jar:/home/alex/.m2/repository/io/dropwizard/metrics/metrics-json/3.1.0/metrics-json-3.1.0.jar:/home/alex/.m2/repository/javolution/javolution/5.5.1/javolution-5.5.1.jar:/home/alex/.m2/repository/org/antlr/antlr-runtime/3.5.2/antlr-runtime-3.5.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-lang3/3.9/commons-lang3-3.9.jar:/home/alex/.m2/repository/org/apache/derby/derby/10.14.1.0/derby-10.14.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-annotations/3.1.0/hadoop-annotations-3.1.0.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/../lib/tools.jar:/home/alex/.m2/repository/commons-cli/commons-cli/1.2/commons-cli-1.2.jar:/home/alex/.m2/repository/org/apache/commons/commons-math3/3.1.1/commons-math3-3.1.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpclient/4.5.2/httpclient-4.5.2.jar:/home/alex/.m2/repository/commons-codec/commons-codec/1.11/commons-codec-1.11.jar:/home/alex/.m2/repository/commons-io/commons-io/2.5/commons-io-2.5.jar:/home/alex/.m2/repository/commons-net/commons-net/3.6/commons-net-3.6.jar:/home/alex/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar:/home/alex/.m2/repository/javax/servlet/javax.servlet-api/3.1.0/javax.servlet-api-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-server/9.3.19.v20170502/jetty-server-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-http/9.3.19.v20170502/jetty-http-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-io/9.3.19.v20170502/jetty-io-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util/9.3.19.v20170502/jetty-util-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-servlet/9.3.19.v20170502/jetty-servlet-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-security/9.3.19.v20170502/jetty-security-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-webapp/9.3.19.v20170502/jetty-webapp-9.3.19.v20170502.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-xml/9.3.19.v20170502/jetty-xml-9.3.19.v20170502.jar:/home/alex/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-core/1.19/jersey-core-1.19.jar:/home/alex/.m2/repository/javax/ws/rs/jsr311-api/1.1.1/jsr311-api-1.1.1.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-servlet/1.19/jersey-servlet-1.19.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-json/1.19/jersey-json-1.19.jar:/home/alex/.m2/repository/org/codehaus/jettison/jettison/1.1/jettison-1.1.jar:/home/alex/.m2/repository/com/sun/xml/bind/jaxb-impl/2.2.3-1/jaxb-impl-2.2.3-1.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-core-asl/1.9.2/jackson-core-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-mapper-asl/1.9.2/jackson-mapper-asl-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-jaxrs/1.9.2/jackson-jaxrs-1.9.2.jar:/home/alex/.m2/repository/org/codehaus/jackson/jackson-xc/1.9.2/jackson-xc-1.9.2.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-server/1.19/jersey-server-1.19.jar:/home/alex/.m2/repository/log4j/log4j/1.2.17/log4j-1.2.17.jar:/home/alex/.m2/repository/commons-lang/commons-lang/2.6/commons-lang-2.6.jar:/home/alex/.m2/repository/org/apache/commons/commons-configuration2/2.1.1/commons-configuration2-2.1.1.jar:/home/alex/.m2/repository/org/apache/avro/avro/1.7.7/avro-1.7.7.jar:/home/alex/.m2/repository/com/thoughtworks/paranamer/paranamer/2.3/paranamer-2.3.jar:/home/alex/.m2/repository/org/xerial/snappy/snappy-java/1.0.5/snappy-java-1.0.5.jar:/home/alex/.m2/repository/com/google/re2j/re2j/1.1/re2j-1.1.jar:/home/alex/.m2/repository/com/google/code/gson/gson/2.2.4/gson-2.2.4.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-auth/3.1.0/hadoop-auth-3.1.0.jar:/home/alex/.m2/repository/com/nimbusds/nimbus-jose-jwt/4.41.1/nimbus-jose-jwt-4.41.1.jar:/home/alex/.m2/repository/com/github/stephenc/jcip/jcip-annotations/1.0-1/jcip-annotations-1.0-1.jar:/home/alex/.m2/repository/net/minidev/json-smart/2.3/json-smart-2.3.jar:/home/alex/.m2/repository/net/minidev/accessors-smart/1.2/accessors-smart-1.2.jar:/home/alex/.m2/repository/org/ow2/asm/asm/5.0.4/asm-5.0.4.jar:/home/alex/.m2/repository/com/jcraft/jsch/0.1.54/jsch-0.1.54.jar:/home/alex/.m2/repository/com/google/code/findbugs/jsr305/3.0.0/jsr305-3.0.0.jar:/home/alex/.m2/repository/org/apache/htrace/htrace-core4/4.1.0-incubating/htrace-core4-4.1.0-incubating.jar:/home/alex/.m2/repository/org/apache/commons/commons-compress/1.4.1/commons-compress-1.4.1.jar:/home/alex/.m2/repository/org/tukaani/xz/1.0/xz-1.0.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-simplekdc/1.0.1/kerb-simplekdc-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-client/1.0.1/kerb-client-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-config/1.0.1/kerby-config-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-core/1.0.1/kerb-core-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-pkix/1.0.1/kerby-pkix-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-asn1/1.0.1/kerby-asn1-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-util/1.0.1/kerby-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-common/1.0.1/kerb-common-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-crypto/1.0.1/kerb-crypto-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-util/1.0.1/kerb-util-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/token-provider/1.0.1/token-provider-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-admin/1.0.1/kerb-admin-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-server/1.0.1/kerb-server-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerb-identity/1.0.1/kerb-identity-1.0.1.jar:/home/alex/.m2/repository/org/apache/kerby/kerby-xdr/1.0.1/kerby-xdr-1.0.1.jar:/home/alex/.m2/repository/org/codehaus/woodstox/stax2-api/3.1.4/stax2-api-3.1.4.jar:/home/alex/.m2/repository/com/fasterxml/woodstox/woodstox-core/5.0.3/woodstox-core-5.0.3.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-distcp/3.1.0/hadoop-distcp-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs/3.1.0/hadoop-hdfs-3.1.0.jar:/home/alex/.m2/repository/org/eclipse/jetty/jetty-util-ajax/9.3.19.v20170502/jetty-util-ajax-9.3.19.v20170502.jar:/home/alex/.m2/repository/commons-daemon/commons-daemon/1.0.13/commons-daemon-1.0.13.jar:/home/alex/.m2/repository/org/fusesource/leveldbjni/leveldbjni-all/1.8/leveldbjni-all-1.8.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar:/home/alex/.m2/repository/com/squareup/okhttp/okhttp/2.7.5/okhttp-2.7.5.jar:/home/alex/.m2/repository/com/squareup/okio/okio/1.6.0/okio-1.6.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-mapreduce-client-core/3.1.0/hadoop-mapreduce-client-core-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-client/3.1.0/hadoop-yarn-client-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-api/3.1.0/hadoop-yarn-api-3.1.0.jar:/home/alex/.m2/repository/org/apache/hadoop/hadoop-yarn-common/3.1.0/hadoop-yarn-common-3.1.0.jar:/home/alex/.m2/repository/com/sun/jersey/jersey-client/1.19/jersey-client-1.19.jar:/home/alex/.m2/repository/com/google/inject/guice/4.0/guice-4.0.jar:/home/alex/.m2/repository/javax/inject/javax.inject/1/javax.inject-1.jar:/home/alex/.m2/repository/aopalliance/aopalliance/1.0/aopalliance-1.0.jar:/home/alex/.m2/repository/com/sun/jersey/contribs/jersey-guice/1.19/jersey-guice-1.19.jar:/home/alex/.m2/repository/com/fasterxml/jackson/module/jackson-module-jaxb-annotations/2.12.0/jackson-module-jaxb-annotations-2.12.0.jar:/home/alex/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/2.3.2/jakarta.xml.bind-api-2.3.2.jar:/home/alex/.m2/repository/jakarta/activation/jakarta.activation-api/1.2.1/jakarta.activation-api-1.2.1.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-json-provider/2.12.0/jackson-jaxrs-json-provider-2.12.0.jar:/home/alex/.m2/repository/com/fasterxml/jackson/jaxrs/jackson-jaxrs-base/2.12.0/jackson-jaxrs-base-2.12.0.jar:/home/alex/.m2/repository/com/google/inject/extensions/guice-servlet/4.0/guice-servlet-4.0.jar:/home/alex/.m2/repository/commons-beanutils/commons-beanutils/1.9.4/commons-beanutils-1.9.4.jar:/home/alex/Repositories/hive/storage-api/target/classes:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-api/2.13.2/log4j-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.13.2/log4j-1.2-api-2.13.2.jar:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-core/2.13.2/log4j-core-2.13.2.jar:/home/alex/.m2/repository/org/apache/thrift/libfb303/0.9.3/libfb303-0.9.3.jar:/home/alex/.m2/repository/org/apache/thrift/libthrift/0.14.1/libthrift-0.14.1.jar:/home/alex/.m2/repository/org/apache/httpcomponents/httpcore/4.4.12/httpcore-4.4.12.jar:/home/alex/.m2/repository/org/apache/tomcat/embed/tomcat-embed-core/8.5.46/tomcat-embed-core-8.5.46.jar:/home/alex/.m2/repository/org/apache/tomcat/tomcat-annotations-api/8.5.46/tomcat-annotations-api-8.5.46.jar:/home/alex/.m2/repository/javax/annotation/javax.annotation-api/1.3.2/javax.annotation-api-1.3.2.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-api-jdo/5.2.4/datanucleus-api-jdo-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-core/5.2.4/datanucleus-core-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/datanucleus-rdbms/5.2.4/datanucleus-rdbms-5.2.4.jar:/home/alex/.m2/repository/org/datanucleus/javax.jdo/3.2.0-release/javax.jdo-3.2.0-release.jar:/home/alex/.m2/repository/javax/transaction/javax.transaction-api/1.3/javax.transaction-api-1.3.jar:/home/alex/.m2/repository/org/glassfish/corba/glassfish-corba-omgapi/4.2.2/glassfish-corba-omgapi-4.2.2.jar:/home/alex/.m2/repository/org/skyscreamer/jsonassert/1.4.0/jsonassert-1.4.0.jar:/home/alex/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar:/home/alex/.m2/repository/sqlline/sqlline/1.9.0/sqlline-1.9.0.jar:/home/alex/.m2/repository/org/jline/jline-terminal/3.12.1/jline-terminal-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-reader/3.12.1/jline-reader-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jansi/3.12.1/jline-terminal-jansi-3.12.1.jar:/home/alex/.m2/repository/org/fusesource/jansi/jansi/1.18/jansi-1.18.jar:/home/alex/.m2/repository/org/jline/jline-terminal-jna/3.12.1/jline-terminal-jna-3.12.1.jar:/home/alex/.m2/repository/net/java/dev/jna/jna/5.3.1/jna-5.3.1.jar:/home/alex/.m2/repository/org/jline/jline-builtins/3.12.1/jline-builtins-3.12.1.jar:/home/alex/.m2/repository/org/jline/jline-style/3.12.1/jline-style-3.12.1.jar:/home/alex/.m2/repository/jline/jline/2.14.6/jline-2.14.6.jar:/home/alex/.m2/repository/commons-logging/commons-logging/1.1.3/commons-logging-1.1.3.jar:/home/alex/.m2/repository/com/cronutils/cron-utils/9.1.3/cron-utils-9.1.3.jar:/home/alex/.m2/repository/org/glassfish/javax.el/3.0.0/javax.el-3.0.0.jar:/home/alex/.m2/repository/com/oracle/database/jdbc/ojdbc8/21.3.0.0/ojdbc8-21.3.0.0.jar:/home/alex/.m2/repository/mysql/mysql-connector-java/8.0.27/mysql-connector-java-8.0.27.jar:/home/alex/.m2/repository/com/microsoft/sqlserver/mssql-jdbc/6.2.1.jre8/mssql-jdbc-6.2.1.jre8.jar:/home/alex/.m2/repository/junit/junit/4.13/junit-4.13.jar:/home/alex/.m2/repository/org/hamcrest/hamcrest-core/1.3/hamcrest-core-1.3.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-integ/1.5.7/apacheds-server-integ-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-interceptor-kerberos/1.5.7/apacheds-interceptor-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core/1.5.7/apacheds-core-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-api/1.5.7/apacheds-core-api-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-entry/1.5.7/apacheds-core-entry-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-constants/1.5.7/apacheds-core-constants-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-utils/1.5.7/apacheds-utils-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-kerberos-shared/1.5.7/apacheds-kerberos-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-jndi/1.5.7/apacheds-core-jndi-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-shared/1.5.7/apacheds-protocol-shared-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-integ/1.5.7/apacheds-core-integ-1.5.7.jar:/home/alex/.m2/repository/ldapsdk/ldapsdk/4.1/ldapsdk-4.1.jar:/home/alex/.m2/repository/org/apache/directory/client/ldap/ldap-client-api/0.1/ldap-client-api-0.1.jar:/home/alex/.m2/repository/commons-pool/commons-pool/1.5.4/commons-pool-1.5.4.jar:/home/alex/.m2/repository/org/apache/mina/mina-core/2.0.0-RC1/mina-core-2.0.0-RC1.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap/0.9.19/shared-ldap-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-i18n/0.9.19/shared-i18n-0.9.19.jar:/home/alex/.m2/repository/antlr/antlr/2.7.7/antlr-2.7.7.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema/0.9.19/shared-ldap-schema-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-loader/0.9.19/shared-ldap-schema-loader-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-manager/0.9.19/shared-ldap-schema-manager-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-cursor/0.9.19/shared-cursor-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-jndi/0.9.19/shared-ldap-jndi-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1-codec/0.9.19/shared-asn1-codec-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-asn1/0.9.19/shared-asn1-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-constants/0.9.19/shared-ldap-constants-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-converter/0.9.19/shared-ldap-converter-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldap-schema-dao/0.9.19/shared-ldap-schema-dao-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-ldif/0.9.19/shared-ldif-0.9.19.jar:/home/alex/.m2/repository/org/apache/directory/shared/shared-dsml-parser/0.9.19/shared-dsml-parser-0.9.19.jar:/home/alex/.m2/repository/dom4j/dom4j/1.6.1/dom4j-1.6.1.jar:/home/alex/.m2/repository/xml-apis/xml-apis/1.0.b2/xml-apis-1.0.b2.jar:/home/alex/.m2/repository/xpp3/xpp3/1.1.4c/xpp3-1.1.4c.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-test-framework/1.5.7/apacheds-test-framework-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-i18n/1.5.7/apacheds-i18n-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-server-annotations/1.5.7/apacheds-server-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-annotations/1.5.7/apacheds-core-annotations-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-partition/1.5.7/apacheds-jdbm-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm-store/1.5.7/apacheds-jdbm-store-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-jdbm/1.5.7/apacheds-jdbm-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-avl/1.5.7/apacheds-core-avl-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-search/1.5.7/apacheds-xdbm-search-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-ldif-partition/1.5.7/apacheds-ldif-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-avl-partition/1.5.7/apacheds-avl-partition-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-core-mock/1.5.7/apacheds-core-mock-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-ldap/1.5.7/apacheds-protocol-ldap-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-tools/1.5.7/apacheds-xdbm-tools-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-xdbm-base/1.5.7/apacheds-xdbm-base-1.5.7.jar:/home/alex/.m2/repository/org/apache/directory/server/apacheds-protocol-kerberos/1.5.7/apacheds-protocol-kerberos-1.5.7.jar:/home/alex/.m2/repository/org/mockito/mockito-core/3.3.3/mockito-core-3.3.3.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy/1.10.5/byte-buddy-1.10.5.jar:/home/alex/.m2/repository/net/bytebuddy/byte-buddy-agent/1.10.5/byte-buddy-agent-1.10.5.jar:/home/alex/.m2/repository/org/objenesis/objenesis/2.6/objenesis-2.6.jar:/home/alex/.m2/repository/org/postgresql/postgresql/42.2.14/postgresql-42.2.14.jar:/home/alex/.m2/repository/org/apache/curator/curator-test/4.2.0/curator-test-4.2.0.jar:/home/alex/Repositories/hive/standalone-metastore/metastore-server/src/test/resources:"/>
    <property name="nondexExecid" value="AvtS1YFqMMEH7FnfZJfSYVQZxh2gTHwne2a7Mar+Tmc="/>
    <property name="sun.cpu.endian" value="little"/>
    <property name="user.home" value="/home/alex"/>
    <property name="user.language" value="en"/>
    <property name="java.specification.vendor" value="Oracle Corporation"/>
    <property name="metastore.schema.verification" value="false"/>
    <property name="java.home" value="/usr/lib/jvm/java-8-openjdk-amd64/jre"/>
    <property name="hive.metastore.warehouse.external.dir" value="file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external"/>
    <property name="file.separator" value="/"/>
    <property name="basedir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server"/>
    <property name="nondexEnd" value="9223372036854775807"/>
    <property name="line.separator" value="&#10;"/>
    <property name="metastore.warehouse.dir" value="file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse"/>
    <property name="derby.stream.error.file" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/derby.log"/>
    <property name="java.vm.specification.vendor" value="Oracle Corporation"/>
    <property name="java.specification.name" value="Java Platform API Specification"/>
    <property name="java.awt.graphicsenv" value="sun.awt.X11GraphicsEnvironment"/>
    <property name="nondexFilter" value=".*"/>
    <property name="nondexSeed" value="1016066"/>
    <property name="surefire.real.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/surefire/surefirebooter4649986247241161907.jar"/>
    <property name="sun.boot.class.path" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex/nondex-instr.jar:/home/alex/.m2/repository/edu/illinois/nondex-common/2.1.7/nondex-common-2.1.7.jar:/home/alex/.m2/repository/edu/illinois/nondex-annotations/2.1.7/nondex-annotations-2.1.7.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/resources.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/rt.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jsse.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jce.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/charsets.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/jfr.jar:/usr/lib/jvm/java-8-openjdk-amd64/jre/classes"/>
    <property name="log4j.debug" value="true"/>
    <property name="sun.management.compiler" value="HotSpot 64-Bit Tiered Compilers"/>
    <property name="java.runtime.version" value="1.8.0_402-8u402-ga-2ubuntu1~22.04-b06"/>
    <property name="user.name" value="alex"/>
    <property name="path.separator" value=":"/>
    <property name="javax.jdo.option.ConnectionURL" value="jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"/>
    <property name="os.version" value="6.5.0-28-generic"/>
    <property name="java.endorsed.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/endorsed"/>
    <property name="java.runtime.name" value="OpenJDK Runtime Environment"/>
    <property name="file.encoding" value="UTF-8"/>
    <property name="java.vm.name" value="OpenJDK 64-Bit Server VM"/>
    <property name="localRepository" value="/home/alex/.m2/repository"/>
    <property name="nondexDir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex"/>
    <property name="build.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target"/>
    <property name="java.vendor.url.bug" value="http://bugreport.sun.com/bugreport/"/>
    <property name="nondexJarDir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/.nondex"/>
    <property name="java.io.tmpdir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp"/>
    <property name="com.zaxxer.hikari.pool_number" value="13"/>
    <property name="java.version" value="1.8.0_402"/>
    <property name="user.dir" value="/home/alex/Repositories/hive/standalone-metastore/metastore-server"/>
    <property name="os.arch" value="amd64"/>
    <property name="nondexMode" value="FULL"/>
    <property name="java.vm.specification.name" value="Java Virtual Machine Specification"/>
    <property name="java.awt.printerjob" value="sun.print.PSPrinterJob"/>
    <property name="user.language.format" value="pt"/>
    <property name="sun.os.patch.level" value="unknown"/>
    <property name="derby.version" value="10.14.1.0"/>
    <property name="java.library.path" value="/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib"/>
    <property name="java.vendor" value="Private Build"/>
    <property name="java.vm.info" value="mixed mode"/>
    <property name="java.vm.version" value="25.402-b06"/>
    <property name="java.specification.maintenance.version" value="5"/>
    <property name="java.ext.dirs" value="/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext:/usr/java/packages/lib/ext"/>
    <property name="sun.io.unicode.encoding" value="UnicodeLittle"/>
    <property name="datanucleus.schema.autoCreateAll" value="true"/>
    <property name="java.class.version" value="52.0"/>
  </properties>
  <testcase name="testNoPartitionDiscoveryForReplTable" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="17.768"/>
  <testcase name="testPartitionDiscoveryTablePattern" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.585">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:38:01.385 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:38:01.385 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:38:01.385 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:38:01.385 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:38:01.399 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:38:01.399 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:38:01.399 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:38:01.399 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:38:01.402 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:38:01.450 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[INFO ] 2024-04-23 23:38:02.030 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:38:02.030 [MetaStoreThread-34607] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:38:02.032 [MetaStoreThread-34607] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] HMSHandler - 5: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:38:02.036 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:38:02.037 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 32
[DEBUG] 2024-04-23 23:38:02.040 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 9, unloaded classes: 108
[DEBUG] 2024-04-23 23:38:02.040 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:02.042 [MetaStoreThread-34607] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:38:02.042 [MetaStoreThread-34607] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:38:02.043 [MetaStoreThread-34607] HikariConfig - HikariPool-4 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:38:02.043 [MetaStoreThread-34607] HikariConfig - HikariPool-4 - configuration:
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true"
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - poolName........................"HikariPool-4"
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariDataSource - HikariPool-4 - Starting...
[INFO ] 2024-04-23 23:38:02.047 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:38:02.047 [MetaStoreThread-34607] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.047 [MetaStoreThread-34607] HikariDataSource - HikariPool-4 - Start completed.
[DEBUG] 2024-04-23 23:38:02.147 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:38:02.149 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.150 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@819434781 (XID = 1160), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.151 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@19760472 (XID = 1162), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.152 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1358457426 (XID = 1164), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.153 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1075768193 (XID = 1166), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.154 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1421235715 (XID = 1168), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.156 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1809764220 (XID = 1170), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.157 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@847029069 (XID = 1172), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.158 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@683971544 (XID = 1174), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.158 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@163580d0, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@163580d0, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7eb5996a created in the thread with id: 80
[DEBUG] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.373 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.373 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.479 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.568 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.591 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.640 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.660 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.667 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.789 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.820 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.829 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.838 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.840 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@163580d0 from thread id: 80
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.848 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.851 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.852 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.852 [MetaStoreThread-34607] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:38:02.852 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.853 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.854 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.854 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.854 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.857 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.857 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] ObjectStore - db details for db default retrieved using SQL in 2.926691ms
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:38:02.861 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.867 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.869 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.871 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.874 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.874 [MetaStoreThread-34607] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:38:02.874 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.874 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:02.879 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.883 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:02.887 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:02.890 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:02.890 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.891 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.891 [MetaStoreThread-34607] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:38:02.891 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.891 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:02.892 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:02.892 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:02.896 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.900 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:02.903 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.905 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.905 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] PerfLogger - </PERFLOG method=init start=1713911882032 end=1713911882906 duration=874 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=5 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Started the new metaserver on port [34607]...
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:38:03.032 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.032 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 6: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.032 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:03.036 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607) is created
[INFO ] 2024-04-23 23:38:03.036 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 34607 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[INFO ] 2024-04-23 23:38:03.036 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:38:03.039 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.040 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.040 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.040 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 1
[DEBUG] 2024-04-23 23:38:03.040 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.040 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883040 end=1713911883040 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.041 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.041 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.041 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 create_database: Database(name:db5, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:38:03.041 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db5, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61a2994d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61a2994d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7490e12c created in the thread with id: 97
[DEBUG] 2024-04-23 23:38:03.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61a2994d from thread id: 97
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.835787ms
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db5, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:38:03.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.050 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[INFO ] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[INFO ] 2024-04-23 23:38:03.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[DEBUG] 2024-04-23 23:38:03.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.057 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.057 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911883041 end=1713911883057 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 create_table_req: Table(tableName:tbl5, dbName:db5, owner:alex, createTime:1713911883, lastAccessTime:1713911883, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl5, dbName:db5, owner:alex, createTime:1713911883, lastAccessTime:1713911883, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.348203ms
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.154407ms
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.069 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5
[DEBUG] 2024-04-23 23:38:03.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.082 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.087 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.092 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.097 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.115 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.116 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911883058 end=1713911883116 duration=58 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.116 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.116 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.116 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:38:03.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.176 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.192 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911883116 end=1713911883194 duration=78 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.194 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:38:03.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911883194 end=1713911883217 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:38:03.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.239 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911883218 end=1713911883241 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911883242 end=1713911883242 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.243 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.534845ms
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.252 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911883242 end=1713911883253 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.253 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=11, comments=HMS client
[DEBUG] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.254 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:38:03.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.258 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.678184ms + 0.016535ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.263 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.938022ms + 0.109389ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.265 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.021844ms + 0.414577ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:03.268 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.027603ms + 0.308597ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.969534ms + 0.143884ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:03.272 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.990983ms + 0.144834ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.274 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.873784ms + 0.152851ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.277 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.33833ms + 0.154131ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.280 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.317492ms + 0.544766ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.312951ms + 0.218547ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 29.034232ms
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911883253 end=1713911883283 duration=30 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.294 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.294 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 alter_table: hive.db5.tbl5 newtbl=tbl5
[INFO ] 2024-04-23 23:38:03.294 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db5.tbl5 newtbl=tbl5	
[DEBUG] 2024-04-23 23:38:03.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.601296ms
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:03.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.483477ms
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.305 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.14231ms
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db5
[WARN ] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:38:03.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:38:03.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.326 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.327 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911883294 end=1713911883327 duration=33 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.329 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.329 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.329 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.329 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 2
[DEBUG] 2024-04-23 23:38:03.331 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.331 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883331 end=1713911883331 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.332 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: source:127.0.0.1 get_table_metas : tbl=hive.*.*tblfoo*
[INFO ] 2024-04-23 23:38:03.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*tblfoo*	
[INFO ] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46a2ebc7, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46a2ebc7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@35b59db4 created in the thread with id: 111
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.338 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.339 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46a2ebc7 from thread id: 111
[DEBUG] 2024-04-23 23:38:03.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableName.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*tblfoo.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911883332 end=1713911883346 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.346 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: *tblfoo* found: 0
[INFO ] 2024-04-23 23:38:03.346 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46a2ebc7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@35b59db4 will be shutdown
[INFO ] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911883346 end=1713911883346 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.348 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.04068ms + 0.012128ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.599409ms + 0.122291ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.269303ms + 0.330646ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:03.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.242376ms + 0.264518ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.351 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.31457ms + 0.171484ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:03.351 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.347817ms + 0.136626ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.352 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.22606ms + 0.123621ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.352 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.246912ms + 0.125182ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.341312ms + 0.345546ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.272933ms + 0.12943ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.918351ms
[DEBUG] 2024-04-23 23:38:03.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.354 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.354 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911883346 end=1713911883354 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.355 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.356 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.356 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.356 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 2
[DEBUG] 2024-04-23 23:38:03.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883356 end=1713911883356 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.357 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.357 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: source:127.0.0.1 get_table_metas : tbl=hive.*.tbl5*
[INFO ] 2024-04-23 23:38:03.357 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.tbl5*	
[INFO ] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@946497e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@946497e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@38056171 created in the thread with id: 112
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.361 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.363 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@946497e from thread id: 112
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableName.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i)tbl5.*, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:38:03.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.372 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.357401ms
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911883357 end=1713911883373 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.374 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: tbl5* found: 1
[DEBUG] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: source:127.0.0.1 get_database: db5
[INFO ] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db5	
[DEBUG] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.026984ms
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911883374 end=1713911883375 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.375 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: source:127.0.0.1 get_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.100839ms
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.390 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:03.392 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:03.392 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911883376 end=1713911883392 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.392 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=16, comments=HMS client
[INFO ] 2024-04-23 23:38:03.392 [main] PartitionManagementTask - Found 1 candidate tables for partition discovery
[INFO ] 2024-04-23 23:38:03.395 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:38:03.395 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:38:03.395 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:38:03.396 [main] PartitionManagementTask - Running partition discovery for table hive.db5.tbl5 retentionPeriod: -1s
[INFO ] 2024-04-23 23:38:03.398 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.398 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.398 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.398 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 3
[DEBUG] 2024-04-23 23:38:03.399 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.399 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883399 end=1713911883399 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=10 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.400 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.400 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: source:127.0.0.1 get_database: db5
[INFO ] 2024-04-23 23:38:03.400 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db5	
[INFO ] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1ab3adc8, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1ab3adc8, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7dc66d1a created in the thread with id: 114
[DEBUG] 2024-04-23 23:38:03.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.406 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.407 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1ab3adc8 from thread id: 114
[DEBUG] 2024-04-23 23:38:03.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.482516ms
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911883400 end=1713911883408 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=10 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.408 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=9, comments=HMS client
[INFO ] 2024-04-23 23:38:03.409 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.409 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.409 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.409 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 4
[DEBUG] 2024-04-23 23:38:03.410 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.410 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883410 end=1713911883410 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.410 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.410 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.411 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: source:127.0.0.1 get_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.411 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db5.tbl5	
[INFO ] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@224367de, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@224367de, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7b286dbd created in the thread with id: 115
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.414 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.416 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@224367de from thread id: 115
[DEBUG] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.780917ms
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.431 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:03.433 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:03.433 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911883410 end=1713911883433 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.433 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=23, comments=HMS client
[DEBUG] 2024-04-23 23:38:03.437 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partition_names from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: source:127.0.0.1 get_partition_names : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partition_names : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionNames
[DEBUG] 2024-04-23 23:38:03.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.450 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.450 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partition_names start=1713911883438 end=1713911883450 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.453 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.455 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions_by_names_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.455 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: source:127.0.0.1 get_partitions_by_names : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.455 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions_by_names : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.463 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 7.530221ms + 0.027751ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:38:03.471 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 6.781078ms + 0.17376ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,2,3) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.476 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.659503ms + 0.597246ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,2,3) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:03.480 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.50045ms + 0.433687ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.481 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.597762ms + 0.316929ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:03.482 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.603556ms + 0.266594ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.483 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.604363ms + 0.272139ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.484 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.561199ms + 0.242384ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.485 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.636847ms + 0.595627ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.509785ms + 0.25696ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 30.355466ms
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:03.494 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:03.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.495 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.497 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions_by_names_req start=1713911883455 end=1713911883497 duration=42 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.500 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Using multi-threaded version of MSCK-GetPaths with number of threads 15
[DEBUG] 2024-04-23 23:38:03.505 [PartitionDiscoveryTask-0] MetaStoreServerUtils - tablePath:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5, partCols: [state, dt]
[DEBUG] 2024-04-23 23:38:03.505 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting '2018-12-01' to type: 'date'.
[DEBUG] 2024-04-23 23:38:03.505 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=WA
[DEBUG] 2024-04-23 23:38:03.505 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting 'WA' to type: 'string'.
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - PartitionName: state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - tablePath:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5, partCols: [dt, state]
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting '2018-12-02' to type: 'date'.
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=UT
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting 'UT' to type: 'string'.
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - PartitionName: state=UT/dt=2018-12-02
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitions not in metastore : 2
[INFO ] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitionsNotInMs=[tbl5:state=UT/dt=2018-12-02, tbl5:state=WA/dt=2018-12-01], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
[INFO ] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] Msck - hive.db5.tbl5 - #partsNotInMs: 2 #partsNotInFs: 0 #expiredPartitions: 0 lockRequired: true (R: true A: true D: true)
[DEBUG] 2024-04-23 23:38:03.508 [PartitionDiscoveryTask-0] Msck - Repair: Added partition to metastore tbl5:state=UT/dt=2018-12-02
[DEBUG] 2024-04-23 23:38:03.508 [PartitionDiscoveryTask-0] Msck - Repair: Added partition to metastore tbl5:state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:38:03.510 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.512 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partitions_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.513 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: add_partitions
[INFO ] 2024-04-23 23:38:03.513 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=add_partitions	
[DEBUG] 2024-04-23 23:38:03.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.514 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.527622ms
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.522 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.195203ms
[DEBUG] 2024-04-23 23:38:03.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.527 [HMSHandler #1] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.lambda$createPartitionFolders$14(HMSHandler.java:4385)
[DEBUG] 2024-04-23 23:38:03.527 [HMSHandler #0] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.lambda$createPartitionFolders$14(HMSHandler.java:4385)
[DEBUG] 2024-04-23 23:38:03.527 [HMSHandler #0] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.527 [HMSHandler #1] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #0] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #1] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #0] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #1] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #0] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #1] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.528 [HMSHandler #1] MetaStoreServerUtils - Updating partition stats fast for: tbl5
[INFO ] 2024-04-23 23:38:03.528 [HMSHandler #0] MetaStoreServerUtils - Updating partition stats fast for: tbl5
[INFO ] 2024-04-23 23:38:03.528 [HMSHandler #0] MetaStoreServerUtils - Updated size to 0
[INFO ] 2024-04-23 23:38:03.528 [HMSHandler #1] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:38:03.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.546 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.548 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partitions_req start=1713911883512 end=1713911883548 duration=36 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.549 [PartitionDiscoveryTask-0] Msck - Tables not in metastore: []
Tables missing on filesystem: []
Partitions not in metastore: [tbl5:state=UT/dt=2018-12-02, tbl5:state=WA/dt=2018-12-01]
Partitions missing from filesystem: []
Expired partitions: []

[INFO ] 2024-04-23 23:38:03.550 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:03.550 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:38:03.550 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@224367de, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7b286dbd will be shutdown
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1ab3adc8, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7dc66d1a will be shutdown
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@946497e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@38056171 will be shutdown
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911883550 end=1713911883550 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=10 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911883550 end=1713911883551 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911883550 end=1713911883551 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.552 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.354588ms + 0.01029ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.557 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.972078ms + 0.177782ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,4,5,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.561 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.714178ms + 0.835791ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,4,5,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:03.565 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.875607ms + 0.324634ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,4,5,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.568 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.363728ms + 0.142947ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,5,6,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:03.570 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.070468ms + 0.182577ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.572 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.943021ms + 0.157814ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.574 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.872889ms + 0.152777ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.575 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.307196ms + 0.292788ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.934396ms + 0.140577ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,5,6,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 5 entries retrieved using SQL in 26.700493ms
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911883550 end=1713911883577 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.578 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.581 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911883579 end=1713911883582 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.585 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.585 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911883582 end=1713911883585 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_database: db5
[INFO ] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db5	
[DEBUG] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.611805ms
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911883586 end=1713911883587 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.588 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_tables_by_type: db=@hive#db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.376062ms
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.585395ms
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911883588 end=1713911883593 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.594 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:03.594 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:03.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.341783ms
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911883593 end=1713911883597 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.597 [main] HiveMetaStoreClient - Selecting dropDatabase method for db5 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:38:03.597 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.830779ms
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_multi_table : db=db5 tbls=tbl5
[INFO ] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db5 tbls=tbl5	
[DEBUG] 2024-04-23 23:38:03.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.540029ms
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911883597 end=1713911883607 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.384799ms
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:03.610 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:03.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.956724ms
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.623 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.628 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:03.628 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:03.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.634 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.638 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:03.638 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:03.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.663 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:03.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.668 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.250212ms
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.664773ms
[DEBUG] 2024-04-23 23:38:03.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.098515ms
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:03.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:03.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:03.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:03.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.703 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:03.703 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.703 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.706 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.708 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.710 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.713 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.715 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.717 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:03.717 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.719 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:03.719 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:05.720 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:05.720 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:05.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:05.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.721 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.448883ms
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.781322ms
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.725 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:05.725 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.726 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:05.727 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:05.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.728 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:05.728 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:05.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.308518ms
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.797065ms
[DEBUG] 2024-04-23 23:38:05.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:05.732 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:05.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.160504ms
[DEBUG] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:05.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:05.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:05.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:05.738 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:05.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:05.739 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:07.739 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:07.740 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:07.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:07.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.744 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 4.544131ms
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.386672ms
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.754 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:07.754 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:07.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.758 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:07.758 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:07.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:07.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:07.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.765 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:07.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.838318ms
[DEBUG] 2024-04-23 23:38:07.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.379293ms
[DEBUG] 2024-04-23 23:38:07.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.090493ms
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:07.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:07.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:07.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:07.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:07.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:07.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.776 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:07.779 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:07.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:07.779 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:09.780 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:09.780 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:09.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:09.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 16.699457ms
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.01425ms
[DEBUG] 2024-04-23 23:38:09.799 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:09.799 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:09.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.801 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:09.801 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:09.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.802 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:09.802 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:09.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.803 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:09.803 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:09.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.446779ms
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.625997ms
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:09.807 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.230641ms
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:09.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:09.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:09.812 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:09.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:09.813 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:11.813 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:11.814 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:11.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:11.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.817 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.7824ms
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.679195ms
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.821 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:11.821 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:11.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.822 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:11.822 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:11.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.823 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:11.823 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:11.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.824 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.211733ms
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.624415ms
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.790145ms
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:11.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:11.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:11.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:11.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:11.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.834 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.834 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:11.834 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:11.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:11.835 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:11.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:11.836 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:13.837 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:13.837 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:13.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:13.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.840 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.933851ms
[DEBUG] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:13.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.012337ms
[DEBUG] 2024-04-23 23:38:13.844 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:13.844 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:13.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.850 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:13.851 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:13.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.855 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:13.855 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:13.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.858 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:13.858 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:13.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.859 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.523571ms
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.660558ms
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.958135ms
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:13.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:13.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:13.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:13.866 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:13.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:13.866 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:13.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:13.867 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:15.867 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:15.867 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:15.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:15.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.871 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:15.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.91743ms
[DEBUG] 2024-04-23 23:38:15.872 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:15.872 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:15.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.814411ms
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.875 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:15.875 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:15.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.876 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:15.876 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:15.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.877 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:15.877 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:15.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.999119ms
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.623679ms
[DEBUG] 2024-04-23 23:38:15.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.968087ms
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:15.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:15.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:15.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.885 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:15.885 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:15.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:15.885 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:15.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:15.886 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:16.406 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:17.887 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:17.887 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:17.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:17.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.931664ms
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.622507ms
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.894 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:17.894 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:17.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.896 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:17.896 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:17.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.952732ms
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.763306ms
[DEBUG] 2024-04-23 23:38:17.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:17.899 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.971606ms
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:17.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:17.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:17.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:17.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.902 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.904 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:17.904 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:17.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:17.905 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:17.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:17.905 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:19.906 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:19.907 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:19.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:19.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.33988ms
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.691367ms
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.913 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:19.913 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:19.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.914 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:19.914 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:19.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.915 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:19.915 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:19.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.916 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.094354ms
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.582201ms
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.918 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.925252ms
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:19.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:19.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:19.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:19.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:19.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:19.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:19.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:19.924 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:21.007 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:21.012 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:21.925 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:21.925 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:21.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:21.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.817585ms
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.578043ms
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.931 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:21.931 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:21.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.932 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:21.932 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:21.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.934 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:21.934 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:21.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.282563ms
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.540911ms
[DEBUG] 2024-04-23 23:38:21.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.216648ms
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:21.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:21.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:21.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:21.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:21.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:21.944 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:21.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:21.945 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:21.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:21.945 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:23.946 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:23.946 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:23.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:23.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.949 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.492119ms
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.699024ms
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.953 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:23.953 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:23.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.954 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:23.954 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:23.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.955 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:23.955 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:23.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.09903ms
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.617645ms
[DEBUG] 2024-04-23 23:38:23.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.084271ms
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:23.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:23.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:23.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:23.963 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:23.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:23.964 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:38:23.964 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911883608 end=1713911903964 duration=20356 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testNoPartitionRetentionForReplTarget" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="40.204"/>
  <testcase name="testPartitionDiscoveryDBPattern" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.157">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoveryDBPattern(TestPartitionManagement.java:383)
]]></failure>
    <system-out><![CDATA[[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2389ccad, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2e276e2f will be shutdown
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911944174 end=1713911944174 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:04.174 [main] MetastoreConf - Unable to find config file: hive-site.xml
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:04.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:04.175 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:04.175 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:04.175 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:04.175 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:04.183 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:04.183 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:04.183 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:04.183 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:04.185 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:04.219 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[INFO ] 2024-04-23 23:39:04.681 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:39:04.681 [MetaStoreThread-34771] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:39:04.681 [MetaStoreThread-34771] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:04.681 [MetaStoreThread-34771] HMSHandler - 17: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - HikariPool-6 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - HikariPool-6 - configuration:
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true"
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - poolName........................"HikariPool-6"
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariDataSource - HikariPool-6 - Starting...
[INFO ] 2024-04-23 23:39:04.686 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:04.686 [MetaStoreThread-34771] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:04.686 [MetaStoreThread-34771] HikariDataSource - HikariPool-6 - Start completed.
[DEBUG] 2024-04-23 23:39:04.787 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:04.788 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.789 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@871788486 (XID = 1145), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.790 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@34561368 (XID = 1147), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.792 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1406767241 (XID = 1149), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.793 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@297178739 (XID = 1151), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.794 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1469558777 (XID = 1153), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.795 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1152806588 (XID = 1155), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.797 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1335723654 (XID = 1157), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.798 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1789065719 (XID = 1159), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.798 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2dbb692b, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2dbb692b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6f30b336 created in the thread with id: 159
[DEBUG] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.892 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.892 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.987 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.164 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.181 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.219 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.236 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.241 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.354 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.382 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.389 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.395 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.398 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.399 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.399 [MetaStoreThread-34771] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:05.399 [MetaStoreThread-34771] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:05.400 [MetaStoreThread-34771] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2dbb692b from thread id: 159
[DEBUG] 2024-04-23 23:39:05.400 [MetaStoreThread-34771] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:05.400 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.403 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.406 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.406 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.406 [MetaStoreThread-34771] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:05.406 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.407 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.407 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.407 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.407 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.410 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.410 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - db details for db default retrieved using SQL in 2.111933ms
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.417 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.419 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.420 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.423 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.423 [MetaStoreThread-34771] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:05.423 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.423 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.426 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.429 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.431 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.433 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.436 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.436 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.440 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.443 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.445 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.447 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] PerfLogger - </PERFLOG method=init start=1713911944681 end=1713911945448 duration=767 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Started the new metaserver on port [34771]...
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:39:05.683 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:05.684 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:05.684 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:05.696 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771) is created
[INFO ] 2024-04-23 23:39:05.696 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 34771 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[INFO ] 2024-04-23 23:39:05.696 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:05.704 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:05.705 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34771]
[INFO ] 2024-04-23 23:39:05.705 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34771)
[INFO ] 2024-04-23 23:39:05.705 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34771) current connections: 2
[DEBUG] 2024-04-23 23:39:05.707 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.707 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911945707 end=1713911945707 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.708 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.708 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.708 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 create_database: Database(name:db4, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:05.708 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db4, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:39:05.710 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:05.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f7c4374, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:05.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:05.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f7c4374, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4bf11fd9 created in the thread with id: 176
[DEBUG] 2024-04-23 23:39:05.715 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.715 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.716 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.720 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.721 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.722 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:05.723 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f7c4374 from thread id: 176
[DEBUG] 2024-04-23 23:39:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.724 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.384547ms
[DEBUG] 2024-04-23 23:39:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db4, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.727 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.727 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db for database db4. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.734 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.735 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911945708 end=1713911945735 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.736 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.736 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.736 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 create_table_req: Table(tableName:tbl4, dbName:db4, owner:alex, createTime:1713911945, lastAccessTime:1713911945, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:39:05.736 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl4, dbName:db4, owner:alex, createTime:1713911945, lastAccessTime:1713911945, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:05.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.745 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 9.416694ms
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.746727ms
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771/db4.db/tbl4
[DEBUG] 2024-04-23 23:39:05.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.774 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.779 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.784 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.788 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.801 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911945736 end=1713911945802 duration=66 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:05.854 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771/db4.db/tbl4/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:39:05.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.864 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.876 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.877 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911945802 end=1713911945877 duration=75 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.877 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771/db4.db/tbl4/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:39:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.896 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.897 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911945878 end=1713911945897 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771/db4.db/tbl4/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:39:05.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.918 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911945898 end=1713911945920 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911945921 end=1713911945921 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_table : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.522736ms
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.931 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911945921 end=1713911945933 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.933 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=12, comments=HMS client
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.939 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 5.0768ms + 0.010775ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:05.943 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.232754ms + 0.111023ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:05.946 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.202822ms + 0.421809ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:05.949 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.082216ms + 0.322385ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.951 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.175146ms + 0.202708ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:05.953 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.886394ms + 0.18288ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.956 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.938682ms + 0.125137ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.957 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.300804ms + 0.119363ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.959 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.572466ms + 0.265306ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.641292ms + 0.119539ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 27.442605ms
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911945933 end=1713911945961 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.972 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.973 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.973 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 alter_table: hive.db4.tbl4 newtbl=tbl4
[INFO ] 2024-04-23 23:39:05.973 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db4.tbl4 newtbl=tbl4	
[DEBUG] 2024-04-23 23:39:05.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.287976ms
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:05.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.975 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.27327ms
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.983 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.126471ms
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db4
[WARN ] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:05.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:05.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:06.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.003 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.004 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911945973 end=1713911946004 duration=31 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:06.005 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:06.005 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34771]
[INFO ] 2024-04-23 23:39:06.006 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34771)
[INFO ] 2024-04-23 23:39:06.006 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34771) current connections: 3
[DEBUG] 2024-04-23 23:39:06.006 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.006 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911946006 end=1713911946006 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=20 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.007 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.007 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.007 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: source:127.0.0.1 get_table_metas : tbl=hive.*dbfoo*.*
[INFO ] 2024-04-23 23:39:06.007 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*dbfoo*.*	
[INFO ] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7dca7529, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7dca7529, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@33a8c207 created in the thread with id: 189
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.010 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7dca7529 from thread id: 189
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*dbfoo.*, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911946007 end=1713911946017 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=20 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:06.017 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *dbfoo* tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:06.017 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7dca7529, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@33a8c207 will be shutdown
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[INFO ] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911946017 end=1713911946017 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=20 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:06.018 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:06.018 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:06.019 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.27884ms + 0.007595ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:06.020 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.81912ms + 0.127464ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:06.021 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.315208ms + 0.389294ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:06.022 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.273548ms + 0.273763ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.022 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.286366ms + 0.185003ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:06.023 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.27199ms + 0.183617ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.023 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.27496ms + 0.181709ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.024 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.274403ms + 0.175685ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.383104ms + 0.419902ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.336001ms + 0.183291ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.851232ms
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.026 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.026 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911946017 end=1713911946026 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:06.027 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:06.027 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34771]
[INFO ] 2024-04-23 23:39:06.027 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34771)
[INFO ] 2024-04-23 23:39:06.028 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34771) current connections: 3
[DEBUG] 2024-04-23 23:39:06.028 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.028 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911946028 end=1713911946028 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=21 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.029 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.029 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.029 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: source:127.0.0.1 get_table_metas : tbl=hive.*db4*.*
[INFO ] 2024-04-23 23:39:06.029 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*db4*.*	
[INFO ] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fe32b6c, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fe32b6c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2eb6b0a6 created in the thread with id: 190
[DEBUG] 2024-04-23 23:39:06.031 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.031 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.031 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fe32b6c from thread id: 190
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*db4.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:39:06.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.037 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911946029 end=1713911946038 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=21 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:06.038 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *db4* tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:06.038 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fe32b6c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2eb6b0a6 will be shutdown
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911946038 end=1713911946038 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=21 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:06.039 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.00693ms + 0.00613ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:06.040 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.52251ms + 0.079974ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:06.041 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.23987ms + 0.324999ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:06.041 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.201088ms + 0.180606ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.042 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.21927ms + 0.153117ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:06.042 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.178162ms + 0.121442ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.042 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.188362ms + 0.149612ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.043 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.209146ms + 0.114506ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.043 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.270482ms + 0.326058ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.246571ms + 0.118579ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.80532ms
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911946038 end=1713911946044 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.048 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.048 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911946045 end=1713911946048 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.048 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.049 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.049 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:06.049 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:06.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911946049 end=1713911946052 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_database: db4
[INFO ] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db4	
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.053 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.326511ms
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911946052 end=1713911946054 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.054 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_tables_by_type: db=@hive#db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.055 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.835397ms
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.518768ms
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911946054 end=1713911946060 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.661594ms
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911946060 end=1713911946063 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.063 [main] HiveMetaStoreClient - Selecting dropDatabase method for db4 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:06.063 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.064 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.28701ms
[DEBUG] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_multi_table : db=db4 tbls=tbl4
[INFO ] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db4 tbls=tbl4	
[DEBUG] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.159635ms
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911946063 end=1713911946071 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.02855ms
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.571444ms
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.083 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.088 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:06.088 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:06.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.093 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.097 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:06.097 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:06.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.119 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.124 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.326112ms
[DEBUG] 2024-04-23 23:39:06.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.732306ms
[DEBUG] 2024-04-23 23:39:06.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:06.127 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.26205ms
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:06.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:06.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:06.149 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:06.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.156 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:06.156 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.156 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.157 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.159 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.160 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.161 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.162 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.163 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:06.163 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.164 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:06.164 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:08.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:08.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:08.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:08.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.99635ms
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:08.171 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:08.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.878616ms
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.174 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:08.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:08.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:08.175 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:08.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.176 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:08.176 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:08.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.186677ms
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.467659ms
[DEBUG] 2024-04-23 23:39:08.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:08.179 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.221583ms
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:08.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:08.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:08.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:08.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:08.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:08.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:08.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:08.184 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:10.184 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:10.184 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:10.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:10.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.187 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:10.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.878786ms
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.508416ms
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.190 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:10.190 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:10.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.192 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.22341ms
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.48358ms
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.870794ms
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:10.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:10.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:10.199 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:10.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:10.199 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:12.200 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:12.200 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:12.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:12.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.203 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:12.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.438593ms
[DEBUG] 2024-04-23 23:39:12.204 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:12.204 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:12.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.839811ms
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.206 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:12.206 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:12.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:12.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:12.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.208 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:12.208 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:12.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.901644ms
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.711594ms
[DEBUG] 2024-04-23 23:39:12.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.853761ms
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:12.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:12.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:12.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:12.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:12.216 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:14.216 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:14.217 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:14.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:14.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.219 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 4.016902ms
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.05272ms
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.224 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:14.224 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:14.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.225 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:14.225 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:14.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.226 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.948899ms
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.545116ms
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:14.229 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.919968ms
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:14.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:14.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:14.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.234 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:14.234 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:14.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:14.234 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:14.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:14.235 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:16.235 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:16.235 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:16.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:16.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.239 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 4.362664ms
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.087628ms
[DEBUG] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.243 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:16.243 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:16.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.245 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:16.245 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:16.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.246 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:16.246 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:16.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.896172ms
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.452247ms
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.726168ms
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:16.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:16.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:16.253 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:16.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:16.253 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:16.408 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:18.254 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:18.254 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:18.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:18.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.257 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:18.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.376287ms
[DEBUG] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.06892ms
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.261 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:18.261 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:18.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.262 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:18.263 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:18.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.264 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:18.264 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:18.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.004546ms
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.462285ms
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:18.266 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.771501ms
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:18.270 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:18.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:18.270 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:20.271 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:20.271 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:20.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:20.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.164742ms
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.589043ms
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.276 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:20.276 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.278 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:20.278 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:20.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.79218ms
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.453715ms
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.822272ms
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:20.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:20.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:20.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:21.009 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:21.013 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:22.285 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:22.285 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:22.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:22.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.288 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:22.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.95511ms
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.519584ms
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.842868ms
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.476534ms
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.829591ms
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:22.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:22.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:22.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:22.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:22.299 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:22.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:22.299 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:24.300 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:24.300 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:24.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:24.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.303 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.327808ms
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.697923ms
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.306 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:24.306 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:24.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.307 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:24.307 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:24.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.769017ms
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.448599ms
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.768776ms
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:24.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:24.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:24.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:24.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:24.314 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:24.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:24.314 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:24.560 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:26.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:26.315 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:26.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:26.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.318 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.474093ms
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.695042ms
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.321 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:26.321 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:26.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.322 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:26.322 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:26.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.323 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:26.323 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:26.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.951155ms
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.538214ms
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.843811ms
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:26.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:26.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:26.330 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:26.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:26.330 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:26.330 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911946072 end=1713911966330 duration=20258 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryDBPattern" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.157">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
  </testcase>
  <testcase name="testPartitionRetention" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="12.175">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionRetention(TestPartitionManagement.java:537)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:39:26.332 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:39:26.332 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:26.332 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:26.332 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:26.344 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:26.344 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:26.344 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:26.344 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:26.346 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:26.386 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[INFO ] 2024-04-23 23:39:26.909 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:39:26.909 [MetaStoreThread-33211] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:39:26.910 [MetaStoreThread-33211] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:26.910 [MetaStoreThread-33211] HMSHandler - 22: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:26.913 [MetaStoreThread-33211] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:26.913 [MetaStoreThread-33211] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:26.914 [MetaStoreThread-33211] HikariConfig - HikariPool-7 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:26.914 [MetaStoreThread-33211] HikariConfig - HikariPool-7 - configuration:
[DEBUG] 2024-04-23 23:39:26.914 [MetaStoreThread-33211] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true"
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - poolName........................"HikariPool-7"
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariDataSource - HikariPool-7 - Starting...
[INFO ] 2024-04-23 23:39:26.917 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:26.919 [MetaStoreThread-33211] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:26.919 [MetaStoreThread-33211] HikariDataSource - HikariPool-7 - Start completed.
[DEBUG] 2024-04-23 23:39:27.019 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:27.020 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.021 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@734422135 (XID = 1145), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.023 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@438791873 (XID = 1147), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.024 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1273600824 (XID = 1149), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.025 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1052058246 (XID = 1151), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.026 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1336386672 (XID = 1153), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.027 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1867856923 (XID = 1155), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.028 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1397582685 (XID = 1157), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.029 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1908263353 (XID = 1159), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.029 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@518fdf48, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@518fdf48, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@216b096e created in the thread with id: 193
[DEBUG] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.163 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.163 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.243 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.307 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.322 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.358 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.377 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.382 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.495 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.522 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.528 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.536 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.538 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@518fdf48 from thread id: 193
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.544 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.547 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.547 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.547 [MetaStoreThread-33211] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:27.547 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.548 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.548 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.548 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.548 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.551 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.551 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.552 [MetaStoreThread-33211] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] ObjectStore - db details for db default retrieved using SQL in 1.705796ms
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.558 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.560 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.561 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.563 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.563 [MetaStoreThread-33211] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:27.563 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.563 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.566 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.569 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.571 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.574 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.574 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.579 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.582 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.584 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.586 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.586 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.586 [MetaStoreThread-33211] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:27.586 [MetaStoreThread-33211] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] PerfLogger - </PERFLOG method=init start=1713911966910 end=1713911967587 duration=677 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Started the new metaserver on port [33211]...
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:39:27.910 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:27.910 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:27.910 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:27.914 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211) is created
[INFO ] 2024-04-23 23:39:27.914 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 33211 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[INFO ] 2024-04-23 23:39:27.915 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:27.918 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:27.918 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33211]
[INFO ] 2024-04-23 23:39:27.918 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33211)
[INFO ] 2024-04-23 23:39:27.919 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33211) current connections: 3
[DEBUG] 2024-04-23 23:39:27.919 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:27.919 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911967919 end=1713911967919 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:27.919 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 create_database: Database(name:db7, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db7, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68df8ab2, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:27.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68df8ab2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ceee6c8 created in the thread with id: 210
[DEBUG] 2024-04-23 23:39:27.922 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.924 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68df8ab2 from thread id: 210
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.686304ms
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db7, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db for database db7. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.929 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911967920 end=1713911967930 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 create_table_req: Table(tableName:tbl7, dbName:db7, owner:alex, createTime:1713911967, lastAccessTime:1713911967, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl7, dbName:db7, owner:alex, createTime:1713911967, lastAccessTime:1713911967, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.933 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.597233ms
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:27.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.938 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.939 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.079542ms
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db/tbl7
[DEBUG] 2024-04-23 23:39:27.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:27.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:27.953 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.958 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.966 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.981 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911967930 end=1713911967982 duration=52 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:27.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db/tbl7/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:39:28.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.030 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.041 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.042 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911967982 end=1713911968042 duration=60 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.042 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.042 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db/tbl7/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:39:28.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.059 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911968042 end=1713911968061 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db/tbl7/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:39:28.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.078 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911968061 end=1713911968080 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911968080 end=1713911968080 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.081 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_table : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.081 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.359822ms
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.089 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:28.089 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:28.089 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911968081 end=1713911968089 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.090 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=10, comments=HMS client
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.095 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.532013ms + 0.006223ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:28.098 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.675856ms + 0.080384ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:28.100 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.658208ms + 0.336207ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:28.102 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.585545ms + 0.227119ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.104 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.697163ms + 0.126077ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:28.105 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.383681ms + 0.118576ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.107 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.562684ms + 0.119681ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.109 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.277946ms + 0.115919ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.110 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.363146ms + 0.251002ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.480922ms + 0.117251ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 21.691929ms
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911968090 end=1713911968112 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.122 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 alter_table: hive.db7.tbl7 newtbl=tbl7
[INFO ] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db7.tbl7 newtbl=tbl7	
[DEBUG] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.224258ms
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.125 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.274361ms
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.981587ms
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.137 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db7
[WARN ] 2024-04-23 23:39:28.138 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:28.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:28.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:28.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.149 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.150 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911968123 end=1713911968150 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:28.153 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:28.153 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33211]
[INFO ] 2024-04-23 23:39:28.153 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33211)
[INFO ] 2024-04-23 23:39:28.154 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33211) current connections: 4
[DEBUG] 2024-04-23 23:39:28.154 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911968154 end=1713911968155 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=25 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@58bde9c3, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@58bde9c3, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@137e10b created in the thread with id: 223
[DEBUG] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@58bde9c3 from thread id: 223
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:28.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.165 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911968155 end=1713911968165 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=25 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:28.166 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:28.166 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@58bde9c3, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@137e10b will be shutdown
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911968166 end=1713911968166 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=25 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:28.167 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.907119ms + 0.005528ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:28.168 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.485177ms + 0.076028ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:28.168 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.195921ms + 0.268706ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:28.169 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.190787ms + 0.167588ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.169 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.237051ms + 0.115971ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:28.170 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.208336ms + 0.143216ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.170 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.204047ms + 0.116705ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.170 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.233183ms + 0.13825ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.290764ms + 0.243489ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.193775ms + 0.110673ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.396947ms
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911968166 end=1713911968172 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911968172 end=1713911968175 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:28.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.178 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911968175 end=1713911968179 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_database: db7
[INFO ] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db7	
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.390132ms
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911968179 end=1713911968180 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.181 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_tables_by_type: db=@hive#db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.275409ms
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.621059ms
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911968181 end=1713911968185 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.49133ms
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911968185 end=1713911968188 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.188 [main] HiveMetaStoreClient - Selecting dropDatabase method for db7 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:28.188 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.00682ms
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_multi_table : db=db7 tbls=tbl7
[INFO ] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db7 tbls=tbl7	
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.193 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.941476ms
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911968188 end=1713911968194 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.953641ms
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.495987ms
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.203 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:28.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:28.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.211 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.214 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:28.214 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:28.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.235 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.079524ms
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.672439ms
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.930063ms
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:28.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:28.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:28.259 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:28.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.267 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:28.267 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.267 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.268 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.271 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.272 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.274 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.275 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:28.275 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.276 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:28.276 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:30.277 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:30.277 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:30.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:30.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.900099ms
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.550051ms
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.284 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:30.284 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:30.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.286 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:30.286 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:30.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.286 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.876656ms
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.456395ms
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:30.288 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.964537ms
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:30.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:30.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:30.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:30.292 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:30.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:30.293 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:32.149 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:32.293 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:32.293 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.296 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.483013ms
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.538571ms
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.862681ms
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.512427ms
[DEBUG] 2024-04-23 23:39:32.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.808228ms
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:32.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:32.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:32.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:32.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:32.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:32.308 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:34.309 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:34.309 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:34.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:34.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.311 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 2.243661ms
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.487873ms
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:34.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:34.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:34.315 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:34.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.316 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:34.316 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:34.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.795717ms
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.460517ms
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.835708ms
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:34.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:34.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:34.323 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:34.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:34.323 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:34.787 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:36.324 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:36.324 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:36.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:36.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.327 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.33052ms
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.552447ms
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.330 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:36.330 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:36.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.331 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:36.331 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:36.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.8679ms
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.477696ms
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:36.334 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.854196ms
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:36.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:36.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:36.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.338 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:36.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:36.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:36.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:36.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:36.339 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:38.340 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:38.340 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:38.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:38.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.172149ms
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.536708ms
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:38.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:38.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.347 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:38.347 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:38.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.348 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:38.348 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:38.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.885103ms
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.498425ms
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:38.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:38.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.372 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.046498ms + 0.006148ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:39:38.376 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.607664ms + 0.006155ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.378 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.615849ms + 0.00498ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.380 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.758052ms + 0.005557ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.382 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.859934ms + 0.00614ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.384 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.861332ms + 0.006193ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.386 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.013327ms + 0.006154ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.389 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.5479ms + 0.005664ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.391 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.611528ms + 0.004697ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.393 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.684798ms + 0.005134ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.395 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.713327ms + 0.005654ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.397 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.505544ms + 0.006074ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.399 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.710514ms + 0.005222ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.401 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.836229ms + 0.005413ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 33.913507ms
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_table : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.863515ms
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.86844ms
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:38.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:38.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:39:38.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.425 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.433 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:38.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:38.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:38.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:39:38.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:38.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:39:38.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:38.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:38.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:38.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:38.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:38.502 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.503 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:38.503 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db7
[DEBUG] 2024-04-23 23:39:38.503 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db
[INFO ] 2024-04-23 23:39:38.503 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:39:38.505 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:38.505 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db7
[DEBUG] 2024-04-23 23:39:38.505 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db
[DEBUG] 2024-04-23 23:39:38.505 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911968194 end=1713911978505 duration=10311 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=5 error=false>
[INFO ] 2024-04-23 23:39:38.506 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68df8ab2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ceee6c8 will be shutdown
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryNonDefaultCatalog" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="4.039">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoveryNonDefaultCatalog(TestPartitionManagement.java:344)
]]></failure>
    <system-out><![CDATA[[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911978506 end=1713911978506 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:38.506 [main] MetastoreConf - Unable to find config file: hive-site.xml
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:38.507 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:38.507 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:38.507 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:38.518 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:38.518 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:38.518 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:38.518 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:38.519 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:38.566 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[INFO ] 2024-04-23 23:39:39.001 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:39:39.002 [MetaStoreThread-35243] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:39:39.003 [MetaStoreThread-35243] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] HMSHandler - 26: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:39.008 [MetaStoreThread-35243] HikariConfig - HikariPool-8 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:39.008 [MetaStoreThread-35243] HikariConfig - HikariPool-8 - configuration:
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true"
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - poolName........................"HikariPool-8"
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariDataSource - HikariPool-8 - Starting...
[INFO ] 2024-04-23 23:39:39.014 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:39.014 [MetaStoreThread-35243] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.015 [MetaStoreThread-35243] HikariDataSource - HikariPool-8 - Start completed.
[DEBUG] 2024-04-23 23:39:39.115 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:39.130 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.131 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1143947317 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.132 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1965114459 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.133 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@604028794 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.135 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@407565634 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.136 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@542009307 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.137 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@993002363 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.138 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1312702645 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.139 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2038402096 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.140 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:39.269 [MetaStoreThread-35243] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:39.269 [MetaStoreThread-35243] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2278b3dd, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:39.269 [MetaStoreThread-35243] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:39.270 [MetaStoreThread-35243] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2278b3dd, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2a07ce18 created in the thread with id: 226
[DEBUG] 2024-04-23 23:39:39.270 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.270 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.270 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.347 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.419 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.433 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.467 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.481 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.486 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.585 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.612 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.618 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.624 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.626 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2278b3dd from thread id: 226
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.631 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.633 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.635 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.635 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.637 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.637 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - db details for db default retrieved using SQL in 1.823713ms
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.644 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.646 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.647 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.649 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.649 [MetaStoreThread-35243] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:39.649 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.649 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:39.653 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.655 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:39.657 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.658 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:39.661 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:39.661 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:39.664 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.667 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:39.669 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.671 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.671 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.671 [MetaStoreThread-35243] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] PerfLogger - </PERFLOG method=init start=1713911979003 end=1713911979672 duration=669 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Started the new metaserver on port [35243]...
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:39:40.002 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:40.002 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.002 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:40.006 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35243) is created
[INFO ] 2024-04-23 23:39:40.006 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 35243 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35243 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[INFO ] 2024-04-23 23:39:40.006 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:40.010 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:40.010 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35243]
[INFO ] 2024-04-23 23:39:40.010 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35243)
[INFO ] 2024-04-23 23:39:40.010 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35243) current connections: 3
[DEBUG] 2024-04-23 23:39:40.010 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.010 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911980010 end=1713911980010 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.014 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.015 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_catalog from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 create_catalog: Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3)
[INFO ] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_catalog: Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3)	
[INFO ] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@786b877, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:40.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@786b877, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@555e18e4 created in the thread with id: 243
[DEBUG] 2024-04-23 23:39:40.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.019 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@786b877 from thread id: 243
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Creating catalog Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3, createTime:1713911980)
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.025 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:39:40.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.030 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.030 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_catalog start=1713911980015 end=1713911980030 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 create_database: Database(name:db3, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:cat3, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db3, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:cat3, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.006049ms
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database cat3.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.035 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.035 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911980031 end=1713911980035 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.035 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.035 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.036 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 create_table_req: Table(tableName:tbl3, dbName:db3, owner:alex, createTime:1713911980, lastAccessTime:1713911980, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:do, type:double, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:cat3, ownerType:USER)
[INFO ] 2024-04-23 23:39:40.036 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl3, dbName:db3, owner:alex, createTime:1713911980, lastAccessTime:1713911980, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:do, type:double, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:cat3, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:40.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.038 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.215864ms
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.95099ms
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.052 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.057 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.062 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.066 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.080 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911980035 end=1713911980080 duration=45 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:39:40.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.137 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.149 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.150 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911980081 end=1713911980150 duration=69 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.151 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911980152 end=1713911980166 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.180 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.181 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911980167 end=1713911980181 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911980182 end=1713911980182 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_table : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.277445ms
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.190 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911980182 end=1713911980191 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.191 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:40.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.195 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.193951ms + 0.006043ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.198 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.74258ms + 0.09938ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.201 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.594136ms + 0.615431ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:40.203 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.444716ms + 0.241413ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.204 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.487351ms + 0.127365ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:40.206 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.565851ms + 0.124858ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.208 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.353433ms + 0.122851ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.209 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.239954ms + 0.120669ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.211 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.359611ms + 0.316753ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.386151ms + 0.121322ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.562161ms
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.213 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.213 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911980191 end=1713911980213 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.214 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.215 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.215 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 alter_table: cat3.db3.tbl3 newtbl=tbl3
[INFO ] 2024-04-23 23:39:40.215 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: cat3.db3.tbl3 newtbl=tbl3	
[DEBUG] 2024-04-23 23:39:40.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.230944ms
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.03077ms
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.223 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.224 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.960678ms
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db3
[WARN ] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:40.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.239 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.240 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911980215 end=1713911980240 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:40.241 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:40.241 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35243]
[INFO ] 2024-04-23 23:39:40.241 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35243)
[INFO ] 2024-04-23 23:39:40.241 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35243) current connections: 4
[DEBUG] 2024-04-23 23:39:40.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911980241 end=1713911980242 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=29 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68608c09, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68608c09, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@64a3ab1f created in the thread with id: 244
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68608c09 from thread id: 244
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:39:40.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911980242 end=1713911980251 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=29 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:40.251 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:40.251 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68608c09, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@64a3ab1f will be shutdown
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911980251 end=1713911980252 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=29 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.908093ms + 0.005013ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.253 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.398386ms + 0.063728ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.254 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.147945ms + 0.545513ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:40.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.154003ms + 0.214385ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156563ms + 0.103532ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:40.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.143923ms + 0.099779ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.177074ms + 0.098744ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.256 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.152103ms + 0.100037ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.256 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.199053ms + 0.258759ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.166656ms + 0.1023ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.162592ms
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911980251 end=1713911980257 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:40.258 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:40.258 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35243]
[INFO ] 2024-04-23 23:39:40.258 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35243)
[INFO ] 2024-04-23 23:39:40.259 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35243) current connections: 4
[DEBUG] 2024-04-23 23:39:40.259 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.259 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911980259 end=1713911980259 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=30 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: source:127.0.0.1 get_table_metas : tbl=cat3.*.*
[INFO ] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=cat3.*.*	
[INFO ] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15fd0b04, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15fd0b04, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@24221cf9 created in the thread with id: 245
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15fd0b04 from thread id: 245
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: cat3, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:40.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.264 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.264 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911980260 end=1713911980264 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=30 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:40.264 [main] PartitionManagementTask - Looking for tables using catalog: cat3 dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:40.265 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15fd0b04, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@24221cf9 will be shutdown
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911980265 end=1713911980265 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=30 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:40.266 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.912383ms + 0.005282ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.267 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.525098ms + 0.06641ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.268 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.159518ms + 0.565748ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:40.268 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.155699ms + 0.149543ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.269 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.186315ms + 0.103095ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:40.269 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.137115ms + 0.101953ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.269 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156823ms + 0.129919ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.155264ms + 0.129368ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.175309ms + 0.245405ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.16504ms + 0.130188ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.369391ms
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.271 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.271 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911980265 end=1713911980271 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.274 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.274 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911980272 end=1713911980274 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_databases: @cat3#
[INFO ] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @cat3#	
[DEBUG] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.277 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911980275 end=1713911980278 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_database: db3
[INFO ] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db3	
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.003864ms
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911980278 end=1713911980279 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.279 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_tables_by_type: db=@hive#db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.676439ms
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.800591ms
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911980279 end=1713911980283 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.284 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@hive#db3
[INFO ] 2024-04-23 23:39:40.284 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db3	
[DEBUG] 2024-04-23 23:39:40.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.47645ms
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911980283 end=1713911980286 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.286 [main] HiveMetaStoreClient - Selecting dropDatabase method for db3 (0 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:40.286 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.607208ms
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_multi_table : db=db3 tbls=
[INFO ] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db3 tbls=	
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911980286 end=1713911980287 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.962512ms
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.579918ms
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.297 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.301 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:40.301 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:40.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.305 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:40.308 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:40.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.326 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.001956ms
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.521353ms
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.967727ms
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:39:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:40.350 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:40.359 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:42.361 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:39:42.361 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:39:42.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.364 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.34154ms
[DEBUG] 2024-04-23 23:39:42.365 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:39:42.365 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:39:42.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.674762ms
[DEBUG] 2024-04-23 23:39:42.367 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:39:42.367 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:39:42.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.368 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:42.368 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:42.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.369 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:42.369 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:42.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.370 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:42.370 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:42.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.049802ms
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.470764ms
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:42.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:42.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.393 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.005514ms + 0.006343ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:39:42.398 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.590606ms + 0.006373ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.400 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.928029ms + 0.006236ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.401 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.636504ms + 0.005852ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.403 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.995574ms + 0.006264ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.405 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.651233ms + 0.006044ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.407 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.742595ms + 0.005846ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.410 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.418214ms + 0.006286ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.412 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.489699ms + 0.004802ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.413 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.316975ms + 0.004557ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.414 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.375389ms + 0.004937ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.417 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.362687ms + 0.005766ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.419 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.569378ms + 0.005451ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.421 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.150431ms + 0.005342ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 32.414454ms
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_table : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.89644ms
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.773715ms
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:42.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:39:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.450 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:42.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:42.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:42.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:42.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:42.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:39:42.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:42.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:39:42.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:42.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:42.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:42.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:42.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.515 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.515 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:42.515 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db3
[DEBUG] 2024-04-23 23:39:42.516 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db
[INFO ] 2024-04-23 23:39:42.516 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db3
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db
[WARN ] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db does not exist; Force to delete it.
[ERROR] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911980287 end=1713911982517 duration=2230 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=1 error=false>
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_database: default
[INFO ] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: default	
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.518 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3] desc [Default database for catalog cat3] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 1.313157ms
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911982517 end=1713911982519 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.519 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_tables_by_type: db=@hive#default pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#default pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=default pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=default pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external] desc [Default Hive database] owner [public] ownertype [ROLE]
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 1.289438ms
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.717413ms
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911982519 end=1713911982521 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@hive#default
[INFO ] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#default	
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.651419ms
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911982522 end=1713911982522 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.522 [main] HiveMetaStoreClient - Selecting dropDatabase method for default (0 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:42.522 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:42.523 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.523 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.523 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external] desc [Default Hive database] owner [public] ownertype [ROLE]
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 1.104289ms
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_multi_table : db=default tbls=
[INFO ] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=default tbls=	
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911982523 end=1713911982524 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_database: @cat3#default
[INFO ] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#default	
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3] desc [Default database for catalog cat3] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 0.785246ms
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@cat3#default
[INFO ] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#default	
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.481396ms
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_functions: db=@cat3#default pat=*
[INFO ] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#default pat=*	
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.527 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:42.527 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=default pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=default pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3] desc [Default database for catalog cat3] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 0.833587ms
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.481197ms
[INFO ] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.default along with all tables
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: default belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.533 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.533 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:42.533 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: default
[DEBUG] 2024-04-23 23:39:42.533 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[DEBUG] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: default
[DEBUG] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[WARN ] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3 does not exist; Force to delete it.
[ERROR] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[DEBUG] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911982524 end=1713911982534 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.536 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_catalog from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_catalog: cat3
[INFO ] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_catalog: cat3	
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.539 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_databases: @cat3#
[INFO ] 2024-04-23 23:39:42.539 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @cat3#	
[DEBUG] 2024-04-23 23:39:42.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping catalog cat3
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.542 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[WARN ] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3 does not exist; Force to delete it.
[ERROR] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_catalog start=1713911982537 end=1713911982543 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911982544 end=1713911982544 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:42.545 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@786b877, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@555e18e4 will be shutdown
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryTransactionalTable" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="14.105">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoveryTransactionalTable(TestPartitionManagement.java:468)
]]></failure>
    <system-out><![CDATA[[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911982545 end=1713911982545 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:42.545 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:39:42.546 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:42.546 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:42.546 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:42.555 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:42.555 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:42.555 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:42.555 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:42.556 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:42.587 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[INFO ] 2024-04-23 23:39:43.025 [MetaStoreThread-38811] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:39:43.025 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:39:43.025 [MetaStoreThread-38811] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] HMSHandler - 31: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - HikariPool-9 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - HikariPool-9 - configuration:
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true"
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - poolName........................"HikariPool-9"
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariDataSource - HikariPool-9 - Starting...
[INFO ] 2024-04-23 23:39:43.030 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:43.031 [MetaStoreThread-38811] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.031 [MetaStoreThread-38811] HikariDataSource - HikariPool-9 - Start completed.
[DEBUG] 2024-04-23 23:39:43.131 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:43.132 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.134 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1881811780 (XID = 1151), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.135 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1099996754 (XID = 1153), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.136 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@268817419 (XID = 1155), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.137 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1054594446 (XID = 1157), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.138 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@340502719 (XID = 1159), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.140 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1779171005 (XID = 1161), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.141 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@227627647 (XID = 1163), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.142 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1405309175 (XID = 1165), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.142 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5fbbae94, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5fbbae94, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3899cac2 created in the thread with id: 248
[DEBUG] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.240 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.313 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.419 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.435 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.468 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.486 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.491 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.600 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.624 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.631 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.636 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.639 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.640 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.640 [MetaStoreThread-38811] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:43.640 [MetaStoreThread-38811] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:43.641 [MetaStoreThread-38811] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5fbbae94 from thread id: 248
[DEBUG] 2024-04-23 23:39:43.641 [MetaStoreThread-38811] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:43.641 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.645 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.647 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.647 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.647 [MetaStoreThread-38811] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:43.648 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.648 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.648 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.649 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.649 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.651 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.651 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - db details for db default retrieved using SQL in 1.78411ms
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.659 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.660 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.661 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.664 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.664 [MetaStoreThread-38811] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:43.664 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.664 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:43.668 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.670 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:43.673 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.674 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:43.677 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:43.677 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:43.680 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.682 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:43.685 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.686 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.686 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] PerfLogger - </PERFLOG method=init start=1713911983025 end=1713911983687 duration=662 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Started the new metaserver on port [38811]...
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Direct SQL optimization = true
[INFO ] 2024-04-23 23:39:44.027 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 38811 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[INFO ] 2024-04-23 23:39:44.027 [main] TestTxnDbUtil - Creating transactional tables
[DEBUG] 2024-04-23 23:39:44.027 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:44.028 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:44.028 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:44.036 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:44.036 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38811]
[INFO ] 2024-04-23 23:39:44.036 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38811)
[INFO ] 2024-04-23 23:39:44.036 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38811) current connections: 3
[DEBUG] 2024-04-23 23:39:44.037 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911984037 end=1713911984038 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.038 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.039 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.039 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 create_database: Database(name:db6, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:44.039 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db6, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@349f64ab, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:44.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@349f64ab, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b451e1b created in the thread with id: 263
[DEBUG] 2024-04-23 23:39:44.045 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.045 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.046 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.049 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@349f64ab from thread id: 263
[DEBUG] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.778281ms
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db6, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.056 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.056 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db for database db6. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.063 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911984039 end=1713911984063 duration=24 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.064 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.065 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.065 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 create_table_req: Table(tableName:tbl6, dbName:db6, owner:alex, createTime:1713911984, lastAccessTime:1713911984, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:39:44.065 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl6, dbName:db6, owner:alex, createTime:1713911984, lastAccessTime:1713911984, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:44.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.074 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 9.916988ms
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.086 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.088 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.514312ms
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db/tbl6
[DEBUG] 2024-04-23 23:39:44.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.105 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.111 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.116 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.122 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.136 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.137 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911984065 end=1713911984137 duration=72 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.137 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:44.176 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db/tbl6/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:39:44.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.193 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911984138 end=1713911984194 duration=56 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:44.202 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db/tbl6/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:39:44.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.214 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.216 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911984195 end=1713911984216 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:44.225 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db/tbl6/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:39:44.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.235 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911984217 end=1713911984237 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911984237 end=1713911984237 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.238 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.182962ms
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:44.244 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911984237 end=1713911984245 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.245 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.249 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.466408ms + 0.006623ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:44.252 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.626369ms + 0.086747ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:44.254 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.589804ms + 0.251013ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:44.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.370301ms + 0.222166ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.257 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.427266ms + 0.11932ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:44.258 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.259608ms + 0.116174ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.260 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.287259ms + 0.117235ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.261 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.212321ms + 0.114197ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.263 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.388815ms + 0.284996ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.324212ms + 0.138577ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 19.254441ms
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.265 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911984245 end=1713911984265 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 alter_table: hive.db6.tbl6 newtbl=tbl6
[INFO ] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db6.tbl6 newtbl=tbl6	
[DEBUG] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.169195ms
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.96608ms
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.009914ms
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[WARN ] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:44.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:44.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.301 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.303 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911984275 end=1713911984303 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:44.304 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:44.304 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38811]
[INFO ] 2024-04-23 23:39:44.304 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38811)
[INFO ] 2024-04-23 23:39:44.304 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38811) current connections: 4
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911984305 end=1713911984305 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@698f8b04, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@698f8b04, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ce21b78 created in the thread with id: 276
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@698f8b04 from thread id: 276
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:44.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.313 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.313 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911984305 end=1713911984313 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:44.313 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:44.313 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:44.313 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@698f8b04, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ce21b78 will be shutdown
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911984313 end=1713911984314 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:44.315 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.947632ms + 0.017316ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:44.315 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.411054ms + 0.072766ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:44.316 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.154027ms + 0.213066ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:44.316 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.143915ms + 0.142907ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.317 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.16859ms + 0.100869ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:44.317 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15462ms + 0.099117ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.317 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150317ms + 0.09831ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.317 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.148601ms + 0.098583ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.179335ms + 0.2108ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15523ms + 0.100734ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.414897ms
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911984314 end=1713911984318 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911984319 end=1713911984321 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.323 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911984321 end=1713911984324 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_database: db6
[INFO ] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db6	
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.051169ms
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911984324 end=1713911984325 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.325 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_tables_by_type: db=@hive#db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.019656ms
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.424119ms
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911984325 end=1713911984329 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.330 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:44.330 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:44.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.363014ms
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911984329 end=1713911984332 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.332 [main] HiveMetaStoreClient - Selecting dropDatabase method for db6 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:44.332 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.946017ms
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_multi_table : db=db6 tbls=tbl6
[INFO ] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db6 tbls=tbl6	
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.97181ms
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911984332 end=1713911984338 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.854748ms
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.445678ms
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.347 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.350 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:44.350 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.354 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:44.357 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:44.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.986112ms
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.566726ms
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.924949ms
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:44.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:44.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.403 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:44.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.403 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.404 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.405 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.409 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.410 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:44.410 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.411 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:44.412 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:46.409 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:46.413 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:46.413 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:46.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:46.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.416 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.718717ms
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.525074ms
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.420 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:46.420 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:46.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.421 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:46.421 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:46.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.797696ms
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.452369ms
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:46.424 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.963382ms
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:46.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:46.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:46.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:46.428 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:46.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:46.428 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:48.429 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:48.429 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:48.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:48.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.253854ms
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:48.433 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:48.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.07004ms
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:48.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:48.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.436 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:48.436 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:48.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.73358ms
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.4251ms
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.6981ms
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:48.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:48.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:50.443 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:50.443 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:50.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:50.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.446 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.283924ms
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.795054ms
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.449 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:50.449 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:50.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.451 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:50.451 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:50.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.451 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.922922ms
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.465079ms
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:50.453 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.764812ms
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:50.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:50.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:50.457 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:50.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:50.457 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:51.010 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:51.014 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:52.458 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:52.458 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:52.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:52.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.259657ms
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:52.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.490091ms
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.464 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:52.464 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:52.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.465 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:52.465 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:52.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.466 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:52.466 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:52.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.791725ms
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.450943ms
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.737227ms
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:52.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:52.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:52.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:52.472 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:52.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:52.472 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:54.473 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:54.473 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.175796ms
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.495262ms
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.478 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:54.478 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:54.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.728349ms
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.42657ms
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.844413ms
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:54.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:54.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:54.560 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:56.486 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:56.486 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:56.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:56.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.489 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.760312ms
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.525097ms
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.492 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:56.492 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:56.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.493 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:56.493 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:56.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.752333ms
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.494082ms
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:56.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:56.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.518 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.731642ms + 0.004355ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:39:56.522 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.56166ms + 0.004669ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.523 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.613672ms + 0.004836ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.525 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.580241ms + 0.004169ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.527 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.533078ms + 0.004732ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.528 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.640684ms + 0.004688ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.530 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.779588ms + 0.004976ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.534 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.382644ms + 0.004258ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.535 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.559259ms + 0.004164ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.537 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.543944ms + 0.004485ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.538 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.438367ms + 0.004089ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.540 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.013847ms + 0.003993ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.542 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.328944ms + 0.003737ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.544 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.690807ms + 0.004167ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 31.487127ms
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.020123ms
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.89963ms
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:56.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:56.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:39:56.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.565 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:39:56.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:39:56.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:56.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.573 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:56.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:56.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:56.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:39:56.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:56.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:56.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:56.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.629 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:56.629 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.629 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6' AND "TC_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6' AND "CTC_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.633 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6' AND "CQ_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6' AND "CC_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.636 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6' AND "T2W_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.637 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6' AND "NWI_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:56.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:56.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.646 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.646 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:56.646 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[DEBUG] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db
[INFO ] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911984338 end=1713911996649 duration=12311 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=6 error=false>
[INFO ] 2024-04-23 23:39:56.649 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@349f64ab, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b451e1b will be shutdown
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryDisabledByDefault" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="12.043"/>
  <testcase name="testPartitionDiscoverySkipInvalidPath" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="21.972">
    <failure message="expected:&lt;4&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<4> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoverySkipInvalidPath(TestPartitionManagement.java:590)
]]></failure>
    <system-out><![CDATA[[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3ca31393, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@781747c6 will be shutdown
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713912008693 end=1713912008693 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:08.693 [main] MetastoreConf - Unable to find config file: hive-site.xml
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:08.694 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:40:08.694 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:40:08.694 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:40:08.701 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:40:08.701 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:40:08.701 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:40:08.702 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:40:08.703 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:08.732 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:09.128 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:40:09.139 [MetaStoreThread-41227] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:40:09.139 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:40:09.139 [MetaStoreThread-41227] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] HMSHandler - 40: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:09.142 [MetaStoreThread-41227] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:40:09.142 [MetaStoreThread-41227] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:40:09.143 [MetaStoreThread-41227] HikariConfig - HikariPool-11 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:40:09.143 [MetaStoreThread-41227] HikariConfig - HikariPool-11 - configuration:
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true"
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - poolName........................"HikariPool-11"
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariDataSource - HikariPool-11 - Starting...
[INFO ] 2024-04-23 23:40:09.146 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:40:09.146 [MetaStoreThread-41227] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.146 [MetaStoreThread-41227] HikariDataSource - HikariPool-11 - Start completed.
[DEBUG] 2024-04-23 23:40:09.247 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:40:09.248 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.249 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1188761808 (XID = 1151), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.250 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2010640906 (XID = 1153), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.251 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@653586335 (XID = 1155), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.253 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@581652053 (XID = 1157), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.254 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@582628826 (XID = 1159), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.255 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@356908229 (XID = 1161), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.256 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1482577439 (XID = 1163), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.257 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@698262705 (XID = 1165), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.257 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@59751c50, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@59751c50, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5e8b1055 created in the thread with id: 313
[DEBUG] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.504 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.573 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.587 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.626 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.642 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.647 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.762 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.787 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.792 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.798 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.800 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.801 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.801 [MetaStoreThread-41227] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:09.802 [MetaStoreThread-41227] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:09.802 [MetaStoreThread-41227] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@59751c50 from thread id: 313
[DEBUG] 2024-04-23 23:40:09.802 [MetaStoreThread-41227] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:09.802 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.804 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.807 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.807 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.807 [MetaStoreThread-41227] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:40:09.807 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.808 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.808 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.808 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.808 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.810 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.811 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - db details for db default retrieved using SQL in 1.684655ms
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.817 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.818 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.819 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.821 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.821 [MetaStoreThread-41227] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:40:09.821 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.821 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:09.824 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.826 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:09.829 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.830 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:09.833 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:09.836 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.838 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:09.841 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.842 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.842 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.842 [MetaStoreThread-41227] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] PerfLogger - </PERFLOG method=init start=1713912009139 end=1713912009843 duration=704 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Started the new metaserver on port [41227]...
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:40:10.140 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:10.140 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:10.141 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:10.145 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227) is created
[INFO ] 2024-04-23 23:40:10.145 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 41227 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[INFO ] 2024-04-23 23:40:10.145 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:10.148 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:10.148 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:41227]
[INFO ] 2024-04-23 23:40:10.148 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:41227)
[INFO ] 2024-04-23 23:40:10.148 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:41227) current connections: 3
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912010149 end=1713912010149 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 create_database: Database(name:db8, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db8, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@243e7266, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:10.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@243e7266, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@136b6060 created in the thread with id: 330
[DEBUG] 2024-04-23 23:40:10.152 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.152 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.152 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.154 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.154 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@243e7266 from thread id: 330
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.859026ms
[DEBUG] 2024-04-23 23:40:10.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db8, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:40:10.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:10.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db for database db8. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.159 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713912010149 end=1713912010160 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 create_table_req: Table(tableName:tbl8, dbName:db8, owner:alex, createTime:1713912010, lastAccessTime:1713912010, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl8, dbName:db8, owner:alex, createTime:1713912010, lastAccessTime:1713912010, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.164 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 4.492556ms
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.171 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.426454ms
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227/db8.db/tbl8
[DEBUG] 2024-04-23 23:40:10.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.189 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.195 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.201 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.207 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.224 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.224 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713912010160 end=1713912010224 duration=64 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227/db8.db/tbl8/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:40:10.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.264 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.274 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912010225 end=1713912010275 duration=50 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:10.281 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227/db8.db/tbl8/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:40:10.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.290 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.291 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912010275 end=1713912010291 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227/db8.db/tbl8/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:40:10.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912010292 end=1713912010308 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713912010308 end=1713912010308 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_table : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.04194ms
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.315 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:10.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:40:10.315 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713912010308 end=1713912010315 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.316 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.319 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.175751ms + 0.005529ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:10.322 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.593979ms + 0.07357ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:10.324 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.567043ms + 0.272281ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:10.326 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.862233ms + 0.255112ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.328 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.66383ms + 0.119843ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:10.330 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.436917ms + 0.137242ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.331 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.634499ms + 0.124901ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.333 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.523705ms + 0.160128ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.335 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.617841ms + 0.253422ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.450701ms + 0.119417ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.966335ms
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912010316 end=1713912010337 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.347 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 alter_table: hive.db8.tbl8 newtbl=tbl8
[INFO ] 2024-04-23 23:40:10.347 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db8.tbl8 newtbl=tbl8	
[DEBUG] 2024-04-23 23:40:10.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.347 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.260596ms
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.076938ms
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.355 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.064222ms
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db8
[WARN ] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:40:10.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:40:10.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.371 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.371 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713912010346 end=1713912010371 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:10.372 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:10.372 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:41227]
[INFO ] 2024-04-23 23:40:10.372 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:41227)
[INFO ] 2024-04-23 23:40:10.372 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:41227) current connections: 4
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912010373 end=1713912010373 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=43 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4af0077b, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4af0077b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@60dee08b created in the thread with id: 343
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.376 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4af0077b from thread id: 343
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:40:10.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.382 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.382 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713912010373 end=1713912010382 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=43 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:10.382 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:40:10.383 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8	
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4af0077b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@60dee08b will be shutdown
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713912010383 end=1713912010383 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=43 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:10.384 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.747258ms + 0.004688ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:10.384 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.401754ms + 0.072089ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:10.385 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150911ms + 0.224095ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:10.385 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.178355ms + 0.173143ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.385 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.170318ms + 0.103603ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:10.386 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.160178ms + 0.114392ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.386 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.182877ms + 0.100864ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.386 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.180249ms + 0.098312ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.225255ms + 0.2893ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.173041ms + 0.104038ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.447426ms
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912010383 end=1713912010387 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.390 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.390 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713912010388 end=1713912010390 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713912010391 end=1713912010393 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.394 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_database: db8
[INFO ] 2024-04-23 23:40:10.394 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db8	
[DEBUG] 2024-04-23 23:40:10.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.394 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.114357ms
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713912010393 end=1713912010395 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.395 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_tables_by_type: db=@hive#db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.106072ms
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.533233ms
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713912010395 end=1713912010400 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:10.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.544663ms
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713912010400 end=1713912010404 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.404 [main] HiveMetaStoreClient - Selecting dropDatabase method for db8 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:40:10.404 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.543511ms
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_multi_table : db=db8 tbls=tbl8
[INFO ] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db8 tbls=tbl8	
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.378484ms
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713912010404 end=1713912010413 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.414 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.42753ms
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.805375ms
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.426 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.431 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:10.431 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:10.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.437 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.441 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:10.441 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:10.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.462 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.528988ms
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.852013ms
[DEBUG] 2024-04-23 23:40:10.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.376953ms
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:10.491 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:10.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.501 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:10.501 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.502 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.503 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.505 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.507 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.508 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.509 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.510 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:10.510 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.511 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:10.512 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:12.512 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:12.512 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:12.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:12.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.905774ms
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:12.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.991511ms
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.735926ms
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.42429ms
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.063809ms
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:12.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:12.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:13.132 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:14.527 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:14.527 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:14.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:14.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.530 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.327277ms
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.434615ms
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.535 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:14.535 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:14.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.536 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:14.536 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:14.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.229216ms
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.720605ms
[DEBUG] 2024-04-23 23:40:14.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.227162ms
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:14.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:14.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:14.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:14.544 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:14.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:14.547 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:14.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:14.547 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:16.409 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:16.548 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:16.548 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:16.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:16.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.551 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.271047ms
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.495182ms
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.722428ms
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.43313ms
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.694031ms
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:16.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:16.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:16.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:16.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:16.561 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:16.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:16.561 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:18.562 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:18.562 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:18.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:18.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.565 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.39676ms
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.943267ms
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.568 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:18.568 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:18.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.569 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:18.569 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:18.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.812661ms
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.482093ms
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:18.572 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.732309ms
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:18.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:18.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.574 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:18.574 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:18.576 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:18.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:18.576 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:20.577 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:20.577 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:20.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:20.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.580 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.585802ms
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.643694ms
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.851519ms
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.499604ms
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.88448ms
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:20.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:20.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:20.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:20.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.590 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:20.592 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:20.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:20.592 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:21.010 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:21.014 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:22.593 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:22.593 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:22.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:22.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.596 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:22.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.398111ms
[DEBUG] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.594061ms
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.868957ms
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.505487ms
[DEBUG] 2024-04-23 23:40:22.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.784118ms
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:22.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:22.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:22.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:22.608 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:24.561 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:24.608 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:24.609 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:24.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:24.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.611 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.395548ms
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.380539ms
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.615 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:24.615 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:24.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.799489ms
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.466768ms
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.751222ms
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:24.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:24.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:24.623 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:26.623 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:26.623 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:26.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:26.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 2.436424ms
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.528431ms
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.628 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:26.628 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:26.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.743062ms
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.447538ms
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.693271ms
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:26.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:26.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:26.635 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:26.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:26.635 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:27.019 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:27.190 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:28.636 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:28.636 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:28.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:28.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.639 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.333654ms
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.887381ms
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.642 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:28.642 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:28.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.644 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:28.644 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:28.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.644 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.808924ms
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.457883ms
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.789046ms
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:28.650 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:30.650 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:30.650 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:30.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:30.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.653 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.477525ms
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.417412ms
[DEBUG] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.800455ms
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.42968ms
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.711946ms
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:30.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:30.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:30.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:30.664 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:30.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:30.664 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:30.664 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713912010413 end=1713912030664 duration=20251 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoverySkipInvalidPath" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="21.972">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
  </testcase>
  <testcase name="testPartitionDiscoveryEnabledBothTableTypes" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="21.968">
    <failure message="expected:&lt;5&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<5> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionDiscoveryEnabledBothTableTypes(TestPartitionManagement.java:270)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:40:30.665 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:40:30.665 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:40:30.665 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:40:30.665 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:40:30.672 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:40:30.672 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:40:30.672 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:40:30.672 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:40:30.673 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:30.714 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:30.890 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:30.891 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:40:30.891 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:30.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@243e7266, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@136b6060 will be shutdown
[DEBUG] 2024-04-23 23:40:30.892 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:30.892 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:31.107 [MetaStoreThread-44247] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:40:31.107 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:40:31.107 [MetaStoreThread-44247] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] HMSHandler - 44: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - HikariPool-12 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - HikariPool-12 - configuration:
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true"
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - poolName........................"HikariPool-12"
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariDataSource - HikariPool-12 - Starting...
[INFO ] 2024-04-23 23:40:31.113 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:40:31.113 [MetaStoreThread-44247] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.113 [MetaStoreThread-44247] HikariDataSource - HikariPool-12 - Start completed.
[DEBUG] 2024-04-23 23:40:31.213 [HikariPool-12 housekeeper] HikariPool - HikariPool-12 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:40:31.215 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.216 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1153144651 (XID = 1142), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.217 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1974802294 (XID = 1144), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.219 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@613705732 (XID = 1146), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.220 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1985841903 (XID = 1148), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.221 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@551202849 (XID = 1150), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.222 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1613537777 (XID = 1152), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.224 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2074167912 (XID = 1154), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.225 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1721160855 (XID = 1156), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.225 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@57baed5d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@57baed5d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3b32acef created in the thread with id: 346
[DEBUG] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.400 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.468 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.481 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.516 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.531 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.536 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.634 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.659 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.666 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.672 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.674 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@57baed5d from thread id: 346
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.679 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.682 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.682 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.682 [MetaStoreThread-44247] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:40:31.682 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.683 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.683 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.683 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.683 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.685 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.685 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - db details for db default retrieved using SQL in 1.609767ms
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.691 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.692 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.693 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.695 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.695 [MetaStoreThread-44247] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:40:31.695 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.695 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:31.699 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.702 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:31.704 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.705 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.705 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.706 [MetaStoreThread-44247] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:40:31.706 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.706 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:31.706 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:31.708 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:31.711 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.714 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:31.716 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.717 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.717 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.717 [MetaStoreThread-44247] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] PerfLogger - </PERFLOG method=init start=1713912031107 end=1713912031718 duration=611 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Started the new metaserver on port [44247]...
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:40:32.109 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:32.109 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:32.109 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:32.119 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247) is created
[INFO ] 2024-04-23 23:40:32.119 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 44247 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[INFO ] 2024-04-23 23:40:32.119 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:32.126 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:32.126 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:44247]
[INFO ] 2024-04-23 23:40:32.127 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:44247)
[INFO ] 2024-04-23 23:40:32.127 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:44247) current connections: 4
[DEBUG] 2024-04-23 23:40:32.128 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.128 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912032128 end=1713912032128 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 create_database: Database(name:db2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f185682, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:32.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f185682, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@22764747 created in the thread with id: 363
[DEBUG] 2024-04-23 23:40:32.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.132 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f185682 from thread id: 363
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.558208ms
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db for database db2. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.137 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.137 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713912032129 end=1713912032137 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 create_table_req: Table(tableName:tbl2, dbName:db2, owner:alex, createTime:1713912032, lastAccessTime:1713912032, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl2, dbName:db2, owner:alex, createTime:1713912032, lastAccessTime:1713912032, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.018346ms
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.866082ms
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247/db2.db/tbl2
[DEBUG] 2024-04-23 23:40:32.150 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:32.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.161 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.169 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713912032138 end=1713912032183 duration=45 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:32.215 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247/db2.db/tbl2/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:40:32.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.222 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.231 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.232 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912032183 end=1713912032232 duration=49 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247/db2.db/tbl2/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:40:32.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.247 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.248 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912032233 end=1713912032248 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.248 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247/db2.db/tbl2/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:40:32.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.264 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912032249 end=1713912032265 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713912032265 end=1713912032265 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.266 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.266 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_table : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.266 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.538144ms
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.273 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:32.274 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:40:32.274 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713912032266 end=1713912032274 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.274 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:40:32.274 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.278 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.894977ms + 0.004699ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.280 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.413876ms + 0.063786ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.282 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.366618ms + 0.270379ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:32.284 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.464394ms + 0.16461ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.286 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.547119ms + 0.121547ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:32.288 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.006177ms + 0.192934ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.289 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.51788ms + 0.122966ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.291 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.356008ms + 0.119153ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.293 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.392527ms + 0.239224ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.495434ms + 0.114422ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 19.63912ms
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.295 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.295 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912032275 end=1713912032295 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.303 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.574383ms + 0.004319ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.305 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.369494ms + 0.053689ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.133686ms + 0.205408ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:32.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.157142ms + 0.135337ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.154645ms + 0.100003ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:32.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.151273ms + 0.098747ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.191385ms + 0.099362ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.146541ms + 0.098286ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.182876ms + 0.202297ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15769ms + 0.10022ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 3.903909ms
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912032304 end=1713912032308 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 alter_table: hive.db2.tbl2 newtbl=tbl2
[INFO ] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db2.tbl2 newtbl=tbl2	
[DEBUG] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.079597ms
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.930606ms
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.316 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.317 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.882129ms
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db2
[WARN ] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:40:32.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:40:32.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.334 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.335 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713912032309 end=1713912032335 duration=26 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:32.336 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:32.336 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:44247]
[INFO ] 2024-04-23 23:40:32.336 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:44247)
[INFO ] 2024-04-23 23:40:32.336 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:44247) current connections: 5
[DEBUG] 2024-04-23 23:40:32.337 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.337 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912032337 end=1713912032337 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.337 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.337 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3362a3d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3362a3d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@61cc8b05 created in the thread with id: 376
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.340 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.340 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.340 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:32.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:32.341 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3362a3d from thread id: 376
[DEBUG] 2024-04-23 23:40:32.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:40:32.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.345 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.345 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713912032337 end=1713912032345 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:32.345 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:40:32.346 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 4
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3362a3d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@61cc8b05 will be shutdown
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713912032346 end=1713912032346 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:32.347 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.908382ms + 0.005543ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.348 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.399618ms + 0.062836ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.348 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150564ms + 0.301014ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:32.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15439ms + 0.139693ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.139848ms + 0.100763ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:32.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.127973ms + 0.100552ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.127035ms + 0.099655ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.125217ms + 0.098581ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.166338ms + 0.20711ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.135233ms + 0.100993ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.307916ms
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912032346 end=1713912032351 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.353 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.353 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713912032351 end=1713912032353 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.353 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.354 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.354 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:40:32.354 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:40:32.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713912032354 end=1713912032356 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_database: db2
[INFO ] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db2	
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.061381ms
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713912032356 end=1713912032357 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.357 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_tables_by_type: db=@hive#db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.121251ms
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.503471ms
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713912032358 end=1713912032361 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.737101ms
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713912032362 end=1713912032364 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.365 [main] HiveMetaStoreClient - Selecting dropDatabase method for db2 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:40:32.365 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:40:32.365 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.365 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.06454ms
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_multi_table : db=db2 tbls=tbl2
[INFO ] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db2 tbls=tbl2	
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.380 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713912032365 end=1713912032381 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.949599ms
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.504767ms
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.390 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.392 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:32.393 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:32.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.398 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:32.399 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:32.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.416 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.842118ms
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.463846ms
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.421 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.742572ms
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:32.435 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:32.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.442 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:32.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.442 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.444 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.445 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.446 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.448 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:32.449 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.450 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:32.450 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:34.451 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:34.451 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:34.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:34.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.453 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.773271ms
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.67661ms
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.457 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:34.457 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:34.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.458 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:34.458 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:34.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.459 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:34.459 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:34.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.037282ms
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.443249ms
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.734597ms
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:34.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:34.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:34.465 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:34.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:34.465 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:34.788 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:36.466 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:36.466 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:36.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:36.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.470 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:36.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.975351ms
[DEBUG] 2024-04-23 23:40:36.471 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:36.471 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:36.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.107245ms
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.475 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:36.475 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:36.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.867537ms
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.469414ms
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.761051ms
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:36.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:36.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:36.482 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:38.482 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:38.483 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:38.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:38.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.485 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.209996ms
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.573601ms
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.490 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:38.490 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:38.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.491 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:38.491 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.492 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:38.492 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:38.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.176922ms
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.687824ms
[DEBUG] 2024-04-23 23:40:38.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.142768ms
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:38.497 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:38.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:38.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:38.500 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:38.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:38.500 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:38.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:38.501 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:39.129 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:39.247 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:40.502 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:40.502 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:40.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:40.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.504 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.878834ms
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.477338ms
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.507 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:40.507 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:40.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.799521ms
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.46543ms
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.774578ms
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:40.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:40.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:40.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:40.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:40.515 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:40.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:40.515 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:42.516 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:42.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:42.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:42.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.518 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.136955ms
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.396222ms
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.522 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:42.522 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.523 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:42.523 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:42.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.524 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:42.524 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.875824ms
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.467297ms
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.777666ms
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:42.530 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:42.531 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:43.133 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:44.531 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:44.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:44.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:44.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.534 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.640555ms
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.696283ms
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.538 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:44.538 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:44.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.539 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:44.539 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:44.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.740073ms
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.451938ms
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:44.542 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.761651ms
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:44.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:44.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.544 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:44.544 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:44.546 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:44.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:44.546 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:46.410 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:46.547 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:46.547 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:46.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:46.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.550 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.5878ms
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.932269ms
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.553 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:46.553 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:46.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.554 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:46.554 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:46.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.555 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:46.555 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:46.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.793256ms
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.456847ms
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:46.557 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.72907ms
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:46.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:46.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:46.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:46.561 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:46.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:46.561 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:48.562 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:48.562 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:48.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:48.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.565 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.608838ms
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.958707ms
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.568 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:48.568 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:48.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.569 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:48.569 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:48.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.570 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:48.570 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:48.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.846653ms
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.467418ms
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.768931ms
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:48.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:48.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:48.577 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:48.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:48.577 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:50.578 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:50.578 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:50.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:50.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.264561ms
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.425628ms
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.583 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:50.583 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:50.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.584 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:50.584 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:50.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.585 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:50.585 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:50.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.738628ms
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.420178ms
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:50.587 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:50.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:50.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 26.245541ms
[DEBUG] 2024-04-23 23:40:50.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:50.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:50.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:50.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:50.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:50.618 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:51.011 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:51.015 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:52.618 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:52.619 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:52.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:52.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.53374ms
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.543013ms
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.623 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:52.623 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.626 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:52.626 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:52.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.626 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.985173ms
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.558159ms
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.900293ms
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:52.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:52.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:52.632 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:52.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:52.632 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:52.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:52.633 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:52.633 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713912032381 end=1713912052633 duration=20252 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionDiscoveryEnabledBothTableTypes" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="21.968">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
  </testcase>
  <testcase name="testPartitionExprFilter" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.25">
    <failure message="expected:&lt;2&gt; but was:&lt;3&gt;" type="java.lang.AssertionError"><![CDATA[java.lang.AssertionError: expected:<2> but was:<3>
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.testPartitionExprFilter(TestPartitionManagement.java:720)
]]></failure>
    <system-out><![CDATA[[INFO ] 2024-04-23 23:40:52.634 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:40:52.634 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:40:52.634 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:40:52.634 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:40:52.641 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:40:52.641 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:40:52.641 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:40:52.641 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:40:52.643 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:52.670 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[INFO ] 2024-04-23 23:40:53.045 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:40:53.045 [MetaStoreThread-39623] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] HMSHandler - 48: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:53.051 [MetaStoreThread-39623] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:40:53.051 [MetaStoreThread-39623] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:40:53.052 [MetaStoreThread-39623] HikariConfig - HikariPool-13 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:40:53.052 [MetaStoreThread-39623] HikariConfig - HikariPool-13 - configuration:
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true"
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - poolName........................"HikariPool-13"
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariDataSource - HikariPool-13 - Starting...
[INFO ] 2024-04-23 23:40:53.056 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:40:53.056 [MetaStoreThread-39623] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.056 [MetaStoreThread-39623] HikariDataSource - HikariPool-13 - Start completed.
[DEBUG] 2024-04-23 23:40:53.156 [HikariPool-13 housekeeper] HikariPool - HikariPool-13 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:40:53.158 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.160 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2013240477 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.161 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1187146729 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.162 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@399533010 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.163 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@459607074 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.165 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@329160867 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.166 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@58598153 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.167 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1183803132 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.168 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1296206150 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.168 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:40:53.307 [MetaStoreThread-39623] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:40:53.307 [MetaStoreThread-39623] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@78a61f0e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:53.307 [MetaStoreThread-39623] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:53.307 [MetaStoreThread-39623] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@78a61f0e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6dd7a7f6 created in the thread with id: 379
[DEBUG] 2024-04-23 23:40:53.308 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.308 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.308 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.381 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.477 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.492 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.528 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.543 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.548 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.691 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.732 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.742 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.751 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.755 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@78a61f0e from thread id: 379
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.761 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.774 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.776 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.778 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.778 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] ObjectStore - db details for db default retrieved using SQL in 2.321334ms
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:40:53.781 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.787 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.789 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.790 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.793 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.793 [MetaStoreThread-39623] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:40:53.793 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.793 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:53.797 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.800 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:53.803 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.805 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:53.808 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:53.808 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:53.812 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.814 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:53.817 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.818 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.819 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.819 [MetaStoreThread-39623] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] PerfLogger - </PERFLOG method=init start=1713912053046 end=1713912053820 duration=774 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Started the new metaserver on port [39623]...
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:40:54.046 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:54.046 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 49: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.046 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:54.050 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623) is created
[INFO ] 2024-04-23 23:40:54.050 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 39623 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[INFO ] 2024-04-23 23:40:54.050 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:54.054 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:54.054 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39623]
[INFO ] 2024-04-23 23:40:54.054 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39623)
[INFO ] 2024-04-23 23:40:54.054 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39623) current connections: 5
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912054055 end=1713912054055 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 create_database: Database(name:db10, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db10, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@fe46a07, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:54.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@fe46a07, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@43d36b67 created in the thread with id: 396
[DEBUG] 2024-04-23 23:40:54.058 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.058 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.058 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.059 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.060 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.060 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:54.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:54.060 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@fe46a07 from thread id: 396
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.915647ms
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db10, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:40:54.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:54.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db for database db10. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.067 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.067 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713912054055 end=1713912054067 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.067 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.068 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.068 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 create_table_req: Table(tableName:tbl10, dbName:db10, owner:alex, createTime:1713912054, lastAccessTime:1713912054, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:), FieldSchema(name:modts, type:timestamp, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:40:54.068 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl10, dbName:db10, owner:alex, createTime:1713912054, lastAccessTime:1713912054, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:), FieldSchema(name:modts, type:timestamp, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:40:54.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.071 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 4.067183ms
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.078 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.416414ms
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:54.081 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623/db10.db/tbl10
[DEBUG] 2024-04-23 23:40:54.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.093 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.098 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.102 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.107 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.122 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.123 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713912054068 end=1713912054123 duration=55 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.123 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623/db10.db/tbl10/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01/modts=__HIVE_DEFAULT_PARTITION__
[DEBUG] 2024-04-23 23:40:54.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.176 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.193 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912054124 end=1713912054194 duration=70 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.194 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.194 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623/db10.db/tbl10/state=CA/dt=1986-04-28/modts=2020-02-21 08%3A30%3A01
[DEBUG] 2024-04-23 23:40:54.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.213 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.214 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912054194 end=1713912054214 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.219 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.220 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.220 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.220 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:54.220 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623/db10.db/tbl10/state=MN/dt=2018-11-31/modts=2020-02-21 08%3A19%3A01
[DEBUG] 2024-04-23 23:40:54.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.231 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.232 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912054215 end=1713912054232 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713912054233 end=1713912054233 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_table : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.024719ms
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.240 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713912054233 end=1713912054241 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.241 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 alter_table: hive.db10.tbl10 newtbl=tbl10
[INFO ] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db10.tbl10 newtbl=tbl10	
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.242 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.171277ms
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.095149ms
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.249 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.943325ms
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db10
[WARN ] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:40:54.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:40:54.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.270 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.270 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713912054241 end=1713912054270 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.274 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.243245ms + 0.005349ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:54.277 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.575896ms + 0.068329ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:54.279 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.550505ms + 0.240272ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:54.281 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.553791ms + 0.177876ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.282 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.526ms + 0.147834ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:54.284 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.399028ms + 0.118303ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.286 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.362938ms + 0.116943ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.287 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.460427ms + 0.118633ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.289 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.610484ms + 0.394983ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.685868ms + 0.178453ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.481106ms
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.292 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912054271 end=1713912054292 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:54.293 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:54.293 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39623]
[INFO ] 2024-04-23 23:40:54.293 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39623)
[INFO ] 2024-04-23 23:40:54.293 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39623) current connections: 6
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912054294 end=1713912054294 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_table_metas : tbl=hive.*db10*.*
[INFO ] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*db10*.*	
[INFO ] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@765bcaa1, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@765bcaa1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3e52fe47 created in the thread with id: 408
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.297 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@765bcaa1 from thread id: 408
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 ) params: hive, (?i).*db10.*, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:40:54.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713912054294 end=1713912054304 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:54.304 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *db10* tablePattern: * found: 0
[INFO ] 2024-04-23 23:40:54.304 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 5
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@765bcaa1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3e52fe47 will be shutdown
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713912054304 end=1713912054304 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:54.305 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.075732ms + 0.00472ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:54.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.587895ms + 0.083938ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:54.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.212777ms + 0.285213ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:54.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.166823ms + 0.15281ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.169046ms + 0.103461ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:54.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.138268ms + 0.102518ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.151178ms + 0.101716ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.151041ms + 0.134905ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.186741ms + 0.203044ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.180005ms + 0.129152ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.116084ms
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912054304 end=1713912054310 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713912054310 end=1713912054313 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713912054313 end=1713912054316 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.317 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_database: db10
[INFO ] 2024-04-23 23:40:54.317 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db10	
[DEBUG] 2024-04-23 23:40:54.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.200883ms
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713912054316 end=1713912054318 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.318 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_tables_by_type: db=@hive#db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.319 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.320 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.230572ms
[DEBUG] 2024-04-23 23:40:54.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.508108ms
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713912054318 end=1713912054322 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:40:54.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.029301ms
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713912054322 end=1713912054326 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.326 [main] HiveMetaStoreClient - Selecting dropDatabase method for db10 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:40:54.326 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.327838ms
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_multi_table : db=db10 tbls=tbl10
[INFO ] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db10 tbls=tbl10	
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.912307ms
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713912054326 end=1713912054332 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.333 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.045293ms
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.603336ms
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.343 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.373 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f185682, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@22764747 will be shutdown
[DEBUG] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:54.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:54.377 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:54.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.383 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.387 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:54.387 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:54.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.416 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.864614ms
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.447659ms
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.993417ms
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:54.445 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:54.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.455 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:54.455 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.457 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.459 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.462 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.711 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f7c4374, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4bf11fd9 will be shutdown
[DEBUG] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:54.712 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.716 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:54.716 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.718 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:54.718 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:56.719 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:40:56.719 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:40:56.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:56.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.721 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.107926ms
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.487392ms
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.725 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:56.725 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:56.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.765304ms
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.428392ms
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.924519ms
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:56.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:56.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:56.731 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:56.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:56.731 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:57.020 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:57.191 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:58.732 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:40:58.732 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:40:58.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:58.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.734 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.107787ms
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.582493ms
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.738 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:58.738 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:58.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.739 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:58.739 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:58.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.778708ms
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.450846ms
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.764415ms
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:58.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:58.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.744 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:58.746 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:58.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:58.746 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:00.746 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:00.747 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:00.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:00.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.749 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.024473ms
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.66418ms
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.753 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:00.753 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:00.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.797477ms
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.453409ms
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.789314ms
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:00.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:00.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:00.760 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:00.760 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:00.760 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:01.214 [HikariPool-12 housekeeper] HikariPool - HikariPool-12 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:02.151 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:02.761 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:02.761 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:02.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:02.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.763 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.047782ms
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.63782ms
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.767 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:02.767 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:02.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.768 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:02.768 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:02.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.833251ms
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.450585ms
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:02.771 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.768627ms
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:02.775 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:04.775 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:04.775 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:04.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:04.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.778 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.391277ms
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.108209ms
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.786 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:04.786 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:04.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.788 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:04.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.789 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:04.789 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:04.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.791 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.792 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:04.792 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:04.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.794 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:04.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.89544ms
[DEBUG] 2024-04-23 23:41:04.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.719689ms
[DEBUG] 2024-04-23 23:41:04.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:04.801 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.765531ms
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:04.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:04.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:04.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:04.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:04.812 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:04.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:04.813 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:06.813 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:06.813 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:06.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:06.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.816 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:06.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.006248ms
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.482279ms
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.818 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:06.818 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:06.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.819 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:06.819 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:06.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.820 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:06.820 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:06.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.81326ms
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.442351ms
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:06.822 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.718764ms
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:06.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:06.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.824 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:06.824 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:06.826 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:06.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:06.826 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:08.827 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:08.827 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:08.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:08.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.345035ms
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.485491ms
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.831 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:08.831 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:08.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.833 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:08.833 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:08.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.833 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.952653ms
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.477538ms
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:08.835 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.784516ms
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:08.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:08.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:08.839 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:08.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:08.839 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:09.130 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:09.247 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:10.840 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:10.840 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:10.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:10.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.843 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.412148ms
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.162231ms
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.846 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:10.846 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:10.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.847 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:10.847 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:10.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.732419ms
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.453791ms
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:10.850 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.858706ms
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:10.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:10.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:10.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:10.854 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:10.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:10.854 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:12.855 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:12.855 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:12.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:12.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.858 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.253601ms
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.847693ms
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.774814ms
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.472454ms
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.728026ms
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:12.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:12.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:12.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:12.870 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:12.870 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:12.870 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:13.133 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.982721ms
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.591669ms
[DEBUG] 2024-04-23 23:41:14.873 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:14.873 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:14.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.874 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:14.874 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:14.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.875 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:14.875 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:14.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.791277ms
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.555084ms
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:14.878 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.779912ms
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:14.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:14.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:14.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:14.882 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:14.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:14.882 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:14.883 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713912054332 end=1713912074883 duration=20551 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=-1 error=true>
]]></system-out>
  </testcase>
  <testcase name="testPartitionExprFilter" classname="org.apache.hadoop.hive.metastore.TestPartitionManagement" time="22.25">
    <error message="javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore&#10;NestedThrowables:&#10;java.sql.BatchUpdateException: DELETE on table &apos;DBS&apos; caused a violation of foreign key constraint &apos;TBLS_FK1&apos; for key (2).  The statement has been rolled back." type="org.apache.hadoop.hive.metastore.api.MetaException"><![CDATA[org.apache.hadoop.hive.metastore.api.MetaException: 
javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
NestedThrowables:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.tearDown(TestPartitionManagement.java:100)
]]></error>
  </testcase>
</testsuite>