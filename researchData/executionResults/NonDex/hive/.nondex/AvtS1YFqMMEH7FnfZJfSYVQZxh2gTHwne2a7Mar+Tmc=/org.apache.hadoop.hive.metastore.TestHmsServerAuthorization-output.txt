[DEBUG] 2024-04-23 23:28:51.512 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.516 [main] HMSHandler - 0: get_database: db_test_get_fields_1
[INFO ] 2024-04-23 23:28:51.518 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:51.519 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.521 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.521 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.521 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.521 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.493548ms
[DEBUG] 2024-04-23 23:28:51.522 [main] ObjectStore - Failed to get database hive.db_test_get_fields_1, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:28:51.523 [main] HMSHandler - get_databasetime taken(ns): 3991921
[DEBUG] 2024-04-23 23:28:51.524 [main] PerfLogger - </PERFLOG method=get_database_req start=1713911331512 end=1713911331524 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:28:51.524 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=12, comments=HMS client
[DEBUG] 2024-04-23 23:28:51.524 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.525 [main] HMSHandler - 0: get_database: db_test_get_fields_2
[INFO ] 2024-04-23 23:28:51.525 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db_test_get_fields_2	
[DEBUG] 2024-04-23 23:28:51.526 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.529 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.529 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.530 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.530 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 4.469428ms
[DEBUG] 2024-04-23 23:28:51.530 [main] ObjectStore - Failed to get database hive.db_test_get_fields_2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:28:51.530 [main] HMSHandler - get_databasetime taken(ns): 5008212
[DEBUG] 2024-04-23 23:28:51.531 [main] PerfLogger - </PERFLOG method=get_database_req start=1713911331524 end=1713911331531 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:28:51.531 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=7, comments=HMS client
[DEBUG] 2024-04-23 23:28:51.532 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.533 [main] HMSHandler - 0: create_database: Database(name:db_test_get_fields_1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:28:51.533 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:db_test_get_fields_1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:28:51.533 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.534 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.534 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.534 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.535 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.436444ms
[DEBUG] 2024-04-23 23:28:51.535 [main] ObjectStore - Failed to get database hive.db_test_get_fields_1, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:28:51.535 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:28:51.535 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.536 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.537 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.538 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[WARN ] 2024-04-23 23:28:51.542 [main] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db for database db_test_get_fields_1. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:28:51.542 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.543 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.544 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.553 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.554 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.555 [main] HMSHandler - create_databasetime taken(ns): 22105212
[DEBUG] 2024-04-23 23:28:51.555 [main] PerfLogger - </PERFLOG method=create_database start=1713911331532 end=1713911331555 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.556 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.556 [main] HMSHandler - 0: create_database: Database(name:db_test_get_fields_2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:28:51.556 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:db_test_get_fields_2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:28:51.557 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.558 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.558 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.559 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.559 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 2.332243ms
[DEBUG] 2024-04-23 23:28:51.559 [main] ObjectStore - Failed to get database hive.db_test_get_fields_2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:28:51.559 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:28:51.560 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.561 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.562 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.563 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[WARN ] 2024-04-23 23:28:51.564 [main] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db for database db_test_get_fields_2. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:28:51.564 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.564 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.565 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.565 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.566 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.566 [main] HMSHandler - create_databasetime taken(ns): 10088616
[DEBUG] 2024-04-23 23:28:51.567 [main] PerfLogger - </PERFLOG method=create_database start=1713911331555 end=1713911331567 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.586 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.587 [main] HMSHandler - 0: create_table_req: Table(tableName:tab1, dbName:db_test_get_fields_1, owner:alex, createTime:1713911331, lastAccessTime:1713911331, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:28:51.587 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tab1, dbName:db_test_get_fields_1, owner:alex, createTime:1713911331, lastAccessTime:1713911331, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:28:51.588 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.601 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.601 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.601 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.602 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.602 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 14.149434ms
[DEBUG] 2024-04-23 23:28:51.602 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.602 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.603 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 23:28:51.614 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.614 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.614 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:28:51.614 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor null with null on table tab1
[DEBUG] 2024-04-23 23:28:51.615 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.616 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.617 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.617 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.617 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.617 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.466074ms
[DEBUG] 2024-04-23 23:28:51.617 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[INFO ] 2024-04-23 23:28:51.617 [main] MetastoreDefaultTransformer - Converting tab1 to EXTERNAL tableType for null
[INFO ] 2024-04-23 23:28:51.617 [main] MetastoreDefaultTransformer - Modified table params are:{TRANSLATED_TO_EXTERNAL=TRUE, external.table.purge=TRUE, EXTERNAL=TRUE}
[INFO ] 2024-04-23 23:28:51.620 [main] MetastoreDefaultTransformer - Using location file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab1 for table tab1
[INFO ] 2024-04-23 23:28:51.621 [main] MetastoreDefaultTransformer - Transformer returning table:Table(tableName:tab1, dbName:db_test_get_fields_1, owner:alex, createTime:1713911331, lastAccessTime:1713911331, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab1, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{EXTERNAL=TRUE, TRANSLATED_TO_EXTERNAL=TRUE, external.table.purge=TRUE}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, catName:hive, ownerType:USER)
[DEBUG] 2024-04-23 23:28:51.622 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.622 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.624 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.624 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.624 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.624 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.185036ms
[DEBUG] 2024-04-23 23:28:51.624 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.624 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:51.625 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 23:28:51.626 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:51.626 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:28:51.631 [main] MetaStoreServerUtils - Updating table stats for tab1
[INFO ] 2024-04-23 23:28:51.631 [main] MetaStoreServerUtils - Updated size of table tab1 to 0
[DEBUG] 2024-04-23 23:28:51.631 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.631 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:51.638 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:51.644 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.656 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.666 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.673 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.700 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.701 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.705 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.708 [main] HMSHandler - create_table_reqtime taken(ns): 120366684
[DEBUG] 2024-04-23 23:28:51.708 [main] PerfLogger - </PERFLOG method=create_table_req start=1713911331586 end=1713911331708 duration=122 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.708 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.708 [main] HMSHandler - 0: create_table_req: Table(tableName:tab2, dbName:db_test_get_fields_1, owner:alex, createTime:1713911331, lastAccessTime:1713911331, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:name, type:string, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:28:51.708 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:tab2, dbName:db_test_get_fields_1, owner:alex, createTime:1713911331, lastAccessTime:1713911331, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:name, type:string, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:28:51.709 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.710 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.711 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.711 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.711 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.711 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.406293ms
[DEBUG] 2024-04-23 23:28:51.711 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.711 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.712 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:28:51.713 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.713 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.713 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:28:51.713 [main] MetastoreDefaultTransformer - Starting translation for CreateTable for processor null with null on table tab2
[DEBUG] 2024-04-23 23:28:51.714 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.715 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.715 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.716 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.716 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.716 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.276089ms
[DEBUG] 2024-04-23 23:28:51.716 [main] MetastoreDefaultTransformer - Table is a MANAGED_TABLE
[INFO ] 2024-04-23 23:28:51.716 [main] MetastoreDefaultTransformer - Converting tab2 to EXTERNAL tableType for null
[INFO ] 2024-04-23 23:28:51.716 [main] MetastoreDefaultTransformer - Modified table params are:{TRANSLATED_TO_EXTERNAL=TRUE, EXTERNAL=TRUE, external.table.purge=TRUE}
[INFO ] 2024-04-23 23:28:51.716 [main] MetastoreDefaultTransformer - Using location file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2 for table tab2
[INFO ] 2024-04-23 23:28:51.717 [main] MetastoreDefaultTransformer - Transformer returning table:Table(tableName:tab2, dbName:db_test_get_fields_1, owner:alex, createTime:1713911331, lastAccessTime:1713911331, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:)], location:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:name, type:string, comment:)], parameters:{TRANSLATED_TO_EXTERNAL=TRUE, EXTERNAL=TRUE, external.table.purge=TRUE}, viewOriginalText:null, viewExpandedText:null, tableType:EXTERNAL_TABLE, catName:hive, ownerType:USER)
[DEBUG] 2024-04-23 23:28:51.717 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.717 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.718 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.719 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.719 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.719 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.874785ms
[DEBUG] 2024-04-23 23:28:51.719 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.719 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:51.719 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:28:51.720 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:51.720 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.721 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.721 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:51.723 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:51.732 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.732 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.735 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.736 [main] HMSHandler - create_table_reqtime taken(ns): 27693277
[DEBUG] 2024-04-23 23:28:51.737 [main] PerfLogger - </PERFLOG method=create_table_req start=1713911331708 end=1713911331737 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.737 [main] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.738 [main] HMSHandler - 0: add_partition : tbl=hive.db_test_get_fields_1.tab2
[INFO ] 2024-04-23 23:28:51.738 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.db_test_get_fields_1.tab2	
[DEBUG] 2024-04-23 23:28:51.738 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.738 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.739 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:51.739 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:28:51.761 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:51.827 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.828 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.848 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:28:51.849 [main] MetaStoreServerUtils - Updating partition stats fast for: tab2
[INFO ] 2024-04-23 23:28:51.850 [main] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:28:51.850 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.850 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:51.850 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:28:51.853 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:51.859 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.873 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.873 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.879 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.883 [main] HMSHandler - add_partitiontime taken(ns): 144855963
[DEBUG] 2024-04-23 23:28:51.883 [main] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911331737 end=1713911331883 duration=146 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.884 [main] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.884 [main] HMSHandler - 0: add_partition : tbl=hive.db_test_get_fields_1.tab2
[INFO ] 2024-04-23 23:28:51.884 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.db_test_get_fields_1.tab2	
[DEBUG] 2024-04-23 23:28:51.884 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.884 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.884 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:51.884 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:28:51.889 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:51.897 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.897 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.899 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:28:51.899 [main] MetaStoreServerUtils - Updating partition stats fast for: tab2
[INFO ] 2024-04-23 23:28:51.900 [main] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:28:51.900 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.900 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:51.900 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:28:51.902 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:51.908 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.908 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.913 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.915 [main] HMSHandler - add_partitiontime taken(ns): 31260732
[DEBUG] 2024-04-23 23:28:51.916 [main] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911331883 end=1713911331916 duration=33 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.916 [main] PerfLogger - <PERFLOG method=get_fields from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.916 [main] HMSHandler - 0: get_fields_with_environment_context: db=@hive#db_test_get_fields_1tbl=tab1
[INFO ] 2024-04-23 23:28:51.916 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_fields_with_environment_context: db=@hive#db_test_get_fields_1tbl=tab1	
[DEBUG] 2024-04-23 23:28:51.917 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.918 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.918 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.919 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.919 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.919 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.186823ms
[DEBUG] 2024-04-23 23:28:51.919 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.919 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.919 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 23:28:51.924 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.931 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.932 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.936 [main] HMSHandler - get_fields_with_environment_contexttime taken(ns): 19277805
[ERROR] 2024-04-23 23:28:51.937 [main] RetryingHMSHandler - MetaException(message:Authorization fails)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization$DummyAuthorizationListenerImpl.onEvent(TestHmsServerAuthorization.java:67)
	at org.apache.hadoop.hive.metastore.HMSHandler.firePreEvent(HMSHandler.java:4033)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_fields_with_environment_context(HMSHandler.java:6292)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_fields(HMSHandler.java:6273)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.get_fields(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getFields(HiveMetaStoreClient.java:3053)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getFields(HiveMetaStoreClient.java:3047)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.testGetFields(TestHmsServerAuthorization.java:186)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:28:51.937 [main] PerfLogger - </PERFLOG method=get_fields start=1713911331916 end=1713911331937 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:28:51.938 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.938 [main] HMSHandler - 0: get_database: db_test_get_fields_1
[INFO ] 2024-04-23 23:28:51.939 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:51.939 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.941 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.942 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.942 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.942 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.942 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 3.246652ms
[INFO ] 2024-04-23 23:28:51.942 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor null with null on database db_test_get_fields_1 locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db managedLocationUri=null
[DEBUG] 2024-04-23 23:28:51.943 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db
[INFO ] 2024-04-23 23:28:51.943 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db_test_get_fields_1, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713911331, type:NATIVE)
[DEBUG] 2024-04-23 23:28:51.943 [main] HMSHandler - get_databasetime taken(ns): 3921152
[DEBUG] 2024-04-23 23:28:51.943 [main] PerfLogger - </PERFLOG method=get_database_req start=1713911331938 end=1713911331943 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.944 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=6, comments=HMS client
[DEBUG] 2024-04-23 23:28:51.944 [main] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.945 [main] HMSHandler - 0: get_tables_by_type: db=@hive#db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:28:51.945 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:28:51.945 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:28:51.945 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:28:51.946 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.947 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.948 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.948 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.948 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.948 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.140228ms
[DEBUG] 2024-04-23 23:28:51.949 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.954 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.954 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.955 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.955 [main] ObjectStore - 0 entries retrieved using SQL in 5.932566ms
[DEBUG] 2024-04-23 23:28:51.955 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 9130104
[DEBUG] 2024-04-23 23:28:51.955 [main] HMSHandler - get_tables_by_typetime taken(ns): 9983932
[DEBUG] 2024-04-23 23:28:51.955 [main] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911331944 end=1713911331955 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.955 [main] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.956 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:51.956 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:51.956 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.961 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.961 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.961 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.961 [main] ObjectStore - 2 entries retrieved using SQL in 4.952587ms
[DEBUG] 2024-04-23 23:28:51.961 [main] HMSHandler - get_all_tablestime taken(ns): 5286994
[DEBUG] 2024-04-23 23:28:51.962 [main] PerfLogger - </PERFLOG method=get_all_tables start=1713911331955 end=1713911331962 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.962 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_test_get_fields_1 (2 tables), metastore.batch.retrieve.max=2
[DEBUG] 2024-04-23 23:28:51.962 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:28:51.962 [main] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.963 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.964 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.965 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.965 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.965 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.965 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.444187ms
[DEBUG] 2024-04-23 23:28:51.966 [main] HMSHandler - 0: get_multi_table : db=db_test_get_fields_1 tbls=tab1,tab2
[INFO ] 2024-04-23 23:28:51.966 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=db_test_get_fields_1 tbls=tab1,tab2	
[DEBUG] 2024-04-23 23:28:51.967 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.976 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.978 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.978 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.978 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.978 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.262746ms
[DEBUG] 2024-04-23 23:28:51.978 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:51.979 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:51.979 [main] HMSHandler - get_multi_tabletime taken(ns): 12157086
[DEBUG] 2024-04-23 23:28:51.979 [main] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911331962 end=1713911331979 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:28:51.979 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:28:51.980 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:51.980 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:51.980 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:51.980 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.982 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:51.982 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.982 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.982 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.807113ms
[DEBUG] 2024-04-23 23:28:51.982 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:51.983 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:51.983 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:51.984 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:51.984 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:51.984 [main] ObjectStore - 2 entries retrieved using SQL in 1.13827ms
[DEBUG] 2024-04-23 23:28:51.984 [main] HMSHandler - get_all_tablestime taken(ns): 1347998
[DEBUG] 2024-04-23 23:28:51.984 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 23:28:51.984 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 23:28:51.985 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:52.024 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.034 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:52.034 [main] HMSHandler - get_functionstime taken(ns): 49252208
[DEBUG] 2024-04-23 23:28:52.034 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:28:52.034 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:28:52.035 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:52.065 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.073 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:52.073 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 38737898
[DEBUG] 2024-04-23 23:28:52.074 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:28:52.074 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:28:52.075 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:52.101 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.107 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:52.107 [main] HMSHandler - get_all_packagestime taken(ns): 32345386
[DEBUG] 2024-04-23 23:28:52.108 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:28:52.108 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:28:52.108 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:52.111 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:52.112 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:52.112 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:52.112 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 4.069738ms
[DEBUG] 2024-04-23 23:28:52.112 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:52.117 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:52.117 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:52.117 [main] ObjectStore - 0 entries retrieved using SQL in 4.776992ms
[DEBUG] 2024-04-23 23:28:52.117 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 9122544
[DEBUG] 2024-04-23 23:28:52.117 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:52.122 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:52.124 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:52.124 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:52.124 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:52.124 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.992808ms
[DEBUG] 2024-04-23 23:28:52.124 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:28:52.125 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 23:28:52.125 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:52.125 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:52.129 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:52.130 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:28:52.150 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.156 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:28:52.168 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:52.184 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:28:52.185 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:28:52.185 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 23:28:52.185 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:28:52.186 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - metricRegistry..................com.codahale.metrics.MetricRegistry@7c46c9c3
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:28:52.187 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:28:52.188 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:28:52.188 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:28:52.188 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:28:52.188 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:28:52.188 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 23:28:52.189 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:28:52.190 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:28:52.193 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 23:28:52.193 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:28:52.194 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:28:52.194 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:28:52.195 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - metricRegistry..................com.codahale.metrics.MetricRegistry@7c46c9c3
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:28:52.196 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 23:28:52.197 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:28:52.197 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:28:52.197 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:28:52.197 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:28:52.197 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:28:52.197 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:28:52.197 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:28:52.197 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:28:52.197 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 23:28:52.199 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:28:52.199 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@169251264 (XID = 1033), (SESSIONID = 23), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:28:52.200 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 23:28:52.200 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.203 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:28:52.204 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:28:52.204 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.204 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 23:28:52.205 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:28:52.206 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:28:52.206 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:28:52.206 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.206 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:52.210 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.211 [main] ObjectStore - rolling back transaction: no open transactions: 0
[DEBUG] 2024-04-23 23:28:52.211 [main] HMSHandler - drop_databasetime taken(ns): 231211667
[ERROR] 2024-04-23 23:28:52.212 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 63 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 65 more

[DEBUG] 2024-04-23 23:28:52.293 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:28:52.295 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1374843299 (XID = 1037), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.297 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@282033048 (XID = 1039), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.298 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@555043639 (XID = 1041), (SESSIONID = 29), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.299 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1893762263 (XID = 1043), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.300 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:28:52.301 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1520568874 (XID = 1045), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.302 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1957599366 (XID = 1049), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.302 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@131180035 (XID = 1048), (SESSIONID = 36), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.304 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1189915704 (XID = 1052), (SESSIONID = 40), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.304 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1114638855 (XID = 1053), (SESSIONID = 41), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.306 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2011195769 (XID = 1056), (SESSIONID = 44), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.306 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@561400120 (XID = 1057), (SESSIONID = 45), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.308 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@650335095 (XID = 1060), (SESSIONID = 47), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.308 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@646699922 (XID = 1061), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.308 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:28:52.309 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1996000455 (XID = 1063), (SESSIONID = 51), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.310 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@579701013 (XID = 1065), (SESSIONID = 53), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.312 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@772435766 (XID = 1067), (SESSIONID = 55), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.314 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@930462641 (XID = 1069), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.315 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1682295808 (XID = 1071), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:52.315 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:28:54.213 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:54.213 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:54.214 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:54.214 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.219 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:54.220 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:54.220 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:54.220 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 5.589513ms
[DEBUG] 2024-04-23 23:28:54.220 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:54.220 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:54.220 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.224 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:54.225 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:54.225 [main] ObjectStore - 2 entries retrieved using SQL in 4.227693ms
[DEBUG] 2024-04-23 23:28:54.225 [main] HMSHandler - get_all_tablestime taken(ns): 4372801
[DEBUG] 2024-04-23 23:28:54.225 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 23:28:54.225 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 23:28:54.225 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.231 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:54.231 [main] HMSHandler - get_functionstime taken(ns): 5959239
[DEBUG] 2024-04-23 23:28:54.231 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:28:54.231 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:28:54.231 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.236 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:54.236 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 4741382
[DEBUG] 2024-04-23 23:28:54.236 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:28:54.236 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:28:54.237 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.241 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:54.241 [main] HMSHandler - get_all_packagestime taken(ns): 4339921
[DEBUG] 2024-04-23 23:28:54.241 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:28:54.241 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:28:54.242 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.243 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:54.244 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:54.244 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:54.244 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.069141ms
[DEBUG] 2024-04-23 23:28:54.244 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.248 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:54.248 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:54.248 [main] ObjectStore - 0 entries retrieved using SQL in 4.241093ms
[DEBUG] 2024-04-23 23:28:54.248 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 6524978
[DEBUG] 2024-04-23 23:28:54.248 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.253 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:54.254 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:54.255 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:54.255 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:54.255 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.759812ms
[DEBUG] 2024-04-23 23:28:54.255 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:28:54.255 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 23:28:54.255 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:54.255 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:54.259 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:54.259 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:28:54.260 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:28:54.261 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:54.262 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:28:54.263 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:28:54.263 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:54.263 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 23:28:54.263 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:28:54.264 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:28:54.264 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:28:54.264 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:54.264 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:54.266 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:54.266 [main] ObjectStore - rolling back transaction: no open transactions: 0
[DEBUG] 2024-04-23 23:28:54.266 [main] HMSHandler - drop_databasetime taken(ns): 52204865
[ERROR] 2024-04-23 23:28:54.266 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 63 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 65 more

[DEBUG] 2024-04-23 23:28:56.267 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:56.267 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:56.268 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:56.269 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.273 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:56.274 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:56.274 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:56.274 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 5.620859ms
[DEBUG] 2024-04-23 23:28:56.274 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:56.275 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:56.275 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.279 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:56.279 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:56.279 [main] ObjectStore - 2 entries retrieved using SQL in 3.453789ms
[DEBUG] 2024-04-23 23:28:56.279 [main] HMSHandler - get_all_tablestime taken(ns): 3967398
[DEBUG] 2024-04-23 23:28:56.280 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 23:28:56.280 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 23:28:56.281 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.287 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:56.288 [main] HMSHandler - get_functionstime taken(ns): 7448347
[DEBUG] 2024-04-23 23:28:56.288 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:28:56.288 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:28:56.289 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.293 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:56.293 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 4704759
[DEBUG] 2024-04-23 23:28:56.294 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:28:56.294 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:28:56.295 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.298 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:56.299 [main] HMSHandler - get_all_packagestime taken(ns): 4621473
[DEBUG] 2024-04-23 23:28:56.300 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:28:56.301 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:28:56.301 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.304 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:56.305 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:56.305 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:56.305 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 3.635535ms
[DEBUG] 2024-04-23 23:28:56.305 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.307 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:56.307 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:56.307 [main] ObjectStore - 0 entries retrieved using SQL in 1.953568ms
[DEBUG] 2024-04-23 23:28:56.307 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 6058207
[DEBUG] 2024-04-23 23:28:56.307 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.310 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:56.312 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:56.312 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:56.312 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:56.312 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.531884ms
[DEBUG] 2024-04-23 23:28:56.312 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:28:56.313 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 23:28:56.313 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:56.313 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:56.315 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:56.315 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:28:56.317 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:28:56.318 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:56.319 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:28:56.320 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:28:56.320 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:56.320 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 23:28:56.321 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:28:56.321 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:28:56.321 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:28:56.321 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:56.321 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:56.323 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:56.323 [main] ObjectStore - rolling back transaction: no open transactions: 0
[DEBUG] 2024-04-23 23:28:56.323 [main] HMSHandler - drop_databasetime taken(ns): 55152201
[ERROR] 2024-04-23 23:28:56.324 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 63 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 65 more

[DEBUG] 2024-04-23 23:28:58.324 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:58.325 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:58.326 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:28:58.326 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.329 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:58.330 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:58.330 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:58.330 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 4.061095ms
[DEBUG] 2024-04-23 23:28:58.330 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:28:58.330 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:28:58.330 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.331 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:58.332 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:58.332 [main] ObjectStore - 2 entries retrieved using SQL in 1.240418ms
[DEBUG] 2024-04-23 23:28:58.332 [main] HMSHandler - get_all_tablestime taken(ns): 1400285
[DEBUG] 2024-04-23 23:28:58.332 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 23:28:58.332 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 23:28:58.332 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.334 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:58.334 [main] HMSHandler - get_functionstime taken(ns): 2131815
[DEBUG] 2024-04-23 23:28:58.335 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:28:58.335 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:28:58.335 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.336 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:58.336 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 1414653
[DEBUG] 2024-04-23 23:28:58.336 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:28:58.336 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:28:58.337 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.338 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:58.338 [main] HMSHandler - get_all_packagestime taken(ns): 1409552
[DEBUG] 2024-04-23 23:28:58.338 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:28:58.338 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:28:58.339 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.340 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:58.340 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:58.340 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:58.340 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.55574ms
[DEBUG] 2024-04-23 23:28:58.340 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.341 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:58.341 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:58.341 [main] ObjectStore - 0 entries retrieved using SQL in 0.776964ms
[DEBUG] 2024-04-23 23:28:58.341 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 2533864
[DEBUG] 2024-04-23 23:28:58.341 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.342 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:58.343 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:28:58.344 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:28:58.344 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:58.344 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.660086ms
[DEBUG] 2024-04-23 23:28:58.344 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:28:58.344 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 23:28:58.344 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:28:58.344 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:28:58.346 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:28:58.346 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:28:58.347 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:28:58.348 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:28:58.348 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:28:58.349 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:28:58.349 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:58.349 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 23:28:58.350 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:28:58.350 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:28:58.350 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:28:58.350 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:58.350 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:28:58.352 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:28:58.352 [main] ObjectStore - rolling back transaction: no open transactions: 0
[DEBUG] 2024-04-23 23:28:58.352 [main] HMSHandler - drop_databasetime taken(ns): 26636003
[ERROR] 2024-04-23 23:28:58.352 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 63 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 65 more

[DEBUG] 2024-04-23 23:29:00.353 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:29:00.353 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:29:00.354 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:00.354 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.357 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:00.357 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:00.358 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:00.358 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 3.125538ms
[DEBUG] 2024-04-23 23:29:00.358 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:29:00.358 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:29:00.358 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.359 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:00.359 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:00.359 [main] ObjectStore - 2 entries retrieved using SQL in 0.97846ms
[DEBUG] 2024-04-23 23:29:00.359 [main] HMSHandler - get_all_tablestime taken(ns): 1107732
[DEBUG] 2024-04-23 23:29:00.359 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 23:29:00.359 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 23:29:00.359 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.361 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:00.361 [main] HMSHandler - get_functionstime taken(ns): 2047571
[DEBUG] 2024-04-23 23:29:00.361 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:29:00.361 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:29:00.362 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.363 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:00.363 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 1293762
[DEBUG] 2024-04-23 23:29:00.363 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:29:00.363 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:29:00.363 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.364 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:00.364 [main] HMSHandler - get_all_packagestime taken(ns): 1296124
[DEBUG] 2024-04-23 23:29:00.365 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:29:00.365 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:29:00.365 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.366 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:00.367 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:00.367 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:00.367 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.534669ms
[DEBUG] 2024-04-23 23:29:00.367 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.367 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:00.368 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:00.368 [main] ObjectStore - 0 entries retrieved using SQL in 0.842806ms
[DEBUG] 2024-04-23 23:29:00.368 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 2569281
[DEBUG] 2024-04-23 23:29:00.368 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.369 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:00.370 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:00.370 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:00.370 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:00.370 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.356439ms
[DEBUG] 2024-04-23 23:29:00.370 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:29:00.370 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 23:29:00.370 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:00.370 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:00.372 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:00.372 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:29:00.373 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:29:00.374 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:00.374 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:29:00.375 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:29:00.375 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:00.375 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 23:29:00.376 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:29:00.376 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:29:00.376 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:29:00.376 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:00.377 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:00.378 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:00.378 [main] ObjectStore - rolling back transaction: no open transactions: 0
[DEBUG] 2024-04-23 23:29:00.378 [main] HMSHandler - drop_databasetime taken(ns): 24033428
[ERROR] 2024-04-23 23:29:00.378 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 63 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 65 more

[DEBUG] 2024-04-23 23:29:02.379 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:29:02.379 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:29:02.380 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:02.380 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.383 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:02.384 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:02.384 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:02.384 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 3.325409ms
[DEBUG] 2024-04-23 23:29:02.384 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:29:02.384 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:29:02.384 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.385 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:02.385 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:02.385 [main] ObjectStore - 2 entries retrieved using SQL in 0.915122ms
[DEBUG] 2024-04-23 23:29:02.385 [main] HMSHandler - get_all_tablestime taken(ns): 1109156
[DEBUG] 2024-04-23 23:29:02.385 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 23:29:02.385 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 23:29:02.386 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.388 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:02.388 [main] HMSHandler - get_functionstime taken(ns): 2402229
[DEBUG] 2024-04-23 23:29:02.388 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:29:02.388 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:29:02.388 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.390 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:02.390 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 1404668
[DEBUG] 2024-04-23 23:29:02.390 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:29:02.390 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:29:02.390 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.391 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:02.391 [main] HMSHandler - get_all_packagestime taken(ns): 1373739
[DEBUG] 2024-04-23 23:29:02.392 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:29:02.392 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:29:02.392 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.393 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:02.394 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:02.394 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:02.394 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.617316ms
[DEBUG] 2024-04-23 23:29:02.394 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.395 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:02.395 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:02.395 [main] ObjectStore - 0 entries retrieved using SQL in 1.219343ms
[DEBUG] 2024-04-23 23:29:02.395 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 3286290
[DEBUG] 2024-04-23 23:29:02.396 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.397 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:02.398 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:02.399 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:02.399 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:02.399 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.728859ms
[DEBUG] 2024-04-23 23:29:02.399 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:29:02.399 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 23:29:02.399 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:02.399 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:02.400 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:02.400 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:29:02.401 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:29:02.402 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:02.403 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:29:02.403 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:29:02.403 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:02.403 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 23:29:02.404 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:29:02.404 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:29:02.404 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:29:02.405 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:02.405 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:02.406 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:02.406 [main] ObjectStore - rolling back transaction: no open transactions: 0
[DEBUG] 2024-04-23 23:29:02.406 [main] HMSHandler - drop_databasetime taken(ns): 26063164
[ERROR] 2024-04-23 23:29:02.406 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 63 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 65 more

[DEBUG] 2024-04-23 23:29:04.407 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:29:04.407 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:29:04.408 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:04.408 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.412 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:04.412 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:04.412 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:04.412 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 3.947502ms
[DEBUG] 2024-04-23 23:29:04.413 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:29:04.413 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:29:04.413 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.414 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:04.414 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:04.414 [main] ObjectStore - 2 entries retrieved using SQL in 1.00397ms
[DEBUG] 2024-04-23 23:29:04.414 [main] HMSHandler - get_all_tablestime taken(ns): 1154741
[DEBUG] 2024-04-23 23:29:04.414 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 23:29:04.414 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 23:29:04.414 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.416 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:04.417 [main] HMSHandler - get_functionstime taken(ns): 2306077
[DEBUG] 2024-04-23 23:29:04.417 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:29:04.417 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:29:04.417 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.418 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:04.418 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 1273225
[DEBUG] 2024-04-23 23:29:04.418 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:29:04.418 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:29:04.419 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.420 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:04.420 [main] HMSHandler - get_all_packagestime taken(ns): 1247552
[DEBUG] 2024-04-23 23:29:04.420 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:29:04.420 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:29:04.420 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.422 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:04.422 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:04.422 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:04.422 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.540419ms
[DEBUG] 2024-04-23 23:29:04.422 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.423 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:04.423 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:04.423 [main] ObjectStore - 0 entries retrieved using SQL in 0.948966ms
[DEBUG] 2024-04-23 23:29:04.423 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 2678925
[DEBUG] 2024-04-23 23:29:04.423 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.424 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:04.425 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:04.426 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:04.426 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:04.426 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 1.427955ms
[DEBUG] 2024-04-23 23:29:04.426 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:29:04.426 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 23:29:04.426 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:04.426 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:04.427 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:04.427 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:29:04.428 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:29:04.429 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:04.430 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:29:04.430 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:29:04.430 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:04.430 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 23:29:04.431 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:29:04.432 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:29:04.432 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:29:04.432 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:04.432 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:04.433 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:04.434 [main] ObjectStore - rolling back transaction: no open transactions: 0
[DEBUG] 2024-04-23 23:29:04.434 [main] HMSHandler - drop_databasetime taken(ns): 25781571
[ERROR] 2024-04-23 23:29:04.434 [main] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy29.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485)
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 63 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 65 more

[DEBUG] 2024-04-23 23:29:06.435 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:29:06.436 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:29:06.437 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:06.437 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.439 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.439 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.439 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.439 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.707554ms
[DEBUG] 2024-04-23 23:29:06.440 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_1
[INFO ] 2024-04-23 23:29:06.440 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_1	
[DEBUG] 2024-04-23 23:29:06.440 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.441 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.441 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.441 [main] ObjectStore - 2 entries retrieved using SQL in 0.863891ms
[DEBUG] 2024-04-23 23:29:06.441 [main] HMSHandler - get_all_tablestime taken(ns): 985807
[DEBUG] 2024-04-23 23:29:06.441 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_1 pat=*
[INFO ] 2024-04-23 23:29:06.441 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_1 pat=*	
[DEBUG] 2024-04-23 23:29:06.441 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.443 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.443 [main] HMSHandler - get_functionstime taken(ns): 2268878
[DEBUG] 2024-04-23 23:29:06.443 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:29:06.443 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:29:06.444 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.445 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.445 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 1553766
[DEBUG] 2024-04-23 23:29:06.445 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:29:06.445 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:29:06.446 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.447 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.447 [main] HMSHandler - get_all_packagestime taken(ns): 1570409
[DEBUG] 2024-04-23 23:29:06.447 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:29:06.448 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:29:06.448 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.449 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.450 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.450 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.450 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.255254ms
[DEBUG] 2024-04-23 23:29:06.450 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.452 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.452 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.452 [main] ObjectStore - 0 entries retrieved using SQL in 1.484401ms
[DEBUG] 2024-04-23 23:29:06.452 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 4035042
[DEBUG] 2024-04-23 23:29:06.452 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.494 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.495 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.495 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:29:06.513 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:29:06.513 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.513 [main] HMSHandler - 0: drop_table : tbl=hive.db_test_get_fields_1.tab1
[INFO ] 2024-04-23 23:29:06.513 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db_test_get_fields_1.tab1	
[DEBUG] 2024-04-23 23:29:06.514 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.514 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.516 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.516 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.516 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.516 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.190161ms
[DEBUG] 2024-04-23 23:29:06.516 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.518 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.518 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.518 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.518 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.135953ms
[DEBUG] 2024-04-23 23:29:06.518 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.519 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.519 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 23:29:06.525 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.526 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.526 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.531 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.531 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.550 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.550 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.550 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.550 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 23:29:06.552 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.552 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:29:06.552 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.578 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.589 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:29:06.589 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.589 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:29:06.589 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:29:06.590 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.619 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1215751309 (XID = 168), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.630 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:29:06.630 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:29:06.630 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.630 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:29:06.630 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:29:06.631 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:29:06.631 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.648 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.648 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:29:06.648 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:29:06.648 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.666 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.666 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:29:06.666 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.666 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:29:06.666 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab1
[DEBUG] 2024-04-23 23:29:06.674 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:29:06.684 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.698 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:29:06.698 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.698 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:29:06.723 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:29:06.723 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.783 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.783 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.783 [main] HMSHandler - drop_tabletime taken(ns): 269361510
[DEBUG] 2024-04-23 23:29:06.784 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.784 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:29:06.793 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:29:06.793 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.794 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.803 [main] MetastoreDirectSqlUtils - Direct SQL query in 8.857155ms + 0.051864ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?)]
[DEBUG] 2024-04-23 23:29:06.813 [main] MetastoreDirectSqlUtils - Direct SQL query in 3.191975ms + 0.0175ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 23:29:06.817 [main] MetastoreDirectSqlUtils - Direct SQL query in 3.237559ms + 0.018132ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 23:29:06.820 [main] MetastoreDirectSqlUtils - Direct SQL query in 3.421073ms + 0.018651ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 23:29:06.825 [main] MetastoreDirectSqlUtils - Direct SQL query in 4.518911ms + 0.020674ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 23:29:06.829 [main] MetastoreDirectSqlUtils - Direct SQL query in 3.699883ms + 0.021493ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 23:29:06.833 [main] MetastoreDirectSqlUtils - Direct SQL query in 3.752094ms + 0.019741ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2)]
[DEBUG] 2024-04-23 23:29:06.839 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.604556ms + 0.020431ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 23:29:06.842 [main] MetastoreDirectSqlUtils - Direct SQL query in 3.032514ms + 0.018204ms, the query is [delete from "SORT_COLS" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 23:29:06.845 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.647299ms + 0.018568ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 23:29:06.847 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.476651ms + 0.018259ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 23:29:06.851 [main] MetastoreDirectSqlUtils - Direct SQL query in 3.084864ms + 0.018931ms, the query is [delete from "SDS" where "SD_ID" in (3,4)]
[DEBUG] 2024-04-23 23:29:06.854 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.665529ms + 0.018948ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (3,4)]
[DEBUG] 2024-04-23 23:29:06.856 [main] MetastoreDirectSqlUtils - Direct SQL query in 2.694751ms + 0.017564ms, the query is [delete from "SERDES" where "SERDE_ID" in (3,4)]
[DEBUG] 2024-04-23 23:29:06.864 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.864 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.864 [main] ObjectStore - 0 entries retrieved using SQL in 69.812112ms
[DEBUG] 2024-04-23 23:29:06.864 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.864 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:29:06.865 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:29:06.866 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.866 [main] HMSHandler - 0: drop_table : tbl=hive.db_test_get_fields_1.tab2
[INFO ] 2024-04-23 23:29:06.866 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.db_test_get_fields_1.tab2	
[DEBUG] 2024-04-23 23:29:06.867 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.867 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.871 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.872 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.872 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.872 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 5.10305ms
[DEBUG] 2024-04-23 23:29:06.872 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.873 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.874 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.874 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.874 [main] ObjectStore - db details for db db_test_get_fields_1 retrieved using SQL in 2.247504ms
[DEBUG] 2024-04-23 23:29:06.874 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.874 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.874 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:29:06.876 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.877 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.877 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.878 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.878 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.882 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.882 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.882 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.882 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:29:06.884 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.884 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:29:06.885 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.894 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:29:06.894 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.894 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:29:06.894 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:29:06.894 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.896 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:29:06.896 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:29:06.896 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.896 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:29:06.896 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:29:06.896 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:29:06.896 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.898 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.898 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:29:06.899 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:29:06.899 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.900 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.900 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:29:06.901 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.901 [main] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:29:06.901 [main] ObjectStore - Executing getMTable for hive.db_test_get_fields_1.tab2
[DEBUG] 2024-04-23 23:29:06.902 [main] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:29:06.903 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.906 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:29:06.906 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:29:06.906 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:29:06.908 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:29:06.908 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:29:06.915 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.915 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.915 [main] HMSHandler - drop_tabletime taken(ns): 48855967
[INFO ] 2024-04-23 23:29:06.915 [main] ObjectStore - Dropping database hive.db_test_get_fields_1 along with all tables
[DEBUG] 2024-04-23 23:29:06.915 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.915 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.920 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.920 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:29:06.921 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:29:06.926 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.926 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:29:06.927 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:29:06.927 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.927 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_1'>
[DEBUG] 2024-04-23 23:29:06.928 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:129) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:29:06.928 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:29:06.928 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:29:06.928 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.929 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:06.931 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.932 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_1
[DEBUG] 2024-04-23 23:29:06.933 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab1
[INFO ] 2024-04-23 23:29:06.934 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:29:06.936 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_1
[DEBUG] 2024-04-23 23:29:06.937 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db/tab2
[DEBUG] 2024-04-23 23:29:06.938 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:29:06.938 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_1
[DEBUG] 2024-04-23 23:29:06.938 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_1.db
[WARN ] 2024-04-23 23:29:06.938 [main] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_1.db does not exist; Force to delete it.
[ERROR] 2024-04-23 23:29:06.938 [main] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_1.db
[DEBUG] 2024-04-23 23:29:06.939 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:29:06.939 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_1
[DEBUG] 2024-04-23 23:29:06.939 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_1.db
[DEBUG] 2024-04-23 23:29:06.940 [main] HMSHandler - drop_databasetime taken(ns): 503974253
[DEBUG] 2024-04-23 23:29:06.940 [main] PerfLogger - </PERFLOG method=drop_database start=1713911331979 end=1713911346940 duration=14961 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=7 error=false>
[DEBUG] 2024-04-23 23:29:06.940 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:29:06.941 [main] HMSHandler - 0: get_database: db_test_get_fields_2
[INFO ] 2024-04-23 23:29:06.941 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: db_test_get_fields_2	
[DEBUG] 2024-04-23 23:29:06.941 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:06.942 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.943 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.943 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:06.943 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.943 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 2.17674ms
[INFO ] 2024-04-23 23:29:06.943 [main] MetastoreDefaultTransformer - Starting translation for transformDatabase for processor null with null on database db_test_get_fields_2 locationUri=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db managedLocationUri=null
[DEBUG] 2024-04-23 23:29:06.943 [main] MetastoreDefaultTransformer - Comparing DB and warehouse paths warehouse=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse db.getLocationUri=/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db
[INFO ] 2024-04-23 23:29:06.943 [main] MetastoreDefaultTransformer - Transformer returning database:Database(name:db_test_get_fields_2, description:null, locationUri:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:1713911331, type:NATIVE)
[DEBUG] 2024-04-23 23:29:06.943 [main] HMSHandler - get_databasetime taken(ns): 2469263
[DEBUG] 2024-04-23 23:29:06.943 [main] PerfLogger - </PERFLOG method=get_database_req start=1713911346940 end=1713911346943 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:29:06.944 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=4, comments=HMS client
[DEBUG] 2024-04-23 23:29:06.944 [main] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:29:06.944 [main] HMSHandler - 0: get_tables_by_type: db=@hive#db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:29:06.944 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_tables_by_type: db=@hive#db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:29:06.944 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:29:06.944 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:29:06.944 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:06.946 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.947 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.947 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:06.947 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.947 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 2.362182ms
[DEBUG] 2024-04-23 23:29:06.947 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:06.951 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.951 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:06.951 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.951 [main] ObjectStore - 0 entries retrieved using SQL in 4.585453ms
[DEBUG] 2024-04-23 23:29:06.951 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 7174906
[DEBUG] 2024-04-23 23:29:06.952 [main] HMSHandler - get_tables_by_typetime taken(ns): 7639274
[DEBUG] 2024-04-23 23:29:06.952 [main] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911346944 end=1713911346952 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:29:06.952 [main] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:29:06.952 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_2
[INFO ] 2024-04-23 23:29:06.952 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_2	
[DEBUG] 2024-04-23 23:29:06.952 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:06.956 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.956 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:06.957 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.957 [main] ObjectStore - 0 entries retrieved using SQL in 4.353624ms
[DEBUG] 2024-04-23 23:29:06.957 [main] HMSHandler - get_all_tablestime taken(ns): 4507838
[DEBUG] 2024-04-23 23:29:06.957 [main] PerfLogger - </PERFLOG method=get_all_tables start=1713911346952 end=1713911346957 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:29:06.957 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_test_get_fields_2 (0 tables), metastore.batch.retrieve.max=2
[DEBUG] 2024-04-23 23:29:06.957 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:29:06.957 [main] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:29:06.957 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:06.959 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.959 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.959 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:06.959 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.959 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.927904ms
[DEBUG] 2024-04-23 23:29:06.959 [main] HMSHandler - 0: get_multi_table : db=db_test_get_fields_2 tbls=
[INFO ] 2024-04-23 23:29:06.959 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_multi_table : db=db_test_get_fields_2 tbls=	
[DEBUG] 2024-04-23 23:29:06.960 [main] HMSHandler - get_multi_tabletime taken(ns): 90990
[DEBUG] 2024-04-23 23:29:06.960 [main] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911346957 end=1713911346960 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:29:06.960 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:29:06.960 [main] HMSHandler - 0: drop_database: @hive#db_test_get_fields_2
[INFO ] 2024-04-23 23:29:06.960 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#db_test_get_fields_2	
[DEBUG] 2024-04-23 23:29:06.960 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:29:06.960 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.962 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.962 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.962 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.962 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.571953ms
[DEBUG] 2024-04-23 23:29:06.962 [main] HMSHandler - 0: get_all_tables: db=@hive#db_test_get_fields_2
[INFO ] 2024-04-23 23:29:06.962 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#db_test_get_fields_2	
[DEBUG] 2024-04-23 23:29:06.962 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.963 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.963 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.963 [main] ObjectStore - 0 entries retrieved using SQL in 1.000495ms
[DEBUG] 2024-04-23 23:29:06.963 [main] HMSHandler - get_all_tablestime taken(ns): 1188554
[DEBUG] 2024-04-23 23:29:06.964 [main] HMSHandler - 0: get_functions: db=@hive#db_test_get_fields_2 pat=*
[INFO ] 2024-04-23 23:29:06.964 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#db_test_get_fields_2 pat=*	
[DEBUG] 2024-04-23 23:29:06.964 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.966 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.966 [main] HMSHandler - get_functionstime taken(ns): 2340585
[DEBUG] 2024-04-23 23:29:06.966 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:29:06.966 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:29:06.967 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.968 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.968 [main] HMSHandler - get_all_stored_procedurestime taken(ns): 1858977
[DEBUG] 2024-04-23 23:29:06.968 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:29:06.969 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:29:06.969 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.970 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.970 [main] HMSHandler - get_all_packagestime taken(ns): 1455260
[DEBUG] 2024-04-23 23:29:06.971 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:29:06.971 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=db_test_get_fields_2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:29:06.971 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.972 [main] MetaStoreDirectSql - getDatabase: directsql returning db db_test_get_fields_2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:29:06.972 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.972 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.972 [main] ObjectStore - db details for db db_test_get_fields_2 retrieved using SQL in 1.494097ms
[DEBUG] 2024-04-23 23:29:06.972 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.973 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:29:06.973 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.973 [main] ObjectStore - 0 entries retrieved using SQL in 0.99029ms
[DEBUG] 2024-04-23 23:29:06.973 [main] HMSHandler - getTablesByTypeCoretime taken(ns): 2701225
[INFO ] 2024-04-23 23:29:06.974 [main] ObjectStore - Dropping database hive.db_test_get_fields_2 along with all tables
[DEBUG] 2024-04-23 23:29:06.974 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:29:06.974 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:29:06.975 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:29:06.976 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:29:06.977 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:29:06.978 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:29:06.978 [main] TxnHandler - Catching sql exception in min history level check
java.sql.SQLSyntaxErrorException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeQuery(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeQuery(ProxyStatement.java:108) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeQuery(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.checkMinHistoryLevelTable(TxnHandler.java:456) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.setConf(TxnHandler.java:422) [classes/:?]
	at org.apache.hadoop.hive.metastore.txn.TxnUtils.getTxnStore(TxnUtils.java:124) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.getTxnHandler(AcidEventListener.java:136) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:57) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:130) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'MIN_HISTORY_LEVEL' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bind(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.CursorNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 54 more
[DEBUG] 2024-04-23 23:29:06.979 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:29:06.979 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.979 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_test_get_fields_2'>
[DEBUG] 2024-04-23 23:29:06.980 [main] TxnHandler - Going to rollback: 
java.sql.SQLSyntaxErrorException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.execute(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.jdbc.EmbedStatement.executeUpdate(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at com.zaxxer.hikari.pool.ProxyStatement.executeUpdate(ProxyStatement.java:117) ~[HikariCP-2.6.1.jar:?]
	at com.zaxxer.hikari.pool.HikariProxyStatement.executeUpdate(HikariProxyStatement.java) ~[HikariCP-2.6.1.jar:?]
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.cleanupRecords(TxnHandler.java:4190) [classes/:?]
	at org.apache.hadoop.hive.metastore.AcidEventListener.onDropDatabase(AcidEventListener.java:58) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier$26.notify(MetaStoreListenerNotifier.java:99) [classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreListenerNotifier.notifyEvent(MetaStoreListenerNotifier.java:339) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1785) [classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) [classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) [classes/:?]
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source) [?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabaseCascadePerDb(HiveMetaStoreClient.java:1601) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1532) [classes/:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.dropDatabase(HiveMetaStoreClient.java:1485) [classes/:?]
	at org.apache.hadoop.hive.metastore.TestHmsServerAuthorization.tearDown(TestHmsServerAuthorization.java:130) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.derby.iapi.error.StandardException: Table/View 'TXN_COMPONENTS' does not exist.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindTableDescriptor(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromBaseTable.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.FromList.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.SelectNode.bindNonVTITables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DMLStatementNode.bindTables(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.compile.DeleteNode.bindStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepMinion(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.GenericStatement.prepare(Unknown Source) ~[derby-10.14.1.0.jar:?]
	at org.apache.derby.impl.sql.conn.GenericLanguageConnectionContext.prepareInternalStatement(Unknown Source) ~[derby-10.14.1.0.jar:?]
	... 52 more
[INFO ] 2024-04-23 23:29:06.980 [main] TxnHandler - Non-retryable error in cleanupRecords : Table/View 'TXN_COMPONENTS' does not exist. (SQLState=42X05, ErrorCode=20000)
[WARN ] 2024-04-23 23:29:06.980 [main] TxnHandler - Cannot perform cleanup since metastore table does not exist
[DEBUG] 2024-04-23 23:29:06.980 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2053481312 (XID = 1031), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.980 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:29:06.981 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1807176280 (XID = 166), (SESSIONID = 1), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:29:06.982 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:29:06.982 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_2
[DEBUG] 2024-04-23 23:29:06.982 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_2.db
[WARN ] 2024-04-23 23:29:06.982 [main] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_2.db does not exist; Force to delete it.
[ERROR] 2024-04-23 23:29:06.982 [main] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/db_test_get_fields_2.db
[DEBUG] 2024-04-23 23:29:06.982 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:29:06.983 [main] ReplChangeManager - Repl policy is not set for database: db_test_get_fields_2
[DEBUG] 2024-04-23 23:29:06.983 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_test_get_fields_2.db
[DEBUG] 2024-04-23 23:29:06.984 [main] HMSHandler - drop_databasetime taken(ns): 23477717
[DEBUG] 2024-04-23 23:29:06.984 [main] PerfLogger - </PERFLOG method=drop_database start=1713911346960 end=1713911346984 duration=24 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:29:06.984 [main] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:29:06.985 [main] HMSHandler - 0: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:29:06.985 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:29:06.985 [main] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@27abb83e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2160e52a will be shutdown
[DEBUG] 2024-04-23 23:29:06.985 [main] HMSHandler - 0: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:29:06.985 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:29:06.985 [main] PerfLogger - </PERFLOG method=shutdown start=1713911346984 end=1713911346985 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:29:06.985 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: -1
[DEBUG] 2024-04-23 23:29:06.996 [Thread-15] ShutdownHookManager - ShutdownHookManger complete shutdown.
