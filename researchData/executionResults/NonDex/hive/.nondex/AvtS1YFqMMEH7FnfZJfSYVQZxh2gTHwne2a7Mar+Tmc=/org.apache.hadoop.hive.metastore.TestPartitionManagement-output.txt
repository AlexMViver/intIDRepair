DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Took 0,074842 seconds to load 240 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@515aebb0]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@515aebb0) with optional ClassLoader: null
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Missing dependencies for Yaml support, ConfigurationFactory org.apache.logging.log4j.core.config.yaml.YamlConfigurationFactory is inactive
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@1bd4fdd
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test330bedb4.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2-test.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2-test.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2-test.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.properties] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.yaml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.json] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.jsn] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
TRACE StatusLogger Trying to find [log4j2330bedb4.xml] using ClassLoader.getSystemResource().
TRACE StatusLogger Trying to find [log4j2.properties] using context class loader sun.misc.Launcher$AppClassLoader@330bedb4.
INFO StatusLogger Log4j appears to be running in a Servlet environment, but there's no log4j-web module available. If you want better web container support, please add the log4j-web JAR to your web archive or server lib directory.
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@765d7657
DEBUG StatusLogger Installed 1 script engine
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
DEBUG StatusLogger PluginManager 'Core' found 124 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="filename", value="logs")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={filename=logs}, Configuration(PropertiesConfig))
DEBUG StatusLogger PluginManager 'Lookup' found 16 plugins
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="STDOUT", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="CAPTURED", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={STDOUT, CAPTURED}, ={}, Configuration(PropertiesConfig), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(disableAnsi="null", Configuration(PropertiesConfig), alwaysWriteExceptions="null", pattern="[%-5level] %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %c{1} - %msg%n", footer="null", PatternSelector=null, Replace=null, charset="null", header="null", noConsoleNoAnsi="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(target="null", follow="null", direct="null", bufferSize="null", immediateFlush="null", bufferedIo="null", ignoreExceptions="null", Configuration(PropertiesConfig), name="STDOUT", PatternLayout([%-5level] %d{yyyy-MM-dd HH:mm:ss.SSS} [%t] %c{1} - %msg%n), Filter=null, ={})
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.hadoop.hive.metastore.testutils.CapturingLogAppender].
DEBUG StatusLogger createAppender(name="CAPTURED")
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={STDOUT, CAPTURED})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@765d7657 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@765d7657
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@765d7657 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@33cb5951...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@33cb5951 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@51bd8b5c
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@515aebb0
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=STDOUT
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=CAPTURED
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/standalone-metastore/metastore-server/target/test-classes/log4j2.properties (org.apache.logging.log4j.core.LoggerContext@515aebb0) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@515aebb0] started OK.
[INFO ] 2024-04-23 23:37:44.286 [main] MetastoreConf - Unable to find config file: hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
[INFO ] 2024-04-23 23:37:44.290 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:37:44.291 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:37:44.291 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:37:44.324 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:37:44.325 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:37:44.325 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:37:44.325 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[DEBUG] 2024-04-23 23:37:44.328 [main] MetastoreConf - MetastoreConf object:
Key: <metastore.acid.housekeeper.interval> old hive key: <hive.metastore.acid.housekeeper.interval>  value: <60s>
Key: <metastore.acid.housekeeper.start> old hive key: <hive.metastore.acid.housekeeper.start>  value: <60s>
Key: <metastore.acid.txn.cleaner.interval> old hive key: <hive.metastore.acid.txn.cleaner.interval>  value: <10s>
Key: <metastore.added.jars.path> old hive key: <hive.added.jars.path>  value: <>
Key: <metastore.aggregate.stats.cache.clean.until> old hive key: <hive.metastore.aggregate.stats.cache.clean.until>  value: <0.8>
Key: <metastore.aggregate.stats.cache.enabled> old hive key: <hive.metastore.aggregate.stats.cache.enabled>  value: <false>
Key: <metastore.aggregate.stats.cache.fpp> old hive key: <hive.metastore.aggregate.stats.cache.fpp>  value: <0.01>
Key: <metastore.aggregate.stats.cache.max.full> old hive key: <hive.metastore.aggregate.stats.cache.max.full>  value: <0.9>
Key: <metastore.aggregate.stats.cache.max.partitions> old hive key: <hive.metastore.aggregate.stats.cache.max.partitions>  value: <10000>
Key: <metastore.aggregate.stats.cache.max.reader.wait> old hive key: <hive.metastore.aggregate.stats.cache.max.reader.wait>  value: <1000ms>
Key: <metastore.aggregate.stats.cache.max.variance> old hive key: <hive.metastore.aggregate.stats.cache.max.variance>  value: <0.01>
Key: <metastore.aggregate.stats.cache.max.writer.wait> old hive key: <hive.metastore.aggregate.stats.cache.max.writer.wait>  value: <5000ms>
Key: <metastore.aggregate.stats.cache.size> old hive key: <hive.metastore.aggregate.stats.cache.size>  value: <10000>
Key: <metastore.aggregate.stats.cache.ttl> old hive key: <hive.metastore.aggregate.stats.cache.ttl>  value: <600s>
Key: <metastore.warehouse.tenant.colocation> old hive key: <hive.metastore.warehouse.tenant.colocation>  value: <false>
Key: <metastore.alter.handler> old hive key: <hive.metastore.alter.impl>  value: <org.apache.hadoop.hive.metastore.HiveAlterHandler>
Key: <metastore.async.log.enabled> old hive key: <hive.async.log.enabled>  value: <true>
Key: <metastore.authorization.storage.checks> old hive key: <hive.metastore.authorization.storage.checks>  value: <false>
Key: <datanucleus.schema.autoCreateAll> old hive key: <datanucleus.schema.autoCreateAll>  value: <true>
Key: <metastore.batch.retrieve.max> old hive key: <hive.metastore.batch.retrieve.max>  value: <300>
Key: <metastore.batch.retrieve.table.partition.max> old hive key: <hive.metastore.batch.retrieve.table.partition.max>  value: <1000>
Key: <metastore.cache.pinobjtypes> old hive key: <hive.metastore.cache.pinobjtypes>  value: <Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order>
Key: <metastore.cached.rawstore.impl> old hive key: <hive.metastore.cached.rawstore.impl>  value: <org.apache.hadoop.hive.metastore.ObjectStore>
Key: <metastore.cached.rawstore.cache.update.frequency> old hive key: <hive.metastore.cached.rawstore.cache.update.frequency>  value: <60s>
Key: <metastore.cached.rawstore.cached.object.whitelist> old hive key: <hive.metastore.cached.rawstore.cached.object.whitelist>  value: <.*>
Key: <metastore.cached.rawstore.cached.object.blacklist> old hive key: <hive.metastore.cached.rawstore.cached.object.blacklist>  value: <>
Key: <metastore.cached.rawstore.max.cache.memory> old hive key: <hive.metastore.cached.rawstore.max.cache.memory>  value: <1Gb>
Key: <metastore.client.capability.check> old hive key: <hive.metastore.client.capability.check>  value: <true>
Key: <metastore.catalog.default> old hive key: <metastore.catalog.default>  value: <hive>
Key: <metastore.cached.rawstore.catalogs> old hive key: <metastore.cached.rawstore.catalogs>  value: <hive>
Key: <metastore.client.connect.retry.delay> old hive key: <hive.metastore.client.connect.retry.delay>  value: <1s>
Key: <metastore.client.kerberos.principal> old hive key: <hive.metastore.client.kerberos.principal>  value: <>
Key: <metastore.client.socket.lifetime> old hive key: <hive.metastore.client.socket.lifetime>  value: <0s>
Key: <metastore.client.socket.timeout> old hive key: <hive.metastore.client.socket.timeout>  value: <600s>
Key: <metastore.compactor.history.retention.did.not.initiate> old hive key: <hive.compactor.history.retention.did.not.initiate>  value: <2>
Key: <metastore.compactor.history.retention.failed> old hive key: <hive.compactor.history.retention.failed>  value: <3>
Key: <metastore.compactor.history.retention.succeeded> old hive key: <hive.compactor.history.retention.succeeded>  value: <3>
Key: <metastore.compactor.history.retention.timeout> old hive key: <hive.compactor.history.retention.timeout>  value: <7d>
Key: <metastore.compactor.initiator.failed.compacts.threshold> old hive key: <hive.compactor.initiator.failed.compacts.threshold>  value: <2>
Key: <metastore.compactor.initiator.failed.retry.time> old hive key: <hive.compactor.initiator.failed.retry.time>  value: <7d>
Key: <metastore.compactor.run.as.user> old hive key: <hive.compactor.run.as.user>  value: <>
Key: <metastore.compactor.oldest.replication.open.txn.threshold.warning> old hive key: <hive.compactor.oldest.replication.open.txn.threshold.warning>  value: <14d>
Key: <metastore.compactor.oldest.replication.open.txn.threshold.error> old hive key: <hive.compactor.oldest.replication.open.txn.threshold.error>  value: <21d>
Key: <metastore.compactor.oldest.open.txn.threshold.warning> old hive key: <hive.compactor.oldest.open.txn.threshold.warning>  value: <24h>
Key: <metastore.compactor.oldest.open.txn.threshold.error> old hive key: <hive.compactor.oldest.open.txn.threshold.error>  value: <72h>
Key: <metastore.compactor.oldest.uncleaned.aborted.txn.time.threshold.warning> old hive key: <hive.compactor.oldest.uncleaned.aborted.txn.time.threshold.warning>  value: <24h>
Key: <metastore.compactor.oldest.uncleaned.aborted.txn.time.threshold.error> old hive key: <hive.compactor.oldest.uncleaned.aborted.txn.time.threshold.error>  value: <48h>
Key: <metastore.compactor.tables.with.aborted.txn.threshold> old hive key: <hive.compactor.tables.with.aborted.txn.threshold>  value: <1>
Key: <metastore.compactor.oldest.uncleaned.compaction.time.threshold> old hive key: <hive.compactor.oldest.uncleaned.compaction.time.threshold>  value: <24h>
Key: <metastore.compactor.failed.compaction.ratio.threshold> old hive key: <hive.compactor.failed.compaction.ratio.threshold>  value: <0.01>
Key: <metastore.compactor.oldest.initiated.compaction.time.threshold.warning> old hive key: <hive.compactor.oldest.initiated.compaction.time.threshold.warning>  value: <1h>
Key: <metastore.compactor.oldest.initiated.compaction.time.threshold.error> old hive key: <hive.compactor.oldest.initiated.compaction.time.threshold.error>  value: <12h>
Key: <metastore.compactor.completed.txn.components.record.threshold.warning> old hive key: <hive.compactor.completed.txn.components.record.threshold.warning>  value: <500000>
Key: <metastore.compactor.completed.txn.components.record.threshold.error> old hive key: <hive.compactor.completed.txn.components.record.threshold.error>  value: <1000000>
Key: <metastore.compactor.txn.to.writeid.record.threshold.warning> old hive key: <hive.compactor.txn.to.writeid.record.threshold.warning>  value: <500000>
Key: <metastore.compactor.txn.to.writeid.record.threshold.error> old hive key: <hive.compactor.txn.to.writeid.record.threshold.error>  value: <1000000>
Key: <metastore.compactor.number.of.disabled.compaction.tables.threshold> old hive key: <hive.compactor.number.of.disabled.compaction.tables.threshold>  value: <1>
Key: <metastore.compactor.acid.metrics.logger.frequency> old hive key: <hive.compactor.acid.metrics.logger.frequency>  value: <360m>
Key: <metastore.housekeeping.leader.hostname> old hive key: <hive.metastore.housekeeping.leader.hostname>  value: <>
Key: <metastore.housekeeping.threads.on> old hive key: <hive.metastore.housekeeping.threads.on>  value: <false>
Key: <metastore.acidmetrics.thread.on> old hive key: <hive.metastore.acidmetrics.thread.on>  value: <true>
Key: <metastore.acidmetrics.check.interval> old hive key: <hive.metastore.acidmetrics.check.interval>  value: <300s>
Key: <metastore.acidmetrics.ext.on> old hive key: <hive.metastore.acidmetrics.ext.on>  value: <true>
Key: <metastore.acidmetrics.table.aborted.txns.threshold> old hive key: <hive.metastore.acidmetrics.table.aborted.txns.threshold>  value: <1500>
Key: <metastore.compactor.initiator.on> old hive key: <hive.compactor.initiator.on>  value: <false>
Key: <metastore.compactor.worker.threads> old hive key: <hive.compactor.worker.threads>  value: <0>
Key: <metastore.compactor.worker.detect.multiple.versions.threshold> old hive key: <hive.metastore.compactor.worker.detect.multiple.versions.threshold>  value: <24h>
Key: <metastore.compactor.enable.stats.compression> old hive key: <metastore.compactor.enable.stats.compression>  value: <true>
Key: <javax.jdo.option.ConnectionDriverName> old hive key: <javax.jdo.option.ConnectionDriverName>  value: <org.apache.derby.jdbc.EmbeddedDriver>
Key: <datanucleus.connectionPool.maxPoolSize> old hive key: <datanucleus.connectionPool.maxPoolSize>  value: <10>
Key: <metastore.ds.connection.url.hook> old hive key: <hive.metastore.ds.connection.url.hook>  value: <>
Key: <javax.jdo.option.ConnectionURL> old hive key: <javax.jdo.option.ConnectionURL>  value: <jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true>
Key: <datanucleus.connectionPoolingType> old hive key: <datanucleus.connectionPoolingType>  value: <HikariCP>
Key: <javax.jdo.option.ConnectionUserName> old hive key: <javax.jdo.option.ConnectionUserName>  value: <APP>
Key: <metastore.create.as.acid> old hive key: <hive.create.as.acid>  value: <false>
Key: <metastore.count.open.txns.interval> old hive key: <hive.count.open.txns.interval>  value: <1s>
Key: <datanucleus.autoStartMechanismMode> old hive key: <datanucleus.autoStartMechanismMode>  value: <ignored>
Key: <datanucleus.cache.level2> old hive key: <datanucleus.cache.level2>  value: <false>
Key: <datanucleus.cache.level2.type> old hive key: <datanucleus.cache.level2.type>  value: <none>
Key: <datanucleus.rdbms.initializeColumnInfo> old hive key: <datanucleus.rdbms.initializeColumnInfo>  value: <NONE>
Key: <datanucleus.plugin.pluginRegistryBundleCheck> old hive key: <datanucleus.plugin.pluginRegistryBundleCheck>  value: <LOG>
Key: <datanucleus.transactionIsolation> old hive key: <datanucleus.transactionIsolation>  value: <read-committed>
Key: <datanucleus.rdbms.useLegacyNativeValueStrategy> old hive key: <datanucleus.rdbms.useLegacyNativeValueStrategy>  value: <true>
Key: <metastore.dbaccess.ssl.truststore.path> old hive key: <hive.metastore.dbaccess.ssl.truststore.path>  value: <>
Key: <metastore.dbaccess.ssl.truststore.type> old hive key: <hive.metastore.dbaccess.ssl.truststore.type>  value: <jks>
Key: <metastore.dbaccess.ssl.use.SSL> old hive key: <hive.metastore.dbaccess.ssl.use.SSL>  value: <false>
Key: <metastore.default.partition.name> old hive key: <hive.exec.default.partition.name>  value: <__HIVE_DEFAULT_PARTITION__>
Key: <metastore.cluster.delegation.key.update-interval> old hive key: <hive.cluster.delegation.key.update-interval>  value: <1d>
Key: <metastore.cluster.delegation.token.gc-interval> old hive key: <hive.cluster.delegation.token.gc-interval>  value: <15m>
Key: <metastore.cluster.delegation.token.max-lifetime> old hive key: <hive.cluster.delegation.token.max-lifetime>  value: <7d>
Key: <metastore.cluster.delegation.token.renew-interval> old hive key: <hive.cluster.delegation.token.renew-interval>  value: <1d>
Key: <metastore.cluster.delegation.token.store.class> old hive key: <hive.cluster.delegation.token.store.class>  value: <org.apache.hadoop.hive.metastore.security.MetastoreDelegationTokenManager>
Key: <javax.jdo.option.DetachAllOnCommit> old hive key: <javax.jdo.option.DetachAllOnCommit>  value: <true>
Key: <metastore.direct.sql.max.elements.in.clause> old hive key: <hive.direct.sql.max.elements.in.clause>  value: <1000>
Key: <metastore.direct.sql.max.elements.values.clause> old hive key: <hive.direct.sql.max.elements.values.clause>  value: <1000>
Key: <metastore.direct.sql.max.parameters> old hive key: <hive.direct.sql.max.parameters>  value: <1000>
Key: <metastore.direct.sql.max.query.length> old hive key: <hive.direct.sql.max.query.length>  value: <100>
Key: <metastore.direct.sql.batch.size> old hive key: <hive.metastore.direct.sql.batch.size>  value: <0>
Key: <metastore.disallow.incompatible.col.type.changes> old hive key: <hive.metastore.disallow.incompatible.col.type.changes>  value: <true>
Key: <metastore.allow.incompatible.col.type.changes.serdes> old hive key: <hive.metastore.allow.incompatible.col.type.changes.serdes>  value: <org.apache.hadoop.hive.kudu.KuduSerDe,org.apache.iceberg.mr.hive.HiveIcebergSerDe>
Key: <metastore.dump.config.on.creation> old hive key: <metastore.dump.config.on.creation>  value: <true>
Key: <metastore.end.function.listeners> old hive key: <hive.metastore.end.function.listeners>  value: <>
Key: <metastore.event.clean.freq> old hive key: <hive.metastore.event.clean.freq>  value: <0s>
Key: <metastore.event.expiry.duration> old hive key: <hive.metastore.event.expiry.duration>  value: <0s>
Key: <metastore.event.listeners> old hive key: <hive.metastore.event.listeners>  value: <>
Key: <metastore.event.message.factory> old hive key: <hive.metastore.event.message.factory>  value: <org.apache.hadoop.hive.metastore.messaging.json.gzip.GzipJSONMessageEncoder>
Key: <metastore.repl.message.factory> old hive key: <hive.metastore.repl.message.factory>  value: <org.apache.hadoop.hive.metastore.messaging.json.gzip.GzipJSONMessageEncoder>
Key: <metastore.notification.parameters.exclude.patterns> old hive key: <hive.metastore.notification.parameters.exclude.patterns>  value: <>
Key: <metastore.event.db.listener.timetolive> old hive key: <hive.metastore.event.db.listener.timetolive>  value: <1d>
Key: <metastore.event.db.clean.maxevents> old hive key: <hive.metastore.event.db.clean.maxevents>  value: <10000>
Key: <metastore.event.db.listener.clean.interval> old hive key: <hive.metastore.event.db.listener.clean.interval>  value: <7200s>
Key: <metastore.event.db.listener.clean.startup.wait.interval> old hive key: <hive.metastore.event.db.listener.clean.startup.wait.interval>  value: <1d>
Key: <metastore.metastore.event.db.notification.api.auth> old hive key: <hive.metastore.event.db.notification.api.auth>  value: <true>
Key: <metastore.execute.setugi> old hive key: <hive.metastore.execute.setugi>  value: <true>
Key: <metastore.expression.proxy> old hive key: <hive.metastore.expression.proxy>  value: <org.apache.hadoop.hive.ql.optimizer.ppr.PartitionExpressionForMetastore>
Key: <metastore.decode.filter.expression.tostring> old hive key: <hive.metastore.decode.filter.expression.tostring>  value: <false>
Key: <metastore.file.metadata.threads> old hive key: <hive.metastore.hbase.file.metadata.threads>  value: <1>
Key: <metastore.filter.hook> old hive key: <hive.metastore.filter.hook>  value: <org.apache.hadoop.hive.metastore.DefaultMetaStoreFilterHookImpl>
Key: <metastore.fs.handler.class> old hive key: <hive.metastore.fs.handler.class>  value: <org.apache.hadoop.hive.metastore.HiveMetaStoreFsImpl>
Key: <metastore.fshandler.threads> old hive key: <hive.metastore.fshandler.threads>  value: <15>
Key: <metastore.hmshandler.retry.attempts> old hive key: <hive.hmshandler.retry.attempts>  value: <10>
Key: <metastore.hmshandler.force.reload.conf> old hive key: <hive.hmshandler.force.reload.conf>  value: <false>
Key: <metastore.hmshandler.retry.interval> old hive key: <hive.hmshandler.retry.interval>  value: <2000ms>
Key: <datanucleus.identifierFactory> old hive key: <datanucleus.identifierFactory>  value: <datanucleus1>
Key: <metastore.init.hooks> old hive key: <hive.metastore.init.hooks>  value: <>
Key: <metastore.initial.metadata.count.enabled> old hive key: <hive.metastore.initial.metadata.count.enabled>  value: <true>
Key: <metastore.integral.jdo.pushdown> old hive key: <hive.metastore.integral.jdo.pushdown>  value: <false>
Key: <metastore.jdbc.max.batch.size> old hive key: <hive.metastore.jdbc.max.batch.size>  value: <1000>
Key: <metastore.kerberos.keytab.file> old hive key: <hive.metastore.kerberos.keytab.file>  value: <>
Key: <metastore.kerberos.principal> old hive key: <hive.metastore.kerberos.principal>  value: <hive-metastore/_HOST@EXAMPLE.COM>
Key: <metastore.authentication> old hive key: <hive.metastore.authentication>  value: <NOSASL>
Key: <metastore.custom.authentication.class> old hive key: <hive.metastore.custom.authentication.class>  value: <>
Key: <metastore.authentication.ldap.url> old hive key: <hive.metastore.authentication.ldap.url>  value: <>
Key: <metastore.authentication.ldap.baseDN> old hive key: <hive.metastore.authentication.ldap.baseDN>  value: <>
Key: <metastore.authentication.ldap.Domain> old hive key: <hive.metastore.authentication.ldap.Domain>  value: <>
Key: <metastore.authentication.ldap.groupDNPattern> old hive key: <hive.metastore.authentication.ldap.groupDNPattern>  value: <>
Key: <metastore.authentication.ldap.groupFilter> old hive key: <hive.metastore.authentication.ldap.groupFilter>  value: <>
Key: <metastore.authentication.ldap.userDNPattern> old hive key: <hive.metastore.authentication.ldap.userDNPattern>  value: <>
Key: <metastore.authentication.ldap.userFilter> old hive key: <hive.metastore.authentication.ldap.userFilter>  value: <>
Key: <metastore.authentication.ldap.guidKey> old hive key: <hive.metastore.authentication.ldap.guidKey>  value: <uid>
Key: <metastore.authentication.ldap.groupMembershipKey> old hive key: <hive.metastore.authentication.ldap.groupMembershipKey>  value: <member>
Key: <metastore.authentication.ldap.userMembershipKey> old hive key: <hive.metastore.authentication.ldap.userMembershipKey>  value: <>
Key: <metastore.authentication.ldap.groupClassKey> old hive key: <hive.metastore.authentication.ldap.groupClassKey>  value: <groupOfNames>
Key: <metastore.authentication.ldap.customLDAPQuery> old hive key: <hive.metastore.authentication.ldap.customLDAPQuery>  value: <>
Key: <metastore.authentication.ldap.binddn> old hive key: <hive.metastore.authentication.ldap.binddn>  value: <>
Key: <metastore.authentication.ldap.bindpw> old hive key: <hive.metastore.authentication.ldap.bindpw>  value: <>
Key: <metastore.limit.partition.request> old hive key: <hive.metastore.limit.partition.request>  value: <-1>
Key: <metastore.client.cache.v2.enabled> old hive key: <hive.metastore.client.cache.v2.enabled>  value: <true>
Key: <metastore.client.cache.v2.maxSize> old hive key: <hive.metastore.client.cache.v2.maxSize>  value: <1Gb>
Key: <metastore.client.cache.v2.recordStats> old hive key: <hive.metastore.client.cache.v2.recordStats>  value: <false>
Key: <metastore.log4j.file> old hive key: <hive.log4j.file>  value: <>
Key: <javax.jdo.PersistenceManagerFactoryClass> old hive key: <javax.jdo.PersistenceManagerFactoryClass>  value: <org.datanucleus.api.jdo.JDOPersistenceManagerFactory>
Key: <metastore.materializations.invalidation.impl> old hive key: <hive.metastore.materializations.invalidation.impl>  value: <DEFAULT>
Key: <metastore.materializations.invalidation.clean.frequency> old hive key: <hive.metastore.materializations.invalidation.clean.frequency>  value: <3600s>
Key: <metastore.materializations.invalidation.max.duration> old hive key: <hive.metastore.materializations.invalidation.max.duration>  value: <86400s>
Key: <metastore.runtime.stats.clean.frequency> old hive key: <hive.metastore.runtime.stats.clean.frequency>  value: <3600s>
Key: <metastore.runtime.stats.max.age> old hive key: <hive.metastore.runtime.stats.max.age>  value: <259200s>
Key: <metastore.scheduled.queries.enabled> old hive key: <hive.metastore.scheduled.queries.enabled>  value: <true>
Key: <metastore.scheduled.queries.execution.timeout> old hive key: <hive.metastore.scheduled.queries.progress.timeout>  value: <120s>
Key: <metastore.scheduled.queries.execution.maint.task.frequency> old hive key: <hive.metastore.scheduled.queries.execution.clean.frequency>  value: <60s>
Key: <metastore.scheduled.queries.execution.max.age> old hive key: <hive.metastore.scheduled.queries.execution.max.age>  value: <2592000s>
Key: <metastore.scheduled.queries.autodisable.count> old hive key: <metastore.scheduled.queries.autodisable.count>  value: <0>
Key: <metastore.scheduled.queries.skip.opportunities.after.failures> old hive key: <metastore.scheduled.queries.skip.opportunities.after.failures>  value: <0>
Key: <metastore.metadata.export.location> old hive key: <hive.metadata.export.location>  value: <>
Key: <metastore.max.event.response> old hive key: <hive.metastore.max.event.response>  value: <1000000>
Key: <metastore.client.filter.enabled> old hive key: <hive.metastore.client.filter.enabled>  value: <true>
Key: <metastore.server.filter.enabled> old hive key: <hive.metastore.server.filter.enabled>  value: <false>
Key: <metastore.metadata.move.exported.metadata.to.trash> old hive key: <hive.metadata.move.exported.metadata.to.trash>  value: <true>
Key: <metastore.metrics.enabled> old hive key: <hive.metastore.metrics.enabled>  value: <false>
Key: <metastore.metrics.hadoop2.component> old hive key: <hive.service.metrics.hadoop2.component>  value: <hivemetastore>
Key: <metastore.metrics.file.frequency> old hive key: <hive.service.metrics.file.frequency>  value: <60000ms>
Key: <metastore.metrics.file.location> old hive key: <hive.service.metrics.file.location>  value: </tmp/report.json>
Key: <metastore.metrics.slf4j.frequency> old hive key: <hive.service.metrics.slf4j.frequency>  value: <5m>
Key: <metastore.metrics.slf4j.logging.level> old hive key: <hive.service.metrics.slf4j.logging.level>  value: <INFO>
Key: <metastore.metrics.reporters> old hive key: <metastore.metrics.reporters>  value: <json,jmx>
Key: <metastore.msck.path.validation> old hive key: <hive.msck.path.validation>  value: <throw>
Key: <metastore.msck.repair.batch.size> old hive key: <hive.msck.repair.batch.size>  value: <3000>
Key: <metastore.msck.repair.batch.max.retries> old hive key: <hive.msck.repair.batch.max.retries>  value: <4>
Key: <metastore.msck.repair.enable.partition.retention> old hive key: <metastore.msck.repair.enable.partition.retention>  value: <false>
Key: <metastore.partition.management.task.frequency> old hive key: <metastore.partition.management.task.frequency>  value: <300s>
Key: <metastore.partition.management.table.types> old hive key: <metastore.partition.management.table.types>  value: <MANAGED_TABLE,EXTERNAL_TABLE>
Key: <metastore.partition.management.task.thread.pool.size> old hive key: <metastore.partition.management.task.thread.pool.size>  value: <3>
Key: <metastore.partition.management.catalog.name> old hive key: <metastore.partition.management.catalog.name>  value: <hive>
Key: <metastore.partition.management.database.pattern> old hive key: <metastore.partition.management.database.pattern>  value: <*>
Key: <metastore.partition.management.table.pattern> old hive key: <metastore.partition.management.table.pattern>  value: <*>
Key: <metastore.metadata.transformer.class> old hive key: <metastore.metadata.transformer.class>  value: <org.apache.hadoop.hive.metastore.MetastoreDefaultTransformer>
Key: <metastore.metadata.transformer.translated.to.external.follows.renames> old hive key: <metastore.metadata.transformer.translated.to.external.follows.renames>  value: <true>
Key: <metastore.metadata.transformer.location.mode> old hive key: <metastore.metadata.transformer.location.mode>  value: <force>
Key: <javax.jdo.option.Multithreaded> old hive key: <javax.jdo.option.Multithreaded>  value: <true>
Key: <metastore.max.open.txns> old hive key: <hive.max.open.txns>  value: <100000>
Key: <javax.jdo.option.NonTransactionalRead> old hive key: <javax.jdo.option.NonTransactionalRead>  value: <true>
Key: <metastore.notification.sequence.lock.max.retries> old hive key: <hive.notification.sequence.lock.max.retries>  value: <10>
Key: <metastore.notification.sequence.lock.retry.sleep.interval> old hive key: <hive.notification.sequence.lock.retry.sleep.interval>  value: <10s>
Key: <metastore.orm.retrieveMapNullsAsEmptyStrings> old hive key: <hive.metastore.orm.retrieveMapNullsAsEmptyStrings>  value: <false>
Key: <metastore.partition.name.whitelist.pattern> old hive key: <hive.metastore.partition.name.whitelist.pattern>  value: <>
Key: <metastore.partition.inherit.table.properties> old hive key: <hive.metastore.partition.inherit.table.properties>  value: <>
Key: <metastore.pre.event.listeners> old hive key: <hive.metastore.pre.event.listeners>  value: <>
Key: <metastore.rawstore.impl> old hive key: <hive.metastore.rawstore.impl>  value: <org.apache.hadoop.hive.metastore.ObjectStore>
Key: <metastore.repl.cmrootdir> old hive key: <hive.repl.cmrootdir>  value: </user/${system:user.name}/cmroot/>
Key: <metastore.repl.cm.encryptionzone.rootdir> old hive key: <hive.repl.cm.encryptionzone.rootdir>  value: <.cmroot>
Key: <metastore.repl.cm.nonencryptionzone.rootdir> old hive key: <hive.repl.cm.nonencryptionzone.rootdir>  value: <>
Key: <metastore.repl.cm.retain> old hive key: <hive.repl.cm.retain>  value: <240h>
Key: <metastore.repl.cm.interval> old hive key: <hive.repl.cm.interval>  value: <3600s>
Key: <metastore.repl.cm.enabled> old hive key: <hive.repl.cm.enabled>  value: <false>
Key: <metastore.repl.rootdir> old hive key: <hive.repl.rootdir>  value: </user/${system:user.name}/repl/>
Key: <metastore.repl.copyfile.maxnumfiles> old hive key: <hive.exec.copyfile.maxnumfiles>  value: <1>
Key: <metastore.repl.copyfile.maxsize> old hive key: <hive.exec.copyfile.maxsize>  value: <33554432>
Key: <metastore.repl.event.db.listener.timetolive> old hive key: <hive.repl.event.db.listener.timetolive>  value: <10d>
Key: <metastore.repl.metrics.cache.maxsize> old hive key: <hive.repl.metrics.cache.maxsize>  value: <10000>
Key: <metastore.repl.metrics.update.frequency> old hive key: <hive.repl.metrics.update.frequency>  value: <1m>
Key: <metastore.repl.metrics.cleanup.frequency> old hive key: <hive.metastore.repl.metrics.cleanup.frequency>  value: <1d>
Key: <metastore.repl.metrics.max.age> old hive key: <hive.metastore.repl.metrics.max.age>  value: <7d>
Key: <metastore.repl.txn.timeout> old hive key: <hive.repl.txn.timeout>  value: <11d>
Key: <metastore.schema.info.class> old hive key: <hive.metastore.schema.info.class>  value: <org.apache.hadoop.hive.metastore.MetaStoreSchemaInfo>
Key: <metastore.schema.verification> old hive key: <hive.metastore.schema.verification>  value: <false>
Key: <metastore.schema.verification.record.version> old hive key: <hive.metastore.schema.verification.record.version>  value: <false>
Key: <metastore.serdes.using.metastore.for.schema> old hive key: <hive.serdes.using.metastore.for.schema>  value: <org.apache.hadoop.hive.ql.io.orc.OrcSerde,org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe,org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe,org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe,org.apache.hadoop.hive.serde2.columnar.LazyBinaryColumnarSerDe,org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe,org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe,org.apache.hadoop.hive.serde2.OpenCSVSerde>
Key: <metastore.server.max.message.size> old hive key: <hive.metastore.server.max.message.size>  value: <104857600>
Key: <metastore.server.max.threads> old hive key: <hive.metastore.server.max.threads>  value: <1000>
Key: <metastore.server.min.threads> old hive key: <hive.metastore.server.min.threads>  value: <200>
Key: <metastore.thrift.port> old hive key: <hive.metastore.port>  value: <9083>
Key: <metastore.keystore.path> old hive key: <hive.metastore.keystore.path>  value: <>
Key: <metastore.keystore.type> old hive key: <hive.metastore.keystore.type>  value: <>
Key: <metastore.keymanagerfactory.algorithm> old hive key: <hive.metastore.keymanagerfactory.algorithm>  value: <>
Key: <metastore.ssl.protocol.blacklist> old hive key: <hive.ssl.protocol.blacklist>  value: <SSLv2,SSLv3>
Key: <metastore.truststore.path> old hive key: <hive.metastore.truststore.path>  value: <>
Key: <metastore.truststore.type> old hive key: <hive.metastore.truststore.type>  value: <>
Key: <metastore.trustmanagerfactory.algorithm> old hive key: <hive.metastore.trustmanagerfactory.algorithm>  value: <>
Key: <metastore.stats.autogather> old hive key: <hive.stats.autogather>  value: <true>
Key: <metastore.stats.fetch.bitvector> old hive key: <hive.stats.fetch.bitvector>  value: <false>
Key: <metastore.stats.ndv.tuner> old hive key: <hive.metastore.stats.ndv.tuner>  value: <0.0>
Key: <metastore.stats.ndv.densityfunction> old hive key: <hive.metastore.stats.ndv.densityfunction>  value: <false>
Key: <metastore.stats.default.aggregator> old hive key: <hive.stats.default.aggregator>  value: <>
Key: <metastore.stats.default.publisher> old hive key: <hive.stats.default.publisher>  value: <>
Key: <metastore.stats.auto.analyze> old hive key: <hive.metastore.stats.auto.analyze>  value: <none>
Key: <metastore.stats.auto.analyze.noop.wait> old hive key: <hive.metastore.stats.auto.analyze.noop.wait>  value: <5m>
Key: <metastore.stats.auto.analyze.worker.count> old hive key: <hive.metastore.stats.auto.analyze.worker.count>  value: <1>
Key: <metastore.storage.schema.reader.impl> old hive key: <metastore.storage.schema.reader.impl>  value: <org.apache.hadoop.hive.metastore.DefaultStorageSchemaReader>
Key: <datanucleus.storeManagerType> old hive key: <datanucleus.storeManagerType>  value: <rdbms>
Key: <metastore.strict.managed.tables> old hive key: <hive.strict.managed.tables>  value: <false>
Key: <metastore.support.special.characters.tablename> old hive key: <hive.support.special.characters.tablename>  value: <true>
Key: <metastore.task.threads.always> old hive key: <metastore.task.threads.always>  value: <org.apache.hadoop.hive.metastore.events.EventCleanerTask,org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask,org.apache.hadoop.hive.metastore.metrics.AcidMetricService,org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask,org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask,org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask>
Key: <metastore.task.threads.remote> old hive key: <metastore.task.threads.remote>  value: <org.apache.hadoop.hive.metastore.txn.AcidHouseKeeperService,org.apache.hadoop.hive.metastore.txn.AcidTxnCleanerService,org.apache.hadoop.hive.metastore.txn.AcidOpenTxnsCounterService,org.apache.hadoop.hive.metastore.MaterializationsRebuildLockCleanerTask,org.apache.hadoop.hive.metastore.PartitionManagementTask>
Key: <metastore.server.tcp.keepalive> old hive key: <hive.metastore.server.tcp.keepalive>  value: <true>
Key: <metastore.thread.pool.size> old hive key: <no.such>  value: <10>
Key: <metastore.connect.retries> old hive key: <hive.metastore.connect.retries>  value: <3>
Key: <metastore.failure.retries> old hive key: <hive.metastore.failure.retries>  value: <1>
Key: <metastore.thrift.bind.host> old hive key: <hive.metastore.thrift.bind.host>  value: <>
Key: <metastore.thrift.uris> old hive key: <hive.metastore.uris>  value: <>
Key: <metastore.service.discovery.mode> old hive key: <hive.metastore.service.discovery.mode>  value: <>
Key: <metastore.zookeeper.kerberos.enabled> old hive key: <hive.zookeeper.kerberos.enabled>  value: <true>
Key: <metastore.zookeeper.client.port> old hive key: <hive.zookeeper.client.port>  value: <2181>
Key: <metastore.zookeeper.session.timeout> old hive key: <hive.zookeeper.session.timeout>  value: <120000ms>
Key: <metastore.zookeeper.connection.timeout> old hive key: <hive.zookeeper.connection.timeout>  value: <15s>
Key: <metastore.zookeeper.namespace> old hive key: <hive.zookeeper.namespace>  value: <hive_metastore>
Key: <metastore.zookeeper.connection.max.retries> old hive key: <hive.zookeeper.connection.max.retries>  value: <3>
Key: <metastore.zookeeper.connection.basesleeptime> old hive key: <hive.zookeeper.connection.basesleeptime>  value: <1000ms>
Key: <metastore.zookeeper.ssl.client.enable> old hive key: <hive.zookeeper.ssl.client.enable>  value: <false>
Key: <metastore.zookeeper.ssl.keystore.location> old hive key: <hive.zookeeper.ssl.keystore.location>  value: <>
Key: <metastore.zookeeper.ssl.truststore.location> old hive key: <hive.zookeeper.ssl.truststore.location>  value: <>
Key: <metastore.thrift.uri.selection> old hive key: <hive.metastore.uri.selection>  value: <RANDOM>
Key: <metastore.token.signature> old hive key: <hive.metastore.token.signature>  value: <>
Key: <metastore.cache.can.use.event> old hive key: <hive.metastore.cache.can.use.event>  value: <false>
Key: <metastore.transactional.event.listeners> old hive key: <hive.metastore.transactional.event.listeners>  value: <>
Key: <metastore.try.direct.sql> old hive key: <hive.metastore.try.direct.sql>  value: <true>
Key: <metastore.try.direct.sql.ddl> old hive key: <hive.metastore.try.direct.sql.ddl>  value: <true>
Key: <metastore.txn.max.open.batch> old hive key: <hive.txn.max.open.batch>  value: <1000>
Key: <metastore.txn.retryable.sqlex.regex> old hive key: <hive.txn.retryable.sqlex.regex>  value: <>
Key: <metastore.txn.store.impl> old hive key: <hive.metastore.txn.store.impl>  value: <org.apache.hadoop.hive.metastore.txn.CompactionTxnHandler>
Key: <metastore.txn.timeout> old hive key: <hive.txn.timeout>  value: <300s>
Key: <metastore.txn.opentxn.timeout> old hive key: <hive.txn.opentxn.timeout>  value: <1000ms>
Key: <metastore.txn.use.minhistorylevel> old hive key: <hive.txn.use.minhistorylevel>  value: <true>
Key: <metastore.uri.resolver> old hive key: <hive.metastore.uri.resolver>  value: <>
Key: <metastore.users.in.admin.role> old hive key: <hive.users.in.admin.role>  value: <>
Key: <metastore.use.SSL> old hive key: <hive.metastore.use.SSL>  value: <false>
Key: <metastore.sasl.enabled> old hive key: <hive.metastore.sasl.enabled>  value: <false>
Key: <metastore.client.auth.mode> old hive key: <hive.metastore.client.auth.mode>  value: <NOSASL>
Key: <metastore.client.plain.username> old hive key: <hive.metastore.client.plain.username>  value: <>
Key: <metastore.authentication.config.username> old hive key: <hive.metastore.authentication.config.username>  value: <>
Key: <metastore.authentication.config.password> old hive key: <hive.metastore.authentication.config.password>  value: <>
Key: <metastore.thrift.framed.transport.enabled> old hive key: <hive.metastore.thrift.framed.transport.enabled>  value: <false>
Key: <metastore.thrift.compact.protocol.enabled> old hive key: <hive.metastore.thrift.compact.protocol.enabled>  value: <false>
Key: <datanucleus.schema.validateColumns> old hive key: <datanucleus.schema.validateColumns>  value: <false>
Key: <datanucleus.schema.validateConstraints> old hive key: <datanucleus.schema.validateConstraints>  value: <false>
Key: <datanucleus.schema.validateTables> old hive key: <datanucleus.schema.validateTables>  value: <false>
Key: <metastore.warehouse.dir> old hive key: <hive.metastore.warehouse.dir>  value: <file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse>
Key: <metastore.warehouse.external.dir> old hive key: <hive.metastore.warehouse.external.dir>  value: <file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external>
Key: <metastore.wm.default.pool.size> old hive key: <hive.metastore.wm.default.pool.size>  value: <4>
Key: <metastore.rawstore.batch.size> old hive key: <metastore.rawstore.batch.size>  value: <-1>
Key: <hive.metastore.runworker.in> old hive key: <hive.metastore.runworker.in>  value: <metastore>
Key: <hive.in.test> old hive key: <hive.in.test>  value: <false>
Key: <hive.in.tez.test> old hive key: <hive.in.tez.test>  value: <false>
Key: <hive.in.iceberg.test> old hive key: <hive.in.iceberg.test>  value: <false>
Key: <hive.security.authorization.manager> old hive key: <hive.security.authorization.manager>  value: <org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory>
Key: <hive.security.metastore.authenticator.manager> old hive key: <hive.security.metastore.authenticator.manager>  value: <org.apache.hadoop.hive.ql.security.HadoopDefaultMetastoreAuthenticator>
Key: <hive.security.metastore.authorization.auth.reads> old hive key: <hive.security.metastore.authorization.auth.reads>  value: <true>
Key: <hive.txn.manager> old hive key: <hive.txn.manager>  value: <org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager>
Key: <hive.support.concurrency> old hive key: <hive.support.concurrency>  value: <false>
Key: <hive.txn.stats.enabled> old hive key: <hive.txn.stats.enabled>  value: <true>
Key: <metastore.use.custom.database.product> old hive key: <hive.metastore.use.custom.database.product>  value: <false>
Key: <metastore.custom.database.product.classname> old hive key: <hive.metastore.custom.database.product.classname>  value: <none>
Key: <hive.blobstore.supported.schemes> old hive key: <hive.blobstore.supported.schemes>  value: <s3,s3a,s3n>
Key: <hive.service.metrics.codahale.reporter.classes> old hive key: <hive.service.metrics.codahale.reporter.classes>  value: <>
Key: <hive.service.metrics.reporter> old hive key: <hive.service.metrics.reporter>  value: <>
Key: <metastore.dbaccess.ssl.properties> old hive key: <hive.metastore.dbaccess.ssl.properties>  value: <>
Key: <metastore.num.striped.table.locks> old hive key: <hive.metastore.num.striped.table.locks>  value: <32>
Key: <metastore.colstats.retain.on.column.removal> old hive key: <hive.metastore.colstats.retain.on.column.removal>  value: <true>
Key: <test.str> old hive key: <hive.test.str>  value: <defaultval>
Key: <test.str.set> old hive key: <hive.test.str.set>  value: <a>
Key: <test.str.list> old hive key: <hive.test.str.list>  value: <a,b,c>
Key: <test.long> old hive key: <hive.test.long>  value: <42>
Key: <test.double> old hive key: <hive.test.double>  value: <3.141592653589793>
Key: <test.time> old hive key: <hive.test.time>  value: <1s>
Key: <test.deprecated> old hive key: <hive.test.deprecated>  value: <0>
Key: <test.time.validator.inclusive> old hive key: <hive.test.time.validator.inclusive>  value: <1s>
Key: <test.time.validator.exclusive> old hive key: <hive.test.time.validator.exclusive>  value: <1s>
Key: <test.bool> old hive key: <hive.test.bool>  value: <true>
Key: <test.class> old hive key: <hive.test.class>  value: <>
Finished MetastoreConf object.

[INFO ] 2024-04-23 23:37:44.347 [main] TestTxnDbUtil - Creating transactional tables
[DEBUG] 2024-04-23 23:37:44.510 [main] Shell - Failed to detect a valid hadoop home directory
java.io.FileNotFoundException: HADOOP_HOME and hadoop.home.dir are unset.
	at org.apache.hadoop.util.Shell.checkHadoopHomeInner(Shell.java:469) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.Shell.checkHadoopHome(Shell.java:440) ~[hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.Shell.<clinit>(Shell.java:517) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.util.StringUtils.<clinit>(StringUtils.java:78) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getStringCollection(Configuration.java:2170) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.security.alias.CredentialProviderFactory.getProviders(CredentialProviderFactory.java:65) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getPasswordFromCredentialProviders(Configuration.java:2340) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.conf.Configuration.getPassword(Configuration.java:2278) [hadoop-common-3.1.0.jar:?]
	at org.apache.hadoop.hive.metastore.conf.MetastoreConf.getPassword(MetastoreConf.java:2261) [classes/:?]
	at org.apache.hadoop.hive.metastore.utils.TestTxnDbUtil.getConnection(TestTxnDbUtil.java:400) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.utils.TestTxnDbUtil.prepDb(TestTxnDbUtil.java:90) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreTestUtils.startMetaStoreWithRetry(MetaStoreTestUtils.java:196) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreTestUtils.startMetaStoreWithRetry(MetaStoreTestUtils.java:143) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.MetaStoreTestUtils.startMetaStoreWithRetry(MetaStoreTestUtils.java:131) [test-classes/:?]
	at org.apache.hadoop.hive.metastore.TestPartitionManagement.setUp(TestPartitionManagement.java:77) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) [junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.invokeMethod(RunBefores.java:33) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:24) [junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) [junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:128) [junit-4.13.jar:4.13]
	at org.junit.runners.Suite.runChild(Suite.java:27) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) [junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) [junit-4.13.jar:4.13]
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158) [surefire-junit47-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
[DEBUG] 2024-04-23 23:37:44.549 [main] Shell - setsid exited with exit code 0
[INFO ] 2024-04-23 23:37:44.960 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[INFO ] 2024-04-23 23:37:46.001 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:37:46.038 [MetaStoreThread-34313] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:37:46.167 [MetaStoreThread-34313] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:37:46.220 [MetaStoreThread-34313] HMSHandler - 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:37:46.263 [MetaStoreThread-34313] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:37:46.263 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:46.264 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:46.265 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:37:46.265 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:37:46.265 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:46.265 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:46.265 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:37:46.265 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:46.265 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:46.265 [MetaStoreThread-34313] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:46.266 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:37:46.266 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:37:46.266 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:37:46.266 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:37:46.266 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:37:46.266 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:37:46.266 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - Updating the pmf due to property change
[INFO ] 2024-04-23 23:37:46.267 [MetaStoreThread-34313] PersistenceManagerProvider - Current pmf properties are uninitialized
[DEBUG] 2024-04-23 23:37:46.277 [MetaStoreThread-34313] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:37:46.285 [MetaStoreThread-34313] HikariConfig - HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:37:46.285 [MetaStoreThread-34313] HikariConfig - HikariPool-1 - configuration:
[DEBUG] 2024-04-23 23:37:46.286 [MetaStoreThread-34313] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:37:46.286 [MetaStoreThread-34313] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:37:46.287 [MetaStoreThread-34313] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true"
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:37:46.288 [MetaStoreThread-34313] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - poolName........................"HikariPool-1"
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:37:46.289 [MetaStoreThread-34313] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:37:46.290 [MetaStoreThread-34313] HikariDataSource - HikariPool-1 - Starting...
[INFO ] 2024-04-23 23:37:46.302 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:37:46.303 [MetaStoreThread-34313] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:46.305 [MetaStoreThread-34313] HikariDataSource - HikariPool-1 - Start completed.
log4j: Trying to find [log4j.xml] using context classloader sun.misc.Launcher$AppClassLoader@330bedb4.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader sun.misc.Launcher$AppClassLoader@330bedb4.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
log4j:WARN No appenders could be found for logger (DataNucleus.General).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
[DEBUG] 2024-04-23 23:37:46.405 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:37:46.407 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.408 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1656949836 (XID = 1160), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.409 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1399540382 (XID = 1162), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.410 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@49083139 (XID = 1164), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.411 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@575417645 (XID = 1166), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.412 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@111316294 (XID = 1168), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.413 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1001127448 (XID = 1170), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.414 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1380945794 (XID = 1172), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.415 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@581105422 (XID = 1174), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.415 [HikariPool-1 connection adder] HikariPool - HikariPool-1 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:37:46.701 [MetaStoreThread-34313] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:37:46.701 [MetaStoreThread-34313] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@228e0e5c, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:37:46.701 [MetaStoreThread-34313] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:37:46.722 [MetaStoreThread-34313] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@228e0e5c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7deca04a created in the thread with id: 18
[DEBUG] 2024-04-23 23:37:46.732 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.733 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:46.734 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:47.002 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:37:47.564 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:47.843 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:47.878 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:47.951 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:47.980 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:47.989 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:48.002 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:37:48.140 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.180 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.191 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.202 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.207 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.218 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.218 [MetaStoreThread-34313] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:37:48.218 [MetaStoreThread-34313] ObjectStore - Initialized ObjectStore
[DEBUG] 2024-04-23 23:37:48.316 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.320 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.335 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.337 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.338 [MetaStoreThread-34313] MetaStoreSchemaInfoFactory - HIVE_HOME is not set. Using current directory instead
[DEBUG] 2024-04-23 23:37:48.338 [MetaStoreThread-34313] ObjectStore - Found expected HMS version of 4.0.0
[INFO ] 2024-04-23 23:37:48.338 [MetaStoreThread-34313] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@228e0e5c from thread id: 18
[DEBUG] 2024-04-23 23:37:48.338 [MetaStoreThread-34313] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:37:48.338 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.347 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.353 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.354 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:48.355 [MetaStoreThread-34313] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:37:48.398 [MetaStoreThread-34313] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginFailure with annotation @org.apache.hadoop.metrics2.annotation.Metric(valueName=Time, type=DEFAULT, about=, value=[Rate of failed kerberos logins and latency (milliseconds)], sampleName=Ops, always=false)
[DEBUG] 2024-04-23 23:37:48.401 [MetaStoreThread-34313] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.getGroups with annotation @org.apache.hadoop.metrics2.annotation.Metric(valueName=Time, about=, always=false, type=DEFAULT, value=[GetGroups], sampleName=Ops)
[DEBUG] 2024-04-23 23:37:48.401 [MetaStoreThread-34313] MutableMetricsFactory - field org.apache.hadoop.metrics2.lib.MutableRate org.apache.hadoop.security.UserGroupInformation$UgiMetrics.loginSuccess with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, sampleName=Ops, valueName=Time, value=[Rate of successful kerberos logins and latency (milliseconds)], type=DEFAULT, always=false)
[DEBUG] 2024-04-23 23:37:48.402 [MetaStoreThread-34313] MutableMetricsFactory - field private org.apache.hadoop.metrics2.lib.MutableGaugeLong org.apache.hadoop.security.UserGroupInformation$UgiMetrics.renewalFailuresTotal with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, value=[Renewal failures since startup], always=false, valueName=Time, type=DEFAULT, sampleName=Ops)
[DEBUG] 2024-04-23 23:37:48.402 [MetaStoreThread-34313] MutableMetricsFactory - field private org.apache.hadoop.metrics2.lib.MutableGaugeInt org.apache.hadoop.security.UserGroupInformation$UgiMetrics.renewalFailures with annotation @org.apache.hadoop.metrics2.annotation.Metric(about=, always=false, sampleName=Ops, valueName=Time, value=[Renewal failures since last successful login], type=DEFAULT)
[DEBUG] 2024-04-23 23:37:48.402 [MetaStoreThread-34313] MetricsSystemImpl - UgiMetrics, User and group related metrics
[DEBUG] 2024-04-23 23:37:48.416 [MetaStoreThread-34313] SecurityUtil - Setting hadoop.security.token.service.use_ip to true
[DEBUG] 2024-04-23 23:37:48.427 [MetaStoreThread-34313] Groups -  Creating new Groups object
[DEBUG] 2024-04-23 23:37:48.428 [MetaStoreThread-34313] NativeCodeLoader - Trying to load the custom-built native-hadoop library...
[DEBUG] 2024-04-23 23:37:48.428 [MetaStoreThread-34313] NativeCodeLoader - Failed to load native-hadoop with error: java.lang.UnsatisfiedLinkError: no hadoop in java.library.path
[DEBUG] 2024-04-23 23:37:48.428 [MetaStoreThread-34313] NativeCodeLoader - java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
[WARN ] 2024-04-23 23:37:48.428 [MetaStoreThread-34313] NativeCodeLoader - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[DEBUG] 2024-04-23 23:37:48.429 [MetaStoreThread-34313] PerformanceAdvisory - Falling back to shell based
[DEBUG] 2024-04-23 23:37:48.429 [MetaStoreThread-34313] JniBasedUnixGroupsMappingWithFallback - Group mapping impl=org.apache.hadoop.security.ShellBasedUnixGroupsMapping
[DEBUG] 2024-04-23 23:37:48.440 [MetaStoreThread-34313] Groups - Group mapping impl=org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback; cacheTimeout=300000; warningDeltaMs=5000
[DEBUG] 2024-04-23 23:37:48.443 [MetaStoreThread-34313] UserGroupInformation - hadoop login
[DEBUG] 2024-04-23 23:37:48.443 [MetaStoreThread-34313] UserGroupInformation - hadoop login commit
[DEBUG] 2024-04-23 23:37:48.444 [MetaStoreThread-34313] UserGroupInformation - using local user:UnixPrincipal: alex
[DEBUG] 2024-04-23 23:37:48.444 [MetaStoreThread-34313] UserGroupInformation - Using user: "UnixPrincipal: alex" with name alex
[DEBUG] 2024-04-23 23:37:48.445 [MetaStoreThread-34313] UserGroupInformation - User entry: "alex"
[DEBUG] 2024-04-23 23:37:48.445 [MetaStoreThread-34313] UserGroupInformation - UGI loginUser:alex (auth:SIMPLE)
[DEBUG] 2024-04-23 23:37:48.456 [MetaStoreThread-34313] FileSystem - Loading filesystems
[DEBUG] 2024-04-23 23:37:48.461 [MetaStoreThread-34313] FileSystem - file:// = class org.apache.hadoop.fs.LocalFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:37:48.464 [MetaStoreThread-34313] FileSystem - viewfs:// = class org.apache.hadoop.fs.viewfs.ViewFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:37:48.465 [MetaStoreThread-34313] FileSystem - har:// = class org.apache.hadoop.fs.HarFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:37:48.466 [MetaStoreThread-34313] FileSystem - http:// = class org.apache.hadoop.fs.http.HttpFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:37:48.467 [MetaStoreThread-34313] FileSystem - https:// = class org.apache.hadoop.fs.http.HttpsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-common/3.1.0/hadoop-common-3.1.0.jar
[DEBUG] 2024-04-23 23:37:48.472 [MetaStoreThread-34313] FileSystem - hdfs:// = class org.apache.hadoop.hdfs.DistributedFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:37:48.685 [MetaStoreThread-34313] FileSystem - webhdfs:// = class org.apache.hadoop.hdfs.web.WebHdfsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:37:48.686 [MetaStoreThread-34313] FileSystem - swebhdfs:// = class org.apache.hadoop.hdfs.web.SWebHdfsFileSystem from /home/alex/.m2/repository/org/apache/hadoop/hadoop-hdfs-client/3.1.0/hadoop-hdfs-client-3.1.0.jar
[DEBUG] 2024-04-23 23:37:48.686 [MetaStoreThread-34313] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:48.686 [MetaStoreThread-34313] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:48.698 [MetaStoreThread-34313] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:48.698 [MetaStoreThread-34313] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:37:48.702 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.703 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.703 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.704 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.705 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.718 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.728 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.733 [MetaStoreThread-34313] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:48.733 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.733 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.733 [MetaStoreThread-34313] ObjectStore - db details for db default retrieved using SQL in 5.589143ms
[DEBUG] 2024-04-23 23:37:48.734 [MetaStoreThread-34313] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:37:48.735 [MetaStoreThread-34313] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:37:48.735 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.753 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.766 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.769 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.776 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:48.777 [MetaStoreThread-34313] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:37:48.777 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.777 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:48.784 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.788 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:48.792 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.794 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.795 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:48.795 [MetaStoreThread-34313] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:37:48.795 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.795 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:48.796 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:48.796 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.797 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:48.797 [MetaStoreThread-34313] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:37:48.800 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:48.802 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:48.803 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:48.805 [MetaStoreThread-34313] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:48.811 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.816 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:48.821 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:48.823 [MetaStoreThread-34313] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:48.824 [MetaStoreThread-34313] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:48.824 [MetaStoreThread-34313] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:37:48.829 [MetaStoreThread-34313] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:37:48.830 [MetaStoreThread-34313] PerfLogger - </PERFLOG method=init start=1713911866167 end=1713911868830 duration=2663 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:49.003 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:37:49.006 [MetaStoreThread-34313] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:37:49.009 [MetaStoreThread-34313] HiveMetaStore - Started the new metaserver on port [34313]...
[INFO ] 2024-04-23 23:37:49.009 [MetaStoreThread-34313] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:37:49.009 [MetaStoreThread-34313] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:37:49.009 [MetaStoreThread-34313] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] deprecation - metastore.compactor.history.retention.did.not.initiate is deprecated. Instead, use metastore.compactor.history.retention.attempted
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] deprecation - hive.compactor.history.retention.did.not.initiate is deprecated. Instead, use hive.compactor.history.retention.attempted
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:37:49.010 [MetaStoreThread-34313] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:37:49.011 [MetaStoreThread-34313] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:37:49.011 [MetaStoreThread-34313] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:37:49.011 [MetaStoreThread-34313] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:37:50.013 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:37:50.013 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 1: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:37:50.013 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:37:50.022 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34313) is created
[INFO ] 2024-04-23 23:37:50.023 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 34313 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34313 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[INFO ] 2024-04-23 23:37:50.023 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:37:50.036 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:37:50.036 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34313]
[INFO ] 2024-04-23 23:37:50.037 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34313)
[INFO ] 2024-04-23 23:37:50.048 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34313) current connections: 1
[DEBUG] 2024-04-23 23:37:50.065 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.065 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911870065 end=1713911870065 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.070 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.072 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.072 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 create_database: Database(name:db_repl1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:37:50.072 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db_repl1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:37:50.074 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:37:50.075 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@9eedb83, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:37:50.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:37:50.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@9eedb83, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@160cc74d created in the thread with id: 37
[DEBUG] 2024-04-23 23:37:50.077 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.077 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.077 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.082 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.083 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.083 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:37:50.083 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:37:50.084 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@9eedb83 from thread id: 37
[DEBUG] 2024-04-23 23:37:50.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.085 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.651787ms
[DEBUG] 2024-04-23 23:37:50.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db_repl1, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:37:50.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:37:50.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.088 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.090 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:37:50.090 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.090 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.090 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.090 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:37:50.091 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db
[INFO ] 2024-04-23 23:37:50.093 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db
[INFO ] 2024-04-23 23:37:50.095 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db
[DEBUG] 2024-04-23 23:37:50.096 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.096 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.107 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.107 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911870072 end=1713911870107 duration=35 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.116 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.118 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.118 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 create_table_req: Table(tableName:tbl_repl1, dbName:db_repl1, owner:alex, createTime:1713911870, lastAccessTime:1713911870, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:37:50.118 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl_repl1, dbName:db_repl1, owner:alex, createTime:1713911870, lastAccessTime:1713911870, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:37:50.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.132 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.133 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 14.538457ms
[DEBUG] 2024-04-23 23:37:50.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.143 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.143 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.143 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.146 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.677341ms
[DEBUG] 2024-04-23 23:37:50.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.148 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.148 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.148 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.148 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.148 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:37:50.149 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34313/db_repl1.db/tbl_repl1
[DEBUG] 2024-04-23 23:37:50.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.167 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.174 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.180 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.186 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.218 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911870118 end=1713911870218 duration=100 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.222 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.224 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.224 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:37:50.224 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.298 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.298 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.298 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.298 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:37:50.298 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34313/db_repl1.db/tbl_repl1/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:37:50.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.310 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.327 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.329 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911870224 end=1713911870329 duration=105 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.331 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.331 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.331 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:37:50.331 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.342 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.342 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.342 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.342 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:37:50.342 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34313/db_repl1.db/tbl_repl1/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:37:50.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.357 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.360 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911870331 end=1713911870360 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.361 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.361 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.361 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:37:50.361 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.372 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.372 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.372 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.372 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:37:50.372 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34313/db_repl1.db/tbl_repl1/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:37:50.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.388 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.390 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911870361 end=1713911870390 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.392 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.393 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.393 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911870393 end=1713911870393 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.396 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.397 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.398 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_table : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:37:50.398 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.400 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.400 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.042699ms
[DEBUG] 2024-04-23 23:37:50.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.411 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:50.413 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:37:50.414 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911870397 end=1713911870414 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.416 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=22, comments=HMS client
[DEBUG] 2024-04-23 23:37:50.417 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.419 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.419 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:37:50.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:37:50.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.427 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 6.918536ms + 0.037718ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:37:50.434 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.91234ms + 0.885307ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:37:50.444 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.804407ms + 5.071512ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:37:50.447 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.520252ms + 0.352484ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.450 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.40885ms + 0.168711ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:37:50.453 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.363879ms + 0.174444ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.456 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.358867ms + 0.165857ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.459 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.166102ms + 0.182173ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.462 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.583125ms + 0.436285ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.465 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.331643ms + 0.166702ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:37:50.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 45.22871ms
[DEBUG] 2024-04-23 23:37:50.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.466 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.466 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911870419 end=1713911870466 duration=47 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.481 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.481 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.481 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:37:50.481 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:37:50.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.483 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.327174ms + 0.019947ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:37:50.485 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.205525ms + 0.194345ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:37:50.486 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.376437ms + 0.361364ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:37:50.486 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.31511ms + 0.262613ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.487 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.409609ms + 0.132272ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:37:50.487 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.266837ms + 0.129557ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.488 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.322686ms + 0.12947ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.489 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.409424ms + 0.145724ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.490 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.415785ms + 0.409215ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.491 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.450094ms + 0.184472ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:37:50.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 9.516718ms
[DEBUG] 2024-04-23 23:37:50.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.491 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.492 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911870481 end=1713911870492 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.495 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.497 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.498 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_database: db_repl1
[INFO ] 2024-04-23 23:37:50.498 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl1	
[DEBUG] 2024-04-23 23:37:50.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.499 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.500 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.013282ms
[DEBUG] 2024-04-23 23:37:50.500 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911870497 end=1713911870500 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.501 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:37:50.502 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.504 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.504 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 alter_database @hive#db_repl1
[INFO ] 2024-04-23 23:37:50.504 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_database @hive#db_repl1	
[DEBUG] 2024-04-23 23:37:50.504 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.504 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.504 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.504 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:37:50.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.506 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.506 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.833044ms
[DEBUG] 2024-04-23 23:37:50.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.514 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_database start=1713911870504 end=1713911870514 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.518 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.520 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.520 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 alter_table: hive.db_repl1.tbl_repl1 newtbl=tbl_repl1
[INFO ] 2024-04-23 23:37:50.520 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db_repl1.tbl_repl1 newtbl=tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.522 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.522 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.325059ms
[DEBUG] 2024-04-23 23:37:50.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.523 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:37:50.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.524 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.525 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.991503ms
[DEBUG] 2024-04-23 23:37:50.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.535 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.539 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.868792ms
[DEBUG] 2024-04-23 23:37:50.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.550 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl1
[WARN ] 2024-04-23 23:37:50.551 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:37:50.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:37:50.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:37:50.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.576 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.579 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911870520 end=1713911870579 duration=59 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:50.583 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:37:50.583 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34313]
[INFO ] 2024-04-23 23:37:50.583 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34313)
[INFO ] 2024-04-23 23:37:50.583 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34313) current connections: 2
[DEBUG] 2024-04-23 23:37:50.584 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.584 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911870584 end=1713911870584 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=3 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.587 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.589 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.590 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:37:50.590 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:37:50.591 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:37:50.591 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:37:50.591 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.591 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:37:50.591 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:37:50.592 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26cb27e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:37:50.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26cb27e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@55be0a6 created in the thread with id: 52
[DEBUG] 2024-04-23 23:37:50.594 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.594 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.594 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.599 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.600 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.600 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:37:50.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:37:50.600 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26cb27e from thread id: 52
[DEBUG] 2024-04-23 23:37:50.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:37:50.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.613 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.614 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911870589 end=1713911870614 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=3 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:50.614 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:37:50.617 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@26cb27e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@55be0a6 will be shutdown
[INFO ] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:37:50.617 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911870617 end=1713911870617 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=3 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.618 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:37:50.618 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 3: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:37:50.618 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:37:50.619 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.550086ms + 0.017085ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:37:50.621 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.20443ms + 0.153061ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:37:50.622 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.532477ms + 0.54559ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:37:50.623 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.467137ms + 0.43609ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.624 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.44905ms + 0.219268ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:37:50.625 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.442668ms + 0.216755ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.626 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.424074ms + 0.213446ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.627 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.605138ms + 0.284114ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.628 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.688109ms + 0.574922ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.629 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.561668ms + 0.222348ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:37:50.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 11.943195ms
[DEBUG] 2024-04-23 23:37:50.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.630 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.630 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911870617 end=1713911870630 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.631 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.631 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.631 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 alter_table: hive.db_repl1.tbl_repl1 newtbl=tbl_repl1
[INFO ] 2024-04-23 23:37:50.632 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db_repl1.tbl_repl1 newtbl=tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.634 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.634 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.989217ms
[DEBUG] 2024-04-23 23:37:50.635 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.635 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.635 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.635 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:37:50.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.637 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.638 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.484275ms
[DEBUG] 2024-04-23 23:37:50.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.649 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.651 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.654 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.680774ms
[DEBUG] 2024-04-23 23:37:50.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.663 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl1
[WARN ] 2024-04-23 23:37:50.663 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:37:50.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.665 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.665 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.665 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.666 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:37:50.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:37:50.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.679 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.682 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911870631 end=1713911870682 duration=51 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:50.686 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:37:50.686 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34313]
[INFO ] 2024-04-23 23:37:50.686 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34313)
[INFO ] 2024-04-23 23:37:50.686 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34313) current connections: 2
[DEBUG] 2024-04-23 23:37:50.687 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.687 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911870687 end=1713911870687 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=4 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.687 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.688 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.688 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:37:50.688 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:37:50.689 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:37:50.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:37:50.689 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6684367f, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:37:50.690 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:37:50.691 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6684367f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@572833d0 created in the thread with id: 53
[DEBUG] 2024-04-23 23:37:50.691 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.691 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.696 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.697 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.697 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:37:50.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:37:50.697 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6684367f from thread id: 53
[DEBUG] 2024-04-23 23:37:50.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.697 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:37:50.699 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.699 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.699 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911870688 end=1713911870699 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=4 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:50.699 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:37:50.699 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:37:50.699 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6684367f, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@572833d0 will be shutdown
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl1.tbl_repl1	
[INFO ] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911870700 end=1713911870700 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=4 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.700 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:37:50.701 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 4: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:37:50.701 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:37:50.702 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.390496ms + 0.0183ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:37:50.703 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.970646ms + 0.123168ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:37:50.704 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.291941ms + 0.323356ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:37:50.705 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.266561ms + 0.239982ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.705 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.288279ms + 0.132493ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:37:50.706 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.254097ms + 0.128528ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.706 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.261194ms + 0.130091ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.707 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.262334ms + 0.175072ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.707 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.400736ms + 0.398809ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:37:50.708 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.298208ms + 0.155683ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:37:50.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.907735ms
[DEBUG] 2024-04-23 23:37:50.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.708 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.708 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911870700 end=1713911870708 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.711 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.713 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.713 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:37:50.713 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:37:50.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:37:50.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.716 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.717 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911870713 end=1713911870717 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.720 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.722 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.722 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:37:50.722 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:37:50.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.726 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.726 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911870722 end=1713911870726 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.727 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.727 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.727 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_database: db_repl1
[INFO ] 2024-04-23 23:37:50.727 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl1	
[DEBUG] 2024-04-23 23:37:50.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.729 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.729 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.724385ms
[DEBUG] 2024-04-23 23:37:50.729 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911870727 end=1713911870729 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.729 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:37:50.732 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.733 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.734 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_tables_by_type: db=@hive#db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:50.734 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:50.734 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:50.734 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:50.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.736 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.737 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 2.63944ms
[DEBUG] 2024-04-23 23:37:50.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.741 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.988639ms
[DEBUG] 2024-04-23 23:37:50.741 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911870733 end=1713911870741 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.744 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.745 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.745 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:37:50.745 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:37:50.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.750 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 4.600524ms
[DEBUG] 2024-04-23 23:37:50.750 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911870745 end=1713911870750 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.750 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_repl1 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:37:50.750 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:37:50.752 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.753 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.755 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.755 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.694325ms
[DEBUG] 2024-04-23 23:37:50.756 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_multi_table : db=db_repl1 tbls=tbl_repl1
[INFO ] 2024-04-23 23:37:50.756 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db_repl1 tbls=tbl_repl1	
[DEBUG] 2024-04-23 23:37:50.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.763 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.86921ms
[DEBUG] 2024-04-23 23:37:50.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.764 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.764 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911870753 end=1713911870764 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:50.767 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:37:50.768 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:50.768 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:37:50.768 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:37:50.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:50.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.770 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.904213ms
[DEBUG] 2024-04-23 23:37:50.770 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:37:50.770 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:37:50.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.79065ms
[DEBUG] 2024-04-23 23:37:50.771 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:37:50.771 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:37:50.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.786 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.797 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:37:50.797 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:37:50.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.806 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.812 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:37:50.812 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:37:50.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.843 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.848 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:37:50.848 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:37:50.848 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:37:50.848 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:37:50.848 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:50.848 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:50.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.850 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.443305ms
[DEBUG] 2024-04-23 23:37:50.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.706474ms
[DEBUG] 2024-04-23 23:37:50.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.852 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:50.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:50.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.186516ms
[DEBUG] 2024-04-23 23:37:50.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:37:50.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:37:50.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:50.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:50.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:50.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:37:50.872 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:37:50.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:50.900 [TThreadPoolServer WorkerProcess-%d] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:37:50.901 [TThreadPoolServer WorkerProcess-%d] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:37:50.901 [TThreadPoolServer WorkerProcess-%d] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 23:37:50.902 [TThreadPoolServer WorkerProcess-%d] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:37:50.902 [TThreadPoolServer WorkerProcess-%d] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:37:50.902 [TThreadPoolServer WorkerProcess-%d] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:37:50.902 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:37:50.902 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:37:50.902 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true"
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:37:50.903 [TThreadPoolServer WorkerProcess-%d] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:37:50.904 [TThreadPoolServer WorkerProcess-%d] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 23:37:50.905 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:37:50.905 [TThreadPoolServer WorkerProcess-%d] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:50.906 [TThreadPoolServer WorkerProcess-%d] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 23:37:50.906 [TThreadPoolServer WorkerProcess-%d] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:37:50.907 [TThreadPoolServer WorkerProcess-%d] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:37:50.907 [TThreadPoolServer WorkerProcess-%d] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true"
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:37:50.908 [TThreadPoolServer WorkerProcess-%d] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:37:50.909 [TThreadPoolServer WorkerProcess-%d] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 23:37:50.910 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:37:50.911 [TThreadPoolServer WorkerProcess-%d] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1732329549 (XID = 1719), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:50.911 [TThreadPoolServer WorkerProcess-%d] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 23:37:50.911 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.913 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:50.914 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.914 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:50.918 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:50.920 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:50.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:50.924 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:50.926 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:50.928 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:50.928 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:50.933 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:50.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:37:50.936 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:37:51.006 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:37:51.009 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@383777322 (XID = 1730), (SESSIONID = 29), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.010 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1474490385 (XID = 1732), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.011 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:37:51.012 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1719640600 (XID = 1734), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.014 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@936185694 (XID = 1738), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.014 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@633202427 (XID = 1737), (SESSIONID = 36), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.016 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1674962813 (XID = 1741), (SESSIONID = 40), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.016 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1686170816 (XID = 1742), (SESSIONID = 41), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.019 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@864244778 (XID = 1745), (SESSIONID = 45), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.019 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1429139377 (XID = 1746), (SESSIONID = 44), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.022 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@148885337 (XID = 1749), (SESSIONID = 48), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.022 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@78582671 (XID = 1750), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.024 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@360951258 (XID = 1753), (SESSIONID = 52), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.024 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1268322408 (XID = 1754), (SESSIONID = 53), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.027 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1312117786 (XID = 1757), (SESSIONID = 56), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.028 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:37:51.028 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@14773129 (XID = 1758), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.030 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@737456402 (XID = 1760), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.033 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@763763460 (XID = 1762), (SESSIONID = 61), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.036 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1689228349 (XID = 1764), (SESSIONID = 63), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:51.036 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:37:52.937 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:37:52.937 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:37:52.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:52.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.941 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:52.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:52.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:52.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.011593ms
[DEBUG] 2024-04-23 23:37:52.942 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:37:52.942 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:37:52.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:52.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:52.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.940023ms
[DEBUG] 2024-04-23 23:37:52.943 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:37:52.943 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:37:52.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:52.946 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:37:52.946 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:37:52.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:52.948 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:37:52.948 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:37:52.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:52.950 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:52.951 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:52.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.952 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:52.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:52.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:52.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.974693ms
[DEBUG] 2024-04-23 23:37:52.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:52.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:52.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.883364ms
[DEBUG] 2024-04-23 23:37:52.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:52.956 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:52.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:52.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:52.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.408168ms
[DEBUG] 2024-04-23 23:37:52.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:37:52.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:37:52.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:52.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:52.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:52.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:37:52.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:37:52.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:52.960 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:52.960 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:52.960 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:52.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:52.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:52.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:52.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:52.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:52.961 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:52.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:52.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:52.963 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:52.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:37:52.964 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:37:54.964 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:37:54.964 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:37:54.965 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:54.965 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.969 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:54.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:54.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:54.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.423587ms
[DEBUG] 2024-04-23 23:37:54.969 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:37:54.969 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:37:54.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:54.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:54.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.080808ms
[DEBUG] 2024-04-23 23:37:54.971 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:37:54.971 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:37:54.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:54.973 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:37:54.973 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:37:54.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:54.974 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:37:54.975 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:37:54.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:54.976 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:54.976 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:54.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.977 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:54.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:54.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:54.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.281928ms
[DEBUG] 2024-04-23 23:37:54.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:54.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:54.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.768408ms
[DEBUG] 2024-04-23 23:37:54.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:54.980 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.270004ms
[DEBUG] 2024-04-23 23:37:54.980 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:37:54.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:37:54.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:54.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:54.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:54.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:37:54.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:37:54.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:54.984 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:54.984 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:54.984 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:54.984 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:54.984 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:54.984 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:54.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:54.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:54.985 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:54.985 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:54.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:54.986 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:54.987 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:37:54.987 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:37:56.988 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:37:56.988 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:37:56.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:56.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:56.992 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:56.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:56.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:56.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.845266ms
[DEBUG] 2024-04-23 23:37:56.993 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:37:56.993 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:37:56.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:56.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:56.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:56.994 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.805238ms
[DEBUG] 2024-04-23 23:37:56.994 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:37:56.994 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:37:56.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:56.996 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:56.997 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:37:56.997 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:37:56.997 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:56.998 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:56.998 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:37:56.998 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:37:56.998 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:56.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:56.999 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:56.999 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:56.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:57.001 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:57.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:57.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:57.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.425927ms
[DEBUG] 2024-04-23 23:37:57.001 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.741895ms
[DEBUG] 2024-04-23 23:37:57.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:57.003 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:57.004 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.420054ms
[DEBUG] 2024-04-23 23:37:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:37:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:37:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:57.004 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:57.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:57.006 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:37:57.007 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:37:57.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:57.008 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:57.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:57.008 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:57.008 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:57.008 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:57.008 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:57.008 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:57.009 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:57.009 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:57.009 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:57.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:57.011 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:57.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:37:57.011 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:37:59.012 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:37:59.012 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:37:59.012 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:59.013 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.016 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:59.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:59.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:59.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.488373ms
[DEBUG] 2024-04-23 23:37:59.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:37:59.017 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:37:59.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:59.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:59.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.836182ms
[DEBUG] 2024-04-23 23:37:59.018 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:37:59.018 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:37:59.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:59.021 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:37:59.021 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:37:59.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:59.022 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:37:59.022 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:37:59.022 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.023 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:59.024 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:59.024 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:59.024 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.025 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:59.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:59.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:59.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.382111ms
[DEBUG] 2024-04-23 23:37:59.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:59.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:59.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.76297ms
[DEBUG] 2024-04-23 23:37:59.026 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:59.028 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:59.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:59.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:59.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.330933ms
[DEBUG] 2024-04-23 23:37:59.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:37:59.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:37:59.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:59.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:59.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:59.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:37:59.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:37:59.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:59.032 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:59.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:59.032 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:59.032 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:59.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:59.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:59.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:59.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:37:59.033 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:59.033 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:59.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:59.035 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:59.035 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:37:59.035 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 42 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 44 more

[DEBUG] 2024-04-23 23:38:01.036 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_database: @hive#db_repl1
[INFO ] 2024-04-23 23:38:01.036 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl1	
[DEBUG] 2024-04-23 23:38:01.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:01.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.041 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:01.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:01.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.041 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 4.575208ms
[DEBUG] 2024-04-23 23:38:01.041 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_tables: db=@hive#db_repl1
[INFO ] 2024-04-23 23:38:01.042 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl1	
[DEBUG] 2024-04-23 23:38:01.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:01.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.693777ms
[DEBUG] 2024-04-23 23:38:01.042 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*
[INFO ] 2024-04-23 23:38:01.043 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl1 pat=*	
[DEBUG] 2024-04-23 23:38:01.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.045 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:01.045 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:01.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.046 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:01.046 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:01.046 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.048 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:01.048 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:01.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.049 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:01.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:01.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.263877ms
[DEBUG] 2024-04-23 23:38:01.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:01.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.689955ms
[DEBUG] 2024-04-23 23:38:01.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:38:01.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:38:01.108 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.109 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.118 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 8.517033ms + 0.019542ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:38:01.125 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.426553ms + 0.013022ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:38:01.128 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.315928ms + 0.012485ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:38:01.130 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.698994ms + 0.013682ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:38:01.133 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.427505ms + 0.027175ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:38:01.136 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.777964ms + 0.014388ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:38:01.139 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.828301ms + 0.014972ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:38:01.144 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.856885ms + 0.017497ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:38:01.147 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.890689ms + 0.015068ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:38:01.151 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.11381ms + 0.01474ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:38:01.153 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.404007ms + 0.013503ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:38:01.158 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.900632ms + 0.01956ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:38:01.161 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.723248ms + 0.016168ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:38:01.164 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.17293ms + 0.014392ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:38:01.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:01.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 60.475864ms
[DEBUG] 2024-04-23 23:38:01.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:38:01.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:38:01.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.171 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: source:127.0.0.1 drop_table : tbl=hive.db_repl1.tbl_repl1
[INFO ] 2024-04-23 23:38:01.171 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db_repl1.tbl_repl1	
[DEBUG] 2024-04-23 23:38:01.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:01.172 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:01.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:01.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:01.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.419419ms
[DEBUG] 2024-04-23 23:38:01.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:01.173 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:01.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:01.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:01.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl1 retrieved using SQL in 1.243694ms
[DEBUG] 2024-04-23 23:38:01.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:01.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:38:01.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:38:01.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:38:01.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:01.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:01.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:01.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:01.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:01.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:01.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:38:01.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:38:01.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:38:01.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:38:01.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:38:01.228 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:01.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:38:01.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:38:01.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:38:01.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:38:01.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:38:01.250 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@603850359 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:01.260 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:38:01.260 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:38:01.260 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:38:01.260 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:38:01.260 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:38:01.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:38:01.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:38:01.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:38:01.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:38:01.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:38:01.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:38:01.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:38:01.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:38:01.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:38:01.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:38:01.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl1.tbl_repl1
[DEBUG] 2024-04-23 23:38:01.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:38:01.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:38:01.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:38:01.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:38:01.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:38:01.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:38:01.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:38:01.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:01.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:01.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl1 along with all tables
[DEBUG] 2024-04-23 23:38:01.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:01.363 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:01.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:01.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:01.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:01.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:01.371 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:01.371 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:01.371 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:38:01.372 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:38:01.372 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:38:01.372 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:38:01.372 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:38:01.372 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl1'>
[DEBUG] 2024-04-23 23:38:01.372 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:01.373 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:01.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:01.374 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@861849223 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:01.375 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:38:01.375 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl1
[DEBUG] 2024-04-23 23:38:01.376 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34313/db_repl1.db
[INFO ] 2024-04-23 23:38:01.377 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:38:01.380 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:38:01.381 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl1
[DEBUG] 2024-04-23 23:38:01.381 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl1.db
[DEBUG] 2024-04-23 23:38:01.381 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911870768 end=1713911881381 duration=10613 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=5 error=false>
[DEBUG] 2024-04-23 23:38:01.382 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:38:01.382 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 0
[DEBUG] 2024-04-23 23:38:01.382 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:01.382 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:38:01.382 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:38:01.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@9eedb83, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@160cc74d will be shutdown
[DEBUG] 2024-04-23 23:38:01.382 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:01.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:01.383 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911881382 end=1713911881383 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=2 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:01.383 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:01.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 2: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:01.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:01.385 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:38:01.385 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:38:01.385 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:38:01.385 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:38:01.399 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:38:01.399 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:38:01.399 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:38:01.399 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:38:01.402 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:38:01.450 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[INFO ] 2024-04-23 23:38:02.030 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:38:02.030 [MetaStoreThread-34607] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:38:02.032 [MetaStoreThread-34607] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] HMSHandler - 5: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.033 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:38:02.034 [MetaStoreThread-34607] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:38:02.036 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:38:02.037 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 32
[DEBUG] 2024-04-23 23:38:02.040 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 9, unloaded classes: 108
[DEBUG] 2024-04-23 23:38:02.040 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:38:02.041 [MetaStoreThread-34607] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:02.042 [MetaStoreThread-34607] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:38:02.042 [MetaStoreThread-34607] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:38:02.043 [MetaStoreThread-34607] HikariConfig - HikariPool-4 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:38:02.043 [MetaStoreThread-34607] HikariConfig - HikariPool-4 - configuration:
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:38:02.044 [MetaStoreThread-34607] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true"
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - poolName........................"HikariPool-4"
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:38:02.045 [MetaStoreThread-34607] HikariDataSource - HikariPool-4 - Starting...
[INFO ] 2024-04-23 23:38:02.047 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:38:02.047 [MetaStoreThread-34607] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.047 [MetaStoreThread-34607] HikariDataSource - HikariPool-4 - Start completed.
[DEBUG] 2024-04-23 23:38:02.147 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:38:02.149 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.150 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@819434781 (XID = 1160), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.151 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@19760472 (XID = 1162), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.152 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1358457426 (XID = 1164), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.153 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1075768193 (XID = 1166), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.154 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1421235715 (XID = 1168), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.156 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1809764220 (XID = 1170), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.157 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@847029069 (XID = 1172), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.158 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@683971544 (XID = 1174), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.158 [HikariPool-4 connection adder] HikariPool - HikariPool-4 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@163580d0, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@163580d0, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7eb5996a created in the thread with id: 80
[DEBUG] 2024-04-23 23:38:02.372 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.373 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.373 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.479 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.568 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.591 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.640 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.660 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.667 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.789 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.820 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.829 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.838 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.840 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@163580d0 from thread id: 80
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:38:02.843 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.848 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.851 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.852 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.852 [MetaStoreThread-34607] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:38:02.852 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.853 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.854 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.854 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.854 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.857 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.857 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] ObjectStore - db details for db default retrieved using SQL in 2.926691ms
[DEBUG] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:38:02.860 [MetaStoreThread-34607] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:38:02.861 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.867 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.869 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.871 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.874 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.874 [MetaStoreThread-34607] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:38:02.874 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.874 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:02.879 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.883 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:02.887 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.889 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:02.890 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:02.890 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.891 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.891 [MetaStoreThread-34607] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:38:02.891 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:02.891 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:02.892 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:02.892 [MetaStoreThread-34607] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:02.896 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.900 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:02.903 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:02.905 [MetaStoreThread-34607] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:02.905 [MetaStoreThread-34607] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] PerfLogger - </PERFLOG method=init start=1713911882032 end=1713911882906 duration=874 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=5 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Started the new metaserver on port [34607]...
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:38:02.906 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:38:02.907 [MetaStoreThread-34607] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:38:03.032 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.032 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 6: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.032 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:03.036 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607) is created
[INFO ] 2024-04-23 23:38:03.036 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 34607 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[INFO ] 2024-04-23 23:38:03.036 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:38:03.039 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.040 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.040 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.040 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 1
[DEBUG] 2024-04-23 23:38:03.040 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.040 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883040 end=1713911883040 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.041 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.041 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.041 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 create_database: Database(name:db5, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:38:03.041 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db5, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61a2994d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61a2994d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7490e12c created in the thread with id: 97
[DEBUG] 2024-04-23 23:38:03.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61a2994d from thread id: 97
[DEBUG] 2024-04-23 23:38:03.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.835787ms
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db5, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:38:03.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:38:03.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.050 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.050 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[INFO ] 2024-04-23 23:38:03.051 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[INFO ] 2024-04-23 23:38:03.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db
[DEBUG] 2024-04-23 23:38:03.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.055 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.057 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.057 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911883041 end=1713911883057 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 create_table_req: Table(tableName:tbl5, dbName:db5, owner:alex, createTime:1713911883, lastAccessTime:1713911883, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl5, dbName:db5, owner:alex, createTime:1713911883, lastAccessTime:1713911883, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:38:03.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.348203ms
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.154407ms
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.068 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.069 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5
[DEBUG] 2024-04-23 23:38:03.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.074 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.082 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.087 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.092 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.097 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.115 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.116 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911883058 end=1713911883116 duration=58 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.116 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.116 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.116 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.165 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:38:03.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.176 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.192 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911883116 end=1713911883194 duration=78 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.194 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.202 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.203 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:38:03.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911883194 end=1713911883217 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 add_partition : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.227 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:38:03.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.239 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911883218 end=1713911883241 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911883242 end=1713911883242 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.243 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.534845ms
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.252 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911883242 end=1713911883253 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.253 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=11, comments=HMS client
[DEBUG] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.253 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.254 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:38:03.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.258 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.678184ms + 0.016535ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.263 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.938022ms + 0.109389ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.265 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.021844ms + 0.414577ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:03.268 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.027603ms + 0.308597ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.969534ms + 0.143884ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:03.272 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.990983ms + 0.144834ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.274 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.873784ms + 0.152851ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.277 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.33833ms + 0.154131ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.280 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.317492ms + 0.544766ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.312951ms + 0.218547ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 29.034232ms
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.283 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911883253 end=1713911883283 duration=30 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.294 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.294 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 alter_table: hive.db5.tbl5 newtbl=tbl5
[INFO ] 2024-04-23 23:38:03.294 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db5.tbl5 newtbl=tbl5	
[DEBUG] 2024-04-23 23:38:03.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.601296ms
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.296 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:03.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.483477ms
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.305 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.14231ms
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db5
[WARN ] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:38:03.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:38:03.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.326 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.327 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911883294 end=1713911883327 duration=33 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.329 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.329 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.329 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.329 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 2
[DEBUG] 2024-04-23 23:38:03.331 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.331 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883331 end=1713911883331 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.332 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: source:127.0.0.1 get_table_metas : tbl=hive.*.*tblfoo*
[INFO ] 2024-04-23 23:38:03.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*tblfoo*	
[INFO ] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.334 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46a2ebc7, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46a2ebc7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@35b59db4 created in the thread with id: 111
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.335 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.338 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.339 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46a2ebc7 from thread id: 111
[DEBUG] 2024-04-23 23:38:03.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableName.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*tblfoo.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911883332 end=1713911883346 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.346 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: *tblfoo* found: 0
[INFO ] 2024-04-23 23:38:03.346 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@46a2ebc7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@35b59db4 will be shutdown
[INFO ] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911883346 end=1713911883346 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=8 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 8: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.347 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.348 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.04068ms + 0.012128ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.599409ms + 0.122291ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.269303ms + 0.330646ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:03.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.242376ms + 0.264518ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.351 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.31457ms + 0.171484ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:03.351 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.347817ms + 0.136626ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.352 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.22606ms + 0.123621ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.352 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.246912ms + 0.125182ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.341312ms + 0.345546ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.272933ms + 0.12943ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.918351ms
[DEBUG] 2024-04-23 23:38:03.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.354 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.354 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911883346 end=1713911883354 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.355 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.356 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.356 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.356 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 2
[DEBUG] 2024-04-23 23:38:03.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883356 end=1713911883356 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.357 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.357 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: source:127.0.0.1 get_table_metas : tbl=hive.*.tbl5*
[INFO ] 2024-04-23 23:38:03.357 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.tbl5*	
[INFO ] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.359 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@946497e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@946497e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@38056171 created in the thread with id: 112
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.361 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.363 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@946497e from thread id: 112
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableName.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i)tbl5.*, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:38:03.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.372 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.372 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.357401ms
[DEBUG] 2024-04-23 23:38:03.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911883357 end=1713911883373 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.374 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: tbl5* found: 1
[DEBUG] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: source:127.0.0.1 get_database: db5
[INFO ] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db5	
[DEBUG] 2024-04-23 23:38:03.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.026984ms
[DEBUG] 2024-04-23 23:38:03.375 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911883374 end=1713911883375 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.375 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: source:127.0.0.1 get_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.376 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.100839ms
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.390 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:03.392 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:03.392 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911883376 end=1713911883392 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.392 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=16, comments=HMS client
[INFO ] 2024-04-23 23:38:03.392 [main] PartitionManagementTask - Found 1 candidate tables for partition discovery
[INFO ] 2024-04-23 23:38:03.395 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:38:03.395 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:38:03.395 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:38:03.395 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:38:03.396 [main] PartitionManagementTask - Running partition discovery for table hive.db5.tbl5 retentionPeriod: -1s
[INFO ] 2024-04-23 23:38:03.398 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.398 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.398 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.398 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 3
[DEBUG] 2024-04-23 23:38:03.399 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.399 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883399 end=1713911883399 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=10 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.400 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.400 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: source:127.0.0.1 get_database: db5
[INFO ] 2024-04-23 23:38:03.400 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db5	
[INFO ] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.401 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1ab3adc8, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1ab3adc8, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7dc66d1a created in the thread with id: 114
[DEBUG] 2024-04-23 23:38:03.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.406 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.407 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1ab3adc8 from thread id: 114
[DEBUG] 2024-04-23 23:38:03.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.482516ms
[DEBUG] 2024-04-23 23:38:03.408 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911883400 end=1713911883408 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=10 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.408 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=9, comments=HMS client
[INFO ] 2024-04-23 23:38:03.409 [PartitionDiscoveryTask-0] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:03.409 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34607]
[INFO ] 2024-04-23 23:38:03.409 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34607)
[INFO ] 2024-04-23 23:38:03.409 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34607) current connections: 4
[DEBUG] 2024-04-23 23:38:03.410 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.410 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911883410 end=1713911883410 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.410 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.410 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.411 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: source:127.0.0.1 get_table : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.411 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db5.tbl5	
[INFO ] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:03.412 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@224367de, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@224367de, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7b286dbd created in the thread with id: 115
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.413 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.414 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.416 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@224367de from thread id: 115
[DEBUG] 2024-04-23 23:38:03.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.780917ms
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.431 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:03.433 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:03.433 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911883410 end=1713911883433 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.433 [PartitionDiscoveryTask-0] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=23, comments=HMS client
[DEBUG] 2024-04-23 23:38:03.437 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partition_names from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: source:127.0.0.1 get_partition_names : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partition_names : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionNames
[DEBUG] 2024-04-23 23:38:03.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.450 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.450 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partition_names start=1713911883438 end=1713911883450 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.453 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.455 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions_by_names_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.455 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: source:127.0.0.1 get_partitions_by_names : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.455 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions_by_names : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.463 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 7.530221ms + 0.027751ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:38:03.471 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 6.781078ms + 0.17376ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (1,2,3) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.476 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.659503ms + 0.597246ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (1,2,3) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:03.480 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.50045ms + 0.433687ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.481 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.597762ms + 0.316929ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:03.482 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.603556ms + 0.266594ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.483 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.604363ms + 0.272139ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.484 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.561199ms + 0.242384ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.485 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.636847ms + 0.595627ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.509785ms + 0.25696ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 30.355466ms
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:03.494 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:03.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.495 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.497 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions_by_names_req start=1713911883455 end=1713911883497 duration=42 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.500 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Using multi-threaded version of MSCK-GetPaths with number of threads 15
[DEBUG] 2024-04-23 23:38:03.505 [PartitionDiscoveryTask-0] MetaStoreServerUtils - tablePath:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5, partCols: [state, dt]
[DEBUG] 2024-04-23 23:38:03.505 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting '2018-12-01' to type: 'date'.
[DEBUG] 2024-04-23 23:38:03.505 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=WA
[DEBUG] 2024-04-23 23:38:03.505 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting 'WA' to type: 'string'.
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - PartitionName: state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - tablePath:file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5, partCols: [dt, state]
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting '2018-12-02' to type: 'date'.
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5/state=UT
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - Converting 'UT' to type: 'string'.
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] MetaStoreServerUtils - currPath=file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34607/db5.db/tbl5
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - PartitionName: state=UT/dt=2018-12-02
[DEBUG] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitions not in metastore : 2
[INFO ] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] HiveMetaStoreChecker - Number of partitionsNotInMs=[tbl5:state=UT/dt=2018-12-02, tbl5:state=WA/dt=2018-12-01], partitionsNotOnFs=[], tablesNotInMs=[], tablesNotOnFs=[], expiredPartitions=[]
[INFO ] 2024-04-23 23:38:03.506 [PartitionDiscoveryTask-0] Msck - hive.db5.tbl5 - #partsNotInMs: 2 #partsNotInFs: 0 #expiredPartitions: 0 lockRequired: true (R: true A: true D: true)
[DEBUG] 2024-04-23 23:38:03.508 [PartitionDiscoveryTask-0] Msck - Repair: Added partition to metastore tbl5:state=UT/dt=2018-12-02
[DEBUG] 2024-04-23 23:38:03.508 [PartitionDiscoveryTask-0] Msck - Repair: Added partition to metastore tbl5:state=WA/dt=2018-12-01
[DEBUG] 2024-04-23 23:38:03.510 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.512 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partitions_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.513 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: add_partitions
[INFO ] 2024-04-23 23:38:03.513 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=add_partitions	
[DEBUG] 2024-04-23 23:38:03.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.514 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.527622ms
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.522 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.195203ms
[DEBUG] 2024-04-23 23:38:03.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.527 [HMSHandler #1] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.lambda$createPartitionFolders$14(HMSHandler.java:4385)
[DEBUG] 2024-04-23 23:38:03.527 [HMSHandler #0] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.lambda$createPartitionFolders$14(HMSHandler.java:4385)
[DEBUG] 2024-04-23 23:38:03.527 [HMSHandler #0] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.527 [HMSHandler #1] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #0] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #1] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #0] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #1] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #0] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:03.528 [HMSHandler #1] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:03.528 [HMSHandler #1] MetaStoreServerUtils - Updating partition stats fast for: tbl5
[INFO ] 2024-04-23 23:38:03.528 [HMSHandler #0] MetaStoreServerUtils - Updating partition stats fast for: tbl5
[INFO ] 2024-04-23 23:38:03.528 [HMSHandler #0] MetaStoreServerUtils - Updated size to 0
[INFO ] 2024-04-23 23:38:03.528 [HMSHandler #1] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:38:03.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db5.tbl5
[DEBUG] 2024-04-23 23:38:03.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.546 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.548 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partitions_req start=1713911883512 end=1713911883548 duration=36 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:03.549 [PartitionDiscoveryTask-0] Msck - Tables not in metastore: []
Tables missing on filesystem: []
Partitions not in metastore: [tbl5:state=UT/dt=2018-12-02, tbl5:state=WA/dt=2018-12-01]
Partitions missing from filesystem: []
Expired partitions: []

[INFO ] 2024-04-23 23:38:03.550 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:03.550 [PartitionDiscoveryTask-0] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:38:03.550 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@224367de, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7b286dbd will be shutdown
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1ab3adc8, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7dc66d1a will be shutdown
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@946497e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@38056171 will be shutdown
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db5.tbl5	
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911883550 end=1713911883550 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=10 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911883550 end=1713911883551 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=11 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.550 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911883550 end=1713911883551 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=9 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 10: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 9: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 11: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:03.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:03.552 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.354588ms + 0.01029ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.557 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.972078ms + 0.177782ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,4,5,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:03.561 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.714178ms + 0.835791ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,4,5,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:03.565 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.875607ms + 0.324634ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,4,5,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.568 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.363728ms + 0.142947ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,5,6,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:03.570 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.070468ms + 0.182577ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.572 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.943021ms + 0.157814ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.574 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.872889ms + 0.152777ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,5,6,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.575 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.307196ms + 0.292788ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.934396ms + 0.140577ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,5,6,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 5 entries retrieved using SQL in 26.700493ms
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.577 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911883550 end=1713911883577 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.578 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:38:03.579 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.581 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911883579 end=1713911883582 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:38:03.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.585 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.585 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911883582 end=1713911883585 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_database: db5
[INFO ] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db5	
[DEBUG] 2024-04-23 23:38:03.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.611805ms
[DEBUG] 2024-04-23 23:38:03.587 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911883586 end=1713911883587 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.588 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_tables_by_type: db=@hive#db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:03.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.376062ms
[DEBUG] 2024-04-23 23:38:03.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.585395ms
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911883588 end=1713911883593 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.593 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.594 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:03.594 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:03.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.341783ms
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911883593 end=1713911883597 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.597 [main] HiveMetaStoreClient - Selecting dropDatabase method for db5 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:38:03.597 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.597 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.830779ms
[DEBUG] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_multi_table : db=db5 tbls=tbl5
[INFO ] 2024-04-23 23:38:03.599 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db5 tbls=tbl5	
[DEBUG] 2024-04-23 23:38:03.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.540029ms
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.607 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911883597 end=1713911883607 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:03.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.384799ms
[DEBUG] 2024-04-23 23:38:03.609 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:03.610 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:03.610 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.956724ms
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:03.611 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.623 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.628 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:03.628 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:03.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.634 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.638 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:03.638 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:03.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.663 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:03.667 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:03.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.668 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.250212ms
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.664773ms
[DEBUG] 2024-04-23 23:38:03.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.098515ms
[DEBUG] 2024-04-23 23:38:03.671 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:03.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:03.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:03.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:03.673 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:03.674 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:03.692 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1911201574 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.696 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:03.703 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:03.703 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:03.703 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.703 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.706 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.708 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.710 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.713 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.715 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:03.717 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:03.717 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:03.719 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:03.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:03.719 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:05.720 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:05.720 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:05.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:05.720 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.721 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.448883ms
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.781322ms
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.725 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:05.725 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.726 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:05.727 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:05.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.728 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:05.728 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:05.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.308518ms
[DEBUG] 2024-04-23 23:38:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.797065ms
[DEBUG] 2024-04-23 23:38:05.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:05.732 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:05.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:05.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.160504ms
[DEBUG] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:05.733 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:05.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:05.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:05.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.736 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:05.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:05.738 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:05.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:05.739 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:07.739 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:07.740 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:07.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:07.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.744 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 4.544131ms
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:07.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.386672ms
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:07.748 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.754 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:07.754 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:07.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.758 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:07.758 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:07.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.762 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:07.762 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:07.763 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.765 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:07.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.838318ms
[DEBUG] 2024-04-23 23:38:07.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.379293ms
[DEBUG] 2024-04-23 23:38:07.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.090493ms
[DEBUG] 2024-04-23 23:38:07.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:07.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:07.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:07.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:07.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:07.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:07.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:07.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:07.776 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:07.777 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:07.779 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:07.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:07.779 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:09.780 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:09.780 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:09.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:09.780 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 16.699457ms
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:09.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.798 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.01425ms
[DEBUG] 2024-04-23 23:38:09.799 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:09.799 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:09.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.801 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:09.801 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:09.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.802 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:09.802 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:09.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.803 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:09.803 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:09.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.446779ms
[DEBUG] 2024-04-23 23:38:09.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.625997ms
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:09.807 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.230641ms
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:09.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:09.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:09.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:09.810 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:09.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:09.812 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:09.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:09.813 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:11.813 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:11.814 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:11.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:11.814 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.817 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.7824ms
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:11.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.679195ms
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:11.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.821 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:11.821 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:11.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.822 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:11.822 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:11.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.823 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:11.823 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:11.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.824 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.211733ms
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.624415ms
[DEBUG] 2024-04-23 23:38:11.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.790145ms
[DEBUG] 2024-04-23 23:38:11.828 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:11.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:11.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:11.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:11.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:11.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:11.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.833 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.834 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:11.834 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:11.834 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:11.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:11.835 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:11.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:11.836 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:13.837 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:13.837 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:13.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:13.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.840 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.933851ms
[DEBUG] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:13.841 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:13.842 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.843 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.012337ms
[DEBUG] 2024-04-23 23:38:13.844 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:13.844 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:13.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.850 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:13.851 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:13.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.855 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:13.855 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:13.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.858 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:13.858 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:13.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.859 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.523571ms
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.660558ms
[DEBUG] 2024-04-23 23:38:13.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.958135ms
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:13.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:13.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:13.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:13.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:13.865 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:13.866 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:13.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:13.866 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:13.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:13.867 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:15.867 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:15.867 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:15.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:15.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.871 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:15.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.91743ms
[DEBUG] 2024-04-23 23:38:15.872 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:15.872 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:15.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.814411ms
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:15.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.875 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:15.875 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:15.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.876 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:15.876 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:15.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.877 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:15.877 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:15.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.999119ms
[DEBUG] 2024-04-23 23:38:15.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.623679ms
[DEBUG] 2024-04-23 23:38:15.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.968087ms
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:15.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:15.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:15.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:15.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.884 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:15.885 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:15.885 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:15.885 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:15.885 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:15.886 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:15.886 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:16.406 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:17.887 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:17.887 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:17.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:17.887 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.931664ms
[DEBUG] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:17.891 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.622507ms
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:17.892 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.894 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:17.894 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:17.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.895 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.896 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:17.896 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:17.896 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.952732ms
[DEBUG] 2024-04-23 23:38:17.897 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.763306ms
[DEBUG] 2024-04-23 23:38:17.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.899 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:17.899 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.971606ms
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:17.900 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:17.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:17.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:17.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:17.902 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:17.902 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.903 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:17.904 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:17.904 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:17.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:17.905 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:17.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:17.905 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:19.906 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:19.907 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:19.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:19.907 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.33988ms
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:19.910 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.691367ms
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:19.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.913 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:19.913 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:19.913 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.914 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:19.914 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:19.914 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.915 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:19.915 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:19.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.916 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.094354ms
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.582201ms
[DEBUG] 2024-04-23 23:38:19.917 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.918 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 0.925252ms
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:19.919 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:19.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:19.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:19.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:19.922 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:19.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:19.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:19.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:19.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:19.924 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:21.007 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:21.012 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:21.925 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:21.925 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:21.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:21.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 2.817585ms
[DEBUG] 2024-04-23 23:38:21.928 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.578043ms
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:21.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.931 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:21.931 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:21.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.932 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:21.932 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:21.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.934 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:21.934 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:21.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.282563ms
[DEBUG] 2024-04-23 23:38:21.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.540911ms
[DEBUG] 2024-04-23 23:38:21.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.216648ms
[DEBUG] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:21.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:21.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:21.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:21.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:21.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:21.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:21.942 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:21.943 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:21.944 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:21.944 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:21.945 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:21.945 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:21.945 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 41 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 43 more

[DEBUG] 2024-04-23 23:38:23.946 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 drop_database: @hive#db5
[INFO ] 2024-04-23 23:38:23.946 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db5	
[DEBUG] 2024-04-23 23:38:23.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:23.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.949 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 3.492119ms
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_tables: db=@hive#db5
[INFO ] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db5	
[DEBUG] 2024-04-23 23:38:23.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.699024ms
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_functions: db=@hive#db5 pat=*
[INFO ] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db5 pat=*	
[DEBUG] 2024-04-23 23:38:23.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.953 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:23.953 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:23.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.954 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:23.954 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:23.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.955 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:23.955 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db5 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:23.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.09903ms
[DEBUG] 2024-04-23 23:38:23.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.617645ms
[DEBUG] 2024-04-23 23:38:23.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db5 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db5.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db5 retrieved using SQL in 1.084271ms
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db5 along with all tables
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:23.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:23.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:23.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:23.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db5'>
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:23.962 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:23.963 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-4 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1335846637 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:23.964 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:23.964 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:38:23.964 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911883608 end=1713911903964 duration=20356 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=7 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:38:23.970 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:38:23.971 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:38:23.971 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:38:23.971 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:38:23.979 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:38:23.979 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:38:23.979 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:38:23.979 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:38:23.981 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:38:24.017 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[INFO ] 2024-04-23 23:38:24.448 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:38:24.449 [MetaStoreThread-45719] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:38:24.449 [MetaStoreThread-45719] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] HMSHandler - 12: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:24.450 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:38:24.451 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34607;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.452 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:38:24.453 [MetaStoreThread-45719] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:24.454 [MetaStoreThread-45719] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:38:24.454 [MetaStoreThread-45719] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:38:24.455 [MetaStoreThread-45719] HikariConfig - HikariPool-5 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:38:24.455 [MetaStoreThread-45719] HikariConfig - HikariPool-5 - configuration:
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:38:24.456 [MetaStoreThread-45719] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true"
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - poolName........................"HikariPool-5"
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:38:24.457 [MetaStoreThread-45719] HikariDataSource - HikariPool-5 - Starting...
[INFO ] 2024-04-23 23:38:24.459 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:38:24.459 [MetaStoreThread-45719] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:24.459 [MetaStoreThread-45719] HikariDataSource - HikariPool-5 - Start completed.
[DEBUG] 2024-04-23 23:38:24.559 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:38:24.561 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.562 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@388378928 (XID = 1163), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.563 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@654042932 (XID = 1165), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.564 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1997131391 (XID = 1167), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.566 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@495316882 (XID = 1169), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.567 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1934087631 (XID = 1171), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.568 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1452710513 (XID = 1173), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.569 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1969123768 (XID = 1175), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.570 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@455656190 (XID = 1177), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.570 [HikariPool-5 connection adder] HikariPool - HikariPool-5 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:24.675 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:24.676 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:38:24.676 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:38:24.676 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@61a2994d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@7490e12c will be shutdown
[DEBUG] 2024-04-23 23:38:24.676 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 7: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:24.676 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:24.719 [MetaStoreThread-45719] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:38:24.719 [MetaStoreThread-45719] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4431a76c, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:24.719 [MetaStoreThread-45719] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:24.719 [MetaStoreThread-45719] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4431a76c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@70db9342 created in the thread with id: 131
[DEBUG] 2024-04-23 23:38:24.719 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.720 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.720 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.833 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.909 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.926 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.962 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.978 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:24.983 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.102 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.127 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.133 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.140 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.143 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.144 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.144 [MetaStoreThread-45719] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:25.144 [MetaStoreThread-45719] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:25.144 [MetaStoreThread-45719] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4431a76c from thread id: 131
[DEBUG] 2024-04-23 23:38:25.145 [MetaStoreThread-45719] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:38:25.145 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.148 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.151 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.151 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:25.152 [MetaStoreThread-45719] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:38:25.152 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.152 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.152 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.153 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.153 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.155 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.156 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.158 [MetaStoreThread-45719] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.158 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.158 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.158 [MetaStoreThread-45719] ObjectStore - db details for db default retrieved using SQL in 2.338227ms
[DEBUG] 2024-04-23 23:38:25.158 [MetaStoreThread-45719] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:38:25.158 [MetaStoreThread-45719] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:38:25.158 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.164 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.166 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.167 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.169 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:25.169 [MetaStoreThread-45719] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:38:25.169 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.169 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.173 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.175 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.178 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.179 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.180 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:25.180 [MetaStoreThread-45719] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:38:25.180 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.180 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.181 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.181 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.182 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:25.182 [MetaStoreThread-45719] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:38:25.182 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.182 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.183 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.183 [MetaStoreThread-45719] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.187 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.190 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.192 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.194 [MetaStoreThread-45719] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.195 [MetaStoreThread-45719] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:25.195 [MetaStoreThread-45719] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:38:25.195 [MetaStoreThread-45719] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:38:25.195 [MetaStoreThread-45719] PerfLogger - </PERFLOG method=init start=1713911904449 end=1713911905195 duration=746 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=12 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:25.195 [MetaStoreThread-45719] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:38:25.195 [MetaStoreThread-45719] HiveMetaStore - Started the new metaserver on port [45719]...
[INFO ] 2024-04-23 23:38:25.195 [MetaStoreThread-45719] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:38:25.196 [MetaStoreThread-45719] HiveMetaStore - Direct SQL optimization = true
[INFO ] 2024-04-23 23:38:25.450 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 45719 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[INFO ] 2024-04-23 23:38:25.451 [main] TestTxnDbUtil - Creating transactional tables
[DEBUG] 2024-04-23 23:38:25.451 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:25.452 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 13: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:25.453 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:25.461 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:25.461 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45719]
[INFO ] 2024-04-23 23:38:25.462 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45719)
[INFO ] 2024-04-23 23:38:25.463 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45719) current connections: 2
[DEBUG] 2024-04-23 23:38:25.464 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.464 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911905464 end=1713911905464 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.465 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.466 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.466 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 create_database: Database(name:db_repl2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:38:25.466 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db_repl2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:25.470 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:25.471 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:25.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2389ccad, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:25.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:25.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2389ccad, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2e276e2f created in the thread with id: 146
[DEBUG] 2024-04-23 23:38:25.475 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.475 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.475 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.482 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.484 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.484 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:25.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:25.485 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2389ccad from thread id: 146
[DEBUG] 2024-04-23 23:38:25.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.487 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.83465ms
[DEBUG] 2024-04-23 23:38:25.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db_repl2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:38:25.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:38:25.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.489 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.489 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.490 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:38:25.490 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:25.490 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:25.490 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:25.490 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:38:25.491 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db for database db_repl2. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:38:25.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.495 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.495 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911905466 end=1713911905495 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.495 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.496 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.496 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 create_table_req: Table(tableName:tbl_repl2, dbName:db_repl2, owner:alex, createTime:1713911905, lastAccessTime:1713911905, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:do, type:double, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:38:25.496 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl_repl2, dbName:db_repl2, owner:alex, createTime:1713911905, lastAccessTime:1713911905, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:do, type:double, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:38:25.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.501 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:25.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.502 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 5.623071ms
[DEBUG] 2024-04-23 23:38:25.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.508 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.509 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:25.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.394917ms
[DEBUG] 2024-04-23 23:38:25.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.511 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:25.511 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:25.511 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:25.511 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:25.511 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db_repl2.db/tbl_repl2
[DEBUG] 2024-04-23 23:38:25.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.523 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.528 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.533 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.538 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.553 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.554 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911905496 end=1713911905554 duration=58 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.554 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.554 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.554 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:38:25.554 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:38:25.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.598 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:25.598 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:25.599 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:25.599 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:25.599 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db_repl2.db/tbl_repl2/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:38:25.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.608 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.624 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.625 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911905554 end=1713911905625 duration=71 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.626 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.626 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.626 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:38:25.626 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:38:25.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.633 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:25.633 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:25.633 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:25.633 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:25.633 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db_repl2.db/tbl_repl2/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:38:25.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.644 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.646 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911905626 end=1713911905646 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.647 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.647 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.647 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:38:25.647 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:38:25.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.653 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.654 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:25.654 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:25.654 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:25.654 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:38:25.654 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db_repl2.db/tbl_repl2/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:38:25.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.665 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.667 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911905647 end=1713911905667 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.668 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.668 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.668 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911905668 end=1713911905668 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.668 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.668 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.668 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_table : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:38:25.668 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:38:25.668 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.669 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:25.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.669 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.669 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.463102ms
[DEBUG] 2024-04-23 23:38:25.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.670 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.672 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.675 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.677 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[INFO ] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911905668 end=1713911905678 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.678 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=10, comments=HMS client
[DEBUG] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.678 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.683 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.878756ms + 0.007144ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:25.688 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.854733ms + 0.100002ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:25.690 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.702376ms + 0.468802ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:25.692 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.828809ms + 0.199443ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.694 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.642534ms + 0.132162ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:25.696 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.817161ms + 0.13292ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.698 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.555226ms + 0.13014ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.700 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.743793ms + 0.178151ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.702 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.99195ms + 0.346759ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.704 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.918732ms + 0.136753ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:25.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 25.928782ms
[DEBUG] 2024-04-23 23:38:25.704 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.705 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.705 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911905678 end=1713911905705 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.706 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.706 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.706 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 alter_table: hive.db_repl2.tbl_repl2 newtbl=tbl_repl2
[INFO ] 2024-04-23 23:38:25.706 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db_repl2.tbl_repl2 newtbl=tbl_repl2	
[DEBUG] 2024-04-23 23:38:25.706 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.707 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:25.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.707 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.707 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.582711ms
[DEBUG] 2024-04-23 23:38:25.708 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:25.708 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:25.708 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:25.708 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:25.708 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.709 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:25.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.709 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.495768ms
[DEBUG] 2024-04-23 23:38:25.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.709 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.712 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.715 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.716 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.717 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.718 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:25.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.168275ms
[DEBUG] 2024-04-23 23:38:25.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.721 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.724 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl2
[WARN ] 2024-04-23 23:38:25.724 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:38:25.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:25.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:38:25.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:25.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:38:25.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:25.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.734 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.735 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.736 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911905706 end=1713911905736 duration=30 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.737 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.737 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.737 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_database: db_repl2
[INFO ] 2024-04-23 23:38:25.737 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl2	
[DEBUG] 2024-04-23 23:38:25.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.738 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:25.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.738 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.248883ms
[DEBUG] 2024-04-23 23:38:25.738 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911905737 end=1713911905738 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.738 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 alter_database @hive#db_repl2
[INFO ] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_database @hive#db_repl2	
[DEBUG] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:25.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.740 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:25.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.741 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.531456ms
[DEBUG] 2024-04-23 23:38:25.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.745 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.746 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_database start=1713911905739 end=1713911905746 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:25.746 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:25.746 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45719]
[INFO ] 2024-04-23 23:38:25.747 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45719)
[INFO ] 2024-04-23 23:38:25.747 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45719) current connections: 3
[DEBUG] 2024-04-23 23:38:25.747 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.747 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911905747 end=1713911905747 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=15 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.748 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.748 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.748 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 15: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:38:25.748 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 15: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1959cc2, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1959cc2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4c64954f created in the thread with id: 155
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.749 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.750 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.751 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.752 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.752 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:25.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:25.752 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1959cc2 from thread id: 155
[DEBUG] 2024-04-23 23:38:25.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911905748 end=1713911905758 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=15 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:25.758 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:38:25.758 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 15: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1959cc2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4c64954f will be shutdown
[INFO ] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 15: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911905758 end=1713911905758 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=15 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:25.758 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:25.759 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 15: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:25.759 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:25.760 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.096371ms + 0.007951ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:25.761 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.670706ms + 0.111067ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:25.762 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.273419ms + 0.390428ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:25.762 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.222873ms + 0.234726ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.763 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.235336ms + 0.182986ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:25.763 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.183231ms + 0.115196ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.763 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.164181ms + 0.113791ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.764 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.160385ms + 0.112531ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.764 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.224966ms + 0.265294ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:25.764 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.216612ms + 0.122699ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:25.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:25.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:25.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 6.002325ms
[DEBUG] 2024-04-23 23:38:25.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:25.765 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:25.765 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911905758 end=1713911905765 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:32.148 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:46.407 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:51.008 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:51.012 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:38:54.560 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:38:55.768 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:38:55.769 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:45719]
[INFO ] 2024-04-23 23:38:55.769 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:45719)
[INFO ] 2024-04-23 23:38:55.770 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:45719) current connections: 3
[DEBUG] 2024-04-23 23:38:55.771 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.771 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911935771 end=1713911935771 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=16 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.772 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.772 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.772 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 16: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:38:55.772 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:38:55.772 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 16: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5bcbbed7, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5bcbbed7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3ddf6df2 created in the thread with id: 156
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.773 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.774 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.775 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.775 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.775 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:38:55.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:38:55.775 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5bcbbed7 from thread id: 156
[DEBUG] 2024-04-23 23:38:55.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.776 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911935772 end=1713911935778 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=16 retryCount=0 error=false>
[INFO ] 2024-04-23 23:38:55.778 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:38:55.778 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 16: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5bcbbed7, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3ddf6df2 will be shutdown
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 16: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911935778 end=1713911935778 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=16 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:38:55.778 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 16: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:38:55.779 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:38:55.779 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.96801ms + 0.006072ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:55.781 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.838478ms + 0.10171ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:38:55.782 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.359197ms + 0.504473ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:38:55.783 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.322208ms + 0.371887ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:55.783 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.347996ms + 0.246751ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:38:55.784 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.331225ms + 0.249906ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:55.785 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.346238ms + 0.208156ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:55.785 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.317235ms + 0.23454ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:55.786 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.435048ms + 0.439697ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:38:55.787 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.330118ms + 0.263562ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:38:55.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 8.455549ms
[DEBUG] 2024-04-23 23:38:55.787 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.787 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.787 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911935778 end=1713911935787 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.788 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.788 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.788 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:38:55.788 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:38:55.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:38:55.788 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.791 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.792 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.792 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911935788 end=1713911935792 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.792 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.792 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.792 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:38:55.792 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:38:55.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.796 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.796 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.796 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911935792 end=1713911935796 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.797 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.797 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.797 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_database: db_repl2
[INFO ] 2024-04-23 23:38:55.797 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db_repl2	
[DEBUG] 2024-04-23 23:38:55.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.798 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.924115ms
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911935797 end=1713911935799 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.799 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_tables_by_type: db=@hive#db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:55.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.800 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:55.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.801 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.668241ms
[DEBUG] 2024-04-23 23:38:55.801 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.805 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 4.050826ms
[DEBUG] 2024-04-23 23:38:55.805 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911935799 end=1713911935805 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.805 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.806 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.806 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:38:55.806 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:38:55.806 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.809 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.809 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.77006ms
[DEBUG] 2024-04-23 23:38:55.809 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911935806 end=1713911935809 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.810 [main] HiveMetaStoreClient - Selecting dropDatabase method for db_repl2 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:38:55.810 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:38:55.810 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.810 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.811 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:55.811 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.812 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.720073ms
[DEBUG] 2024-04-23 23:38:55.812 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_multi_table : db=db_repl2 tbls=tbl_repl2
[INFO ] 2024-04-23 23:38:55.812 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db_repl2 tbls=tbl_repl2	
[DEBUG] 2024-04-23 23:38:55.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.818 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:55.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.476167ms
[DEBUG] 2024-04-23 23:38:55.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.819 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.819 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911935810 end=1713911935819 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:38:55.819 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:38:55.820 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:38:55.820 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:38:55.820 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:38:55.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:55.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.821 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.54447ms
[DEBUG] 2024-04-23 23:38:55.821 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:38:55.821 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:38:55.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.840167ms
[DEBUG] 2024-04-23 23:38:55.822 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:38:55.822 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:38:55.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.836 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.841 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:55.841 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:55.841 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.846 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.850 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:55.850 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:55.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.872 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.876 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:38:55.876 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:38:55.876 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:38:55.876 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:38:55.876 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:55.876 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:55.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.878 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:55.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.573453ms
[DEBUG] 2024-04-23 23:38:55.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.745208ms
[DEBUG] 2024-04-23 23:38:55.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:55.881 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:55.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:55.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:55.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.244194ms
[DEBUG] 2024-04-23 23:38:55.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:55.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:38:55.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:55.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:55.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:55.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:55.899 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.904 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:55.909 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:55.909 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:55.909 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.909 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:55.911 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:55.912 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:55.914 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:55.916 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:55.918 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:55.920 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:55.920 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.920 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:55.922 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:55.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:55.922 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:38:57.923 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:38:57.924 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:38:57.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:57.924 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.928 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:57.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:57.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:57.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 4.515193ms
[DEBUG] 2024-04-23 23:38:57.929 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:38:57.929 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:38:57.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:57.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:57.929 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.636581ms
[DEBUG] 2024-04-23 23:38:57.930 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:38:57.930 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:38:57.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:57.931 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:57.931 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:57.931 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:57.932 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:57.932 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:57.932 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:57.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:57.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:57.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.934 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:57.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:57.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:57.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.935627ms
[DEBUG] 2024-04-23 23:38:57.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:57.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:57.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.564731ms
[DEBUG] 2024-04-23 23:38:57.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.935 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:57.936 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:57.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:57.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:57.936 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.947965ms
[DEBUG] 2024-04-23 23:38:57.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:57.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:38:57.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:57.937 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:57.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:57.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:57.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:57.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:57.939 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:57.939 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:57.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:57.939 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:57.940 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:57.940 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:57.940 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:57.940 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:57.940 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:57.940 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:57.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:57.941 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:57.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:57.942 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:38:59.942 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:38:59.942 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:38:59.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:38:59.943 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.946 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:59.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:59.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:59.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 4.157618ms
[DEBUG] 2024-04-23 23:38:59.947 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:38:59.947 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:38:59.947 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:59.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:59.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.59021ms
[DEBUG] 2024-04-23 23:38:59.948 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:38:59.948 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:38:59.948 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:59.950 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:38:59.950 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:38:59.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:59.951 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:38:59.951 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:38:59.951 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:59.952 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:38:59.952 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:38:59.952 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.953 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:59.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:59.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:59.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.183557ms
[DEBUG] 2024-04-23 23:38:59.953 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:59.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:59.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.600463ms
[DEBUG] 2024-04-23 23:38:59.954 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.955 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:59.956 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:38:59.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:38:59.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:59.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.955468ms
[DEBUG] 2024-04-23 23:38:59.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:38:59.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:38:59.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:38:59.956 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:38:59.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:38:59.957 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:38:59.958 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:38:59.959 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:38:59.960 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:59.960 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:38:59.961 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:38:59.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:38:59.962 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:01.962 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:39:01.963 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:39:01.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:01.963 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.965 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:01.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:01.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:01.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 2.829737ms
[DEBUG] 2024-04-23 23:39:01.966 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:39:01.966 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:39:01.966 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:01.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:01.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.774908ms
[DEBUG] 2024-04-23 23:39:01.967 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:39:01.967 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:39:01.967 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:01.969 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:01.969 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:01.969 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:01.970 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:01.970 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:01.970 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:01.971 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:01.971 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:01.971 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.972 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:01.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:01.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:01.972 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.085191ms
[DEBUG] 2024-04-23 23:39:01.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:01.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:01.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.617925ms
[DEBUG] 2024-04-23 23:39:01.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:01.975 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:01.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:01.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:01.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.979091ms
[DEBUG] 2024-04-23 23:39:01.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:01.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:39:01.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:01.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:01.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:01.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:01.977 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:01.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:01.978 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:01.978 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:01.978 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:01.978 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:01.978 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:01.978 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:01.979 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:01.979 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:01.979 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:01.979 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:01.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:01.981 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:01.981 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:01.981 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:02.148 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:03.982 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 drop_database: @hive#db_repl2
[INFO ] 2024-04-23 23:39:03.982 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db_repl2	
[DEBUG] 2024-04-23 23:39:03.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:03.983 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:03.985 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:03.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:03.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 2.713866ms
[DEBUG] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_tables: db=@hive#db_repl2
[INFO ] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db_repl2	
[DEBUG] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.585221ms
[DEBUG] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*
[INFO ] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db_repl2 pat=*	
[DEBUG] 2024-04-23 23:39:03.986 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:03.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:03.989 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:03.989 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:03.989 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:03.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:03.990 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:03.990 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:03.990 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:03.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:03.991 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:03.991 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db_repl2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:03.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:03.992 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:03.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:03.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:03.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 0.96056ms
[DEBUG] 2024-04-23 23:39:03.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:03.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:03.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:03.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.530162ms
[DEBUG] 2024-04-23 23:39:03.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:04.009 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:04.010 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:04.010 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:04.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:04.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:04.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:04.022 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.987961ms + 0.01293ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:39:04.027 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.232049ms + 0.005967ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:04.029 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.910066ms + 0.005547ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:04.031 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.096328ms + 0.007112ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:04.033 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.923453ms + 0.006232ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:04.035 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.035499ms + 0.007382ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:04.038 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.58309ms + 0.025846ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:04.043 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.916329ms + 0.006297ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:04.045 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.924938ms + 0.005651ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:04.047 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.91344ms + 0.006178ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:04.049 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.924484ms + 0.00575ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:04.052 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.792433ms + 0.007509ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:04.054 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.883546ms + 0.005692ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:04.056 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.241063ms + 0.006593ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:04.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:04.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:04.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 41.006757ms
[DEBUG] 2024-04-23 23:39:04.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:04.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:04.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:04.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:04.060 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: source:127.0.0.1 drop_table : tbl=hive.db_repl2.tbl_repl2
[INFO ] 2024-04-23 23:39:04.060 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db_repl2.tbl_repl2	
[DEBUG] 2024-04-23 23:39:04.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:04.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:04.061 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:04.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:04.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:04.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.227795ms
[DEBUG] 2024-04-23 23:39:04.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:04.062 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db_repl2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:04.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:04.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:04.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db_repl2 retrieved using SQL in 1.115113ms
[DEBUG] 2024-04-23 23:39:04.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:04.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:04.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:39:04.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:04.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:04.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:04.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:04.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:04.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:04.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:04.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:04.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:39:04.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:04.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:39:04.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:04.084 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:39:04.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:04.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:39:04.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:04.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:04.095 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1444625163 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:04.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:04.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:04.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:39:04.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:04.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:04.100 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:04.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:04.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:04.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:04.106 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:04.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:04.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:04.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:04.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:39:04.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db_repl2.tbl_repl2
[DEBUG] 2024-04-23 23:39:04.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:39:04.118 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:04.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:04.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:04.121 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:04.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:04.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:04.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:04.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:04.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db_repl2 along with all tables
[DEBUG] 2024-04-23 23:39:04.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:04.162 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:04.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:04.168 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:04.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:04.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:04.169 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:04.169 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db_repl2'>
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:04.171 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-5 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1765635170 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.172 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:04.172 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl2
[DEBUG] 2024-04-23 23:39:04.172 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/45719/db_repl2.db
[INFO ] 2024-04-23 23:39:04.173 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:39:04.173 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:04.173 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db_repl2
[DEBUG] 2024-04-23 23:39:04.173 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db_repl2.db
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911935820 end=1713911944174 duration=8354 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=4 error=false>
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:39:04.174 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 1
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2389ccad, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2e276e2f will be shutdown
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911944174 end=1713911944174 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=14 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:04.174 [main] MetastoreConf - Unable to find config file: hive-site.xml
[DEBUG] 2024-04-23 23:39:04.174 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:04.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 14: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:04.175 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:04.175 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:04.175 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:04.175 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:04.183 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:04.183 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:04.183 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:04.183 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:04.185 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:04.219 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[INFO ] 2024-04-23 23:39:04.681 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:39:04.681 [MetaStoreThread-34771] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:39:04.681 [MetaStoreThread-34771] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:04.681 [MetaStoreThread-34771] HMSHandler - 17: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_45719;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:39:04.682 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:04.683 [MetaStoreThread-34771] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - HikariPool-6 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - HikariPool-6 - configuration:
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:04.684 [MetaStoreThread-34771] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true"
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - poolName........................"HikariPool-6"
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:04.685 [MetaStoreThread-34771] HikariDataSource - HikariPool-6 - Starting...
[INFO ] 2024-04-23 23:39:04.686 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:04.686 [MetaStoreThread-34771] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:04.686 [MetaStoreThread-34771] HikariDataSource - HikariPool-6 - Start completed.
[DEBUG] 2024-04-23 23:39:04.787 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:04.788 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.789 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@871788486 (XID = 1145), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.790 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@34561368 (XID = 1147), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.792 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1406767241 (XID = 1149), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.793 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@297178739 (XID = 1151), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.794 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1469558777 (XID = 1153), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.795 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1152806588 (XID = 1155), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.797 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1335723654 (XID = 1157), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.798 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1789065719 (XID = 1159), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.798 [HikariPool-6 connection adder] HikariPool - HikariPool-6 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2dbb692b, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2dbb692b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6f30b336 created in the thread with id: 159
[DEBUG] 2024-04-23 23:39:04.891 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.892 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.892 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:04.987 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.164 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.181 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.219 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.236 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.241 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.354 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.382 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.389 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.395 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.398 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.399 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.399 [MetaStoreThread-34771] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:05.399 [MetaStoreThread-34771] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:05.400 [MetaStoreThread-34771] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2dbb692b from thread id: 159
[DEBUG] 2024-04-23 23:39:05.400 [MetaStoreThread-34771] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:05.400 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.403 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.406 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.406 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.406 [MetaStoreThread-34771] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:05.406 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.407 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.407 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.407 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.407 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.410 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.410 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - db details for db default retrieved using SQL in 2.111933ms
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:05.412 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.417 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.419 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.420 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.423 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.423 [MetaStoreThread-34771] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:05.423 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.423 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.426 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.429 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.431 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.433 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.434 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.435 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.436 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.436 [MetaStoreThread-34771] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.440 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.443 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.445 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.447 [MetaStoreThread-34771] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] PerfLogger - </PERFLOG method=init start=1713911944681 end=1713911945448 duration=767 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=17 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:05.448 [MetaStoreThread-34771] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Started the new metaserver on port [34771]...
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:05.449 [MetaStoreThread-34771] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:39:05.683 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:05.684 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 18: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:05.684 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:05.696 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771) is created
[INFO ] 2024-04-23 23:39:05.696 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 34771 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[INFO ] 2024-04-23 23:39:05.696 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:05.704 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:05.705 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34771]
[INFO ] 2024-04-23 23:39:05.705 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34771)
[INFO ] 2024-04-23 23:39:05.705 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34771) current connections: 2
[DEBUG] 2024-04-23 23:39:05.707 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.707 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911945707 end=1713911945707 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.708 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.708 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.708 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 create_database: Database(name:db4, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:05.708 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db4, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:39:05.710 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:05.711 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:05.712 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:05.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f7c4374, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:05.713 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:05.714 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f7c4374, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4bf11fd9 created in the thread with id: 176
[DEBUG] 2024-04-23 23:39:05.715 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.715 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.716 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.720 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.721 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.722 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:05.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:05.723 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f7c4374 from thread id: 176
[DEBUG] 2024-04-23 23:39:05.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.724 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.384547ms
[DEBUG] 2024-04-23 23:39:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db4, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:05.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.727 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.727 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db for database db4. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:39:05.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.734 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.735 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911945708 end=1713911945735 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.736 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.736 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.736 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 create_table_req: Table(tableName:tbl4, dbName:db4, owner:alex, createTime:1713911945, lastAccessTime:1713911945, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:39:05.736 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl4, dbName:db4, owner:alex, createTime:1713911945, lastAccessTime:1713911945, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:05.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.745 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 9.416694ms
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.746727ms
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:05.760 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771/db4.db/tbl4
[DEBUG] 2024-04-23 23:39:05.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.774 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.779 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.784 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.788 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.801 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911945736 end=1713911945802 duration=66 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.803 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.853 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:05.854 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771/db4.db/tbl4/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:39:05.858 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.860 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.864 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.876 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.877 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911945802 end=1713911945877 duration=75 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.877 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.883 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:05.884 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771/db4.db/tbl4/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:39:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.889 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.890 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.893 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.894 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.896 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.897 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911945878 end=1713911945897 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 add_partition : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.898 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.901 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.905 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:05.906 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/34771/db4.db/tbl4/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:39:05.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.911 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.912 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.915 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.918 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911945898 end=1713911945920 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911945921 end=1713911945921 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_table : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.522736ms
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.923 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.931 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911945921 end=1713911945933 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.933 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=12, comments=HMS client
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.933 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.939 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 5.0768ms + 0.010775ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:05.943 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.232754ms + 0.111023ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:05.946 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.202822ms + 0.421809ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:05.949 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.082216ms + 0.322385ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.951 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.175146ms + 0.202708ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:05.953 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.886394ms + 0.18288ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.956 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.938682ms + 0.125137ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.957 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.300804ms + 0.119363ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.959 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.572466ms + 0.265306ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.641292ms + 0.119539ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 27.442605ms
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.961 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911945933 end=1713911945961 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:05.972 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:05.973 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:05.973 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 alter_table: hive.db4.tbl4 newtbl=tbl4
[INFO ] 2024-04-23 23:39:05.973 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db4.tbl4 newtbl=tbl4	
[DEBUG] 2024-04-23 23:39:05.973 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.287976ms
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:05.974 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:05.975 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.975 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.27327ms
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.976 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.978 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:05.983 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:05.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:05.984 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.126471ms
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.985 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.988 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db4
[WARN ] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:05.991 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:05.993 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:05.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:05.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:05.995 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:05.999 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:06.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.002 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.003 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.004 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911945973 end=1713911946004 duration=31 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:06.005 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:06.005 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34771]
[INFO ] 2024-04-23 23:39:06.006 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34771)
[INFO ] 2024-04-23 23:39:06.006 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34771) current connections: 3
[DEBUG] 2024-04-23 23:39:06.006 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.006 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911946006 end=1713911946006 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=20 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.007 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.007 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.007 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: source:127.0.0.1 get_table_metas : tbl=hive.*dbfoo*.*
[INFO ] 2024-04-23 23:39:06.007 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*dbfoo*.*	
[INFO ] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7dca7529, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7dca7529, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@33a8c207 created in the thread with id: 189
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.008 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.010 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7dca7529 from thread id: 189
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.011 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*dbfoo.*, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911946007 end=1713911946017 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=20 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:06.017 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *dbfoo* tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:06.017 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@7dca7529, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@33a8c207 will be shutdown
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[INFO ] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911946017 end=1713911946017 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=20 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.017 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:06.018 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 20: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:06.018 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:06.019 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.27884ms + 0.007595ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:06.020 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.81912ms + 0.127464ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:06.021 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.315208ms + 0.389294ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:06.022 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.273548ms + 0.273763ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.022 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.286366ms + 0.185003ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:06.023 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.27199ms + 0.183617ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.023 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.27496ms + 0.181709ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.024 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.274403ms + 0.175685ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.383104ms + 0.419902ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.336001ms + 0.183291ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 7.851232ms
[DEBUG] 2024-04-23 23:39:06.025 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.026 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.026 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911946017 end=1713911946026 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:06.027 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:06.027 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:34771]
[INFO ] 2024-04-23 23:39:06.027 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:34771)
[INFO ] 2024-04-23 23:39:06.028 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:34771) current connections: 3
[DEBUG] 2024-04-23 23:39:06.028 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.028 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911946028 end=1713911946028 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=21 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.029 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.029 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.029 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: source:127.0.0.1 get_table_metas : tbl=hive.*db4*.*
[INFO ] 2024-04-23 23:39:06.029 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*db4*.*	
[INFO ] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fe32b6c, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:06.030 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fe32b6c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2eb6b0a6 created in the thread with id: 190
[DEBUG] 2024-04-23 23:39:06.031 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.031 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.031 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fe32b6c from thread id: 190
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 || tableType == :param4 ) params: hive, (?i).*db4.*, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:39:06.037 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.037 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911946029 end=1713911946038 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=21 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:06.038 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *db4* tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:06.038 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@1fe32b6c, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2eb6b0a6 will be shutdown
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db4.tbl4	
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911946038 end=1713911946038 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=21 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 21: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:06.038 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:06.039 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.00693ms + 0.00613ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:06.040 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.52251ms + 0.079974ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:06.041 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.23987ms + 0.324999ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:06.041 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.201088ms + 0.180606ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.042 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.21927ms + 0.153117ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:06.042 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.178162ms + 0.121442ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.042 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.188362ms + 0.149612ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.043 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.209146ms + 0.114506ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.043 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.270482ms + 0.326058ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.246571ms + 0.118579ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.80532ms
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.044 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911946038 end=1713911946044 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:06.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.048 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.048 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911946045 end=1713911946048 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.048 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.049 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.049 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:06.049 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:06.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911946049 end=1713911946052 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_database: db4
[INFO ] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db4	
[DEBUG] 2024-04-23 23:39:06.052 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.053 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.326511ms
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911946052 end=1713911946054 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.054 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_tables_by_type: db=@hive#db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:06.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.055 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.835397ms
[DEBUG] 2024-04-23 23:39:06.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.518768ms
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911946054 end=1713911946060 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:06.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.661594ms
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911946060 end=1713911946063 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.063 [main] HiveMetaStoreClient - Selecting dropDatabase method for db4 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:06.063 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.064 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.28701ms
[DEBUG] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_multi_table : db=db4 tbls=tbl4
[INFO ] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db4 tbls=tbl4	
[DEBUG] 2024-04-23 23:39:06.065 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.070 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.159635ms
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911946063 end=1713911946071 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:06.071 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:06.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.02855ms
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.571444ms
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:06.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.083 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.088 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:06.088 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:06.088 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.093 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.097 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:06.097 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:06.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.119 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:06.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.124 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.326112ms
[DEBUG] 2024-04-23 23:39:06.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.732306ms
[DEBUG] 2024-04-23 23:39:06.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:06.127 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.26205ms
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:06.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:06.129 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:06.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:06.149 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1925932541 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:06.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:06.156 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:06.156 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.156 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.157 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.159 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.160 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.161 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.162 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:06.163 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:06.163 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:06.164 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:06.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:06.164 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:08.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:08.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:08.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:08.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.99635ms
[DEBUG] 2024-04-23 23:39:08.170 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:08.171 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:08.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.878616ms
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:08.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.174 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:08.174 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:08.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:08.175 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:08.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.176 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:08.176 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:08.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.186677ms
[DEBUG] 2024-04-23 23:39:08.177 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.467659ms
[DEBUG] 2024-04-23 23:39:08.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:08.179 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.221583ms
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:08.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:08.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:08.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:08.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:08.182 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:08.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:08.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:08.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:08.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:08.184 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:10.184 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:10.184 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:10.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:10.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.187 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:10.187 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.878786ms
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.508416ms
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:10.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.190 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:10.190 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:10.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:10.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.192 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.22341ms
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.48358ms
[DEBUG] 2024-04-23 23:39:10.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.870794ms
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:10.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:10.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:10.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:10.197 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:10.198 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:10.199 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:10.199 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:10.199 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:12.200 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:12.200 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:12.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:12.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.203 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:12.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.203 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.438593ms
[DEBUG] 2024-04-23 23:39:12.204 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:12.204 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:12.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.839811ms
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:12.205 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.206 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:12.206 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:12.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:12.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:12.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.208 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:12.208 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:12.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.901644ms
[DEBUG] 2024-04-23 23:39:12.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.711594ms
[DEBUG] 2024-04-23 23:39:12.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.853761ms
[DEBUG] 2024-04-23 23:39:12.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:12.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:12.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:12.213 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:12.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:12.215 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:12.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:12.216 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:14.216 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:14.217 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:14.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:14.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.219 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 4.016902ms
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:14.221 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.05272ms
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:14.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.224 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:14.224 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:14.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.225 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:14.225 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:14.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.226 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.227 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.948899ms
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.545116ms
[DEBUG] 2024-04-23 23:39:14.228 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:14.229 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.919968ms
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:14.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:14.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:14.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:14.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.233 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:14.234 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:14.234 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:14.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:14.234 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:14.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:14.235 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:16.235 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:16.235 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:16.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:16.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.239 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 4.362664ms
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:16.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.087628ms
[DEBUG] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:16.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.243 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:16.243 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:16.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.245 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:16.245 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:16.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.246 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:16.246 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:16.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.896172ms
[DEBUG] 2024-04-23 23:39:16.247 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.452247ms
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.726168ms
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:16.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:16.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:16.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:16.251 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:16.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:16.253 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:16.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:16.253 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:16.408 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:18.254 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:18.254 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:18.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:18.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.257 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:18.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.376287ms
[DEBUG] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:18.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.06892ms
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:18.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.261 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:18.261 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:18.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.262 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:18.263 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:18.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.264 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:18.264 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:18.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 1.004546ms
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.462285ms
[DEBUG] 2024-04-23 23:39:18.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:18.266 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.771501ms
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:18.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:18.268 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:18.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:18.270 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:18.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:18.270 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:20.271 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:20.271 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:20.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:20.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.164742ms
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:20.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.589043ms
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:20.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.276 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:20.276 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:20.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.278 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:20.278 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:20.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.79218ms
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.453715ms
[DEBUG] 2024-04-23 23:39:20.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.822272ms
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:20.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:20.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:20.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:20.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:20.283 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:20.284 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:21.009 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:21.013 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:22.285 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:22.285 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:22.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:22.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.288 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:22.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 2.95511ms
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.519584ms
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:22.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.291 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:22.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.842868ms
[DEBUG] 2024-04-23 23:39:22.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.476534ms
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.829591ms
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:22.295 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:22.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:22.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:22.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:22.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:22.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:22.299 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:22.299 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:22.299 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:24.300 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:24.300 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:24.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:24.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.303 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.327808ms
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:24.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.697923ms
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:24.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.306 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:24.306 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:24.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.307 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:24.307 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:24.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.308 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.769017ms
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.448599ms
[DEBUG] 2024-04-23 23:39:24.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.768776ms
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:24.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:24.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:24.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:24.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:24.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:24.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:24.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:24.314 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:24.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:24.314 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:24.560 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:26.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 drop_database: @hive#db4
[INFO ] 2024-04-23 23:39:26.315 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db4	
[DEBUG] 2024-04-23 23:39:26.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:26.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.318 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 3.474093ms
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_tables: db=@hive#db4
[INFO ] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db4	
[DEBUG] 2024-04-23 23:39:26.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.695042ms
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_functions: db=@hive#db4 pat=*
[INFO ] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db4 pat=*	
[DEBUG] 2024-04-23 23:39:26.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.321 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:26.321 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:26.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.322 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:26.322 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:26.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.323 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:26.323 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db4 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:26.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.951155ms
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.538214ms
[DEBUG] 2024-04-23 23:39:26.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db4 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db4.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db4 retrieved using SQL in 0.843811ms
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db4 along with all tables
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:26.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:26.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:26.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:26.328 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db4'>
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:26.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:26.330 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-6 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986724630 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:26.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:26.330 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:26.330 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911946072 end=1713911966330 duration=20258 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=19 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:39:26.332 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:39:26.332 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:26.332 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:26.332 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:26.344 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:26.344 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:26.344 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:26.344 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:26.346 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:26.386 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[INFO ] 2024-04-23 23:39:26.909 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:39:26.909 [MetaStoreThread-33211] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:39:26.910 [MetaStoreThread-33211] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:26.910 [MetaStoreThread-33211] HMSHandler - 22: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34771;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:26.911 [MetaStoreThread-33211] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:26.912 [MetaStoreThread-33211] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:26.913 [MetaStoreThread-33211] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:26.913 [MetaStoreThread-33211] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:26.914 [MetaStoreThread-33211] HikariConfig - HikariPool-7 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:26.914 [MetaStoreThread-33211] HikariConfig - HikariPool-7 - configuration:
[DEBUG] 2024-04-23 23:39:26.914 [MetaStoreThread-33211] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true"
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - poolName........................"HikariPool-7"
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:26.915 [MetaStoreThread-33211] HikariDataSource - HikariPool-7 - Starting...
[INFO ] 2024-04-23 23:39:26.917 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:26.919 [MetaStoreThread-33211] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:26.919 [MetaStoreThread-33211] HikariDataSource - HikariPool-7 - Start completed.
[DEBUG] 2024-04-23 23:39:27.019 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:27.020 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.021 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@734422135 (XID = 1145), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.023 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@438791873 (XID = 1147), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.024 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1273600824 (XID = 1149), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.025 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1052058246 (XID = 1151), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.026 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1336386672 (XID = 1153), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.027 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1867856923 (XID = 1155), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.028 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1397582685 (XID = 1157), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.029 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1908263353 (XID = 1159), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.029 [HikariPool-7 connection adder] HikariPool - HikariPool-7 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@518fdf48, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@518fdf48, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@216b096e created in the thread with id: 193
[DEBUG] 2024-04-23 23:39:27.162 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.163 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.163 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.243 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.307 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.322 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.358 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.377 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.382 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.495 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.522 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.528 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.536 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.538 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@518fdf48 from thread id: 193
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:27.540 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.544 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.547 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.547 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.547 [MetaStoreThread-33211] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:27.547 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.548 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.548 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.548 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.548 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.551 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.551 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.552 [MetaStoreThread-33211] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] ObjectStore - db details for db default retrieved using SQL in 1.705796ms
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:27.553 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.558 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.560 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.561 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.563 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.563 [MetaStoreThread-33211] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:27.563 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.563 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.566 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.569 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.571 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.573 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.574 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.574 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.575 [MetaStoreThread-33211] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.579 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.582 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.584 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.586 [MetaStoreThread-33211] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.586 [MetaStoreThread-33211] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:27.586 [MetaStoreThread-33211] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:27.586 [MetaStoreThread-33211] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] PerfLogger - </PERFLOG method=init start=1713911966910 end=1713911967587 duration=677 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=22 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Started the new metaserver on port [33211]...
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:27.587 [MetaStoreThread-33211] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:39:27.910 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:27.910 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 23: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:27.910 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:27.914 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211) is created
[INFO ] 2024-04-23 23:39:27.914 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 33211 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[INFO ] 2024-04-23 23:39:27.915 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:27.918 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:27.918 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33211]
[INFO ] 2024-04-23 23:39:27.918 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33211)
[INFO ] 2024-04-23 23:39:27.919 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33211) current connections: 3
[DEBUG] 2024-04-23 23:39:27.919 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:27.919 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911967919 end=1713911967919 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:27.919 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 create_database: Database(name:db7, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db7, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:27.920 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68df8ab2, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:27.921 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:27.922 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68df8ab2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ceee6c8 created in the thread with id: 210
[DEBUG] 2024-04-23 23:39:27.922 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.923 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.924 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68df8ab2 from thread id: 210
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.925 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.686304ms
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db7, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:27.926 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db for database db7. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.927 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.928 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.929 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911967920 end=1713911967930 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 create_table_req: Table(tableName:tbl7, dbName:db7, owner:alex, createTime:1713911967, lastAccessTime:1713911967, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl7, dbName:db7, owner:alex, createTime:1713911967, lastAccessTime:1713911967, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:27.930 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.933 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.597233ms
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.934 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:27.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.938 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.938 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.939 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.939 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.079542ms
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:27.940 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:27.941 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db/tbl7
[DEBUG] 2024-04-23 23:39:27.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.946 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:27.950 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:27.953 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.958 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.962 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.966 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:27.979 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:27.981 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911967930 end=1713911967982 duration=52 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:27.982 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:27.992 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.016 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:28.021 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db/tbl7/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:39:28.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.030 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.038 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.041 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.042 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911967982 end=1713911968042 duration=60 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.042 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.042 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.047 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.048 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:28.049 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db/tbl7/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:39:28.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.054 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.059 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911968042 end=1713911968061 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 add_partition : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:28.067 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db/tbl7/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:39:28.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.073 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.078 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911968061 end=1713911968080 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911968080 end=1713911968080 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.080 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.081 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_table : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.081 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.359822ms
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.082 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.084 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.089 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:28.089 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:28.089 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911968081 end=1713911968089 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.090 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=10, comments=HMS client
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.095 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.532013ms + 0.006223ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:28.098 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.675856ms + 0.080384ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:28.100 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.658208ms + 0.336207ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:28.102 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.585545ms + 0.227119ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.104 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.697163ms + 0.126077ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:28.105 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.383681ms + 0.118576ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.107 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.562684ms + 0.119681ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.109 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.277946ms + 0.115919ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.110 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.363146ms + 0.251002ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.480922ms + 0.117251ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 21.691929ms
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.112 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911968090 end=1713911968112 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.122 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 alter_table: hive.db7.tbl7 newtbl=tbl7
[INFO ] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db7.tbl7 newtbl=tbl7	
[DEBUG] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.123 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.224258ms
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:28.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.125 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.274361ms
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.127 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.132 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.981587ms
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.137 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.137 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db7
[WARN ] 2024-04-23 23:39:28.138 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:28.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.139 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:28.140 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:28.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:28.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.147 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.149 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.150 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911968123 end=1713911968150 duration=27 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:28.153 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:28.153 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:33211]
[INFO ] 2024-04-23 23:39:28.153 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:33211)
[INFO ] 2024-04-23 23:39:28.154 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:33211) current connections: 4
[DEBUG] 2024-04-23 23:39:28.154 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911968154 end=1713911968155 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=25 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:39:28.155 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:28.156 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@58bde9c3, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@58bde9c3, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@137e10b created in the thread with id: 223
[DEBUG] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@58bde9c3 from thread id: 223
[DEBUG] 2024-04-23 23:39:28.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:28.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.165 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911968155 end=1713911968165 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=25 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:28.166 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:28.166 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@58bde9c3, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@137e10b will be shutdown
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911968166 end=1713911968166 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=25 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 25: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:28.166 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:28.167 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.907119ms + 0.005528ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:28.168 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.485177ms + 0.076028ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:28.168 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.195921ms + 0.268706ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:28.169 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.190787ms + 0.167588ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.169 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.237051ms + 0.115971ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:28.170 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.208336ms + 0.143216ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.170 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.204047ms + 0.116705ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.170 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.233183ms + 0.13825ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.290764ms + 0.243489ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.193775ms + 0.110673ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.396947ms
[DEBUG] 2024-04-23 23:39:28.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911968166 end=1713911968172 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:28.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911968172 end=1713911968175 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:28.175 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:28.176 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.178 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911968175 end=1713911968179 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_database: db7
[INFO ] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db7	
[DEBUG] 2024-04-23 23:39:28.179 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.390132ms
[DEBUG] 2024-04-23 23:39:28.180 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911968179 end=1713911968180 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.181 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_tables_by_type: db=@hive#db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:28.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.275409ms
[DEBUG] 2024-04-23 23:39:28.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.621059ms
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911968181 end=1713911968185 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:28.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.49133ms
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911968185 end=1713911968188 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.188 [main] HiveMetaStoreClient - Selecting dropDatabase method for db7 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:28.188 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.00682ms
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_multi_table : db=db7 tbls=tbl7
[INFO ] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db7 tbls=tbl7	
[DEBUG] 2024-04-23 23:39:28.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.193 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.193 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.941476ms
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911968188 end=1713911968194 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:28.194 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.953641ms
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:28.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.495987ms
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:28.196 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.203 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.207 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:28.207 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:28.207 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.211 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.214 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:28.214 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:28.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.235 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:28.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 1.079524ms
[DEBUG] 2024-04-23 23:39:28.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.672439ms
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.930063ms
[DEBUG] 2024-04-23 23:39:28.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:28.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:28.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:28.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:28.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:28.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:28.259 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:28.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:28.267 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:28.267 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.267 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.268 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.270 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.271 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.272 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.274 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:28.275 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:28.275 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:28.276 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:28.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:28.276 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:30.277 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:30.277 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:30.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:30.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.900099ms
[DEBUG] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:30.281 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.550051ms
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:30.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.284 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:30.284 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:30.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.286 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:30.286 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:30.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.286 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.876656ms
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.456395ms
[DEBUG] 2024-04-23 23:39:30.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:30.288 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.964537ms
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:30.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:30.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:30.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:30.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:30.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:30.292 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:30.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:30.293 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:32.149 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:32.293 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:32.293 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.296 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.483013ms
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:32.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.538571ms
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:32.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:32.301 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.862681ms
[DEBUG] 2024-04-23 23:39:32.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.512427ms
[DEBUG] 2024-04-23 23:39:32.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.808228ms
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:32.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:32.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:32.305 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:32.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:32.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:32.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:32.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:32.308 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:34.309 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:34.309 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:34.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:34.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.311 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 2.243661ms
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.487873ms
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:34.312 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:34.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:34.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:34.315 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:34.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.316 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:34.316 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:34.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.795717ms
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.460517ms
[DEBUG] 2024-04-23 23:39:34.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.835708ms
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:34.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:34.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:34.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.321 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:34.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:34.323 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:34.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:34.323 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:34.787 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:36.324 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:36.324 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:36.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:36.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.327 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.33052ms
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.552447ms
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:36.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.330 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:36.330 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:36.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.331 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:36.331 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:36.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.332 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.8679ms
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.477696ms
[DEBUG] 2024-04-23 23:39:36.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:36.334 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.854196ms
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:36.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:36.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:36.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:36.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.337 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:36.338 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:36.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:36.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:36.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:36.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:36.339 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:38.340 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_database: @hive#db7
[INFO ] 2024-04-23 23:39:38.340 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db7	
[DEBUG] 2024-04-23 23:39:38.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:38.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 3.172149ms
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_tables: db=@hive#db7
[INFO ] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db7	
[DEBUG] 2024-04-23 23:39:38.343 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.536708ms
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_functions: db=@hive#db7 pat=*
[INFO ] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db7 pat=*	
[DEBUG] 2024-04-23 23:39:38.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:38.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:38.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.347 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:38.347 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:38.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.348 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:38.348 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db7 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:38.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.885103ms
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.498425ms
[DEBUG] 2024-04-23 23:39:38.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:38.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:38.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.372 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.046498ms + 0.006148ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:39:38.376 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.607664ms + 0.006155ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.378 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.615849ms + 0.00498ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.380 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.758052ms + 0.005557ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.382 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.859934ms + 0.00614ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.384 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.861332ms + 0.006193ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.386 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.013327ms + 0.006154ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:38.389 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.5479ms + 0.005664ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.391 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.611528ms + 0.004697ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.393 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.684798ms + 0.005134ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.395 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.713327ms + 0.005654ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.397 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.505544ms + 0.006074ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.399 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.710514ms + 0.005222ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.401 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.836229ms + 0.005413ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 33.913507ms
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.403 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: source:127.0.0.1 drop_table : tbl=hive.db7.tbl7
[INFO ] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db7.tbl7	
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.863515ms
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.405 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db7 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db7 retrieved using SQL in 0.86844ms
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:38.407 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:38.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:39:38.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.425 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:38.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.433 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1794862668 (XID = 1143), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:38.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:38.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:38.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:38.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:39:38.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db7.tbl7
[DEBUG] 2024-04-23 23:39:38.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:39:38.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:38.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:38.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:38.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:38.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db7 along with all tables
[DEBUG] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:38.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:38.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:38.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.500 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db7'>
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:38.502 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-7 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@2030463411 (XID = 1141), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:38.503 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:38.503 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db7
[DEBUG] 2024-04-23 23:39:38.503 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/33211/db7.db
[INFO ] 2024-04-23 23:39:38.503 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:39:38.505 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:38.505 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db7
[DEBUG] 2024-04-23 23:39:38.505 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db7.db
[DEBUG] 2024-04-23 23:39:38.505 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911968194 end=1713911978505 duration=10311 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=5 error=false>
[INFO ] 2024-04-23 23:39:38.506 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68df8ab2, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ceee6c8 will be shutdown
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911978506 end=1713911978506 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=24 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:38.506 [main] MetastoreConf - Unable to find config file: hive-site.xml
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 24: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:38.506 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:38.507 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:38.507 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:38.507 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:38.518 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:38.518 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:38.518 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:38.518 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:38.519 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:38.566 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[INFO ] 2024-04-23 23:39:39.001 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:39:39.002 [MetaStoreThread-35243] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:39:39.003 [MetaStoreThread-35243] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] HMSHandler - 26: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:39.004 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_33211;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:39.005 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 10
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.006 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:39.007 [MetaStoreThread-35243] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:39.008 [MetaStoreThread-35243] HikariConfig - HikariPool-8 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:39.008 [MetaStoreThread-35243] HikariConfig - HikariPool-8 - configuration:
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true"
[DEBUG] 2024-04-23 23:39:39.009 [MetaStoreThread-35243] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - poolName........................"HikariPool-8"
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:39.010 [MetaStoreThread-35243] HikariDataSource - HikariPool-8 - Starting...
[INFO ] 2024-04-23 23:39:39.014 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:39.014 [MetaStoreThread-35243] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.015 [MetaStoreThread-35243] HikariDataSource - HikariPool-8 - Start completed.
[DEBUG] 2024-04-23 23:39:39.115 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:39.130 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.131 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1143947317 (XID = 1157), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.132 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1965114459 (XID = 1159), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.133 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@604028794 (XID = 1161), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.135 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@407565634 (XID = 1163), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.136 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@542009307 (XID = 1165), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.137 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@993002363 (XID = 1167), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.138 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1312702645 (XID = 1169), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.139 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2038402096 (XID = 1171), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.140 [HikariPool-8 connection adder] HikariPool - HikariPool-8 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:39.269 [MetaStoreThread-35243] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:39.269 [MetaStoreThread-35243] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2278b3dd, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:39.269 [MetaStoreThread-35243] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:39.270 [MetaStoreThread-35243] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2278b3dd, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2a07ce18 created in the thread with id: 226
[DEBUG] 2024-04-23 23:39:39.270 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.270 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.270 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.347 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.419 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.433 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.467 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.481 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.486 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.585 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.612 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.618 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.624 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.626 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2278b3dd from thread id: 226
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:39.628 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.631 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.633 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.634 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.635 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.635 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.637 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.637 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - db details for db default retrieved using SQL in 1.823713ms
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:39.639 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.644 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.646 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.647 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.649 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.649 [MetaStoreThread-35243] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:39.649 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.649 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:39.653 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.655 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:39.657 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.658 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:39.659 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:39.660 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:39.661 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:39.661 [MetaStoreThread-35243] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:39.664 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.667 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:39.669 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:39.671 [MetaStoreThread-35243] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:39.671 [MetaStoreThread-35243] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:39.671 [MetaStoreThread-35243] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] PerfLogger - </PERFLOG method=init start=1713911979003 end=1713911979672 duration=669 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=26 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Started the new metaserver on port [35243]...
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:39.672 [MetaStoreThread-35243] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:39:40.002 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:40.002 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 27: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.002 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:40.006 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35243) is created
[INFO ] 2024-04-23 23:39:40.006 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 35243 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/35243 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[INFO ] 2024-04-23 23:39:40.006 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:40.010 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:40.010 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35243]
[INFO ] 2024-04-23 23:39:40.010 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35243)
[INFO ] 2024-04-23 23:39:40.010 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35243) current connections: 3
[DEBUG] 2024-04-23 23:39:40.010 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.010 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911980010 end=1713911980010 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.014 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.015 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_catalog from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 create_catalog: Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3)
[INFO ] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_catalog: Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3)	
[INFO ] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.016 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@786b877, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:40.017 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:40.018 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@786b877, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@555e18e4 created in the thread with id: 243
[DEBUG] 2024-04-23 23:39:40.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.018 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.019 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@786b877 from thread id: 243
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:39:40.020 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Creating catalog Catalog(name:cat3, locationUri:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3, createTime:1713911980)
[DEBUG] 2024-04-23 23:39:40.021 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.025 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:39:40.027 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.028 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.029 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.030 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.030 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_catalog start=1713911980015 end=1713911980030 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 create_database: Database(name:db3, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:cat3, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db3, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:cat3, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:39:40.031 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.006049ms
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database cat3.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:39:40.032 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.033 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.034 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.035 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.035 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911980031 end=1713911980035 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.035 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.035 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.036 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 create_table_req: Table(tableName:tbl3, dbName:db3, owner:alex, createTime:1713911980, lastAccessTime:1713911980, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:do, type:double, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:cat3, ownerType:USER)
[INFO ] 2024-04-23 23:39:40.036 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl3, dbName:db3, owner:alex, createTime:1713911980, lastAccessTime:1713911980, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:b, type:binary, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:do, type:double, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:cat3, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:40.036 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.038 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.215864ms
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.039 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.043 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.95099ms
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.045 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.049 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.052 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.057 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.062 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.066 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.078 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.080 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.080 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911980035 end=1713911980080 duration=45 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.081 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.105 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.128 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:39:40.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:39:40.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.137 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.149 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.150 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911980081 end=1713911980150 duration=69 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.151 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.158 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.159 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.163 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.166 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911980152 end=1713911980166 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.167 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updating partition stats fast for: tbl3
[INFO ] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] MetaStoreServerUtils - Updated size to 0
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.174 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.178 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.180 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.181 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911980167 end=1713911980181 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911980182 end=1713911980182 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_table : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.182 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.277445ms
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.189 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.190 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911980182 end=1713911980191 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.191 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.191 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:40.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.192 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.195 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.193951ms + 0.006043ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.198 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.74258ms + 0.09938ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.201 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.594136ms + 0.615431ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:40.203 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.444716ms + 0.241413ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.204 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.487351ms + 0.127365ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:40.206 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.565851ms + 0.124858ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.208 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.353433ms + 0.122851ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.209 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.239954ms + 0.120669ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.211 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.359611ms + 0.316753ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.386151ms + 0.121322ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.562161ms
[DEBUG] 2024-04-23 23:39:40.212 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.213 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.213 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911980191 end=1713911980213 duration=22 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.214 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.215 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.215 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 alter_table: cat3.db3.tbl3 newtbl=tbl3
[INFO ] 2024-04-23 23:39:40.215 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: cat3.db3.tbl3 newtbl=tbl3	
[DEBUG] 2024-04-23 23:39:40.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.230944ms
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.03077ms
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.223 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.224 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.960678ms
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db3
[WARN ] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:40.231 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:40.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.239 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.240 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911980215 end=1713911980240 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:40.241 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:40.241 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35243]
[INFO ] 2024-04-23 23:39:40.241 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35243)
[INFO ] 2024-04-23 23:39:40.241 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35243) current connections: 4
[DEBUG] 2024-04-23 23:39:40.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911980241 end=1713911980242 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=29 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:39:40.242 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68608c09, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68608c09, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@64a3ab1f created in the thread with id: 244
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68608c09 from thread id: 244
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:39:40.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911980242 end=1713911980251 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=29 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:40.251 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:40.251 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[INFO ] 2024-04-23 23:39:40.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@68608c09, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@64a3ab1f will be shutdown
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911980251 end=1713911980252 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=29 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 29: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:40.252 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.908093ms + 0.005013ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.253 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.398386ms + 0.063728ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.254 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.147945ms + 0.545513ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:40.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.154003ms + 0.214385ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156563ms + 0.103532ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:40.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.143923ms + 0.099779ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.177074ms + 0.098744ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.256 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.152103ms + 0.100037ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.256 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.199053ms + 0.258759ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.166656ms + 0.1023ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.162592ms
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.257 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911980251 end=1713911980257 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:40.258 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:40.258 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:35243]
[INFO ] 2024-04-23 23:39:40.258 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:35243)
[INFO ] 2024-04-23 23:39:40.259 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:35243) current connections: 4
[DEBUG] 2024-04-23 23:39:40.259 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.259 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911980259 end=1713911980259 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=30 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: source:127.0.0.1 get_table_metas : tbl=cat3.*.*
[INFO ] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=cat3.*.*	
[INFO ] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:40.260 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15fd0b04, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15fd0b04, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@24221cf9 created in the thread with id: 245
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.261 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15fd0b04 from thread id: 245
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: cat3, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:40.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.264 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.264 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911980260 end=1713911980264 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=30 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:40.264 [main] PartitionManagementTask - Looking for tables using catalog: cat3 dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:40.265 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@15fd0b04, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@24221cf9 will be shutdown
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911980265 end=1713911980265 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=30 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 30: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:40.265 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:40.266 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.912383ms + 0.005282ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.267 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.525098ms + 0.06641ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:40.268 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.159518ms + 0.565748ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:40.268 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.155699ms + 0.149543ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.269 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.186315ms + 0.103095ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:40.269 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.137115ms + 0.101953ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.269 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156823ms + 0.129919ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.155264ms + 0.129368ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.175309ms + 0.245405ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.16504ms + 0.130188ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.369391ms
[DEBUG] 2024-04-23 23:39:40.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.271 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.271 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911980265 end=1713911980271 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:40.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.274 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.274 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.274 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911980272 end=1713911980274 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_databases: @cat3#
[INFO ] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @cat3#	
[DEBUG] 2024-04-23 23:39:40.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.277 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911980275 end=1713911980278 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_database: db3
[INFO ] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db3	
[DEBUG] 2024-04-23 23:39:40.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.003864ms
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911980278 end=1713911980279 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.279 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.279 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_tables_by_type: db=@hive#db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.676439ms
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:40.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.800591ms
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911980279 end=1713911980283 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.283 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.284 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@hive#db3
[INFO ] 2024-04-23 23:39:40.284 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db3	
[DEBUG] 2024-04-23 23:39:40.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.47645ms
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911980283 end=1713911980286 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.286 [main] HiveMetaStoreClient - Selecting dropDatabase method for db3 (0 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:40.286 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.286 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.607208ms
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db3, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_multi_table : db=db3 tbls=
[INFO ] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db3 tbls=	
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911980286 end=1713911980287 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:40.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.962512ms
[DEBUG] 2024-04-23 23:39:40.288 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.579918ms
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:39:40.289 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.297 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.301 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:40.301 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:40.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.305 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.307 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:40.308 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:40.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.326 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.330 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.001956ms
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.521353ms
[DEBUG] 2024-04-23 23:39:40.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.967727ms
[DEBUG] 2024-04-23 23:39:40.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:39:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:40.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:40.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:40.350 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:40.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:40.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:40.359 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (3).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:42.361 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_database: @cat3#db3
[INFO ] 2024-04-23 23:39:42.361 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#db3	
[DEBUG] 2024-04-23 23:39:42.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.364 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 3.34154ms
[DEBUG] 2024-04-23 23:39:42.365 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@cat3#db3
[INFO ] 2024-04-23 23:39:42.365 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#db3	
[DEBUG] 2024-04-23 23:39:42.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.674762ms
[DEBUG] 2024-04-23 23:39:42.367 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_functions: db=@cat3#db3 pat=*
[INFO ] 2024-04-23 23:39:42.367 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#db3 pat=*	
[DEBUG] 2024-04-23 23:39:42.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.368 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:42.368 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:42.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.369 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:42.369 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:42.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.370 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:42.370 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=db3 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:42.370 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 1.049802ms
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.470764ms
[DEBUG] 2024-04-23 23:39:42.371 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.384 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:42.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:42.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.393 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.005514ms + 0.006343ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:39:42.398 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.590606ms + 0.006373ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.400 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.928029ms + 0.006236ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.401 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.636504ms + 0.005852ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.403 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.995574ms + 0.006264ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.405 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.651233ms + 0.006044ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.407 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.742595ms + 0.005846ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:42.410 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.418214ms + 0.006286ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.412 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.489699ms + 0.004802ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.413 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.316975ms + 0.004557ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.414 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.375389ms + 0.004937ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.417 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.362687ms + 0.005766ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.419 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.569378ms + 0.005451ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.421 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.150431ms + 0.005342ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 32.414454ms
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:42.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_table : tbl=cat3.db3.tbl3
[INFO ] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=cat3.db3.tbl3	
[DEBUG] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.424 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.89644ms
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db3 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db3 retrieved using SQL in 0.773715ms
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:42.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:39:42.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:42.446 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.450 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@85084686 (XID = 1155), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:39:42.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:42.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:42.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:42.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:42.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:42.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:39:42.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for cat3.db3.tbl3
[DEBUG] 2024-04-23 23:39:42.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:39:42.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:42.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:42.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:42.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:42.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.db3 along with all tables
[DEBUG] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:42.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: db3 belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.515 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.515 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:42.515 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db3
[DEBUG] 2024-04-23 23:39:42.516 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db
[INFO ] 2024-04-23 23:39:42.516 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db3
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db
[WARN ] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db does not exist; Force to delete it.
[ERROR] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3/db3.db
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911980287 end=1713911982517 duration=2230 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=1 error=false>
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_database: default
[INFO ] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: default	
[DEBUG] 2024-04-23 23:39:42.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.518 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3] desc [Default database for catalog cat3] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 1.313157ms
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911982517 end=1713911982519 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.519 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_tables_by_type: db=@hive#default pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#default pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=default pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=default pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external] desc [Default Hive database] owner [public] ownertype [ROLE]
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 1.289438ms
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.717413ms
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911982519 end=1713911982521 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.521 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@hive#default
[INFO ] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#default	
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.651419ms
[DEBUG] 2024-04-23 23:39:42.522 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911982522 end=1713911982522 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.522 [main] HiveMetaStoreClient - Selecting dropDatabase method for default (0 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:42.522 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:42.523 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.523 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.523 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external] desc [Default Hive database] owner [public] ownertype [ROLE]
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 1.104289ms
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_multi_table : db=default tbls=
[INFO ] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=default tbls=	
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911982523 end=1713911982524 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_database: @cat3#default
[INFO ] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @cat3#default	
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3] desc [Default database for catalog cat3] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 0.785246ms
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_tables: db=@cat3#default
[INFO ] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@cat3#default	
[DEBUG] 2024-04-23 23:39:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.481396ms
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_functions: db=@cat3#default pat=*
[INFO ] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@cat3#default pat=*	
[DEBUG] 2024-04-23 23:39:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.527 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:42.527 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=default pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=cat3: db=default pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:42.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db default locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3] desc [Default database for catalog cat3] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db default retrieved using SQL in 0.833587ms
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.481197ms
[INFO ] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database cat3.default along with all tables
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Skipping cleanup because db: default belongs to catalog other than default catalog: cat3
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.533 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.533 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:42.533 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: default
[DEBUG] 2024-04-23 23:39:42.533 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[DEBUG] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: default
[DEBUG] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[WARN ] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3 does not exist; Force to delete it.
[ERROR] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[DEBUG] 2024-04-23 23:39:42.534 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911982524 end=1713911982534 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.536 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_catalog from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 drop_catalog: cat3
[INFO ] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_catalog: cat3	
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog cat3
[DEBUG] 2024-04-23 23:39:42.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.539 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_databases: @cat3#
[INFO ] 2024-04-23 23:39:42.539 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @cat3#	
[DEBUG] 2024-04-23 23:39:42.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping catalog cat3
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:42.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:42.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:42.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.542 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[WARN ] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileUtils - File file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3 does not exist; Force to delete it.
[ERROR] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] FileUtils - Failed to delete file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/cat3
[DEBUG] 2024-04-23 23:39:42.543 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_catalog start=1713911982537 end=1713911982543 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-8 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@365954077 (XID = 1153), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:42.544 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911982544 end=1713911982544 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:42.545 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@786b877, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@555e18e4 will be shutdown
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911982545 end=1713911982545 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=28 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 28: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:42.545 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:42.545 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:39:42.546 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:42.546 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:42.546 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:42.555 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:42.555 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:42.555 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:42.555 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:42.556 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:42.587 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[INFO ] 2024-04-23 23:39:43.025 [MetaStoreThread-38811] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:39:43.025 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:39:43.025 [MetaStoreThread-38811] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] HMSHandler - 31: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_35243;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:43.026 [MetaStoreThread-38811] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:43.027 [MetaStoreThread-38811] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - HikariPool-9 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - HikariPool-9 - configuration:
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:43.028 [MetaStoreThread-38811] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true"
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - poolName........................"HikariPool-9"
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:43.029 [MetaStoreThread-38811] HikariDataSource - HikariPool-9 - Starting...
[INFO ] 2024-04-23 23:39:43.030 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:43.031 [MetaStoreThread-38811] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.031 [MetaStoreThread-38811] HikariDataSource - HikariPool-9 - Start completed.
[DEBUG] 2024-04-23 23:39:43.131 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:43.132 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.134 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1881811780 (XID = 1151), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.135 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1099996754 (XID = 1153), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.136 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@268817419 (XID = 1155), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.137 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1054594446 (XID = 1157), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.138 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@340502719 (XID = 1159), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.140 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1779171005 (XID = 1161), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.141 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@227627647 (XID = 1163), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.142 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1405309175 (XID = 1165), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.142 [HikariPool-9 connection adder] HikariPool - HikariPool-9 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5fbbae94, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5fbbae94, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3899cac2 created in the thread with id: 248
[DEBUG] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.239 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.240 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.313 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.419 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.435 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.468 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.486 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.491 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.600 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.624 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.631 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.636 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.639 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.640 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.640 [MetaStoreThread-38811] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:43.640 [MetaStoreThread-38811] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:43.641 [MetaStoreThread-38811] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5fbbae94 from thread id: 248
[DEBUG] 2024-04-23 23:39:43.641 [MetaStoreThread-38811] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:43.641 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.645 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.647 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.647 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.647 [MetaStoreThread-38811] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:43.648 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.648 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.648 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.649 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.649 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.651 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.651 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - db details for db default retrieved using SQL in 1.78411ms
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:43.653 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.659 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.660 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.661 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.664 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.664 [MetaStoreThread-38811] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:43.664 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.664 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:43.668 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.670 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:43.673 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.674 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:43.675 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:43.676 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:43.677 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:43.677 [MetaStoreThread-38811] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:43.680 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.682 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:43.685 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:43.686 [MetaStoreThread-38811] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:43.686 [MetaStoreThread-38811] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] PerfLogger - </PERFLOG method=init start=1713911983025 end=1713911983687 duration=662 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=31 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Started the new metaserver on port [38811]...
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:43.687 [MetaStoreThread-38811] HiveMetaStore - Direct SQL optimization = true
[INFO ] 2024-04-23 23:39:44.027 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 38811 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[INFO ] 2024-04-23 23:39:44.027 [main] TestTxnDbUtil - Creating transactional tables
[DEBUG] 2024-04-23 23:39:44.027 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:44.028 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 32: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:44.028 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:44.036 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:44.036 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38811]
[INFO ] 2024-04-23 23:39:44.036 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38811)
[INFO ] 2024-04-23 23:39:44.036 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38811) current connections: 3
[DEBUG] 2024-04-23 23:39:44.037 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.038 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911984037 end=1713911984038 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.038 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.039 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.039 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 create_database: Database(name:db6, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:44.039 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db6, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:44.041 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@349f64ab, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:44.042 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:44.044 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@349f64ab, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b451e1b created in the thread with id: 263
[DEBUG] 2024-04-23 23:39:44.045 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.045 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.046 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.049 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@349f64ab from thread id: 263
[DEBUG] 2024-04-23 23:39:44.051 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.778281ms
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db6, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:44.053 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.056 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.056 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.056 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db for database db6. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.059 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.063 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911984039 end=1713911984063 duration=24 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.064 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.065 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.065 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 create_table_req: Table(tableName:tbl6, dbName:db6, owner:alex, createTime:1713911984, lastAccessTime:1713911984, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:39:44.065 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl6, dbName:db6, owner:alex, createTime:1713911984, lastAccessTime:1713911984, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:44.066 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.074 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 9.916988ms
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.075 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.076 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.086 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.086 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.087 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.088 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 2.514312ms
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.089 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:44.091 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db/tbl6
[DEBUG] 2024-04-23 23:39:44.097 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.098 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.101 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.105 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.111 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.116 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.122 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.136 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.137 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911984065 end=1713911984137 duration=72 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.137 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.169 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.175 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:44.176 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db/tbl6/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:39:44.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.181 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.184 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.191 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.193 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911984138 end=1713911984194 duration=56 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.201 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:44.202 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db/tbl6/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:39:44.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.206 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.214 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.216 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911984195 end=1713911984216 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 add_partition : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.217 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.220 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.223 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.224 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:44.225 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db/tbl6/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:39:44.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.235 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911984217 end=1713911984237 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911984237 end=1713911984237 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.238 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.182962ms
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:44.244 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911984237 end=1713911984245 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.245 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.249 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.466408ms + 0.006623ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:44.252 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.626369ms + 0.086747ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:44.254 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.589804ms + 0.251013ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:44.255 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.370301ms + 0.222166ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.257 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.427266ms + 0.11932ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:44.258 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.259608ms + 0.116174ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.260 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.287259ms + 0.117235ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.261 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.212321ms + 0.114197ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.263 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.388815ms + 0.284996ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.324212ms + 0.138577ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 19.254441ms
[DEBUG] 2024-04-23 23:39:44.264 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.265 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911984245 end=1713911984265 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 alter_table: hive.db6.tbl6 newtbl=tbl6
[INFO ] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db6.tbl6 newtbl=tbl6	
[DEBUG] 2024-04-23 23:39:44.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.169195ms
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.277 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.96608ms
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.278 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.282 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.283 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.284 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.009914ms
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.287 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[WARN ] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.290 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:44.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.293 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:44.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:44.297 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.300 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.301 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.303 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911984275 end=1713911984303 duration=28 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:44.304 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:44.304 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:38811]
[INFO ] 2024-04-23 23:39:44.304 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:38811)
[INFO ] 2024-04-23 23:39:44.304 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:38811) current connections: 4
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911984305 end=1713911984305 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:39:44.305 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@698f8b04, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@698f8b04, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ce21b78 created in the thread with id: 276
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@698f8b04 from thread id: 276
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:44.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.313 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.313 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911984305 end=1713911984313 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:44.313 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:44.313 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:44.313 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@698f8b04, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1ce21b78 will be shutdown
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911984313 end=1713911984314 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=34 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 34: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:44.314 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:44.315 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.947632ms + 0.017316ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:44.315 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.411054ms + 0.072766ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:44.316 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.154027ms + 0.213066ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:44.316 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.143915ms + 0.142907ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.317 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.16859ms + 0.100869ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:44.317 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15462ms + 0.099117ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.317 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150317ms + 0.09831ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.317 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.148601ms + 0.098583ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.179335ms + 0.2108ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15523ms + 0.100734ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.414897ms
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911984314 end=1713911984318 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:44.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911984319 end=1713911984321 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:44.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.323 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911984321 end=1713911984324 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_database: db6
[INFO ] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db6	
[DEBUG] 2024-04-23 23:39:44.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.051169ms
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911984324 end=1713911984325 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.325 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.325 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_tables_by_type: db=@hive#db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.326 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.019656ms
[DEBUG] 2024-04-23 23:39:44.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.424119ms
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911984325 end=1713911984329 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.329 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.330 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:44.330 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:44.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.363014ms
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911984329 end=1713911984332 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.332 [main] HiveMetaStoreClient - Selecting dropDatabase method for db6 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:44.332 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.946017ms
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_multi_table : db=db6 tbls=tbl6
[INFO ] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db6 tbls=tbl6	
[DEBUG] 2024-04-23 23:39:44.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.97181ms
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911984332 end=1713911984338 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:44.338 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.854748ms
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:44.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.445678ms
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:44.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.347 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.350 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:44.350 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:44.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.354 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.357 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:44.357 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:44.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.378 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.986112ms
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.566726ms
[DEBUG] 2024-04-23 23:39:44.379 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.924949ms
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:44.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:44.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:44.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:44.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:44.402 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:44.403 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:44.403 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.403 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.404 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.405 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.407 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.408 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.409 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:44.410 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:44.410 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.410 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:44.411 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:44.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:44.412 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:46.409 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:46.413 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:46.413 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:46.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:46.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.416 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.718717ms
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:46.417 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.525074ms
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:46.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.420 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:46.420 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:46.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.421 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:46.421 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:46.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.422 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.797696ms
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.452369ms
[DEBUG] 2024-04-23 23:39:46.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.424 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:46.424 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.963382ms
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:46.425 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:46.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:46.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:46.426 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:46.427 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:46.428 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:46.428 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:46.428 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:48.429 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:48.429 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:48.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:48.429 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.253854ms
[DEBUG] 2024-04-23 23:39:48.432 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:48.433 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:48.433 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.07004ms
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:48.434 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:48.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:48.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.436 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:48.436 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:48.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.73358ms
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.4251ms
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.6981ms
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:48.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:48.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:48.440 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:48.441 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:48.442 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:50.443 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:50.443 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:50.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:50.443 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.446 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.283924ms
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:50.447 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.795054ms
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:50.448 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.449 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:50.449 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:50.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.451 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:50.451 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:50.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.451 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.922922ms
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.465079ms
[DEBUG] 2024-04-23 23:39:50.452 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.453 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:50.453 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.764812ms
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:50.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:50.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:50.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:50.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:50.457 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:50.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:50.457 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:51.010 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:51.014 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:52.458 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:52.458 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:52.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:52.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.259657ms
[DEBUG] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:52.461 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:52.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.490091ms
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:52.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.464 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:52.464 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:52.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.465 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:52.465 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:52.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.466 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:52.466 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:52.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.791725ms
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.450943ms
[DEBUG] 2024-04-23 23:39:52.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.737227ms
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:52.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:52.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:52.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:52.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:52.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:52.472 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:52.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:52.472 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:54.473 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:54.473 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:54.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.175796ms
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:54.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.495262ms
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:54.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.478 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:54.478 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:54.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.728349ms
[DEBUG] 2024-04-23 23:39:54.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.42657ms
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.844413ms
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:54.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:54.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:54.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:54.485 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:39:54.560 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:39:56.486 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_database: @hive#db6
[INFO ] 2024-04-23 23:39:56.486 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db6	
[DEBUG] 2024-04-23 23:39:56.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:56.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.489 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 3.760312ms
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_tables: db=@hive#db6
[INFO ] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db6	
[DEBUG] 2024-04-23 23:39:56.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.525097ms
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_functions: db=@hive#db6 pat=*
[INFO ] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db6 pat=*	
[DEBUG] 2024-04-23 23:39:56.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.492 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:56.492 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:56.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.493 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:56.493 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:56.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db6 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.494 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.752333ms
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.494082ms
[DEBUG] 2024-04-23 23:39:56.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:56.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:56.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.518 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.731642ms + 0.004355ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:39:56.522 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.56166ms + 0.004669ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.523 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.613672ms + 0.004836ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.525 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.580241ms + 0.004169ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.527 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.533078ms + 0.004732ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.528 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.640684ms + 0.004688ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.530 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.779588ms + 0.004976ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:39:56.534 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.382644ms + 0.004258ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.535 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.559259ms + 0.004164ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.537 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.543944ms + 0.004485ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.538 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.438367ms + 0.004089ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.540 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.013847ms + 0.003993ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.542 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.328944ms + 0.003737ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.544 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.690807ms + 0.004167ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 31.487127ms
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: source:127.0.0.1 drop_table : tbl=hive.db6.tbl6
[INFO ] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db6.tbl6	
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 1.020123ms
[DEBUG] 2024-04-23 23:39:56.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db6 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db6 retrieved using SQL in 0.89963ms
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:56.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.549 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:56.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:39:56.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.565 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:39:56.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:39:56.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:56.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.573 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@823599487 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:56.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:39:56.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:56.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:39:56.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db6.tbl6
[DEBUG] 2024-04-23 23:39:56.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:39:56.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:56.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:39:56.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:56.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:56.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:39:56.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.629 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:56.629 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.629 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6' AND "TC_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6' AND "CTC_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.633 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6' AND "CQ_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6' AND "CC_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.636 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6' AND "T2W_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.637 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6' AND "NWI_TABLE"='tbl6'>
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db6 along with all tables
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:56.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:56.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:56.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:56.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:56.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.645 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.646 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db6'>
[DEBUG] 2024-04-23 23:39:56.646 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:56.646 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-9 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1639910556 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[DEBUG] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/38811/db6.db
[INFO ] 2024-04-23 23:39:56.647 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db6
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db6.db
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911984338 end=1713911996649 duration=12311 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=6 error=false>
[INFO ] 2024-04-23 23:39:56.649 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:56.649 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@349f64ab, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@1b451e1b will be shutdown
[DEBUG] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911996649 end=1713911996650 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=33 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 33: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:56.650 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:56.650 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:39:56.650 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:39:56.651 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:39:56.651 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:39:56.658 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:39:56.658 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:39:56.658 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:39:56.658 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:39:56.659 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:56.687 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:57.019 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:57.084 [MetaStoreThread-37041] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:39:57.084 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:39:57.084 [MetaStoreThread-37041] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] HMSHandler - 35: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_38811;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:39:57.085 [MetaStoreThread-37041] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:39:57.086 [MetaStoreThread-37041] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - HikariPool-10 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - HikariPool-10 - configuration:
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:39:57.087 [MetaStoreThread-37041] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true"
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - poolName........................"HikariPool-10"
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:39:57.088 [MetaStoreThread-37041] HikariDataSource - HikariPool-10 - Starting...
[INFO ] 2024-04-23 23:39:57.089 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:39:57.089 [MetaStoreThread-37041] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:57.089 [MetaStoreThread-37041] HikariDataSource - HikariPool-10 - Start completed.
[DEBUG] 2024-04-23 23:39:57.190 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:39:57.191 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.192 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1577291473 (XID = 1163), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.194 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1863824470 (XID = 1165), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.195 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1043100062 (XID = 1167), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.196 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1137587713 (XID = 1169), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.197 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@979544835 (XID = 1171), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.198 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1441880004 (XID = 1173), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.199 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1633098643 (XID = 1175), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.200 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@833465402 (XID = 1177), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.200 [HikariPool-10 connection adder] HikariPool - HikariPool-10 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:39:57.335 [MetaStoreThread-37041] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:39:57.335 [MetaStoreThread-37041] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@303fedb5, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:57.335 [MetaStoreThread-37041] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:57.335 [MetaStoreThread-37041] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@303fedb5, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2d515d5b created in the thread with id: 279
[DEBUG] 2024-04-23 23:39:57.335 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.335 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.336 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.419 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.477 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.491 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.527 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.541 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.546 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.648 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.672 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.678 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.683 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.685 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.687 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.687 [MetaStoreThread-37041] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:57.687 [MetaStoreThread-37041] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:57.687 [MetaStoreThread-37041] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@303fedb5 from thread id: 279
[DEBUG] 2024-04-23 23:39:57.687 [MetaStoreThread-37041] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:57.687 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:57.690 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.693 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:57.693 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:57.693 [MetaStoreThread-37041] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:39:57.693 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:57.694 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:57.694 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.694 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:57.694 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:57.697 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.697 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:57.699 [MetaStoreThread-37041] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:57.699 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:57.699 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.699 [MetaStoreThread-37041] ObjectStore - db details for db default retrieved using SQL in 1.814694ms
[DEBUG] 2024-04-23 23:39:57.699 [MetaStoreThread-37041] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:39:57.699 [MetaStoreThread-37041] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:39:57.699 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:57.704 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.706 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:57.706 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.708 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:57.708 [MetaStoreThread-37041] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:39:57.709 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:57.709 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:57.712 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.714 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:57.716 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.718 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:57.718 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:57.718 [MetaStoreThread-37041] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:39:57.718 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:57.718 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:57.719 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:57.719 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:57.720 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:57.720 [MetaStoreThread-37041] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:39:57.720 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:57.720 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:57.720 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:57.720 [MetaStoreThread-37041] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:57.723 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.726 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:57.728 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:57.729 [MetaStoreThread-37041] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:57.730 [MetaStoreThread-37041] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:57.730 [MetaStoreThread-37041] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:39:57.730 [MetaStoreThread-37041] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:39:57.730 [MetaStoreThread-37041] PerfLogger - </PERFLOG method=init start=1713911997084 end=1713911997730 duration=646 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=35 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Started the new metaserver on port [37041]...
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:39:57.731 [MetaStoreThread-37041] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:39:58.086 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:58.086 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 36: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:58.086 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:39:58.097 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37041) is created
[INFO ] 2024-04-23 23:39:58.097 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 37041 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37041 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[INFO ] 2024-04-23 23:39:58.097 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:39:58.105 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:58.105 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:37041]
[INFO ] 2024-04-23 23:39:58.106 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:37041)
[INFO ] 2024-04-23 23:39:58.106 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:37041) current connections: 3
[DEBUG] 2024-04-23 23:39:58.107 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.107 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911998107 end=1713911998107 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.108 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.108 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.108 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 create_database: Database(name:db1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:39:58.108 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db1, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:39:58.109 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3ca31393, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:58.110 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3ca31393, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@781747c6 created in the thread with id: 296
[DEBUG] 2024-04-23 23:39:58.111 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.111 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.111 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.112 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.112 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.112 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3ca31393 from thread id: 296
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.514939ms
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db1, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:39:58.113 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db for database db1. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.114 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.115 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.115 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.116 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.116 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713911998108 end=1713911998116 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.117 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.117 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.117 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 create_table_req: Table(tableName:tbl1, dbName:db1, owner:alex, createTime:1713911998, lastAccessTime:1713911998, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:39:58.117 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl1, dbName:db1, owner:alex, createTime:1713911998, lastAccessTime:1713911998, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:s, type:string, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:39:58.117 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.120 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.120 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 2.950788ms
[DEBUG] 2024-04-23 23:39:58.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.124 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.125 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.880254ms
[DEBUG] 2024-04-23 23:39:58.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.125 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.126 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.126 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:58.126 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:58.126 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:58.126 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:58.126 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37041/db1.db/tbl1
[DEBUG] 2024-04-23 23:39:58.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.137 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.141 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.145 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.149 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.161 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.163 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.164 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713911998117 end=1713911998164 duration=47 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.165 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.165 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.165 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:39:58.165 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:39:58.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.175 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.204 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.211 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:58.211 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:58.211 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:58.211 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:58.211 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37041/db1.db/tbl1/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:39:58.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.220 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.230 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.233 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.234 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911998165 end=1713911998234 duration=69 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.234 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.235 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.235 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:39:58.235 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:39:58.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.239 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.240 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.240 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:58.240 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:58.240 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:58.240 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:58.240 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37041/db1.db/tbl1/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:39:58.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.251 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911998235 end=1713911998252 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 add_partition : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.258 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:58.258 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:58.258 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:58.258 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:39:58.258 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37041/db1.db/tbl1/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:39:58.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.268 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.269 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713911998252 end=1713911998269 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.270 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.270 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.270 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713911998270 end=1713911998270 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.270 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.270 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.270 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_table : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:39:58.270 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:39:58.270 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.271 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.271 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.299276ms
[DEBUG] 2024-04-23 23:39:58.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.273 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.276 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.277 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[INFO ] 2024-04-23 23:39:58.278 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:39:58.278 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713911998270 end=1713911998278 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.278 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:39:58.278 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.278 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.278 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:39:58.279 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:39:58.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:58.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.283 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 4.164534ms + 0.005239ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:58.286 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.869764ms + 0.079221ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:58.288 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.734751ms + 0.259102ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:58.290 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.580248ms + 0.193233ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.292 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.88402ms + 0.130094ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:58.294 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.569925ms + 0.126241ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.296 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.515783ms + 0.120426ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.297 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.627419ms + 0.121764ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.299 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.583838ms + 0.264676ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.301 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.6352ms + 0.120498ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:58.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 22.52674ms
[DEBUG] 2024-04-23 23:39:58.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.301 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.301 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911998278 end=1713911998301 duration=23 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.311 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.311 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.311 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:39:58.311 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:39:58.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:58.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.312 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.728275ms + 0.004672ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:58.313 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.491001ms + 0.145355ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:58.314 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.193086ms + 0.311995ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:58.314 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.172897ms + 0.148876ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.315 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.223969ms + 0.105932ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:58.315 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.176332ms + 0.105419ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.315 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.178913ms + 0.104258ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.316 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.180086ms + 0.104351ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.316 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.229869ms + 0.254801ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.316 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.191614ms + 0.101034ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:58.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.947256ms
[DEBUG] 2024-04-23 23:39:58.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.317 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.317 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911998311 end=1713911998317 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:58.318 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:58.318 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:37041]
[INFO ] 2024-04-23 23:39:58.318 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:37041)
[INFO ] 2024-04-23 23:39:58.318 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:37041) current connections: 4
[DEBUG] 2024-04-23 23:39:58.319 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.319 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911998319 end=1713911998319 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=38 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.319 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.319 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.319 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 38: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:39:58.319 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 38: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:58.320 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2cb80eaf, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2cb80eaf, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@20364e3f created in the thread with id: 309
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.321 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.322 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.322 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.322 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:58.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:58.322 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2cb80eaf from thread id: 309
[DEBUG] 2024-04-23 23:39:58.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911998319 end=1713911998328 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=38 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:58.328 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:58.328 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 38: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2cb80eaf, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@20364e3f will be shutdown
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 38: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[INFO ] 2024-04-23 23:39:58.328 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:58.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.329 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911998328 end=1713911998329 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=38 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.329 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.329 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:58.329 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 38: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:58.329 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:58.329 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.915264ms + 0.004934ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:58.330 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.499094ms + 0.091279ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:58.331 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.158542ms + 0.238162ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:58.331 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.152642ms + 0.145692ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.332 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156524ms + 0.13334ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:58.332 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.158446ms + 0.131802ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.332 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.156249ms + 0.131959ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.333 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.155897ms + 0.131744ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.333 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.185634ms + 0.229126ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.333 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.157316ms + 0.141878ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:58.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.866508ms
[DEBUG] 2024-04-23 23:39:58.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.334 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.334 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911998328 end=1713911998334 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.335 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.335 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.335 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 alter_table: hive.db1.tbl1 newtbl=tbl1
[INFO ] 2024-04-23 23:39:58.335 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db1.tbl1 newtbl=tbl1	
[DEBUG] 2024-04-23 23:39:58.335 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.121183ms
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:58.336 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.337 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.337 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.08115ms
[DEBUG] 2024-04-23 23:39:58.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.342 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.343 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.344 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.345 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.987262ms
[DEBUG] 2024-04-23 23:39:58.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.350 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db1
[WARN ] 2024-04-23 23:39:58.350 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:39:58.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.352 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:39:58.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:39:58.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.360 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.361 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713911998335 end=1713911998361 duration=26 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:58.362 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:39:58.362 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:37041]
[INFO ] 2024-04-23 23:39:58.362 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:37041)
[INFO ] 2024-04-23 23:39:58.362 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:37041) current connections: 4
[DEBUG] 2024-04-23 23:39:58.363 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.363 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713911998363 end=1713911998363 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=39 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.363 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.363 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 39: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 39: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:39:58.364 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5f3d0755, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5f3d0755, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6e281a7d created in the thread with id: 310
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.365 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.366 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.366 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.366 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:39:58.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:39:58.366 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5f3d0755 from thread id: 310
[DEBUG] 2024-04-23 23:39:58.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, MANAGED_TABLE, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:39:58.368 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.368 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.368 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713911998363 end=1713911998368 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=39 retryCount=0 error=false>
[INFO ] 2024-04-23 23:39:58.368 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:39:58.368 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:39:58.368 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 39: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@5f3d0755, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6e281a7d will be shutdown
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 39: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db1.tbl1	
[INFO ] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713911998369 end=1713911998369 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=39 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 39: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:39:58.369 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:39:58.370 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.897526ms + 0.003994ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:58.371 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.508941ms + 0.125942ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:39:58.371 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.173533ms + 0.228843ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:39:58.372 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.151165ms + 0.150015ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.372 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150905ms + 0.105633ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:39:58.372 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.137176ms + 0.105026ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.372 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.160643ms + 0.134891ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.373 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.161226ms + 0.135413ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.373 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.218858ms + 0.3893ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:39:58.374 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.210578ms + 0.139618ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:39:58.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.978244ms
[DEBUG] 2024-04-23 23:39:58.374 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.374 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.374 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713911998369 end=1713911998374 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.375 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.375 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:39:58.375 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:39:58.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:39:58.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.377 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.377 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713911998375 end=1713911998377 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.377 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.377 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:39:58.377 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:39:58.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.380 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.380 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713911998377 end=1713911998380 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.380 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.380 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.380 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_database: db1
[INFO ] 2024-04-23 23:39:58.380 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db1	
[DEBUG] 2024-04-23 23:39:58.380 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.381 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.325727ms
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713911998380 end=1713911998382 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.382 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_tables_by_type: db=@hive#db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:58.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.383 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.383 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.173644ms
[DEBUG] 2024-04-23 23:39:58.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.385 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.420678ms
[DEBUG] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713911998382 end=1713911998386 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:39:58.386 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.389 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.822362ms
[DEBUG] 2024-04-23 23:39:58.389 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713911998386 end=1713911998389 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.389 [main] HiveMetaStoreClient - Selecting dropDatabase method for db1 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:39:58.389 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:39:58.389 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.389 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.389 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.390 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.391 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.283193ms
[DEBUG] 2024-04-23 23:39:58.391 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_multi_table : db=db1 tbls=tbl1
[INFO ] 2024-04-23 23:39:58.391 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db1 tbls=tbl1	
[DEBUG] 2024-04-23 23:39:58.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.395 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.940737ms
[DEBUG] 2024-04-23 23:39:58.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.395 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.396 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713911998389 end=1713911998396 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:39:58.396 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:39:58.396 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:39:58.396 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:39:58.396 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:39:58.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:39:58.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.397 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.845086ms
[DEBUG] 2024-04-23 23:39:58.397 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:39:58.397 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:39:58.397 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.545292ms
[DEBUG] 2024-04-23 23:39:58.398 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:39:58.398 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:39:58.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.405 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.408 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:39:58.408 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:39:58.408 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.412 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.414 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.415 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:39:58.415 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:39:58.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.432 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.435 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:39:58.435 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:39:58.435 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:39:58.435 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:39:58.435 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:39:58.435 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:39:58.435 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.436 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.832377ms
[DEBUG] 2024-04-23 23:39:58.436 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.463887ms
[DEBUG] 2024-04-23 23:39:58.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.437 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.438 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:39:58.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:39:58.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.808114ms
[DEBUG] 2024-04-23 23:39:58.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:39:58.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:39:58.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:39:58.438 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:39:58.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:39:58.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:39:58.454 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:39:58.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:39:58.461 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:39:58.461 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.461 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:39:58.463 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:39:58.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:39:58.465 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:39:58.466 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:39:58.467 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:39:58.468 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:39:58.468 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:39:58.469 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:39:58.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:39:58.469 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:00.470 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:40:00.470 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:40:00.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:00.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.473 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:00.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:00.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:00.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.868948ms
[DEBUG] 2024-04-23 23:40:00.474 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:40:00.474 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:40:00.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:00.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:00.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.492972ms
[DEBUG] 2024-04-23 23:40:00.475 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:40:00.475 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:40:00.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:00.477 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:00.477 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:00.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:00.478 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:00.478 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:00.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:00.478 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:00.478 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:00.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.479 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:00.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:00.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:00.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.853592ms
[DEBUG] 2024-04-23 23:40:00.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:00.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:00.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.48362ms
[DEBUG] 2024-04-23 23:40:00.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:00.481 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:00.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:00.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:00.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 1.063583ms
[DEBUG] 2024-04-23 23:40:00.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:00.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:40:00.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:00.482 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:00.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:00.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:00.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:00.484 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:00.484 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:00.484 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:00.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:00.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:00.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:00.484 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:00.485 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:00.485 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:00.485 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:00.485 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:00.485 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:00.486 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:00.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:00.486 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:02.150 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:02.487 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:40:02.487 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:40:02.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:02.487 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.489 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:02.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:02.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:02.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 3.229684ms
[DEBUG] 2024-04-23 23:40:02.490 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:40:02.490 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:40:02.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:02.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:02.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.576415ms
[DEBUG] 2024-04-23 23:40:02.491 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:40:02.491 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:40:02.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:02.493 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:02.493 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:02.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:02.494 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:02.494 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:02.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:02.495 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:02.495 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:02.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.495 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:02.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:02.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:02.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.799717ms
[DEBUG] 2024-04-23 23:40:02.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:02.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:02.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.464781ms
[DEBUG] 2024-04-23 23:40:02.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.497 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:02.498 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:02.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:02.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:02.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.993828ms
[DEBUG] 2024-04-23 23:40:02.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:02.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:40:02.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:02.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:02.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:02.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:02.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:02.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:02.500 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:02.500 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:02.500 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:02.500 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:02.500 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:02.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:02.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:02.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:02.501 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:02.501 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:02.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:02.502 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:02.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:02.502 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:04.503 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:40:04.503 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:40:04.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:04.503 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 2.601768ms
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.460266ms
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:40:04.506 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:04.508 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:04.508 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:04.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:04.509 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:04.509 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:04.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:04.509 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:04.509 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:04.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.510 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:04.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:04.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:04.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.84977ms
[DEBUG] 2024-04-23 23:40:04.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:04.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:04.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.628565ms
[DEBUG] 2024-04-23 23:40:04.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.767249ms
[DEBUG] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:04.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:04.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:04.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:04.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:04.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:04.514 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:04.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:04.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:04.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:04.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:04.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:04.515 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:04.515 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:04.515 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:04.515 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:04.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:04.516 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:04.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:04.516 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:04.788 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:06.516 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:40:06.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:40:06.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:06.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.517 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:06.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:06.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:06.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.971918ms
[DEBUG] 2024-04-23 23:40:06.517 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:40:06.517 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:40:06.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:06.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:06.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.548742ms
[DEBUG] 2024-04-23 23:40:06.518 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:40:06.518 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:40:06.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:06.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:06.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:06.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:06.520 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:06.520 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:06.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:06.521 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:06.521 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:06.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.521 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:06.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:06.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:06.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.747933ms
[DEBUG] 2024-04-23 23:40:06.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:06.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:06.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.43388ms
[DEBUG] 2024-04-23 23:40:06.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:06.523 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:06.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:06.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:06.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.717991ms
[DEBUG] 2024-04-23 23:40:06.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:06.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:40:06.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:06.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:06.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:06.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:06.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:06.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:06.525 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:06.525 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:06.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:06.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:06.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:06.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:06.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:06.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:06.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:06.526 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:06.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:06.527 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:06.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:06.527 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:08.527 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 drop_database: @hive#db1
[INFO ] 2024-04-23 23:40:08.527 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db1	
[DEBUG] 2024-04-23 23:40:08.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:08.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.530 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:08.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:08.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 2.87298ms
[DEBUG] 2024-04-23 23:40:08.530 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_tables: db=@hive#db1
[INFO ] 2024-04-23 23:40:08.530 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db1	
[DEBUG] 2024-04-23 23:40:08.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:08.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.465055ms
[DEBUG] 2024-04-23 23:40:08.531 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_functions: db=@hive#db1 pat=*
[INFO ] 2024-04-23 23:40:08.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db1 pat=*	
[DEBUG] 2024-04-23 23:40:08.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.532 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.533 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:08.533 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:08.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.533 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:08.533 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:08.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.534 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:08.534 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db1 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:08.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.535 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:08.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:08.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.893185ms
[DEBUG] 2024-04-23 23:40:08.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:08.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.474986ms
[DEBUG] 2024-04-23 23:40:08.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:40:08.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:40:08.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.559 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.231059ms + 0.004865ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  and "PARTITIONS"."PART_NAME" in (?,?,?)]
[DEBUG] 2024-04-23 23:40:08.564 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.163639ms + 0.005599ms, the query is [delete from "PART_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:40:08.566 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.842537ms + 0.00495ms, the query is [delete from "PART_COL_PRIVS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:40:08.568 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.016978ms + 0.005333ms, the query is [delete from "PART_COL_STATS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:40:08.570 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.873793ms + 0.005673ms, the query is [delete from "PARTITION_PARAMS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:40:08.572 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.906264ms + 0.005422ms, the query is [delete from "PARTITION_KEY_VALS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:40:08.574 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.932303ms + 0.00572ms, the query is [delete from "PARTITIONS" where "PART_ID" in (1,2,3)]
[DEBUG] 2024-04-23 23:40:08.578 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.716257ms + 0.005156ms, the query is [delete from "SD_PARAMS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:40:08.580 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.74689ms + 0.004888ms, the query is [delete from "SORT_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:40:08.582 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.759869ms + 0.005094ms, the query is [delete from "BUCKETING_COLS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:40:08.584 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.773193ms + 0.005381ms, the query is [delete from "SKEWED_COL_NAMES" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:40:08.586 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.571745ms + 0.005366ms, the query is [delete from "SDS" where "SD_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:40:08.588 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.7189ms + 0.004887ms, the query is [delete from "SERDE_PARAMS" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:40:08.590 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.152454ms + 0.005669ms, the query is [delete from "SERDES" where "SERDE_ID" in (2,3,4)]
[DEBUG] 2024-04-23 23:40:08.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:08.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 36.84099ms
[DEBUG] 2024-04-23 23:40:08.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:40:08.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:40:08.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.594 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: source:127.0.0.1 drop_table : tbl=hive.db1.tbl1
[INFO ] 2024-04-23 23:40:08.594 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_table : tbl=hive.db1.tbl1	
[DEBUG] 2024-04-23 23:40:08.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.594 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:08.594 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:08.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:08.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:08.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.970565ms
[DEBUG] 2024-04-23 23:40:08.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:08.595 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db1 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:08.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:08.595 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:08.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db1 retrieved using SQL in 0.853164ms
[DEBUG] 2024-04-23 23:40:08.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:08.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:40:08.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:40:08.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:40:08.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:08.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:08.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:08.599 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:08.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:08.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:08.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:40:08.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:40:08.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:40:08.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:40:08.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:40:08.614 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:08.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:40:08.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:40:08.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:40:08.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:40:08.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:40:08.623 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@524190954 (XID = 1161), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:08.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:40:08.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:40:08.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:40:08.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:40:08.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:40:08.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:40:08.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:40:08.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:40:08.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:40:08.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:40:08.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:40:08.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:40:08.637 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:40:08.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:40:08.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 5, isActive = true
[DEBUG] 2024-04-23 23:40:08.638 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db1.tbl1
[DEBUG] 2024-04-23 23:40:08.639 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 4, isactive true
[DEBUG] 2024-04-23 23:40:08.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:40:08.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:40:08.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:40:08.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:40:08.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:40:08.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:40:08.682 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:08.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:08.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db1 along with all tables
[DEBUG] 2024-04-23 23:40:08.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:08.683 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:08.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:08.687 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:08.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:08.688 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:08.688 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:08.688 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:08.688 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:08.689 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:08.689 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:08.689 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:08.689 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:08.689 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db1'>
[DEBUG] 2024-04-23 23:40:08.689 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:08.689 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:08.689 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:08.690 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-10 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@510991682 (XID = 1159), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:08.690 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:40:08.690 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db1
[DEBUG] 2024-04-23 23:40:08.691 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/37041/db1.db
[INFO ] 2024-04-23 23:40:08.691 [TThreadPoolServer WorkerProcess-%d] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:40:08.692 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:40:08.692 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db1
[DEBUG] 2024-04-23 23:40:08.692 [TThreadPoolServer WorkerProcess-%d] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db1.db
[DEBUG] 2024-04-23 23:40:08.692 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713911998396 end=1713912008692 duration=10296 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=5 error=false>
[INFO ] 2024-04-23 23:40:08.693 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 2
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3ca31393, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@781747c6 will be shutdown
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713912008693 end=1713912008693 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=37 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:08.693 [main] MetastoreConf - Unable to find config file: hive-site.xml
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 37: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:08.693 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:08.694 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:40:08.694 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:40:08.694 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:40:08.701 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:40:08.701 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:40:08.701 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:40:08.702 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:40:08.703 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:08.732 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:09.128 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:40:09.139 [MetaStoreThread-41227] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:40:09.139 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:40:09.139 [MetaStoreThread-41227] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] HMSHandler - 40: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:40:09.140 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_37041;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 31
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 121
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:40:09.141 [MetaStoreThread-41227] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:09.142 [MetaStoreThread-41227] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:40:09.142 [MetaStoreThread-41227] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:40:09.143 [MetaStoreThread-41227] HikariConfig - HikariPool-11 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:40:09.143 [MetaStoreThread-41227] HikariConfig - HikariPool-11 - configuration:
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true"
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - poolName........................"HikariPool-11"
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:40:09.144 [MetaStoreThread-41227] HikariDataSource - HikariPool-11 - Starting...
[INFO ] 2024-04-23 23:40:09.146 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:40:09.146 [MetaStoreThread-41227] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.146 [MetaStoreThread-41227] HikariDataSource - HikariPool-11 - Start completed.
[DEBUG] 2024-04-23 23:40:09.247 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:40:09.248 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.249 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1188761808 (XID = 1151), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.250 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2010640906 (XID = 1153), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.251 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@653586335 (XID = 1155), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.253 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@581652053 (XID = 1157), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.254 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@582628826 (XID = 1159), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.255 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@356908229 (XID = 1161), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.256 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1482577439 (XID = 1163), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.257 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@698262705 (XID = 1165), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.257 [HikariPool-11 connection adder] HikariPool - HikariPool-11 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@59751c50, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@59751c50, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@5e8b1055 created in the thread with id: 313
[DEBUG] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.407 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.504 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.573 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.587 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.626 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.642 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.647 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.762 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.787 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.792 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.798 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.800 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.801 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.801 [MetaStoreThread-41227] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:09.802 [MetaStoreThread-41227] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:09.802 [MetaStoreThread-41227] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@59751c50 from thread id: 313
[DEBUG] 2024-04-23 23:40:09.802 [MetaStoreThread-41227] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:09.802 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.804 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.807 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.807 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.807 [MetaStoreThread-41227] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:40:09.807 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.808 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.808 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.808 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.808 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.810 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.811 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - db details for db default retrieved using SQL in 1.684655ms
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:40:09.812 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.817 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.818 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.819 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.821 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.821 [MetaStoreThread-41227] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:40:09.821 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.821 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:09.824 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.826 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:09.829 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.830 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:09.831 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:09.832 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:09.833 [MetaStoreThread-41227] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:09.836 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.838 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:09.841 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:09.842 [MetaStoreThread-41227] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:09.842 [MetaStoreThread-41227] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:09.842 [MetaStoreThread-41227] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] PerfLogger - </PERFLOG method=init start=1713912009139 end=1713912009843 duration=704 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=40 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Started the new metaserver on port [41227]...
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:40:09.843 [MetaStoreThread-41227] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:40:10.140 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:10.140 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 41: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:10.141 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:10.145 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227) is created
[INFO ] 2024-04-23 23:40:10.145 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 41227 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[INFO ] 2024-04-23 23:40:10.145 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:10.148 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:10.148 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:41227]
[INFO ] 2024-04-23 23:40:10.148 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:41227)
[INFO ] 2024-04-23 23:40:10.148 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:41227) current connections: 3
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912010149 end=1713912010149 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 create_database: Database(name:db8, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:40:10.149 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db8, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:10.150 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@243e7266, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:10.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:10.152 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@243e7266, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@136b6060 created in the thread with id: 330
[DEBUG] 2024-04-23 23:40:10.152 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.152 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.152 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.154 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.154 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@243e7266 from thread id: 330
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.155 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.859026ms
[DEBUG] 2024-04-23 23:40:10.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db8, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:40:10.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:10.156 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db for database db8. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.157 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.159 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713912010149 end=1713912010160 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 create_table_req: Table(tableName:tbl8, dbName:db8, owner:alex, createTime:1713912010, lastAccessTime:1713912010, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl8, dbName:db8, owner:alex, createTime:1713912010, lastAccessTime:1713912010, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:l, type:bigint, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:40:10.160 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.164 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 4.492556ms
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.165 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.170 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.171 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.426454ms
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.173 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:10.174 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227/db8.db/tbl8
[DEBUG] 2024-04-23 23:40:10.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.185 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.189 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.195 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.201 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.207 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.222 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.224 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.224 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713912010160 end=1713912010224 duration=64 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.232 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.252 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:10.256 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227/db8.db/tbl8/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:40:10.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.261 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.264 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.274 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912010225 end=1713912010275 duration=50 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.277 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.279 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.280 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:10.281 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227/db8.db/tbl8/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:40:10.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.285 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.286 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.288 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.290 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.291 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912010275 end=1713912010291 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 add_partition : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.292 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:10.297 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/41227/db8.db/tbl8/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:40:10.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.301 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.302 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.306 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912010292 end=1713912010308 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713912010308 end=1713912010308 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_table : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.04194ms
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.315 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:10.315 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:40:10.315 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713912010308 end=1713912010315 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.316 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8	
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.319 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.175751ms + 0.005529ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:10.322 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.593979ms + 0.07357ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:10.324 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.567043ms + 0.272281ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:10.326 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.862233ms + 0.255112ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.328 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.66383ms + 0.119843ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:10.330 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.436917ms + 0.137242ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.331 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.634499ms + 0.124901ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.333 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.523705ms + 0.160128ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.335 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.617841ms + 0.253422ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.450701ms + 0.119417ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.966335ms
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.337 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912010316 end=1713912010337 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.347 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 alter_table: hive.db8.tbl8 newtbl=tbl8
[INFO ] 2024-04-23 23:40:10.347 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db8.tbl8 newtbl=tbl8	
[DEBUG] 2024-04-23 23:40:10.347 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.347 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.260596ms
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:10.348 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.076938ms
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.349 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.355 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.064222ms
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db8
[WARN ] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db8.tbl8
[DEBUG] 2024-04-23 23:40:10.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:40:10.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:40:10.367 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.369 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.371 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.371 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713912010346 end=1713912010371 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:10.372 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:10.372 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:41227]
[INFO ] 2024-04-23 23:40:10.372 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:41227)
[INFO ] 2024-04-23 23:40:10.372 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:41227) current connections: 4
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912010373 end=1713912010373 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=43 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:40:10.373 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:10.374 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4af0077b, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4af0077b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@60dee08b created in the thread with id: 343
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.375 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.376 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4af0077b from thread id: 343
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:40:10.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.382 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.382 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713912010373 end=1713912010382 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=43 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:10.382 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:40:10.383 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 3
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db8.tbl8	
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@4af0077b, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@60dee08b will be shutdown
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713912010383 end=1713912010383 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=43 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 43: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:10.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:10.384 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.747258ms + 0.004688ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:10.384 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.401754ms + 0.072089ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:10.385 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150911ms + 0.224095ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:10.385 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.178355ms + 0.173143ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.385 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.170318ms + 0.103603ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:10.386 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.160178ms + 0.114392ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.386 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.182877ms + 0.100864ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.386 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.180249ms + 0.098312ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.225255ms + 0.2893ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.173041ms + 0.104038ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.447426ms
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.387 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912010383 end=1713912010387 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:40:10.388 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.390 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.390 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.390 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713912010388 end=1713912010390 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:40:10.391 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713912010391 end=1713912010393 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.393 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.394 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_database: db8
[INFO ] 2024-04-23 23:40:10.394 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db8	
[DEBUG] 2024-04-23 23:40:10.394 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.394 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.114357ms
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713912010393 end=1713912010395 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.395 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_tables_by_type: db=@hive#db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:10.395 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.106072ms
[DEBUG] 2024-04-23 23:40:10.396 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 3.533233ms
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713912010395 end=1713912010400 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:10.400 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:10.401 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.544663ms
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713912010400 end=1713912010404 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.404 [main] HiveMetaStoreClient - Selecting dropDatabase method for db8 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:40:10.404 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.404 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.405 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.543511ms
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_multi_table : db=db8 tbls=tbl8
[INFO ] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db8 tbls=tbl8	
[DEBUG] 2024-04-23 23:40:10.406 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.411 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.378484ms
[DEBUG] 2024-04-23 23:40:10.412 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713912010404 end=1713912010413 duration=9 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:10.413 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.414 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.42753ms
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:10.415 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.805375ms
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:10.416 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.426 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.431 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:10.431 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:10.431 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.437 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.441 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:10.441 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:10.441 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.462 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:10.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.528988ms
[DEBUG] 2024-04-23 23:40:10.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.852013ms
[DEBUG] 2024-04-23 23:40:10.468 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.469 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.376953ms
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:10.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:10.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:10.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:10.491 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@132520683 (XID = 1149), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:10.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:10.501 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:10.501 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.502 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.503 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.505 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.507 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.508 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.509 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:10.510 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:10.510 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:10.511 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:10.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:10.512 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:12.512 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:12.512 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:12.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:12.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.905774ms
[DEBUG] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:12.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:12.517 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.991511ms
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:12.518 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:12.520 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.735926ms
[DEBUG] 2024-04-23 23:40:12.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.42429ms
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.063809ms
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:12.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:12.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:12.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.525 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:12.526 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:13.132 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:14.527 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:14.527 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:14.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:14.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.530 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.327277ms
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:14.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.434615ms
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:14.533 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.534 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.535 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:14.535 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:14.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.536 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:14.536 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:14.536 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.229216ms
[DEBUG] 2024-04-23 23:40:14.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.720605ms
[DEBUG] 2024-04-23 23:40:14.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 1.227162ms
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:14.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:14.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:14.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:14.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:14.543 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:14.544 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:14.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:14.547 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:14.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:14.547 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:16.409 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:16.548 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:16.548 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:16.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:16.548 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.551 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.271047ms
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.495182ms
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:16.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:16.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.555 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.722428ms
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.43313ms
[DEBUG] 2024-04-23 23:40:16.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.694031ms
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:16.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:16.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:16.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:16.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:16.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:16.560 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:16.561 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:16.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:16.561 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:18.562 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:18.562 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:18.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:18.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.565 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.39676ms
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:18.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.943267ms
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:18.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.568 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:18.568 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:18.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.569 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:18.569 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:18.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.570 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.812661ms
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.482093ms
[DEBUG] 2024-04-23 23:40:18.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:18.572 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.732309ms
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:18.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:18.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:18.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:18.574 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:18.574 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:18.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:18.576 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:18.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:18.576 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:20.577 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:20.577 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:20.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:20.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.580 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.585802ms
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:20.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.643694ms
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:20.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:20.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.851519ms
[DEBUG] 2024-04-23 23:40:20.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.499604ms
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.88448ms
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:20.588 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:20.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:20.589 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:20.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:20.590 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:20.590 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:20.591 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:20.592 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:20.592 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:20.592 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:21.010 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:21.014 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:22.593 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:22.593 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:22.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:22.593 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.596 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:22.596 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.398111ms
[DEBUG] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:22.597 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.594061ms
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:22.598 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.600 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.601 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.868957ms
[DEBUG] 2024-04-23 23:40:22.602 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.505487ms
[DEBUG] 2024-04-23 23:40:22.603 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.784118ms
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:22.604 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:22.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:22.605 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:22.606 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:22.607 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:22.608 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:22.608 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:24.561 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:24.608 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:24.609 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:24.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:24.609 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.611 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.395548ms
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:24.612 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.380539ms
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:24.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.615 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:24.615 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:24.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.799489ms
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.466768ms
[DEBUG] 2024-04-23 23:40:24.618 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.751222ms
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:24.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:24.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:24.620 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.621 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:24.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:24.623 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:26.623 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:26.623 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:26.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:26.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 2.436424ms
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:26.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.528431ms
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:26.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.628 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:26.628 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:26.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.743062ms
[DEBUG] 2024-04-23 23:40:26.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.447538ms
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.693271ms
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:26.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:26.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:26.633 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:26.634 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:26.635 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:26.635 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:26.635 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:27.019 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:27.190 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:28.636 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:28.636 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:28.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:28.636 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.639 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.333654ms
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:28.640 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.887381ms
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:28.641 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.642 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:28.642 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:28.642 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.643 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.644 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:28.644 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:28.644 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.644 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.808924ms
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.457883ms
[DEBUG] 2024-04-23 23:40:28.645 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.789046ms
[DEBUG] 2024-04-23 23:40:28.646 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:28.647 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.648 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:28.649 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:28.650 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:30.650 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 drop_database: @hive#db8
[INFO ] 2024-04-23 23:40:30.650 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db8	
[DEBUG] 2024-04-23 23:40:30.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:30.650 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.653 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 3.477525ms
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_tables: db=@hive#db8
[INFO ] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db8	
[DEBUG] 2024-04-23 23:40:30.654 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.655 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.417412ms
[DEBUG] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_functions: db=@hive#db8 pat=*
[INFO ] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db8 pat=*	
[DEBUG] 2024-04-23 23:40:30.656 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.657 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.658 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db8 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.800455ms
[DEBUG] 2024-04-23 23:40:30.659 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.42968ms
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.660 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db8 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db8.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db8 retrieved using SQL in 0.711946ms
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db8 along with all tables
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:30.661 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:30.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:30.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:30.662 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db8'>
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:30.663 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:30.664 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-11 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1986515730 (XID = 1147), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:30.664 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:30.664 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:30.664 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713912010413 end=1713912030664 duration=20251 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=42 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:40:30.665 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:40:30.665 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:40:30.665 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:40:30.665 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:40:30.672 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:40:30.672 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:40:30.672 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:40:30.672 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:40:30.673 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:30.714 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:30.890 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:30.891 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:40:30.891 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:30.891 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@243e7266, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@136b6060 will be shutdown
[DEBUG] 2024-04-23 23:40:30.892 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 42: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:30.892 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:31.107 [MetaStoreThread-44247] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[INFO ] 2024-04-23 23:40:31.107 [main] MetaStoreTestUtils - Waiting the HMS to start.
[DEBUG] 2024-04-23 23:40:31.107 [MetaStoreThread-44247] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] HMSHandler - 44: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_41227;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:40:31.108 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:40:31.109 [MetaStoreThread-44247] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - HikariPool-12 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - HikariPool-12 - configuration:
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:40:31.110 [MetaStoreThread-44247] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true"
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - poolName........................"HikariPool-12"
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:40:31.111 [MetaStoreThread-44247] HikariDataSource - HikariPool-12 - Starting...
[INFO ] 2024-04-23 23:40:31.113 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:40:31.113 [MetaStoreThread-44247] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.113 [MetaStoreThread-44247] HikariDataSource - HikariPool-12 - Start completed.
[DEBUG] 2024-04-23 23:40:31.213 [HikariPool-12 housekeeper] HikariPool - HikariPool-12 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:40:31.215 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.216 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1153144651 (XID = 1142), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.217 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1974802294 (XID = 1144), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.219 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@613705732 (XID = 1146), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.220 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1985841903 (XID = 1148), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.221 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@551202849 (XID = 1150), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.222 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1613537777 (XID = 1152), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.224 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2074167912 (XID = 1154), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.225 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1721160855 (XID = 1156), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.225 [HikariPool-12 connection adder] HikariPool - HikariPool-12 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@57baed5d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@57baed5d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3b32acef created in the thread with id: 346
[DEBUG] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.318 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.400 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.468 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.481 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.516 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.531 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.536 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.634 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.659 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.666 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.672 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.674 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@57baed5d from thread id: 346
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:31.676 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.679 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.682 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.682 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.682 [MetaStoreThread-44247] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:40:31.682 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.683 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.683 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.683 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.683 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.685 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.685 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - db details for db default retrieved using SQL in 1.609767ms
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:40:31.687 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.691 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.692 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.693 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.695 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.695 [MetaStoreThread-44247] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:40:31.695 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.695 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:31.699 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.702 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:31.704 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.705 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.705 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.706 [MetaStoreThread-44247] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:40:31.706 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.706 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:31.706 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:31.707 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:31.708 [MetaStoreThread-44247] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:31.711 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.714 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:31.716 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:31.717 [MetaStoreThread-44247] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:31.717 [MetaStoreThread-44247] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:31.717 [MetaStoreThread-44247] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] PerfLogger - </PERFLOG method=init start=1713912031107 end=1713912031718 duration=611 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=44 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Started the new metaserver on port [44247]...
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:40:31.718 [MetaStoreThread-44247] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:40:32.109 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:32.109 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 45: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:32.109 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:32.119 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247) is created
[INFO ] 2024-04-23 23:40:32.119 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 44247 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[INFO ] 2024-04-23 23:40:32.119 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:32.126 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:32.126 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:44247]
[INFO ] 2024-04-23 23:40:32.127 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:44247)
[INFO ] 2024-04-23 23:40:32.127 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:44247) current connections: 4
[DEBUG] 2024-04-23 23:40:32.128 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.128 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912032128 end=1713912032128 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 create_database: Database(name:db2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db2, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.129 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f185682, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:32.130 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:32.131 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f185682, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@22764747 created in the thread with id: 363
[DEBUG] 2024-04-23 23:40:32.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.131 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.132 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f185682 from thread id: 363
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.558208ms
[DEBUG] 2024-04-23 23:40:32.133 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db2, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:40:32.134 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db for database db2. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.136 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.137 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.137 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713912032129 end=1713912032137 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 create_table_req: Table(tableName:tbl2, dbName:db2, owner:alex, createTime:1713912032, lastAccessTime:1713912032, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl2, dbName:db2, owner:alex, createTime:1713912032, lastAccessTime:1713912032, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:do, type:double, comment:), FieldSchema(name:d, type:date, comment:), FieldSchema(name:b, type:binary, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:40:32.138 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.018346ms
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.141 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.144 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.145 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.866082ms
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.146 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:32.147 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247/db2.db/tbl2
[DEBUG] 2024-04-23 23:40:32.150 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:32.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.151 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.154 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.157 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.161 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.165 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.169 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.180 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.182 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713912032138 end=1713912032183 duration=45 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.183 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.190 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.210 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.214 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:32.215 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247/db2.db/tbl2/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01
[DEBUG] 2024-04-23 23:40:32.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.218 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.222 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.231 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.232 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912032183 end=1713912032232 duration=49 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.235 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.237 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:32.238 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247/db2.db/tbl2/state=CA/dt=1986-04-28
[DEBUG] 2024-04-23 23:40:32.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.245 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.247 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.248 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912032233 end=1713912032248 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.248 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 add_partition : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.249 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:32.254 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/44247/db2.db/tbl2/state=MN/dt=2018-11-31
[DEBUG] 2024-04-23 23:40:32.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.262 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.264 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912032249 end=1713912032265 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713912032265 end=1713912032265 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.265 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.266 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.266 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_table : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.266 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.538144ms
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.267 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.269 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.272 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.273 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:32.274 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:40:32.274 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713912032266 end=1713912032274 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.274 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=9, comments=HMS client
[DEBUG] 2024-04-23 23:40:32.274 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.275 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.278 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.894977ms + 0.004699ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.280 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.413876ms + 0.063786ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.282 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.366618ms + 0.270379ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:32.284 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.464394ms + 0.16461ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.286 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.547119ms + 0.121547ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:32.288 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.006177ms + 0.192934ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.289 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.51788ms + 0.122966ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.291 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.356008ms + 0.119153ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.293 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.392527ms + 0.239224ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.495434ms + 0.114422ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 19.63912ms
[DEBUG] 2024-04-23 23:40:32.294 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.295 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.295 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912032275 end=1713912032295 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.303 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.304 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.574383ms + 0.004319ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.305 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.369494ms + 0.053689ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.133686ms + 0.205408ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:32.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.157142ms + 0.135337ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.154645ms + 0.100003ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:32.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.151273ms + 0.098747ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.191385ms + 0.099362ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.146541ms + 0.098286ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.182876ms + 0.202297ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15769ms + 0.10022ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 3.903909ms
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.308 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912032304 end=1713912032308 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 alter_table: hive.db2.tbl2 newtbl=tbl2
[INFO ] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db2.tbl2 newtbl=tbl2	
[DEBUG] 2024-04-23 23:40:32.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.079597ms
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:32.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.930606ms
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.311 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.315 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.316 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.317 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.882129ms
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db2
[WARN ] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.324 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db2.tbl2
[DEBUG] 2024-04-23 23:40:32.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:40:32.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:40:32.330 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.334 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.335 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713912032309 end=1713912032335 duration=26 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:32.336 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:32.336 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:44247]
[INFO ] 2024-04-23 23:40:32.336 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:44247)
[INFO ] 2024-04-23 23:40:32.336 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:44247) current connections: 5
[DEBUG] 2024-04-23 23:40:32.337 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.337 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912032337 end=1713912032337 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.337 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.337 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: source:127.0.0.1 get_table_metas : tbl=hive.*.*
[INFO ] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*.*	
[INFO ] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:32.338 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3362a3d, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3362a3d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@61cc8b05 created in the thread with id: 376
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.339 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.340 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.340 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.340 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:32.340 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:32.341 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3362a3d from thread id: 376
[DEBUG] 2024-04-23 23:40:32.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.341 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (tableType == :param2 || tableType == :param3 ) params: hive, EXTERNAL_TABLE, MANAGED_TABLE
[DEBUG] 2024-04-23 23:40:32.345 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.345 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.345 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713912032337 end=1713912032345 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:32.345 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: * tablePattern: * found: 0
[INFO ] 2024-04-23 23:40:32.346 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 4
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@3362a3d, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@61cc8b05 will be shutdown
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db2.tbl2	
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Done cleaning up thread local RawStore
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713912032346 end=1713912032346 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=47 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 47: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:32.346 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:32.347 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.908382ms + 0.005543ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.348 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.399618ms + 0.062836ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:32.348 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.150564ms + 0.301014ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:32.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.15439ms + 0.139693ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.139848ms + 0.100763ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:32.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.127973ms + 0.100552ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.349 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.127035ms + 0.099655ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.125217ms + 0.098581ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.166338ms + 0.20711ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.135233ms + 0.100993ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 4.307916ms
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.350 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912032346 end=1713912032351 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:40:32.351 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.353 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.353 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.353 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713912032351 end=1713912032353 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.353 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.354 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.354 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:40:32.354 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:40:32.354 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713912032354 end=1713912032356 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_database: db2
[INFO ] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db2	
[DEBUG] 2024-04-23 23:40:32.356 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.061381ms
[DEBUG] 2024-04-23 23:40:32.357 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713912032356 end=1713912032357 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.357 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=1, comments=HMS client
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_tables_by_type: db=@hive#db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.358 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.121251ms
[DEBUG] 2024-04-23 23:40:32.359 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.503471ms
[DEBUG] 2024-04-23 23:40:32.361 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713912032358 end=1713912032361 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:32.362 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.737101ms
[DEBUG] 2024-04-23 23:40:32.364 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713912032362 end=1713912032364 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.365 [main] HiveMetaStoreClient - Selecting dropDatabase method for db2 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:40:32.365 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:40:32.365 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.365 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.365 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.06454ms
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_multi_table : db=db2 tbls=tbl2
[INFO ] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db2 tbls=tbl2	
[DEBUG] 2024-04-23 23:40:32.366 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.378 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.380 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713912032365 end=1713912032381 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:32.381 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.949599ms
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:32.382 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.504767ms
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:32.383 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.390 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.392 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.392 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:32.393 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:32.393 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.396 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.398 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.398 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:32.399 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:32.399 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.416 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.418 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.419 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.842118ms
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.463846ms
[DEBUG] 2024-04-23 23:40:32.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.421 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.742572ms
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:32.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:32.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:32.435 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@92708208 (XID = 1140), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.439 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:32.442 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:32.442 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:32.442 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.442 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.443 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.444 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.445 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.446 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.447 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:32.448 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:32.449 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.449 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:32.450 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:32.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:32.450 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:34.451 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:34.451 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:34.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:34.451 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.453 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.773271ms
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:34.454 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.67661ms
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:34.456 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.457 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:34.457 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:34.457 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.458 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:34.458 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:34.458 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.459 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:34.459 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:34.459 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.037282ms
[DEBUG] 2024-04-23 23:40:34.460 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.443249ms
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.461 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.734597ms
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:34.462 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:34.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:34.463 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:34.464 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:34.465 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:34.465 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:34.465 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:34.788 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:36.466 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:36.466 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:36.466 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:36.467 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.470 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:36.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.470 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.975351ms
[DEBUG] 2024-04-23 23:40:36.471 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:36.471 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:36.471 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.107245ms
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:36.472 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.473 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:36.474 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.475 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:36.475 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:36.475 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.867537ms
[DEBUG] 2024-04-23 23:40:36.476 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.469414ms
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.477 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.761051ms
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:36.478 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:36.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:36.479 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.480 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:36.481 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:36.482 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:38.482 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:38.483 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:38.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:38.483 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.485 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.209996ms
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:38.486 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.573601ms
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:38.488 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.490 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:38.490 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:38.490 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.491 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:38.491 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:38.491 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.492 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:38.492 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:38.492 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.176922ms
[DEBUG] 2024-04-23 23:40:38.493 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.687824ms
[DEBUG] 2024-04-23 23:40:38.494 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.495 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 1.142768ms
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:38.496 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:38.497 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:38.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:38.498 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:38.499 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:38.500 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:38.500 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:38.500 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:38.501 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:38.501 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:39.129 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:39.247 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:40.502 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:40.502 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:40.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:40.502 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.504 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.878834ms
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.477338ms
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:40.505 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.507 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:40.507 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:40.507 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.508 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.799521ms
[DEBUG] 2024-04-23 23:40:40.509 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.46543ms
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.510 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.774578ms
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:40.511 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:40.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:40.512 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:40.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:40.513 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:40.514 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:40.515 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:40.515 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:40.515 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:42.516 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:42.516 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:42.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:42.516 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.518 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.136955ms
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:42.519 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.396222ms
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:42.521 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.522 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:42.522 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:42.522 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.523 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:42.523 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:42.523 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.524 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:42.524 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:42.524 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.875824ms
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.467297ms
[DEBUG] 2024-04-23 23:40:42.525 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.526 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.777666ms
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:42.527 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:42.528 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:42.529 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:42.530 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:42.530 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:42.531 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:43.133 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:44.531 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:44.531 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:44.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:44.531 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.534 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.640555ms
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:44.535 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.696283ms
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:44.537 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.538 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:44.538 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:44.538 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.539 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:44.539 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:44.539 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.540 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.740073ms
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.451938ms
[DEBUG] 2024-04-23 23:40:44.541 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.542 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:44.542 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.761651ms
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:44.543 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:44.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:44.544 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:44.544 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:44.544 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:44.545 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:44.546 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:44.546 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:44.546 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:46.410 [HikariPool-1 housekeeper] HikariPool - HikariPool-1 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:46.547 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:46.547 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:46.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:46.547 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.550 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.5878ms
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:46.551 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.932269ms
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:46.552 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.553 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:46.553 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:46.553 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.554 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:46.554 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:46.554 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.555 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:46.555 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:46.555 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.793256ms
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.456847ms
[DEBUG] 2024-04-23 23:40:46.556 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.557 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:46.557 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.72907ms
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:46.558 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:46.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:46.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:46.559 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:46.560 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:46.561 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:46.561 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:46.561 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:48.562 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:48.562 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:48.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:48.562 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.565 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.608838ms
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:48.566 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.958707ms
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:48.567 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.568 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:48.568 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:48.568 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.569 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:48.569 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:48.569 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.570 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:48.570 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:48.570 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.846653ms
[DEBUG] 2024-04-23 23:40:48.571 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.467418ms
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.572 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.768931ms
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:48.573 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:48.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:48.574 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:48.575 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:48.576 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:48.577 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:48.577 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:48.577 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:50.578 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:50.578 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:50.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:50.578 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 3.264561ms
[DEBUG] 2024-04-23 23:40:50.581 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.425628ms
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:50.582 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.583 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:50.583 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:50.583 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.584 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:50.584 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:50.584 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.585 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:50.585 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:50.585 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.738628ms
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.420178ms
[DEBUG] 2024-04-23 23:40:50.586 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:50.587 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:50.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:50.587 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:50.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 26.245541ms
[DEBUG] 2024-04-23 23:40:50.613 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:50.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:50.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:50.614 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:50.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:50.615 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.616 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:50.617 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:50.618 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:51.011 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:51.015 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:52.618 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 drop_database: @hive#db2
[INFO ] 2024-04-23 23:40:52.619 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db2	
[DEBUG] 2024-04-23 23:40:52.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:52.619 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 2.53374ms
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_tables: db=@hive#db2
[INFO ] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db2	
[DEBUG] 2024-04-23 23:40:52.621 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.543013ms
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_functions: db=@hive#db2 pat=*
[INFO ] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db2 pat=*	
[DEBUG] 2024-04-23 23:40:52.622 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.623 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.623 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:52.623 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:52.624 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.625 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.626 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:52.626 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db2 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:52.626 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.626 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.985173ms
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.558159ms
[DEBUG] 2024-04-23 23:40:52.627 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.628 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db2 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db2.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db2 retrieved using SQL in 0.900293ms
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db2 along with all tables
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:52.629 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:52.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:52.630 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db2'>
[DEBUG] 2024-04-23 23:40:52.631 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:52.632 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:52.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:52.632 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-12 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1943304622 (XID = 1138), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:52.632 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:52.633 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:52.633 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713912032381 end=1713912052633 duration=20252 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=46 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:40:52.634 [main] MetastoreConf - Unable to find config file: hive-site.xml
[INFO ] 2024-04-23 23:40:52.634 [main] MetastoreConf - Unable to find config file: hivemetastore-site.xml
[INFO ] 2024-04-23 23:40:52.634 [main] MetastoreConf - Unable to find config file: metastore-site.xml
[DEBUG] 2024-04-23 23:40:52.634 [main] MetastoreConf - Setting conf value datanucleus.schema.autoCreateAll using value true
[DEBUG] 2024-04-23 23:40:52.641 [main] MetastoreConf - Setting conf value javax.jdo.option.ConnectionURL using value jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true
[DEBUG] 2024-04-23 23:40:52.641 [main] MetastoreConf - Setting conf value metastore.schema.verification using value false
[DEBUG] 2024-04-23 23:40:52.641 [main] MetastoreConf - Setting conf value metastore.warehouse.dir using value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse
[DEBUG] 2024-04-23 23:40:52.641 [main] MetastoreConf - Picking up system property hive.metastore.warehouse.external.dir with value file:///home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external
[INFO ] 2024-04-23 23:40:52.643 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:52.670 [main] TestTxnDbUtil - Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[INFO ] 2024-04-23 23:40:53.045 [main] MetaStoreTestUtils - Waiting the HMS to start.
[INFO ] 2024-04-23 23:40:53.045 [MetaStoreThread-39623] AuthFactory - Using authentication NOSASL with kerberos authentication disabled
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PerfLogger - <PERFLOG method=init from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] HMSHandler - 48: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:53.046 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Updating the pmf due to property change
[DEBUG] 2024-04-23 23:40:53.047 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.schema.autoCreateAll to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.schema.validateTables to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.rdbms.useLegacyNativeValueStrategy to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.connectionPool.maxPoolSize to be different. Old val : 10 : New Val : 10
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.schema.validateColumns to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.autoStartMechanismMode to be different. Old val : ignored : New Val : ignored
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found masked property javax.jdo.option.ConnectionPassword to be different
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.rdbms.initializeColumnInfo to be different. Old val : NONE : New Val : NONE
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.Multithreaded to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.identifierFactory to be different. Old val : datanucleus1 : New Val : datanucleus1
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.transactionIsolation to be different. Old val : read-committed : New Val : read-committed
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.ConnectionURL to be different. Old val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_44247;create=true : New Val : jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.DetachAllOnCommit to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.NonTransactionalRead to be different. Old val : true : New Val : true
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.ConnectionDriverName to be different. Old val : org.apache.derby.jdbc.EmbeddedDriver : New Val : org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.schema.validateConstraints to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.option.ConnectionUserName to be different. Old val : APP : New Val : APP
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.cache.level2 to be different. Old val : false : New Val : false
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.plugin.pluginRegistryBundleCheck to be different. Old val : LOG : New Val : LOG
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.cache.level2.type to be different. Old val : none : New Val : none
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found javax.jdo.PersistenceManagerFactoryClass to be different. Old val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory : New Val : org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.storeManagerType to be different. Old val : rdbms : New Val : rdbms
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Found datanucleus.connectionPoolingType to be different. Old val : HikariCP : New Val : HikariCP
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 37, loaded classes: 0, unloaded classes: 9
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 27
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 8, unloaded classes: 120
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.048 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Cleared ClassLoaderResolverImpl: resources: 0, loaded classes: 0, unloaded classes: 0
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Removed cached classloaders from DataNucleus NucleusContext
[DEBUG] 2024-04-23 23:40:53.049 [MetaStoreThread-39623] PersistenceManagerProvider - Closing PersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:53.051 [MetaStoreThread-39623] PersistenceManagerProvider - PersistenceManagerFactory closed
[DEBUG] 2024-04-23 23:40:53.051 [MetaStoreThread-39623] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:40:53.052 [MetaStoreThread-39623] HikariConfig - HikariPool-13 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:40:53.052 [MetaStoreThread-39623] HikariConfig - HikariPool-13 - configuration:
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true"
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:40:53.053 [MetaStoreThread-39623] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - poolName........................"HikariPool-13"
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:40:53.054 [MetaStoreThread-39623] HikariDataSource - HikariPool-13 - Starting...
[INFO ] 2024-04-23 23:40:53.056 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:40:53.056 [MetaStoreThread-39623] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.056 [MetaStoreThread-39623] HikariDataSource - HikariPool-13 - Start completed.
[DEBUG] 2024-04-23 23:40:53.156 [HikariPool-13 housekeeper] HikariPool - HikariPool-13 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:40:53.158 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.160 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2013240477 (XID = 1154), (SESSIONID = 7), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.161 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1187146729 (XID = 1156), (SESSIONID = 9), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.162 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@399533010 (XID = 1158), (SESSIONID = 11), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.163 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@459607074 (XID = 1160), (SESSIONID = 13), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.165 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@329160867 (XID = 1162), (SESSIONID = 15), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.166 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@58598153 (XID = 1164), (SESSIONID = 17), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.167 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1183803132 (XID = 1166), (SESSIONID = 19), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.168 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1296206150 (XID = 1168), (SESSIONID = 21), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.168 [HikariPool-13 connection adder] HikariPool - HikariPool-13 - After adding stats (total=10, active=0, idle=10, waiting=0)
[INFO ] 2024-04-23 23:40:53.307 [MetaStoreThread-39623] PersistenceManagerProvider - Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
[INFO ] 2024-04-23 23:40:53.307 [MetaStoreThread-39623] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@78a61f0e, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:53.307 [MetaStoreThread-39623] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:53.307 [MetaStoreThread-39623] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@78a61f0e, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6dd7a7f6 created in the thread with id: 379
[DEBUG] 2024-04-23 23:40:53.308 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.308 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.308 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.381 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.477 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.492 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.528 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.543 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.548 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.691 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.732 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.742 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.751 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.755 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@78a61f0e from thread id: 379
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:53.757 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.761 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.774 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] HMSHandler - Setting location of default catalog, as it hasn't been done after upgrade
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.775 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.776 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.778 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.778 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] ObjectStore - db details for db default retrieved using SQL in 2.321334ms
[DEBUG] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] ObjectStore - Failed to get database hive.default, returning NoSuchObjectException
[INFO ] 2024-04-23 23:40:53.780 [MetaStoreThread-39623] HMSHandler - Started creating a default database with name: default
[DEBUG] 2024-04-23 23:40:53.781 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.787 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.789 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.790 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.793 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.793 [MetaStoreThread-39623] HMSHandler - Successfully created a default database with name: default
[DEBUG] 2024-04-23 23:40:53.793 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.793 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:53.797 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.800 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:53.803 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.805 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] HMSHandler - Added admin role in metastore
[DEBUG] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:53.806 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] HMSHandler - Added public role in metastore
[DEBUG] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:53.807 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:53.808 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:53.808 [MetaStoreThread-39623] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:53.812 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.814 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:53.817 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:53.818 [MetaStoreThread-39623] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:53.819 [MetaStoreThread-39623] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:53.819 [MetaStoreThread-39623] HMSHandler - No user is added in admin role, since config is empty
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HMSHandler - HMS server filtering is disabled by configuration
[DEBUG] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] PerfLogger - </PERFLOG method=init start=1713912053046 end=1713912053820 duration=774 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=48 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Starting DB backed MetaStore Server with SetUGI enabled
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Started the new metaserver on port [39623]...
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Options.minWorkerThreads = 200
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Options.maxWorkerThreads = 1000
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - TCP keepalive = true
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Enable SSL = false
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Compaction HMS parameters:
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.initiator.on = false
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.worker.threads = 0
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - hive.metastore.runworker.in = metastore
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.history.retention.attempted = 2
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.history.retention.failed = 3
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.history.retention.succeeded = 3
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.initiator.failed.compacts.threshold = 2
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - metastore.compactor.enable.stats.compression
[WARN ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Compactor Initiator is turned Off. Automatic compaction will not be triggered.
[WARN ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Invalid number of Compactor Worker threads(0) on HMS
[INFO ] 2024-04-23 23:40:53.820 [MetaStoreThread-39623] HiveMetaStore - Direct SQL optimization = true
[DEBUG] 2024-04-23 23:40:54.046 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:54.046 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 49: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.046 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[INFO ] 2024-04-23 23:40:54.050 [main] MetaStoreTestUtils - MetaStore warehouse root dir (file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623) is created
[INFO ] 2024-04-23 23:40:54.050 [main] MetaStoreTestUtils - MetaStore Thrift Server started on port: 39623 with warehouse dir: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623 with jdbcUrl: jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[INFO ] 2024-04-23 23:40:54.050 [main] TestTxnDbUtil - Creating transactional tables
[INFO ] 2024-04-23 23:40:54.054 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:54.054 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39623]
[INFO ] 2024-04-23 23:40:54.054 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39623)
[INFO ] 2024-04-23 23:40:54.054 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39623) current connections: 5
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912054055 end=1713912054055 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 create_database: Database(name:db10, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:40:54.055 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_database: Database(name:db10, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[INFO ] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:54.056 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@fe46a07, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:54.057 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:54.058 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@fe46a07, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@43d36b67 created in the thread with id: 396
[DEBUG] 2024-04-23 23:40:54.058 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.058 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.058 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.059 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.060 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.060 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:54.060 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:54.060 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@fe46a07 from thread id: 396
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.915647ms
[DEBUG] 2024-04-23 23:40:54.061 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Failed to get database hive.db10, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:40:54.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:40:54.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.062 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[WARN ] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db for database db10. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.063 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.064 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.067 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.067 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_database start=1713912054055 end=1713912054067 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.067 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.068 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.068 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 create_table_req: Table(tableName:tbl10, dbName:db10, owner:alex, createTime:1713912054, lastAccessTime:1713912054, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:), FieldSchema(name:modts, type:timestamp, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:40:54.068 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 create_table_req: Table(tableName:tbl10, dbName:db10, owner:alex, createTime:1713912054, lastAccessTime:1713912054, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:d, type:date, comment:), FieldSchema(name:do, type:double, comment:), FieldSchema(name:s, type:string, comment:), FieldSchema(name:bo, type:boolean, comment:), FieldSchema(name:l, type:bigint, comment:), FieldSchema(name:b, type:binary, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:state, type:string, comment:), FieldSchema(name:dt, type:date, comment:), FieldSchema(name:modts, type:timestamp, comment:)], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:40:54.068 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.071 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 4.067183ms
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.072 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.077 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.078 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.416414ms
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.079 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.080 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:54.081 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623/db10.db/tbl10
[DEBUG] 2024-04-23 23:40:54.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.085 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.090 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.093 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.098 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.102 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.107 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.120 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.122 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.123 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=create_table_req start=1713912054068 end=1713912054123 duration=55 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.123 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.124 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.135 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.158 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:54.164 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623/db10.db/tbl10/state=__HIVE_DEFAULT_PARTITION__/dt=1990-01-01/modts=__HIVE_DEFAULT_PARTITION__
[DEBUG] 2024-04-23 23:40:54.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.171 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.172 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.176 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.188 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.193 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912054124 end=1713912054194 duration=70 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.194 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.194 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.194 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.195 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.197 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.200 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.201 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:54.202 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623/db10.db/tbl10/state=CA/dt=1986-04-28/modts=2020-02-21 08%3A30%3A01
[DEBUG] 2024-04-23 23:40:54.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.208 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.209 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.211 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.213 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.214 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912054194 end=1713912054214 duration=20 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=add_partition_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 add_partition : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 add_partition : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.215 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.216 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.219 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.219 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.220 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.220 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.220 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[INFO ] 2024-04-23 23:40:54.220 [TThreadPoolServer WorkerProcess-%d] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/39623/db10.db/tbl10/state=MN/dt=2018-11-31/modts=2020-02-21 08%3A19%3A01
[DEBUG] 2024-04-23 23:40:54.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.225 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.226 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.229 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.231 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.232 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=add_partition_with_environment_context start=1713912054215 end=1713912054232 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=flushCache from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=flushCache start=1713912054233 end=1713912054233 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_table : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.233 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.024719ms
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.234 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.236 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.238 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.240 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[INFO ] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_req start=1713912054233 end=1713912054241 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.241 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=8, comments=HMS client
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=alter_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 alter_table: hive.db10.tbl10 newtbl=tbl10
[INFO ] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 alter_table: hive.db10.tbl10 newtbl=tbl10	
[DEBUG] 2024-04-23 23:40:54.241 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.242 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.242 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.171277ms
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:54.243 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.095149ms
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.244 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.246 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.248 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.249 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.250 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.943325ms
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.251 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.253 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] ReplChangeManager - Repl policy is not set for database: db10
[WARN ] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] HiveAlterHandler - Alter table not cascaded to partitions.
[DEBUG] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.256 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.257 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getMTable for hive.db10.tbl10
[DEBUG] 2024-04-23 23:40:54.258 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:40:54.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.259 [TThreadPoolServer WorkerProcess-%d] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:40:54.263 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.266 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.270 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.270 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=alter_table_req start=1713912054241 end=1713912054270 duration=29 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.271 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.274 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 3.243245ms + 0.005349ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:54.277 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 2.575896ms + 0.068329ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:54.279 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.550505ms + 0.240272ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:54.281 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.553791ms + 0.177876ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.282 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.526ms + 0.147834ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:54.284 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.399028ms + 0.118303ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.286 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.362938ms + 0.116943ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.287 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.460427ms + 0.118633ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.289 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.610484ms + 0.394983ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.685868ms + 0.178453ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 20.481106ms
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.291 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.292 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912054271 end=1713912054292 duration=21 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:54.293 [main] HiveMetaStoreClient - HMS client filtering is enabled.
[INFO ] 2024-04-23 23:40:54.293 [main] HiveMetaStoreClient - Resolved metastore uris: [thrift://localhost:39623]
[INFO ] 2024-04-23 23:40:54.293 [main] HiveMetaStoreClient - Trying to connect to metastore with URI (thrift://localhost:39623)
[INFO ] 2024-04-23 23:40:54.293 [main] HiveMetaStoreClient - Opened a connection to metastore, URI (thrift://localhost:39623) current connections: 6
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=set_ugi from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=set_ugi start=1713912054294 end=1713912054294 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_meta from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: source:127.0.0.1 get_table_metas : tbl=hive.*db10*.*
[INFO ] 2024-04-23 23:40:54.294 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_table_metas : tbl=hive.*db10*.*	
[INFO ] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
[INFO ] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.autoCreateAll value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionDriverName value null from jpox.properties with org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPool.maxPoolSize value null from jpox.properties with 10
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.connectionPoolingType value null from jpox.properties with HikariCP
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionURL value null from jpox.properties with jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.ConnectionUserName value null from jpox.properties with APP
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.autoStartMechanismMode value null from jpox.properties with ignored
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2 value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.cache.level2.type value null from jpox.properties with none
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.initializeColumnInfo value null from jpox.properties with NONE
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.plugin.pluginRegistryBundleCheck value null from jpox.properties with LOG
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.transactionIsolation value null from jpox.properties with read-committed
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.rdbms.useLegacyNativeValueStrategy value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.DetachAllOnCommit value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.identifierFactory value null from jpox.properties with datanucleus1
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.PersistenceManagerFactoryClass value null from jpox.properties with org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.Multithreaded value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding javax.jdo.option.NonTransactionalRead value null from jpox.properties with true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.storeManagerType value null from jpox.properties with rdbms
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateColumns value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateConstraints value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - Overriding datanucleus.schema.validateTables value null from jpox.properties with false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.autoCreateAll = true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateTables = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.useLegacyNativeValueStrategy = true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateColumns = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPool.maxPoolSize = 10
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.autoStartMechanismMode = ignored
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.rdbms.initializeColumnInfo = NONE
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.Multithreaded = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.identifierFactory = datanucleus1
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.transactionIsolation = read-committed
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionURL = jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623;create=true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.DetachAllOnCommit = true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.NonTransactionalRead = true
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.schema.validateConstraints = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionDriverName = org.apache.derby.jdbc.EmbeddedDriver
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.option.ConnectionUserName = APP
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2 = false
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.plugin.pluginRegistryBundleCheck = LOG
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.cache.level2.type = none
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - javax.jdo.PersistenceManagerFactoryClass = org.datanucleus.api.jdo.JDOPersistenceManagerFactory
[DEBUG] 2024-04-23 23:40:54.295 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.storeManagerType = rdbms
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] PersistenceManagerProvider - datanucleus.connectionPoolingType = HikariCP
[INFO ] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@765bcaa1, with PersistenceManager: null will be shutdown
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - ObjectStore, initialize called
[INFO ] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@765bcaa1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3e52fe47 created in the thread with id: 408
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.296 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.297 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - Using direct SQL, underlying DB is org.apache.hadoop.hive.metastore.DatabaseProduct@16822855
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Initialized ObjectStore
[INFO ] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] HMSHandler - Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@765bcaa1 from thread id: 408
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.298 [TThreadPoolServer WorkerProcess-%d] ObjectStore - getTableMeta with filter  (database.catalogName == :param1 ) &&  (database.name.matches(:param2) ) &&  (tableType == :param3 ) params: hive, (?i).*db10.*, EXTERNAL_TABLE
[DEBUG] 2024-04-23 23:40:54.303 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_meta start=1713912054294 end=1713912054304 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[INFO ] 2024-04-23 23:40:54.304 [main] PartitionManagementTask - Looking for tables using catalog: hive dbPattern: *db10* tablePattern: * found: 0
[INFO ] 2024-04-23 23:40:54.304 [main] HiveMetaStoreClient - Closed a connection to metastore, current connections: 5
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=shutdown from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Cleaning up thread local RawStore...
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_partitions from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@765bcaa1, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@3e52fe47 will be shutdown
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_partitions : tbl=hive.db10.tbl10	
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing getPartitions
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=shutdown start=1713912054304 end=1713912054304 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=51 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 51: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.304 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:54.305 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 1.075732ms + 0.00472ms, the query is [select "PARTITIONS"."PART_ID" from "PARTITIONS"  inner join "TBLS" on "PARTITIONS"."TBL_ID" = "TBLS"."TBL_ID"     and "TBLS"."TBL_NAME" = ?   inner join "DBS" on "TBLS"."DB_ID" = "DBS"."DB_ID"      and "DBS"."NAME" = ?  where "DBS"."CTLG_NAME" = ?  order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:54.306 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.587895ms + 0.083938ms, the query is [select "PARTITIONS"."PART_ID", "SDS"."SD_ID", "SDS"."CD_ID", "SERDES"."SERDE_ID", "PARTITIONS"."CREATE_TIME", "PARTITIONS"."LAST_ACCESS_TIME", "SDS"."INPUT_FORMAT", "SDS"."IS_COMPRESSED", "SDS"."IS_STOREDASSUBDIRECTORIES", "SDS"."LOCATION", "SDS"."NUM_BUCKETS", "SDS"."OUTPUT_FORMAT", "SERDES"."NAME", "SERDES"."SLIB", "PARTITIONS"."WRITE_ID" from "PARTITIONS"  left outer join "SDS" on "PARTITIONS"."SD_ID" = "SDS"."SD_ID"   left outer join "SERDES" on "SDS"."SERDE_ID" = "SERDES"."SERDE_ID" where "PART_ID" in (2,3,1) order by "PART_NAME" asc]
[DEBUG] 2024-04-23 23:40:54.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.212777ms + 0.285213ms, the query is [select "PART_ID", "PARAM_KEY", "PARAM_VALUE" from "PARTITION_PARAMS" where "PART_ID" in (2,3,1) and "PARAM_KEY" is not null order by "PART_ID" asc]
[DEBUG] 2024-04-23 23:40:54.307 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.166823ms + 0.15281ms, the query is [select "PART_ID", "PART_KEY_VAL" from "PARTITION_KEY_VALS" where "PART_ID" in (2,3,1) order by "PART_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.169046ms + 0.103461ms, the query is [select "SD_ID", "PARAM_KEY", "PARAM_VALUE" from "SD_PARAMS" where "SD_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SD_ID" asc]
[DEBUG] 2024-04-23 23:40:54.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.138268ms + 0.102518ms, the query is [select "SD_ID", "COLUMN_NAME", "SORT_COLS"."ORDER" from "SORT_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.151178ms + 0.101716ms, the query is [select "SD_ID", "BUCKET_COL_NAME" from "BUCKETING_COLS" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.308 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.151041ms + 0.134905ms, the query is [select "SD_ID", "SKEWED_COL_NAME" from "SKEWED_COL_NAMES" where "SD_ID" in (3,4,2) order by "SD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.186741ms + 0.203044ms, the query is [select "CD_ID", "COMMENT", "COLUMN_NAME", "TYPE_NAME" from "COLUMNS_V2" where "CD_ID" in (1) order by "CD_ID" asc, "INTEGER_IDX" asc]
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] MetastoreDirectSqlUtils - Direct SQL query in 0.180005ms + 0.129152ms, the query is [select "SERDE_ID", "PARAM_KEY", "PARAM_VALUE" from "SERDE_PARAMS" where "SERDE_ID" in (3,4,2) and "PARAM_KEY" is not null order by "SERDE_ID" asc]
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 3 entries retrieved using SQL in 5.116084ms
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.309 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_partitions start=1713912054304 end=1713912054310 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_catalogs from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_catalogs
[INFO ] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_catalogs	
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Fetching all catalog names
[DEBUG] 2024-04-23 23:40:54.310 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_catalogs start=1713912054310 end=1713912054313 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_databases from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_databases: @hive#
[INFO ] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_databases: @hive#	
[DEBUG] 2024-04-23 23:40:54.313 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_databases start=1713912054313 end=1713912054316 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.316 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.317 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_database: db10
[INFO ] 2024-04-23 23:40:54.317 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_database: db10	
[DEBUG] 2024-04-23 23:40:54.317 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.200883ms
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_database_req start=1713912054316 end=1713912054318 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.318 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=2, comments=HMS client
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_tables_by_type from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_tables_by_type: db=@hive#db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_tables_by_type: db=@hive#db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:54.318 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.319 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.319 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.320 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.230572ms
[DEBUG] 2024-04-23 23:40:54.320 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 2.508108ms
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_tables_by_type start=1713912054318 end=1713912054322 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_all_tables from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:40:54.322 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:40:54.323 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.325 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.325 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 3.029301ms
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_all_tables start=1713912054322 end=1713912054326 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.326 [main] HiveMetaStoreClient - Selecting dropDatabase method for db10 (1 tables), metastore.batch.retrieve.max=300
[DEBUG] 2024-04-23 23:40:54.326 [main] HiveMetaStoreClient - Dropping database in a per DB manner.
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=get_table_objects_by_name_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.326 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.327838ms
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_multi_table : db=db10 tbls=tbl10
[INFO ] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_multi_table : db=db10 tbls=tbl10	
[DEBUG] 2024-04-23 23:40:54.327 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.331 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.912307ms
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=get_table_objects_by_name_req start=1713912054326 end=1713912054332 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:54.332 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.333 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.333 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 1.045293ms
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.603336ms
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:40:54.334 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.343 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.373 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@2f185682, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@22764747 will be shutdown
[DEBUG] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 46: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.375 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:54.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.377 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:54.377 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:54.377 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.383 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.387 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:54.387 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:54.387 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.416 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking for FS supporting file
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - looking for configuration option fs.file.impl
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - Looking in service filesystems for implementation class
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] FileSystem - FS for file is class org.apache.hadoop.fs.LocalFileSystem
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:54.419 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.864614ms
[DEBUG] 2024-04-23 23:40:54.420 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.447659ms
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.421 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.993417ms
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:54.422 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:54.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:54.423 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:54.445 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@918722214 (XID = 1152), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.450 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:54.455 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:54.455 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:54.455 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.456 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.457 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.459 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.460 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.462 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.711 [HikariPool-5 housekeeper] HikariPool - HikariPool-5 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] TThreadPoolServer - Error processing request
org.apache.thrift.transport.TTransportException: Socket is closed by peer.
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:181) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:109) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.security.TFilterTransport.readAll(TFilterTransport.java:63) ~[classes/:?]
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:463) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:361) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:244) ~[libthrift-0.14.1.jar:0.14.1]
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:76) ~[classes/:?]
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248) [libthrift-0.14.1.jar:0.14.1]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
[DEBUG] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Cleaning up thread local RawStore...
[INFO ] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Cleaning up thread local RawStore...	
[INFO ] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] ObjectStore - RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6f7c4374, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@4bf11fd9 will be shutdown
[DEBUG] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 19: Done cleaning up thread local RawStore
[INFO ] 2024-04-23 23:40:54.711 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=Done cleaning up thread local RawStore	
[DEBUG] 2024-04-23 23:40:54.712 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:54.716 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:54.716 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.716 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:54.718 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:54.718 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:54.718 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 1 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:56.719 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:40:56.719 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:40:56.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:56.719 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.721 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.107926ms
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.487392ms
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:40:56.722 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.723 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:56.724 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.725 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:56.725 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:56.725 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.765304ms
[DEBUG] 2024-04-23 23:40:56.726 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.428392ms
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.727 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.924519ms
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:56.728 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:56.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:56.729 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:56.730 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:56.731 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:56.731 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:56.731 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 2 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:40:57.020 [HikariPool-7 housekeeper] HikariPool - HikariPool-7 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:57.191 [HikariPool-10 housekeeper] HikariPool - HikariPool-10 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:40:58.732 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:40:58.732 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:40:58.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:40:58.732 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.734 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.107787ms
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:40:58.735 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.582493ms
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:40:58.737 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.738 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:40:58.738 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:40:58.738 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.739 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:40:58.739 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:40:58.739 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.740 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.778708ms
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.450846ms
[DEBUG] 2024-04-23 23:40:58.741 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.764415ms
[DEBUG] 2024-04-23 23:40:58.742 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:40:58.743 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:40:58.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:40:58.744 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:40:58.744 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:58.745 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:40:58.746 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:40:58.746 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:40:58.746 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 3 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:00.746 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:00.747 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:00.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:00.747 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.749 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.024473ms
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:00.750 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.66418ms
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:00.752 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.753 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:00.753 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:00.753 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.754 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.797477ms
[DEBUG] 2024-04-23 23:41:00.755 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.453409ms
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.756 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.789314ms
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:00.757 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:00.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:00.758 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:00.759 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:00.760 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:00.760 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:00.760 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 4 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:01.214 [HikariPool-12 housekeeper] HikariPool - HikariPool-12 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:02.151 [HikariPool-4 housekeeper] HikariPool - HikariPool-4 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:02.761 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:02.761 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:02.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:02.761 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.763 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.047782ms
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:02.764 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.63782ms
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:02.766 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.767 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:02.767 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:02.767 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.768 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:02.768 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:02.768 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.769 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.833251ms
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.450585ms
[DEBUG] 2024-04-23 23:41:02.770 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.771 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:02.771 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.768627ms
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:02.772 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:02.773 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:02.774 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:02.775 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 5 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:04.775 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:04.775 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:04.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:04.775 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.778 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.391277ms
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:04.779 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 2.108209ms
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:04.781 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.786 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:04.786 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:04.786 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.788 [HikariPool-6 housekeeper] HikariPool - HikariPool-6 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:04.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.789 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:04.789 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:04.789 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.791 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.792 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:04.792 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:04.792 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.794 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:04.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.89544ms
[DEBUG] 2024-04-23 23:41:04.795 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 1.719689ms
[DEBUG] 2024-04-23 23:41:04.797 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.799 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:04.801 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.765531ms
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:04.802 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:04.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:04.805 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:04.807 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:04.808 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.809 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:04.810 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:04.812 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:04.812 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:04.813 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 6 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:06.813 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:06.813 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:06.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:06.813 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.816 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:06.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.816 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.006248ms
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.482279ms
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:06.817 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.818 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:06.818 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:06.818 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.819 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:06.819 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:06.819 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.820 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:06.820 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:06.820 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.81326ms
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.442351ms
[DEBUG] 2024-04-23 23:41:06.821 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.822 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:06.822 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.718764ms
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:06.823 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:06.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:06.824 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:06.824 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:06.824 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:06.825 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:06.826 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:06.826 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:06.826 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 7 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:08.827 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:08.827 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:08.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:08.827 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 2.345035ms
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:08.829 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.485491ms
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:08.830 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.831 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:08.831 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:08.831 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.832 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.833 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:08.833 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:08.833 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.833 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.952653ms
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.477538ms
[DEBUG] 2024-04-23 23:41:08.834 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.835 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:08.835 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.784516ms
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:08.836 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:08.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:08.837 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:08.838 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:08.839 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:08.839 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:08.839 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 8 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:09.130 [HikariPool-8 housekeeper] HikariPool - HikariPool-8 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:09.247 [HikariPool-11 housekeeper] HikariPool - HikariPool-11 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:10.840 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:10.840 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:10.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:10.840 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.843 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.412148ms
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:10.844 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.162231ms
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:10.845 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.846 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:10.846 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:10.846 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.847 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:10.847 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:10.847 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.848 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.732419ms
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.453791ms
[DEBUG] 2024-04-23 23:41:10.849 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.850 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:10.850 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.858706ms
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:10.851 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:10.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:10.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:10.852 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:10.853 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:10.854 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:10.854 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:10.854 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 9 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:12.855 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:12.855 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:12.855 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:12.856 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.858 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 3.253601ms
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:12.859 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 1.847693ms
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:12.861 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.862 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:12.863 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:12.864 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.774814ms
[DEBUG] 2024-04-23 23:41:12.865 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.472454ms
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.866 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.728026ms
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:12.867 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:12.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:12.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:12.868 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:12.869 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:12.870 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:12.870 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:12.870 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - Retrying HMSHandler after 2000 ms (attempt 10 of 10) with error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:13.133 [HikariPool-9 housekeeper] HikariPool - HikariPool-9 - Pool stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 drop_database: @hive#db10
[INFO ] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 drop_database: @hive#db10	
[DEBUG] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.871 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.982721ms
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_tables: db=@hive#db10
[INFO ] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_tables: db=@hive#db10	
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.872 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 1 entries retrieved using SQL in 0.591669ms
[DEBUG] 2024-04-23 23:41:14.873 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_functions: db=@hive#db10 pat=*
[INFO ] 2024-04-23 23:41:14.873 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_functions: db=@hive#db10 pat=*	
[DEBUG] 2024-04-23 23:41:14.873 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.874 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_stored_procedures
[INFO ] 2024-04-23 23:41:14.874 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_stored_procedures	
[DEBUG] 2024-04-23 23:41:14.874 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.875 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 get_all_packages
[INFO ] 2024-04-23 23:41:14.875 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 get_all_packages	
[DEBUG] 2024-04-23 23:41:14.875 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] HMSHandler - 50: source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] audit - ugi=alex	ip=127.0.0.1	cmd=source:127.0.0.1 getTablesByTypeCore: catName=hive: db=db10 pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.876 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.791277ms
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - 0 entries retrieved using SQL in 0.555084ms
[DEBUG] 2024-04-23 23:41:14.877 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.878 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:14.878 [TThreadPoolServer WorkerProcess-%d] MetaStoreDirectSql - getDatabase: directsql returning db db10 locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/db10.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - db details for db db10 retrieved using SQL in 0.779912ms
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Dropping database hive.db10 along with all tables
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:41:14.879 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:41:14.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:41:14.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:41:14.880 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='db10'>
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@200688912 (XID = 1717), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_34313), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:14.881 [TThreadPoolServer WorkerProcess-%d] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:41:14.882 [TThreadPoolServer WorkerProcess-%d] PoolBase - HikariPool-13 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@949737438 (XID = 1150), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db_39623), (DRDAID = null) 
[DEBUG] 2024-04-23 23:41:14.882 [TThreadPoolServer WorkerProcess-%d] ObjectStore - rolling back transaction: no open transactions: 0
[ERROR] 2024-04-23 23:41:14.882 [TThreadPoolServer WorkerProcess-%d] RetryingHMSHandler - HMSHandler Fatal error: javax.jdo.JDODataStoreException: Exception thrown flushing changes to datastore
	at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.java:542)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:162)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
NestedThrowablesStackTrace:
java.sql.BatchUpdateException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.EmbedStatement.executeLargeBatch(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeBatch(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:125)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at org.datanucleus.store.rdbms.ParamLoggingPreparedStatement.executeBatch(ParamLoggingPreparedStatement.java:366)
	at org.datanucleus.store.rdbms.SQLController.processConnectionStatement(SQLController.java:675)
	at org.datanucleus.store.rdbms.SQLController.processStatementsForConnection(SQLController.java:643)
	at org.datanucleus.store.rdbms.SQLController$1.transactionFlushed(SQLController.java:729)
	at org.datanucleus.store.connection.AbstractManagedConnection.transactionFlushed(AbstractManagedConnection.java:95)
	at org.datanucleus.store.connection.ConnectionManagerImpl$2.transactionFlushed(ConnectionManagerImpl.java:528)
	at org.datanucleus.TransactionImpl.flush(TransactionImpl.java:222)
	at org.datanucleus.TransactionImpl.commit(TransactionImpl.java:286)
	at org.datanucleus.api.jdo.JDOTransaction.commit(JDOTransaction.java:99)
	at org.apache.hadoop.hive.metastore.ObjectStore.commitTransaction(ObjectStore.java:615)
	at sun.reflect.GeneratedMethodAccessor140.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.java:97)
	at com.sun.proxy.$Proxy30.commitTransaction(Unknown Source)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1790)
	at org.apache.hadoop.hive.metastore.HMSHandler.drop_database(HMSHandler.java:1869)
	at sun.reflect.GeneratedMethodAccessor146.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy35.drop_database(Unknown Source)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18285)
	at org.apache.hadoop.hive.metastore.api.ThriftHiveMetastore$Processor$drop_database.getResult(ThriftHiveMetastore.java:18264)
	at org.apache.thrift.ProcessFunction.process(ProcessFunction.java:38)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:111)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor$1.run(TUGIBasedProcessor.java:107)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1682)
	at org.apache.hadoop.hive.metastore.TUGIBasedProcessor.process(TUGIBasedProcessor.java:119)
	at org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:248)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.derby.shared.common.error.DerbySQLIntegrityConstraintViolationException: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.Util.generateCsSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.wrapInSQLException(Unknown Source)
	at org.apache.derby.impl.jdbc.TransactionResourceImpl.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedConnection.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.ConnectionChild.handleException(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedStatement.executeStatement(Unknown Source)
	at org.apache.derby.impl.jdbc.EmbedPreparedStatement.executeBatchElement(Unknown Source)
	... 40 more
Caused by: ERROR 23503: DELETE on table 'DBS' caused a violation of foreign key constraint 'TBLS_FK1' for key (2).  The statement has been rolled back.
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.iapi.error.StandardException.newException(Unknown Source)
	at org.apache.derby.impl.sql.execute.ReferencedKeyRIChecker.doCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.RISetChecker.doPKCheck(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.collectAffectedRows(Unknown Source)
	at org.apache.derby.impl.sql.execute.DeleteResultSet.open(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.executeStmt(Unknown Source)
	at org.apache.derby.impl.sql.GenericPreparedStatement.execute(Unknown Source)
	... 42 more

[DEBUG] 2024-04-23 23:41:14.883 [TThreadPoolServer WorkerProcess-%d] PerfLogger - </PERFLOG method=drop_database start=1713912054332 end=1713912074883 duration=20551 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=50 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:41:14.921 [Thread-15] ShutdownHookManager - ShutdownHookManger complete shutdown.
