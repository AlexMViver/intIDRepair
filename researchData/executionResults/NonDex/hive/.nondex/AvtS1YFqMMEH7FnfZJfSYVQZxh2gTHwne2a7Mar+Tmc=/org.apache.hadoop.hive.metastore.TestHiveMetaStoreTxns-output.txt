[DEBUG] 2024-04-23 23:37:40.854 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:40.872 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:37:40.873 [main] HikariConfig - HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:37:40.873 [main] HikariConfig - HikariPool-2 - configuration:
[DEBUG] 2024-04-23 23:37:40.874 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:37:40.874 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:37:40.874 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:37:40.874 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:37:40.874 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:37:40.874 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:37:40.874 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:37:40.874 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:37:40.875 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - poolName........................"HikariPool-2"
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:37:40.876 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:37:40.877 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:37:40.877 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:37:40.877 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:37:40.877 [main] HikariDataSource - HikariPool-2 - Starting...
[INFO ] 2024-04-23 23:37:40.878 [main] PoolBase - HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:37:40.879 [main] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:40.879 [main] HikariDataSource - HikariPool-2 - Start completed.
[DEBUG] 2024-04-23 23:37:40.879 [main] HikariCPDataSourceProvider - Creating Hikari connection pool for the MetaStore
[WARN ] 2024-04-23 23:37:40.880 [main] HikariConfig - HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
[DEBUG] 2024-04-23 23:37:40.880 [main] HikariConfig - HikariPool-3 - configuration:
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - allowPoolSuspension.............false
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - autoCommit......................true
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - catalog.........................none
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - connectionInitSql...............none
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - connectionTestQuery.............none
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - connectionTimeout...............30000
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - dataSource......................none
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - dataSourceClassName.............none
[DEBUG] 2024-04-23 23:37:40.881 [main] HikariConfig - dataSourceJNDI..................none
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - dataSourceProperties............{password=<masked>}
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - driverClassName.................none
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - healthCheckProperties...........{}
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - healthCheckRegistry.............none
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - idleTimeout.....................600000
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - initializationFailFast..........true
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - initializationFailTimeout.......1
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - isolateInternalQueries..........false
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - jdbc4ConnectionTest.............false
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - jdbcUrl........................."jdbc:derby:memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db;create=true"
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - leakDetectionThreshold..........0
[DEBUG] 2024-04-23 23:37:40.882 [main] HikariConfig - maxLifetime.....................1800000
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - maximumPoolSize.................10
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - metricRegistry..................none
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - metricsTrackerFactory...........none
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - minimumIdle.....................10
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - password........................<masked>
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - poolName........................"HikariPool-3"
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - readOnly........................false
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - registerMbeans..................false
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - scheduledExecutor...............none
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - scheduledExecutorService........internal
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - threadFactory...................internal
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - transactionIsolation............default
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - username........................"APP"
[DEBUG] 2024-04-23 23:37:40.883 [main] HikariConfig - validationTimeout...............5000
[INFO ] 2024-04-23 23:37:40.884 [main] HikariDataSource - HikariPool-3 - Starting...
[INFO ] 2024-04-23 23:37:40.885 [main] PoolBase - HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
[DEBUG] 2024-04-23 23:37:40.886 [main] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@697707311 (XID = 1566), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:40.886 [main] HikariDataSource - HikariPool-3 - Start completed.
[DEBUG] 2024-04-23 23:37:40.886 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.888 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:40.889 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.890 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:40.894 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:40.898 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:40.899 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:40.906 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:37:40.908 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:40.916 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:40.917 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.917 [main] PerfLogger - </PERFLOG method=open_txns start=1713911860854 end=1713911860917 duration=63 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:40.918 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:40.926 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:37:40.929 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:37:40.929 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:40.929 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:40.930 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:37:40.930 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:40.941 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:40.942 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:40.944 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:40.945 [main] TxnHandler - Going to execute update <UPDATE "TABLE_PARAMS" SET "PARAM_VALUE" = 'myvalue' WHERE "TBL_ID" = 10 AND "PARAM_KEY" = '_metamykey'>
[WARN ] 2024-04-23 23:37:40.948 [main] TxnHandler - Error updating key/value in the sql backend with txnId=1, tableId=10, key=_metamykey, value=myvalue. Only one row should have been affected but 0 rows where affected.
[DEBUG] 2024-04-23 23:37:40.950 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:40.951 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:37:40.952 [main] RetryingHMSHandler - java.lang.IllegalStateException: Error updating key/value in the sql backend with txnId=1, tableId=10, key=_metamykey, value=myvalue. Only one row should have been affected but 0 rows where affected.
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.updateKeyValueAssociatedWithTxn(TxnHandler.java:1773)
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.commitTxn(TxnHandler.java:1575)
	at org.apache.hadoop.hive.metastore.HMSHandler.commit_txn(HMSHandler.java:8741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy37.commit_txn(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.commitTxnWithKeyValue(HiveMetaStoreClient.java:3964)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxNWithKeyValueNoTableId(TestHiveMetaStoreTxns.java:177)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:37:40.952 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911860918 end=1713911860952 duration=34 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:37:40.952 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:40.953 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:40.956 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 1.
[DEBUG] 2024-04-23 23:37:40.956 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:40.956 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.959 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911860952 end=1713911860959 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:40.960 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:40.965 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:40.967 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:40.970 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:40.972 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:40.974 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:40.976 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:40.979 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:40.979 [HikariPool-2 housekeeper] HikariPool - HikariPool-2 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:37:40.981 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@2090609160 (XID = 1613), (SESSIONID = 31), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.982 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1033969715 (XID = 1615), (SESSIONID = 33), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.983 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:40.983 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@206986148 (XID = 1619), (SESSIONID = 35), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.985 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1569644412 (XID = 1621), (SESSIONID = 37), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.986 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:40.986 [HikariPool-3 housekeeper] HikariPool - HikariPool-3 - Pool stats (total=1, active=0, idle=1, waiting=0)
[DEBUG] 2024-04-23 23:37:40.988 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1307385296 (XID = 1624), (SESSIONID = 39), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.990 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@380813149 (XID = 1629), (SESSIONID = 41), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.991 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1505814083 (XID = 1631), (SESSIONID = 43), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.992 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1469035878 (XID = 1633), (SESSIONID = 45), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.993 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1209134775 (XID = 1635), (SESSIONID = 47), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.994 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:40.994 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1712489039 (XID = 1638), (SESSIONID = 49), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.995 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@288801938 (XID = 1641), (SESSIONID = 51), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.995 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@933251625 (XID = 1643), (SESSIONID = 53), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.997 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@10398963 (XID = 1645), (SESSIONID = 55), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:40.999 [HikariPool-2 connection adder] HikariPool - HikariPool-2 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:37:40.999 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1814926012 (XID = 1647), (SESSIONID = 57), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.000 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:41.000 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@871239992 (XID = 1650), (SESSIONID = 59), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.001 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1446133091 (XID = 1653), (SESSIONID = 61), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.003 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@1157328691 (XID = 1655), (SESSIONID = 63), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.003 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:41.004 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - Added connection org.apache.derby.impl.jdbc.EmbedConnection@33910568 (XID = 1659), (SESSIONID = 65), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.004 [HikariPool-3 connection adder] HikariPool - HikariPool-3 - After adding stats (total=10, active=0, idle=10, waiting=0)
[DEBUG] 2024-04-23 23:37:41.006 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:41.008 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:41.011 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:41.027 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.027 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:41.029 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:41.032 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:41.033 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:41.037 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:37:41.038 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:41.038 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:41.038 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.038 [main] PerfLogger - </PERFLOG method=open_txns start=1713911861027 end=1713911861038 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.038 [main] PerfLogger - <PERFLOG method=allocate_table_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.039 [main] TxnHandler - Going to execute query <SELECT COUNT(*) FROM "TXNS" WHERE "TXN_STATE" = 'o' AND "TXN_TYPE" != 2 AND "TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:37:41.043 [main] TxnHandler - Going to execute query <SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE" FROM "TXNS" WHERE "TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:37:41.046 [main] TxnHandler - Going to execute query <SELECT "CTC_TXNID" FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_TXNID" in (1)>
[ERROR] 2024-04-23 23:37:41.048 [main] TxnHandler - Write ID allocation on db.tbl failed for input txns: {1,read-only}
[DEBUG] 2024-04-23 23:37:41.049 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:41.049 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:37:41.049 [main] RetryingHMSHandler - java.lang.IllegalStateException: Write ID allocation failed on db.tbl as not all input txns in open state or read-only
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.allocateTableWriteIds(TxnHandler.java:2140)
	at org.apache.hadoop.hive.metastore.HMSHandler.allocate_table_write_ids(HMSHandler.java:8821)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy37.allocate_table_write_ids(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteIdsBatchIntr(HiveMetaStoreClient.java:4033)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteIdsBatch(HiveMetaStoreClient.java:4020)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.allocateTableWriteId(HiveMetaStoreClient.java:4012)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testAllocateTableWriteIdForReadOnlyTxn(TestHiveMetaStoreTxns.java:360)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:37:41.049 [main] PerfLogger - </PERFLOG method=allocate_table_write_ids start=1713911861038 end=1713911861049 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[INFO ] 2024-04-23 23:37:41.050 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:41.053 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.053 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.056 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:41.056 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.057 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.057 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:41.057 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:41.058 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:41.058 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:41.058 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:41.059 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:41.059 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:41.059 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:41.059 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:41.060 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:41.073 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.073 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:41.076 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:41.080 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:41.080 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:41.084 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:37:41.085 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:41.085 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:41.085 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.085 [main] PerfLogger - </PERFLOG method=open_txns start=1713911861073 end=1713911861085 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.087 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.088 [main] HMSHandler - 0: create_database: Database(name:mydbKeyValueWrongPrefix, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:37:41.088 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydbKeyValueWrongPrefix, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:37:41.088 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.090 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.090 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.090 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.090 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.17658ms
[DEBUG] 2024-04-23 23:37:41.090 [main] ObjectStore - Failed to get database hive.mydbKeyValueWrongPrefix, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:37:41.091 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:37:41.091 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.093 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.093 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.095 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 23:37:41.097 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[INFO ] 2024-04-23 23:37:41.099 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[INFO ] 2024-04-23 23:37:41.108 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:37:41.108 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.109 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.110 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.110 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.112 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.112 [main] PerfLogger - </PERFLOG method=create_database start=1713911861087 end=1713911861112 duration=25 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.119 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.120 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydbKeyValueWrongPrefix, owner:alex, createTime:1713911861, lastAccessTime:1713911861, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:37:41.120 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydbKeyValueWrongPrefix, owner:alex, createTime:1713911861, lastAccessTime:1713911861, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:37:41.120 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.130 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.130 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.131 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.131 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.131 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 10.672747ms
[DEBUG] 2024-04-23 23:37:41.131 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.131 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.131 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:37:41.140 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.140 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.141 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.142 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.142 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.143 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.143 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.143 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.144 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.767471ms
[DEBUG] 2024-04-23 23:37:41.144 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.144 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.144 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:37:41.145 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.145 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:37:41.146 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db/mytable
[DEBUG] 2024-04-23 23:37:41.151 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.151 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.157 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.165 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.174 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.182 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.189 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.210 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.211 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.215 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.218 [main] PerfLogger - </PERFLOG method=create_table_req start=1713911861119 end=1713911861218 duration=99 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.218 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.219 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:37:41.219 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:37:41.219 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.221 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.221 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.221 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.221 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.222 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.337419ms
[DEBUG] 2024-04-23 23:37:41.222 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.222 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.222 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:37:41.242 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.286 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.288 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:41.290 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:37:41.290 [main] PerfLogger - </PERFLOG method=get_table_req start=1713911861218 end=1713911861290 duration=72 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.291 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=73, comments=HMS client
[DEBUG] 2024-04-23 23:37:41.292 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.294 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:37:41.294 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:37:41.294 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:41.294 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:41.294 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.295 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:41.297 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:41.298 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:41.298 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:37:41.298 [main] TxnHandler - Error updating key/value in the sql backend with txnId=1, tableId=1, key=mykey, value=myvalue. key should start with _meta.
[DEBUG] 2024-04-23 23:37:41.298 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:41.299 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[ERROR] 2024-04-23 23:37:41.299 [main] RetryingHMSHandler - java.lang.IllegalArgumentException: Error updating key/value in the sql backend with txnId=1, tableId=1, key=mykey, value=myvalue. key should start with _meta.
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.updateKeyValueAssociatedWithTxn(TxnHandler.java:1756)
	at org.apache.hadoop.hive.metastore.txn.TxnHandler.commitTxn(TxnHandler.java:1575)
	at org.apache.hadoop.hive.metastore.HMSHandler.commit_txn(HMSHandler.java:8741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy37.commit_txn(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.commitTxnWithKeyValue(HiveMetaStoreClient.java:3964)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxNWithKeyWrongPrefix(TestHiveMetaStoreTxns.java:206)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:37:41.299 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911861292 end=1713911861299 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:37:41.299 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.299 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:37:41.299 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:37:41.299 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.301 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.302 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.302 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.302 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.302 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.844855ms
[DEBUG] 2024-04-23 23:37:41.302 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.302 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.302 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:37:41.306 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.312 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.314 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:41.315 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:37:41.315 [main] PerfLogger - </PERFLOG method=get_table_req start=1713911861299 end=1713911861315 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.315 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=16, comments=HMS client
[DEBUG] 2024-04-23 23:37:41.315 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.316 [main] HMSHandler - 0: drop_table : tbl=hive.mydbKeyValueWrongPrefix.mytable
[INFO ] 2024-04-23 23:37:41.316 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.mydbKeyValueWrongPrefix.mytable	
[DEBUG] 2024-04-23 23:37:41.316 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.316 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.318 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.318 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.318 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.318 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.458149ms
[DEBUG] 2024-04-23 23:37:41.318 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.320 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.320 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.320 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.320 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 1.687451ms
[DEBUG] 2024-04-23 23:37:41.320 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.320 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.320 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:37:41.324 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.330 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.330 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.334 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.335 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.335 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:37:41.347 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:37:41.347 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.348 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.365 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.365 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.365 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.365 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:37:41.366 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.367 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:37:41.367 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.394 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.402 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:37:41.402 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.402 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:37:41.402 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:37:41.402 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.412 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.419 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:37:41.419 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:37:41.419 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.419 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:37:41.419 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:37:41.420 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:37:41.420 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.431 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.431 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:37:41.431 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:37:41.431 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.442 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.442 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:37:41.443 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.443 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:37:41.443 [main] ObjectStore - Executing getMTable for hive.mydbkeyvaluewrongprefix.mytable
[DEBUG] 2024-04-23 23:37:41.444 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:37:41.451 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.455 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:37:41.455 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.455 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:37:41.483 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:37:41.483 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.548 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.548 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.551 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.552 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:37:41.552 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:37:41.552 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db/mytable
[INFO ] 2024-04-23 23:37:41.556 [main] deprecation - io.bytes.per.checksum is deprecated. Instead, use dfs.bytes-per-checksum
[DEBUG] 2024-04-23 23:37:41.559 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713911861315 end=1713911861559 duration=244 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.559 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.560 [main] HMSHandler - 0: get_database: mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:37:41.560 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:37:41.560 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.562 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.563 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.563 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.563 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.563 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 3.230192ms
[DEBUG] 2024-04-23 23:37:41.563 [main] PerfLogger - </PERFLOG method=get_database_req start=1713911861559 end=1713911861563 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.563 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=4, comments=HMS client
[DEBUG] 2024-04-23 23:37:41.563 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.563 [main] HMSHandler - 0: drop_database: @hive#mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:37:41.563 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:37:41.563 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:41.564 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.565 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.566 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.566 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.566 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.773475ms
[DEBUG] 2024-04-23 23:37:41.566 [main] HMSHandler - 0: get_all_tables: db=@hive#mydbKeyValueWrongPrefix
[INFO ] 2024-04-23 23:37:41.567 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#mydbKeyValueWrongPrefix	
[DEBUG] 2024-04-23 23:37:41.567 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.573 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.573 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.573 [main] ObjectStore - 0 entries retrieved using SQL in 5.875753ms
[DEBUG] 2024-04-23 23:37:41.573 [main] HMSHandler - 0: get_functions: db=@hive#mydbKeyValueWrongPrefix pat=*
[INFO ] 2024-04-23 23:37:41.574 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#mydbKeyValueWrongPrefix pat=*	
[DEBUG] 2024-04-23 23:37:41.574 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.594 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.606 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.607 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:37:41.607 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:37:41.607 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.617 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.624 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.624 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:37:41.624 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:37:41.624 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.662 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.668 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.669 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=mydbKeyValueWrongPrefix pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:41.669 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=mydbKeyValueWrongPrefix pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:41.669 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.671 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvaluewrongprefix locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:41.672 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.672 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.672 [main] ObjectStore - db details for db mydbkeyvaluewrongprefix retrieved using SQL in 2.382477ms
[DEBUG] 2024-04-23 23:37:41.672 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.676 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:41.676 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.676 [main] ObjectStore - 0 entries retrieved using SQL in 4.535605ms
[INFO ] 2024-04-23 23:37:41.677 [main] ObjectStore - Dropping database hive.mydbKeyValueWrongPrefix along with all tables
[DEBUG] 2024-04-23 23:37:41.677 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:41.677 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:41.682 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:41.682 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:37:41.700 [main] PoolBase - HikariPool-1 - Reset (autoCommit, isolation) on connection org.apache.derby.impl.jdbc.EmbedConnection@1260594329 (XID = 1158), (SESSIONID = 5), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.705 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:37:41.711 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:41.713 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:41.713 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.713 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:37:41.716 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:37:41.717 [main] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:37:41.720 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:37:41.722 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:37:41.724 [main] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='mydbkeyvaluewrongprefix'>
[DEBUG] 2024-04-23 23:37:41.726 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:41.727 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.727 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:41.728 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.728 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:37:41.728 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:37:41.729 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:37:41.730 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:37:41.730 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvaluewrongprefix
[DEBUG] 2024-04-23 23:37:41.730 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvaluewrongprefix.db
[DEBUG] 2024-04-23 23:37:41.731 [main] PerfLogger - </PERFLOG method=drop_database start=1713911861563 end=1713911861731 duration=168 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.731 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.731 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:41.734 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 1.
[DEBUG] 2024-04-23 23:37:41.735 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:41.735 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.735 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911861731 end=1713911861735 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:41.735 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:41.740 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.742 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.744 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:41.745 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.747 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.749 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:41.751 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:41.753 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:41.755 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:41.756 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:41.758 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:41.760 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:41.762 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:41.764 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:41.766 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:41.781 [main] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.793 [main] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, ?, ?, ?)> queries. Batch size: 3
[DEBUG] 2024-04-23 23:37:41.795 [main] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 23:37:41.796 [main] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = 4514446248282415010>
[DEBUG] 2024-04-23 23:37:41.805 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:37:41.807 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:37:41.808 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:37:41.835 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.840 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:37:41.840 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.840 [main] PerfLogger - </PERFLOG method=lock start=1713911861781 end=1713911861840 duration=59 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.840 [main] PerfLogger - <PERFLOG method=check_lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.841 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:37:41.841 [main] TxnHandler - getTxnIdFromLockId(1) Return txnid:0
[DEBUG] 2024-04-23 23:37:41.841 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.846 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:37:41.846 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:37:41.846 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:37:41.846 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:37:41.847 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.848 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:0 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:EXCLUSIVE, lockid:1 intLockId:2 txnid:0 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:0 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:37:41.848 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.848 [main] PerfLogger - </PERFLOG method=check_lock start=1713911861840 end=1713911861848 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.848 [main] PerfLogger - <PERFLOG method=heartbeat from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.848 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.849 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:37:41.849 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.849 [main] PerfLogger - </PERFLOG method=heartbeat start=1713911861848 end=1713911861849 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.849 [main] PerfLogger - <PERFLOG method=unlock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.849 [main] TxnHandler - Going to execute update <DELETE FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1 AND ("HL_TXNID" = 0 OR ("HL_TXNID" <> 0 AND "HL_LOCK_STATE" = 'w'))>
[DEBUG] 2024-04-23 23:37:41.852 [main] TxnHandler - Successfully unlocked at least 1 lock with extLockId=1
[DEBUG] 2024-04-23 23:37:41.853 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.853 [main] PerfLogger - </PERFLOG method=unlock start=1713911861849 end=1713911861853 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:41.853 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:41.856 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.856 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.858 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:41.858 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.859 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.859 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:41.859 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:41.859 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:41.859 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:41.860 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:41.860 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:41.860 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:41.860 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:41.860 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:41.860 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:41.866 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.867 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:41.869 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:41.872 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:41.872 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:41.879 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:37:41.881 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:41.881 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:41.882 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.882 [main] PerfLogger - </PERFLOG method=open_txns start=1713911861866 end=1713911861882 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.882 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.884 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:41.884 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:41.886 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:41.886 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:37:41.888 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:37:41.888 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:41.888 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:37:41.888 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:41.894 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:41.894 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.895 [main] PerfLogger - </PERFLOG method=abort_txn start=1713911861882 end=1713911861895 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.895 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.899 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:37:41.902 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 23:37:41.902 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 23:37:41.902 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 23:37:41.902 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 23:37:41.902 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:41.907 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:37:41.907 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:41.909 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:37:41.912 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 23:37:41.912 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:41.912 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.912 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:41.912 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.912 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911861895 end=1713911861912 duration=17 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.912 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.912 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:41.915 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:37:41.915 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:41.915 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.915 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911861912 end=1713911861915 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:41.915 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:41.918 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.918 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.920 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:41.920 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.920 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.921 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:41.921 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:41.921 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:41.921 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:41.922 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:41.922 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:41.922 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:41.922 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:41.922 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:41.923 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:41.929 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.929 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:41.932 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:41.934 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:41.934 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:41.938 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:37:41.939 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:41.939 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:41.939 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.940 [main] PerfLogger - </PERFLOG method=open_txns start=1713911861929 end=1713911861940 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.940 [main] PerfLogger - <PERFLOG method=lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.946 [main] TxnHandler - Going to execute query <SELECT "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = ? AND "T2W_TABLE" = ? AND "T2W_TXNID" = ?>
[DEBUG] 2024-04-23 23:37:41.946 [main] TxnHandler - Going to execute query <SELECT "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = ? AND "T2W_TABLE" = ? AND "T2W_TXNID" = ?>
[DEBUG] 2024-04-23 23:37:41.946 [main] TxnHandler - Executing a batch of <INSERT INTO "TXN_COMPONENTS" ("TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_OPERATION_TYPE", "TC_WRITEID") VALUES (?, ?, ?, ?, ?, ?)> queries. Batch size: 2
[DEBUG] 2024-04-23 23:37:41.948 [main] TxnHandler - Executing a batch of <INSERT INTO "HIVE_LOCKS" ( "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_LAST_HEARTBEAT", "HL_USER", "HL_HOST", "HL_AGENT_INFO") VALUES (?, ?, ?, ?, ?, ?, ?, ?, 0, ?, ?, ?)> queries. Batch size: 3
[DEBUG] 2024-04-23 23:37:41.949 [main] TxnHandler - Going to execute query <SELECT "NL_NEXT" FROM "NEXT_LOCK_ID">
[DEBUG] 2024-04-23 23:37:41.949 [main] TxnHandler - Going to execute updates in batch: <UPDATE "NEXT_LOCK_ID" SET "NL_NEXT" = 2>, and <UPDATE "HIVE_LOCKS" SET "HL_LOCK_EXT_ID" = 1 WHERE "HL_LOCK_EXT_ID" = 7322365226834671409>
[DEBUG] 2024-04-23 23:37:41.952 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:37:41.952 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:37:41.952 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:37:41.953 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.956 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:WAITING type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:WAITING type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:WAITING type:SHARED_READ]
[DEBUG] 2024-04-23 23:37:41.956 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.956 [main] PerfLogger - </PERFLOG method=lock start=1713911861940 end=1713911861956 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.956 [main] PerfLogger - <PERFLOG method=check_lock from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.956 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:37:41.956 [main] TxnHandler - getTxnIdFromLockId(1) Return txnid:1
[DEBUG] 2024-04-23 23:37:41.957 [main] TxnHandler - Going to execute update <UPDATE "TXNS" SET "TXN_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "TXN_ID" = 1 AND "TXN_STATE" = 'o'>
[DEBUG] 2024-04-23 23:37:41.959 [main] TxnHandler - Successfully heartbeated for txnId=1
[DEBUG] 2024-04-23 23:37:41.959 [main] TxnHandler - Going to execute query <SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE", "HL_TXNID" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = ?> for extLockId=1
[DEBUG] 2024-04-23 23:37:41.960 [main] TxnHandler - Found 3 locks for extLockId=1. Locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:37:41.960 [main] TxnHandler - Going to execute query <(select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='r' AND "EX"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NOT NULL AND "REQ"."HL_TABLE" IS NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='e' AND NOT ("EX"."HL_TABLE" IS NULL AND "EX"."HL_LOCK_TYPE"='r' AND "REQ"."HL_TABLE" IS NOT NULL) fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='w' AND "EX"."HL_LOCK_TYPE" IN ('x','e') fetch first 1 rows only) UNION ALL (select  "EX".*, "REQ"."HL_LOCK_INT_ID" "LOCK_INT_ID", "REQ"."HL_LOCK_TYPE" "LOCK_TYPE" FROM ( SELECT "HL_LOCK_EXT_ID", "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_STATE", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" < 1) "EX" INNER JOIN ( SELECT "HL_LOCK_INT_ID", "HL_TXNID", "HL_DB", "HL_TABLE", "HL_PARTITION", "HL_LOCK_TYPE" FROM "HIVE_LOCKS" WHERE "HL_LOCK_EXT_ID" = 1) "REQ" ON "EX"."HL_DB" = "REQ"."HL_DB" AND ("EX"."HL_TABLE" IS NULL OR "REQ"."HL_TABLE" IS NULL OR "EX"."HL_TABLE" = "REQ"."HL_TABLE" AND ("EX"."HL_PARTITION" IS NULL OR "REQ"."HL_PARTITION" IS NULL OR "EX"."HL_PARTITION" = "REQ"."HL_PARTITION")) WHERE ("REQ"."HL_TXNID" = 0 OR "EX"."HL_TXNID" != "REQ"."HL_TXNID") AND  "REQ"."HL_LOCK_TYPE"='x' AND "EX"."HL_LOCK_TYPE"!='r' fetch first 1 rows only)>
[DEBUG] 2024-04-23 23:37:41.960 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LOCK_STATE" = 'a', "HL_LAST_HEARTBEAT" = 0,"HL_ACQUIRED_AT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,"HL_BLOCKEDBY_EXT_ID"=NULL,"HL_BLOCKEDBY_INT_ID"=NULL WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.961 [main] TxnHandler - Successfully acquired locks: [lockid:1 intLockId:1 txnid:1 db:mydb table:mytable partition:mypartition=MyValue state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:2 txnid:1 db:mydb table:yourtable partition:null state:ACQUIRED type:SHARED_WRITE, lockid:1 intLockId:3 txnid:1 db:yourdb table:null partition:null state:ACQUIRED type:SHARED_READ]
[DEBUG] 2024-04-23 23:37:41.961 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.961 [main] PerfLogger - </PERFLOG method=check_lock start=1713911861956 end=1713911861961 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.961 [main] PerfLogger - <PERFLOG method=heartbeat from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.961 [main] TxnHandler - Going to execute update <UPDATE "HIVE_LOCKS" SET "HL_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "HL_LOCK_EXT_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.962 [main] TxnHandler - Successfully heartbeated for extLockId=1
[DEBUG] 2024-04-23 23:37:41.962 [main] TxnHandler - Going to execute update <UPDATE "TXNS" SET "TXN_LAST_HEARTBEAT" = { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 WHERE "TXN_ID" = 1 AND "TXN_STATE" = 'o'>
[DEBUG] 2024-04-23 23:37:41.962 [main] TxnHandler - Successfully heartbeated for txnId=1
[DEBUG] 2024-04-23 23:37:41.962 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.962 [main] PerfLogger - </PERFLOG method=heartbeat start=1713911861961 end=1713911861962 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:41.962 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.968 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode false
[DEBUG] 2024-04-23 23:37:41.968 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS">
[DEBUG] 2024-04-23 23:37:41.969 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'Y' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[DEBUG] 2024-04-23 23:37:41.972 [main] TxnUtils - Adding query to batch: <UPDATE "WRITE_SET" SET "WS_COMMIT_ID" = 1 WHERE "WS_COMMIT_ID" = -5960656972039771812 AND "WS_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:41.972 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:41.972 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:41.972 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:37:41.972 [main] TxnUtils - Going to execute queries in batch. Batch size: 4
[DEBUG] 2024-04-23 23:37:41.980 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:41.980 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:41.980 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:37:41.981 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:37:41.981 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:41.981 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.981 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:41.981 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:41.981 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911861962 end=1713911861981 duration=19 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:41.982 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:41.985 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.986 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:41.988 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:41.988 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.988 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:41.988 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:41.989 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:41.989 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:41.989 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:41.989 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:41.990 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:41.990 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:41.990 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:41.990 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:41.990 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:41.996 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:41.996 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:41.998 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:42.001 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:42.001 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:42.009 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:37:42.009 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:42.009 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.009 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.009 [main] PerfLogger - </PERFLOG method=open_txns start=1713911861996 end=1713911862009 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.009 [main] PerfLogger - <PERFLOG method=allocate_table_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.009 [main] TxnHandler - Going to execute query <SELECT COUNT(*) FROM "TXNS" WHERE "TXN_STATE" = 'o' AND "TXN_TYPE" != 2 AND "TXN_ID" in (1,2,3)>
[DEBUG] 2024-04-23 23:37:42.014 [main] TxnHandler - Going to execute query <SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' AND "T2W_TXNID" in (1,2,3)>
[DEBUG] 2024-04-23 23:37:42.016 [main] TxnHandler - Going to execute query <SELECT "NWI_NEXT" FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE" = 'db' AND "NWI_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:37:42.018 [main] TxnHandler - Going to execute insert <INSERT INTO "NEXT_WRITE_ID" ("NWI_DATABASE", "NWI_TABLE", "NWI_NEXT") VALUES ('db', 'tbl', 4)>
[INFO ] 2024-04-23 23:37:42.021 [main] TxnHandler - Allocated writeId: 1 for txnId: 1
[INFO ] 2024-04-23 23:37:42.021 [main] TxnHandler - Allocated writeId: 2 for txnId: 2
[INFO ] 2024-04-23 23:37:42.021 [main] TxnHandler - Allocated writeId: 3 for txnId: 3
[DEBUG] 2024-04-23 23:37:42.021 [main] TxnHandler - Executing a batch of <INSERT INTO "TXN_TO_WRITE_ID" ("T2W_TXNID", "T2W_DATABASE", "T2W_TABLE", "T2W_WRITEID") VALUES (?, ?, ?, ?)> queries. Batch size: 3
[INFO ] 2024-04-23 23:37:42.021 [main] TxnHandler - Allocated write ids for dbName=db, tblName=tbl (txnIds: [1, 2, 3])
[DEBUG] 2024-04-23 23:37:42.022 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.023 [main] PerfLogger - </PERFLOG method=allocate_table_write_ids start=1713911862009 end=1713911862023 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.023 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.025 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:42.025 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:42.025 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.025 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:37:42.025 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:37:42.025 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:42.025 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:37:42.025 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:42.028 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.028 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.028 [main] PerfLogger - </PERFLOG method=abort_txn start=1713911862023 end=1713911862028 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.029 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.029 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:42.031 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 3.
[DEBUG] 2024-04-23 23:37:42.031 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.031 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.032 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911862029 end=1713911862032 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.032 [main] PerfLogger - <PERFLOG method=get_valid_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.034 [main] TxnHandler - Going to execute query<SELECT MAX("T2W_WRITEID") FROM "TXN_TO_WRITE_ID" WHERE "T2W_TXNID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:37:42.037 [main] TxnHandler - Going to execute query<SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_WRITEID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' ORDER BY "T2W_WRITEID" ASC>
[DEBUG] 2024-04-23 23:37:42.040 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.040 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.040 [main] PerfLogger - </PERFLOG method=get_valid_write_ids start=1713911862032 end=1713911862040 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.041 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.045 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:37:42.047 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
[DEBUG] 2024-04-23 23:37:42.048 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3>
[DEBUG] 2024-04-23 23:37:42.048 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 3>
[DEBUG] 2024-04-23 23:37:42.048 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 3>
[DEBUG] 2024-04-23 23:37:42.048 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:42.054 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (3)>
[DEBUG] 2024-04-23 23:37:42.054 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:42.056 [main] TxnHandler - Removed transactions: ([3]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:37:42.056 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:3
[DEBUG] 2024-04-23 23:37:42.056 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.056 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.057 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.057 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.057 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911862041 end=1713911862057 duration=16 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.057 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.057 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:42.057 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:37:42.057 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.057 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.058 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911862057 end=1713911862058 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.058 [main] PerfLogger - <PERFLOG method=get_valid_write_ids from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.058 [main] TxnHandler - Going to execute query<SELECT MAX("T2W_WRITEID") FROM "TXN_TO_WRITE_ID" WHERE "T2W_TXNID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl'>
[DEBUG] 2024-04-23 23:37:42.058 [main] TxnHandler - Going to execute query<SELECT "T2W_TXNID", "T2W_WRITEID" FROM "TXN_TO_WRITE_ID" WHERE "T2W_WRITEID" <= 3 AND "T2W_DATABASE" = 'db' AND "T2W_TABLE" = 'tbl' ORDER BY "T2W_WRITEID" ASC>
[DEBUG] 2024-04-23 23:37:42.058 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.058 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.058 [main] PerfLogger - </PERFLOG method=get_valid_write_ids start=1713911862058 end=1713911862058 duration=0 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:42.059 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:42.062 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.062 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.064 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:42.064 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.065 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.065 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:42.065 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:42.066 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:42.066 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:42.066 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:42.066 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:42.066 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:42.066 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:42.067 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:42.067 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.073 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.073 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:42.075 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:42.077 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:42.078 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:42.085 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1),(2, 1),(3, 1)>
[INFO ] 2024-04-23 23:37:42.085 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1, 2, 3]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:42.085 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.086 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.086 [main] PerfLogger - </PERFLOG method=open_txns start=1713911862073 end=1713911862086 duration=13 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.086 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.088 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:42.088 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:42.088 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.088 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:37:42.088 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (1))>
[DEBUG] 2024-04-23 23:37:42.088 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:42.088 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (1)>
[DEBUG] 2024-04-23 23:37:42.088 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:42.091 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.091 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.091 [main] PerfLogger - </PERFLOG method=abort_txn start=1713911862086 end=1713911862091 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.091 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.093 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:37:42.093 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
[DEBUG] 2024-04-23 23:37:42.093 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 2>
[DEBUG] 2024-04-23 23:37:42.093 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 2>
[DEBUG] 2024-04-23 23:37:42.093 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 2>
[DEBUG] 2024-04-23 23:37:42.093 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:42.096 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:37:42.096 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:42.096 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:37:42.096 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:2
[DEBUG] 2024-04-23 23:37:42.096 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.096 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.096 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.096 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.097 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911862091 end=1713911862097 duration=6 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.097 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.097 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:42.099 [main] TxnHandler - Got OpenTxnList with hwm: 3 and openTxnList size 2.
[DEBUG] 2024-04-23 23:37:42.099 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.099 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.100 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911862097 end=1713911862100 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:42.100 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:42.103 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.103 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.106 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:42.106 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.106 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.107 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:42.107 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:42.107 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:42.107 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:42.108 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:42.108 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:42.108 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:42.108 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:42.108 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:42.109 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.116 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.116 [main] HMSHandler - 0: create_database: Database(name:mydbKeyValue, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:37:42.116 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydbKeyValue, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:37:42.116 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.117 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.117 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.117 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.117 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.161733ms
[DEBUG] 2024-04-23 23:37:42.117 [main] ObjectStore - Failed to get database hive.mydbKeyValue, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:37:42.118 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:37:42.118 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.121 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.121 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.122 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[INFO ] 2024-04-23 23:37:42.123 [main] HMSHandler - Creating database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[INFO ] 2024-04-23 23:37:42.123 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[INFO ] 2024-04-23 23:37:42.127 [main] HMSHandler - Created database path in external directory file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:37:42.127 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.127 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.129 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.129 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.131 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.131 [main] PerfLogger - </PERFLOG method=create_database start=1713911862116 end=1713911862131 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.131 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.131 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydbKeyValue, owner:alex, createTime:1713911862, lastAccessTime:1713911862, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:37:42.131 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydbKeyValue, owner:alex, createTime:1713911862, lastAccessTime:1713911862, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:37:42.131 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.135 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.135 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.135 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.135 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.136 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 4.082556ms
[DEBUG] 2024-04-23 23:37:42.136 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.136 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.136 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:37:42.140 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.140 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.140 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.141 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.141 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.142 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.142 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.142 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.142 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.69058ms
[DEBUG] 2024-04-23 23:37:42.142 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.142 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.142 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:37:42.143 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.144 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:37:42.144 [main] FileUtils - Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db/mytable
[DEBUG] 2024-04-23 23:37:42.149 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.149 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.154 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.173 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.173 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.176 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.178 [main] PerfLogger - </PERFLOG method=create_table_req start=1713911862131 end=1713911862178 duration=47 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.178 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.178 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:37:42.178 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:37:42.178 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.180 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.180 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.180 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.180 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.180 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 2.284045ms
[DEBUG] 2024-04-23 23:37:42.180 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.181 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.181 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:37:42.193 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.231 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.233 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:42.235 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:37:42.235 [main] PerfLogger - </PERFLOG method=get_table_req start=1713911862178 end=1713911862235 duration=57 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.235 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=57, comments=HMS client
[DEBUG] 2024-04-23 23:37:42.237 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.237 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:42.240 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:42.242 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:42.242 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:42.246 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:37:42.248 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:42.248 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.248 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.248 [main] PerfLogger - </PERFLOG method=open_txns start=1713911862237 end=1713911862248 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.248 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.251 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:37:42.253 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:37:42.253 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:42.254 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:42.254 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:37:42.254 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:42.256 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:42.256 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:42.256 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.257 [main] TxnHandler - Going to execute update <UPDATE "TABLE_PARAMS" SET "PARAM_VALUE" = 'myvalue' WHERE "TBL_ID" = 2 AND "PARAM_KEY" = '_metamykey'>
[WARN ] 2024-04-23 23:37:42.259 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:37:42.259 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.259 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.260 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.260 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.260 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911862248 end=1713911862260 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.260 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.260 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:42.262 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 0.
[DEBUG] 2024-04-23 23:37:42.262 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.262 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.262 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911862260 end=1713911862262 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.264 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.264 [main] HMSHandler - 0: get_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:37:42.264 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:37:42.265 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.267 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.267 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.267 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.267 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.268 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 2.938566ms
[DEBUG] 2024-04-23 23:37:42.268 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.268 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.268 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:37:42.272 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.278 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.280 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:42.282 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:37:42.282 [main] PerfLogger - </PERFLOG method=get_table_req start=1713911862264 end=1713911862282 duration=18 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.282 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=18, comments=HMS client
[DEBUG] 2024-04-23 23:37:42.282 [main] PerfLogger - <PERFLOG method=drop_table_with_environment_context from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.282 [main] HMSHandler - 0: drop_table : tbl=hive.mydbKeyValue.mytable
[INFO ] 2024-04-23 23:37:42.282 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.mydbKeyValue.mytable	
[DEBUG] 2024-04-23 23:37:42.282 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.282 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.284 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.285 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.285 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.285 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 2.557407ms
[DEBUG] 2024-04-23 23:37:42.285 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.286 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.286 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.286 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.287 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.738793ms
[DEBUG] 2024-04-23 23:37:42.287 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.287 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.287 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:37:42.290 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.295 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.295 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.298 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.298 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.298 [main] ObjectStore - Executing getPartitionLocations
[DEBUG] 2024-04-23 23:37:42.303 [main] ObjectStore - Done executing query for getPartitionLocations
[DEBUG] 2024-04-23 23:37:42.303 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.304 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.314 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.314 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.314 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.314 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:37:42.315 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.315 [main] ObjectStore - Executing listAllTableGrants
[DEBUG] 2024-04-23 23:37:42.315 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.321 [main] ObjectStore - Done executing query for listAllTableGrants
[DEBUG] 2024-04-23 23:37:42.321 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.322 [main] ObjectStore - Done retrieving all objects for listAllTableGrants
[DEBUG] 2024-04-23 23:37:42.322 [main] ObjectStore - Executing listTableAllColumnGrants
[DEBUG] 2024-04-23 23:37:42.322 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.328 [main] ObjectStore - Query to obtain objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:37:42.328 [main] ObjectStore - RetrieveAll on all the objects for listTableAllColumnGrants finished
[DEBUG] 2024-04-23 23:37:42.328 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.328 [main] ObjectStore - Transaction running query to obtain objects for listTableAllColumnGrants committed
[DEBUG] 2024-04-23 23:37:42.328 [main] ObjectStore - Done retrieving 0 objects for listTableAllColumnGrants
[DEBUG] 2024-04-23 23:37:42.328 [main] ObjectStore - Executing listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:37:42.328 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.336 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.336 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionGrants
[DEBUG] 2024-04-23 23:37:42.336 [main] ObjectStore - Executing listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:37:42.336 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.343 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.343 [main] ObjectStore - Done retrieving all objects for listTableAllPartitionColumnGrants
[DEBUG] 2024-04-23 23:37:42.344 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.344 [main] ObjectStore - Open transaction: count = 4, isActive = true
[DEBUG] 2024-04-23 23:37:42.344 [main] ObjectStore - Executing getMTable for hive.mydbkeyvalue.mytable
[DEBUG] 2024-04-23 23:37:42.345 [main] ObjectStore - Commit transaction: count = 3, isactive true
[DEBUG] 2024-04-23 23:37:42.350 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.353 [main] ObjectStore - execute removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:37:42.353 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.353 [main] ObjectStore - The dbType is derby 
[DEBUG] 2024-04-23 23:37:42.367 [main] ObjectStore - successfully deleted a CD in removeUnusedColumnDescriptor
[DEBUG] 2024-04-23 23:37:42.367 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.409 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.409 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.410 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.411 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:37:42.411 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:37:42.411 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db/mytable
[DEBUG] 2024-04-23 23:37:42.412 [main] PerfLogger - </PERFLOG method=drop_table_with_environment_context start=1713911862282 end=1713911862412 duration=130 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.412 [main] PerfLogger - <PERFLOG method=get_database_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.412 [main] HMSHandler - 0: get_database: mydbKeyValue
[INFO ] 2024-04-23 23:37:42.412 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_database: mydbKeyValue	
[DEBUG] 2024-04-23 23:37:42.413 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.415 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.415 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.415 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.415 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.415 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 2.978355ms
[DEBUG] 2024-04-23 23:37:42.416 [main] PerfLogger - </PERFLOG method=get_database_req start=1713911862412 end=1713911862416 duration=4 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.416 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getDatabase, duration=4, comments=HMS client
[DEBUG] 2024-04-23 23:37:42.416 [main] PerfLogger - <PERFLOG method=drop_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.416 [main] HMSHandler - 0: drop_database: @hive#mydbKeyValue
[INFO ] 2024-04-23 23:37:42.416 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=drop_database: @hive#mydbKeyValue	
[DEBUG] 2024-04-23 23:37:42.416 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.416 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.417 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.417 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.417 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.417 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.447938ms
[DEBUG] 2024-04-23 23:37:42.417 [main] HMSHandler - 0: get_all_tables: db=@hive#mydbKeyValue
[INFO ] 2024-04-23 23:37:42.417 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_tables: db=@hive#mydbKeyValue	
[DEBUG] 2024-04-23 23:37:42.418 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.421 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.421 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.421 [main] ObjectStore - 0 entries retrieved using SQL in 3.7881ms
[DEBUG] 2024-04-23 23:37:42.421 [main] HMSHandler - 0: get_functions: db=@hive#mydbKeyValue pat=*
[INFO ] 2024-04-23 23:37:42.421 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_functions: db=@hive#mydbKeyValue pat=*	
[DEBUG] 2024-04-23 23:37:42.421 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.427 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.428 [main] HMSHandler - 0: get_all_stored_procedures
[INFO ] 2024-04-23 23:37:42.428 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_stored_procedures	
[DEBUG] 2024-04-23 23:37:42.428 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.433 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.434 [main] HMSHandler - 0: get_all_packages
[INFO ] 2024-04-23 23:37:42.434 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_all_packages	
[DEBUG] 2024-04-23 23:37:42.434 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.439 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.440 [main] HMSHandler - 0: getTablesByTypeCore: catName=hive: db=mydbKeyValue pat=.*,type=MATERIALIZED_VIEW
[INFO ] 2024-04-23 23:37:42.440 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=getTablesByTypeCore: catName=hive: db=mydbKeyValue pat=.*,type=MATERIALIZED_VIEW	
[DEBUG] 2024-04-23 23:37:42.440 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.441 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydbkeyvalue locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.442 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.442 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.442 [main] ObjectStore - db details for db mydbkeyvalue retrieved using SQL in 1.971734ms
[DEBUG] 2024-04-23 23:37:42.442 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.446 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.446 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.446 [main] ObjectStore - 0 entries retrieved using SQL in 3.67338ms
[INFO ] 2024-04-23 23:37:42.446 [main] ObjectStore - Dropping database hive.mydbKeyValue along with all tables
[DEBUG] 2024-04-23 23:37:42.446 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.446 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.460 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.461 [main] ObjectStore - Executing listDatabaseGrants
[DEBUG] 2024-04-23 23:37:42.465 [main] ObjectStore - Done retrieving all objects for listDatabaseGrants: []
[DEBUG] 2024-04-23 23:37:42.471 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.474 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.474 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.474 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:37:42.477 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:37:42.480 [main] TxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:37:42.483 [main] TxnHandler - Going to execute update <DELETE FROM "COMPLETED_COMPACTIONS" WHERE "CC_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:37:42.485 [main] TxnHandler - Going to execute update <DELETE FROM "TXN_TO_WRITE_ID" WHERE "T2W_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:37:42.488 [main] TxnHandler - Going to execute update <DELETE FROM "NEXT_WRITE_ID" WHERE "NWI_DATABASE"='mydbkeyvalue'>
[DEBUG] 2024-04-23 23:37:42.490 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.490 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.490 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.491 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.492 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1807)
[DEBUG] 2024-04-23 23:37:42.492 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:37:42.492 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/warehouse/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:37:42.493 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.drop_database_core(HMSHandler.java:1820)
[DEBUG] 2024-04-23 23:37:42.493 [main] ReplChangeManager - Repl policy is not set for database: mydbkeyvalue
[DEBUG] 2024-04-23 23:37:42.493 [main] FileUtils - deleting  file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydbkeyvalue.db
[DEBUG] 2024-04-23 23:37:42.494 [main] PerfLogger - </PERFLOG method=drop_database start=1713911862416 end=1713911862494 duration=78 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:42.497 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:42.502 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.504 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.506 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:42.507 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.509 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.511 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:42.513 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:42.514 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:42.516 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:42.517 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:42.520 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:42.521 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:42.523 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:42.524 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:42.526 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.535 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.535 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:42.538 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:42.540 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:42.540 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:42.543 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:37:42.543 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:42.543 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.543 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.543 [main] PerfLogger - </PERFLOG method=open_txns start=1713911862535 end=1713911862543 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.543 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.547 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:37:42.547 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
[DEBUG] 2024-04-23 23:37:42.547 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:42.547 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 1>
[DEBUG] 2024-04-23 23:37:42.547 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 1>
[DEBUG] 2024-04-23 23:37:42.547 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:42.553 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (1)>
[DEBUG] 2024-04-23 23:37:42.553 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:42.553 [main] TxnHandler - Removed transactions: ([1]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:37:42.553 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:1
[DEBUG] 2024-04-23 23:37:42.553 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.553 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.553 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.553 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.553 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911862543 end=1713911862553 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.553 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.553 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:42.556 [main] TxnHandler - Got OpenTxnList with hwm: 1 and openTxnList size 0.
[DEBUG] 2024-04-23 23:37:42.556 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.556 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.556 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911862553 end=1713911862556 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:42.556 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:42.558 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.559 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.560 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:42.560 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.561 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.561 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:42.561 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:42.561 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:42.561 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:42.562 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:42.562 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:42.562 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:42.562 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:42.562 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:42.562 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.568 [main] PerfLogger - <PERFLOG method=create_database from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.569 [main] HMSHandler - 0: create_database: Database(name:mydb, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)
[INFO ] 2024-04-23 23:37:42.569 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_database: Database(name:mydb, description:null, locationUri:null, parameters:{}, ownerName:alex, ownerType:USER, catalogName:hive, createTime:0, type:NATIVE)	
[DEBUG] 2024-04-23 23:37:42.569 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.570 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.570 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.570 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.570 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.234629ms
[DEBUG] 2024-04-23 23:37:42.570 [main] ObjectStore - Failed to get database hive.mydb, returning NoSuchObjectException
[DEBUG] 2024-04-23 23:37:42.570 [main] ObjectStore - Fetching catalog hive
[DEBUG] 2024-04-23 23:37:42.570 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.573 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.573 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.574 [main] UserGroupInformation - PrivilegedAction as:alex (auth:SIMPLE) from:org.apache.hadoop.hive.metastore.HMSHandler.create_database_core(HMSHandler.java:1375)
[WARN ] 2024-04-23 23:37:42.575 [main] HMSHandler - Failed to create external path file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db for database mydb. This may result in access not being allowed if the StorageBasedAuthorizationProvider is enabled
[DEBUG] 2024-04-23 23:37:42.575 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.575 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.577 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.577 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.578 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.578 [main] PerfLogger - </PERFLOG method=create_database start=1713911862568 end=1713911862578 duration=10 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.578 [main] PerfLogger - <PERFLOG method=create_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.579 [main] HMSHandler - 0: create_table_req: Table(tableName:mytable, dbName:mydb, owner:alex, createTime:1713911862, lastAccessTime:1713911862, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)
[INFO ] 2024-04-23 23:37:42.579 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:mytable, dbName:mydb, owner:alex, createTime:1713911862, lastAccessTime:1713911862, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:id, type:int, comment:), FieldSchema(name:name, type:string, comment:)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.HiveInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveOutputFormat, compressed:false, numBuckets:0, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, catName:hive, ownerType:USER)	
[DEBUG] 2024-04-23 23:37:42.579 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.580 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.580 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.580 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.581 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.581 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.867492ms
[DEBUG] 2024-04-23 23:37:42.581 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.581 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.581 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:37:42.584 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.584 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.585 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.585 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.585 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.586 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.586 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.586 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.587 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.652906ms
[DEBUG] 2024-04-23 23:37:42.587 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.587 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.587 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:37:42.587 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.588 [main] ObjectStore - Commit transaction: count = 1, isactive true
[INFO ] 2024-04-23 23:37:42.589 [main] MetaStoreServerUtils - Updating table stats for mytable
[INFO ] 2024-04-23 23:37:42.589 [main] MetaStoreServerUtils - Updated size of table mytable to 0
[DEBUG] 2024-04-23 23:37:42.589 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.589 [main] ObjectStore - Open transaction: count = 3, isActive = true
[DEBUG] 2024-04-23 23:37:42.591 [main] ObjectStore - Commit transaction: count = 2, isactive true
[DEBUG] 2024-04-23 23:37:42.607 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.607 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.610 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.611 [main] PerfLogger - </PERFLOG method=create_table_req start=1713911862578 end=1713911862611 duration=33 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.611 [main] PerfLogger - <PERFLOG method=get_table_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.611 [main] HMSHandler - 0: get_table : tbl=hive.mydb.mytable
[INFO ] 2024-04-23 23:37:42.611 [main] audit - ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.mydb.mytable	
[DEBUG] 2024-04-23 23:37:42.612 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.613 [main] MetaStoreDirectSql - getDatabase: directsql returning db mydb locn[file:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/external/mydb.db] desc [null] owner [alex] ownertype [USER]
[DEBUG] 2024-04-23 23:37:42.613 [main] ObjectStore - Using direct SQL optimization.
[DEBUG] 2024-04-23 23:37:42.613 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.613 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.613 [main] ObjectStore - db details for db mydb retrieved using SQL in 1.940395ms
[DEBUG] 2024-04-23 23:37:42.614 [main] ObjectStore - Open transaction: count = 1, isActive = true
[DEBUG] 2024-04-23 23:37:42.614 [main] ObjectStore - Open transaction: count = 2, isActive = true
[DEBUG] 2024-04-23 23:37:42.614 [main] ObjectStore - Executing getMTable for hive.mydb.mytable
[DEBUG] 2024-04-23 23:37:42.624 [main] ObjectStore - Commit transaction: count = 1, isactive true
[DEBUG] 2024-04-23 23:37:42.651 [main] ObjectStore - Commit transaction: count = 0, isactive true
[DEBUG] 2024-04-23 23:37:42.652 [main] PoolBase - HikariPool-1 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1183572822 (XID = 1156), (SESSIONID = 3), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[INFO ] 2024-04-23 23:37:42.654 [main] HMSHandler - Skipping translation for processor with null
[DEBUG] 2024-04-23 23:37:42.654 [main] PerfLogger - </PERFLOG method=get_table_req start=1713911862611 end=1713911862654 duration=43 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.654 [main] HiveMetaStoreClient - class=org.apache.hadoop.hive.metastore.HiveMetaStoreClient, method=getTable, duration=43, comments=HMS client
[DEBUG] 2024-04-23 23:37:42.654 [main] PerfLogger - <PERFLOG method=compact2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.654 [main] TxnHandler - About to execute SQL: SELECT "MT_COMMENT" FROM "AUX_TABLE" WHERE "MT_KEY1"='CompactionScheduler' and "MT_KEY2"=0
[DEBUG] 2024-04-23 23:37:42.658 [main] TxnHandler - 'CompactionScheduler' locked by 'Lenovo-Bot'
[DEBUG] 2024-04-23 23:37:42.658 [main] TxnHandler - going to execute query <SELECT "NCQ_NEXT" FROM "NEXT_COMPACTION_QUEUE_ID">
[DEBUG] 2024-04-23 23:37:42.659 [main] TxnHandler - Going to execute update <UPDATE "NEXT_COMPACTION_QUEUE_ID" SET "NCQ_NEXT" = 2>
[DEBUG] 2024-04-23 23:37:42.663 [main] TxnHandler - Going to execute query <SELECT "CQ_ID", "CQ_STATE" FROM "COMPACTION_QUEUE" WHERE "CQ_STATE" IN('i','w') AND "CQ_DATABASE"=? AND "CQ_TABLE"=? AND "CQ_PARTITION" is null>
[DEBUG] 2024-04-23 23:37:42.666 [main] TxnHandler - Going to execute update <INSERT INTO "COMPACTION_QUEUE" ("CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_STATE", "CQ_TYPE", "CQ_ENQUEUE_TIME", "CQ_TBLPROPERTIES", "CQ_INITIATOR_ID") values (1, ?, ?, 'i', 'i',{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, ?, ?)>
[DEBUG] 2024-04-23 23:37:42.667 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.668 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.668 [main] PoolBase - HikariPool-3 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@697707311 (XID = 1566), (SESSIONID = 27), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.669 [main] TxnHandler - 'CompactionScheduler' unlocked by 'Lenovo-Bot'
[DEBUG] 2024-04-23 23:37:42.669 [main] PerfLogger - </PERFLOG method=compact2 start=1713911862654 end=1713911862669 duration=15 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.669 [main] PerfLogger - <PERFLOG method=find_next_compact2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.669 [main] CompactionTxnHandler - Going to execute query <SELECT "CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_PARTITION", "CQ_TYPE", "CQ_TBLPROPERTIES" FROM "COMPACTION_QUEUE" WHERE "CQ_STATE" = 'i'>
[DEBUG] 2024-04-23 23:37:42.671 [main] TxnHandler - Going to execute query <values current_timestamp>
[DEBUG] 2024-04-23 23:37:42.672 [main] CompactionTxnHandler - Going to execute update <UPDATE   "COMPACTION_QUEUE" SET  "CQ_WORKER_ID" = 'myworker',  "CQ_WORKER_VERSION" = 'null',  "CQ_START" = 1713911862672,  "CQ_STATE" = 'w' WHERE "CQ_ID" = 1  AND "CQ_STATE"='i'>
[DEBUG] 2024-04-23 23:37:42.675 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.676 [main] PerfLogger - </PERFLOG method=find_next_compact2 start=1713911862669 end=1713911862676 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.676 [main] PerfLogger - <PERFLOG method=mark_cleaned from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.676 [main] CompactionTxnHandler - Running markCleaned with CompactionInfo: id:1,dbname:mydb,tableName:mytable,partName:null,state: ,type:MINOR,enqueueTime:0,start:0,properties:0:,runAs:null,tooManyAborts:false,hasOldAbort:false,highestWriteId:0,errorMessage:null,workerId: null,initiatorId: null
[DEBUG] 2024-04-23 23:37:42.679 [main] CompactionTxnHandler - Going to execute update <INSERT INTO "COMPLETED_COMPACTIONS"("CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_STATE", "CC_TYPE", "CC_TBLPROPERTIES", "CC_WORKER_ID", "CC_START", "CC_END", "CC_RUN_AS", "CC_HIGHEST_WRITE_ID", "CC_META_INFO", "CC_HADOOP_JOB_ID", "CC_ERROR_MESSAGE", "CC_ENQUEUE_TIME", "CC_WORKER_VERSION", "CC_INITIATOR_ID", "CC_INITIATOR_VERSION") SELECT "CQ_ID", "CQ_DATABASE", "CQ_TABLE", "CQ_PARTITION", 's', "CQ_TYPE", "CQ_TBLPROPERTIES", "CQ_WORKER_ID", "CQ_START", { fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000, "CQ_RUN_AS", "CQ_HIGHEST_WRITE_ID", "CQ_META_INFO", "CQ_HADOOP_JOB_ID", "CQ_ERROR_MESSAGE", "CQ_ENQUEUE_TIME", "CQ_WORKER_VERSION", "CQ_INITIATOR_ID", "CQ_INITIATOR_VERSION"FROM "COMPACTION_QUEUE" WHERE "CQ_ID" = ?> for CQ_ID=1
[DEBUG] 2024-04-23 23:37:42.681 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "COMPACTION_QUEUE" WHERE "CQ_ID" = ?>
[DEBUG] 2024-04-23 23:37:42.683 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "COMPLETED_TXN_COMPONENTS" WHERE "CTC_DATABASE" = ? AND "CTC_TABLE" = ?>
[WARN ] 2024-04-23 23:37:42.683 [main] CompactionTxnHandler - Expected to remove at least one row from completed_txn_components when marking compaction entry as clean!
[DEBUG] 2024-04-23 23:37:42.683 [main] CompactionTxnHandler - Removed 0 records from completed_txn_components
[DEBUG] 2024-04-23 23:37:42.684 [main] CompactionTxnHandler - Going to execute update <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" IN ( SELECT "TXN_ID" FROM "TXNS" WHERE "TXN_STATE" = 'a') AND "TC_DATABASE" = ? AND "TC_TABLE" = ? AND "TC_PARTITION" IS NULL>
[DEBUG] 2024-04-23 23:37:42.686 [main] CompactionTxnHandler - Removed 0 records from txn_components
[DEBUG] 2024-04-23 23:37:42.686 [main] CompactionTxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.687 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.687 [main] PerfLogger - </PERFLOG method=mark_cleaned start=1713911862676 end=1713911862687 duration=11 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.687 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[ERROR] 2024-04-23 23:37:42.689 [main] RetryingHMSHandler - MetaException(message:Database name and table name cannot be null.)
	at org.apache.hadoop.hive.metastore.HMSHandler.get_latest_committed_compaction_info(HMSHandler.java:8811)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy37.get_latest_committed_compaction_info(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.getLatestCommittedCompactionInfo(HiveMetaStoreClient.java:4155)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.lambda$testGetLatestCommittedCompactionInfo$0(TestHiveMetaStoreTxns.java:432)
	at org.junit.Assert.assertThrows(Assert.java:1001)
	at org.junit.Assert.assertThrows(Assert.java:981)
	at org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testGetLatestCommittedCompactionInfo(TestHiveMetaStoreTxns.java:432)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runners.Suite.runChild(Suite.java:128)
	at org.junit.runners.Suite.runChild(Suite.java:27)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.apache.maven.surefire.junitcore.JUnitCore.run(JUnitCore.java:55)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.createRequestAndRun(JUnitCoreWrapper.java:137)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.executeEager(JUnitCoreWrapper.java:107)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:83)
	at org.apache.maven.surefire.junitcore.JUnitCoreWrapper.execute(JUnitCoreWrapper.java:75)
	at org.apache.maven.surefire.junitcore.JUnitCoreProvider.invoke(JUnitCoreProvider.java:158)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

[DEBUG] 2024-04-23 23:37:42.689 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713911862687 end=1713911862689 duration=2 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=-1 error=true>
[DEBUG] 2024-04-23 23:37:42.689 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.693 [main] TxnHandler - Going to execute query <SELECT * FROM (   SELECT   "CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_TYPE"   FROM "COMPLETED_COMPACTIONS"     WHERE "CC_STATE" = 's'   UNION ALL   SELECT   "CQ_ID" AS "CC_ID", "CQ_DATABASE" AS "CC_DATABASE"   ,"CQ_TABLE" AS "CC_TABLE", "CQ_PARTITION" AS "CC_PARTITION"   ,"CQ_TYPE" AS "CC_TYPE"   FROM "COMPACTION_QUEUE"     WHERE "CQ_STATE" = 'r') AS compactions  WHERE "CC_DATABASE"=? AND "CC_TABLE"=? AND "CC_PARTITION" IS NULL ORDER BY "CC_ID" DESC>
[DEBUG] 2024-04-23 23:37:42.694 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.694 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.694 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713911862689 end=1713911862694 duration=5 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.694 [main] PerfLogger - <PERFLOG method=get_latest_committed_compaction_info from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.694 [main] TxnHandler - Going to execute query <SELECT * FROM (   SELECT   "CC_ID", "CC_DATABASE", "CC_TABLE", "CC_PARTITION", "CC_TYPE"   FROM "COMPLETED_COMPACTIONS"     WHERE "CC_STATE" = 's'   UNION ALL   SELECT   "CQ_ID" AS "CC_ID", "CQ_DATABASE" AS "CC_DATABASE"   ,"CQ_TABLE" AS "CC_TABLE", "CQ_PARTITION" AS "CC_PARTITION"   ,"CQ_TYPE" AS "CC_TYPE"   FROM "COMPACTION_QUEUE"     WHERE "CQ_STATE" = 'r') AS compactions  WHERE "CC_DATABASE"=? AND "CC_TABLE"=? AND "CC_PARTITION" IS NULL ORDER BY "CC_ID" DESC>
[DEBUG] 2024-04-23 23:37:42.694 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.694 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.695 [main] PerfLogger - </PERFLOG method=get_latest_committed_compaction_info start=1713911862694 end=1713911862695 duration=1 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:42.695 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:42.697 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.697 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.700 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:42.700 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.700 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.701 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:42.701 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:42.701 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:42.701 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:42.702 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:42.702 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:42.702 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:42.702 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:42.702 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:42.703 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.708 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.708 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:42.710 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:42.712 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:42.712 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:42.715 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:37:42.715 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:42.715 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.715 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.715 [main] PerfLogger - </PERFLOG method=open_txns start=1713911862708 end=1713911862715 duration=7 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.715 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.716 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:42.716 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:42.716 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 1, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:42.716 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:42.720 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(2, 1),(3, 1),(4, 1)>
[INFO ] 2024-04-23 23:37:42.722 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([2, 3, 4]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:42.722 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.723 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.723 [main] PerfLogger - </PERFLOG method=open_txns start=1713911862715 end=1713911862723 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.723 [main] PerfLogger - <PERFLOG method=abort_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.725 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:37:42.725 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:42.727 [main] TxnHandler - Removed transactions: ([2]) from MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.727 [main] TxnHandler - Going to execute select <SELECT "RTM_REPL_POLICY" FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (2)>
[DEBUG] 2024-04-23 23:37:42.728 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'a' WHERE "TXN_STATE" = 'o' AND ("TXN_ID" in (2))>
[DEBUG] 2024-04-23 23:37:42.728 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" in (2)>
[DEBUG] 2024-04-23 23:37:42.728 [main] TxnUtils - Adding query to batch: <DELETE FROM "REPL_TXN_MAP" WHERE "RTM_TARGET_TXN_ID" in (2)>
[DEBUG] 2024-04-23 23:37:42.728 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:42.734 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.735 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.735 [main] PerfLogger - </PERFLOG method=abort_txn start=1713911862723 end=1713911862735 duration=12 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.735 [main] PerfLogger - <PERFLOG method=commit_txn from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.739 [main] TxnHandler - Going to execute insert <INSERT INTO "COMPLETED_TXN_COMPONENTS" ("CTC_TXNID", "CTC_DATABASE", "CTC_TABLE", "CTC_PARTITION", "CTC_WRITEID", "CTC_UPDATE_DELETE") SELECT "TC_TXNID", "TC_DATABASE", "TC_TABLE", "TC_PARTITION", "TC_WRITEID", 'N' FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3 AND "TC_OPERATION_TYPE" <> 'c'>
[INFO ] 2024-04-23 23:37:42.741 [main] TxnHandler - Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
[DEBUG] 2024-04-23 23:37:42.741 [main] TxnUtils - Adding query to batch: <DELETE FROM "TXN_COMPONENTS" WHERE "TC_TXNID" = 3>
[DEBUG] 2024-04-23 23:37:42.741 [main] TxnUtils - Adding query to batch: <DELETE FROM "HIVE_LOCKS" WHERE "HL_TXNID" = 3>
[DEBUG] 2024-04-23 23:37:42.741 [main] TxnUtils - Adding query to batch: <UPDATE "TXNS" SET "TXN_STATE" = 'c' WHERE "TXN_ID" = 3>
[DEBUG] 2024-04-23 23:37:42.741 [main] TxnUtils - Going to execute queries in batch. Batch size: 3
[DEBUG] 2024-04-23 23:37:42.747 [main] TxnUtils - Adding query to batch: <DELETE FROM "MIN_HISTORY_LEVEL" WHERE "MHL_TXNID" in (3)>
[DEBUG] 2024-04-23 23:37:42.747 [main] TxnUtils - Going to execute queries in batch. Batch size: 1
[INFO ] 2024-04-23 23:37:42.749 [main] TxnHandler - Removed transactions: ([3]) from MIN_HISTORY_LEVEL
[WARN ] 2024-04-23 23:37:42.749 [main] CompactionTxnHandler - No compaction queue record found for Compaction type transaction commit. txnId:3
[DEBUG] 2024-04-23 23:37:42.749 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.749 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.749 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.749 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.749 [main] PerfLogger - </PERFLOG method=commit_txn start=1713911862735 end=1713911862749 duration=14 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[DEBUG] 2024-04-23 23:37:42.749 [main] PerfLogger - <PERFLOG method=get_open_txns_req from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.750 [main] TxnHandler - Going to execute query<SELECT "TXN_ID", "TXN_STATE", "TXN_TYPE", ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - "TXN_STARTED") FROM "TXNS" ORDER BY "TXN_ID">
[DEBUG] 2024-04-23 23:37:42.752 [main] TxnHandler - Got OpenTxnList with hwm: 4 and openTxnList size 3.
[DEBUG] 2024-04-23 23:37:42.752 [main] ProxyConnection - HikariPool-2 - Executed rollback on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null)  due to dirty commit state on close().
[DEBUG] 2024-04-23 23:37:42.752 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.753 [main] PerfLogger - </PERFLOG method=get_open_txns_req start=1713911862749 end=1713911862752 duration=3 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:42.753 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:42.755 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.755 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.757 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:42.757 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.758 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.758 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:42.758 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:42.758 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:42.759 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:42.759 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:42.759 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:42.759 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:42.759 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:42.759 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:42.760 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.766 [main] PerfLogger - <PERFLOG method=open_txns from=org.apache.hadoop.hive.metastore.RetryingHMSHandler>
[DEBUG] 2024-04-23 23:37:42.766 [main] TxnHandler - TXN lock locked by 'Lenovo-Bot' in mode true
[DEBUG] 2024-04-23 23:37:42.768 [main] TxnHandler - Going to execute query <SELECT MAX("TXN_ID") FROM "TXNS" WHERE "TXN_STARTED" < ({ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000 - 1000)>
[DEBUG] 2024-04-23 23:37:42.770 [main] TxnHandler - MinOpenTxnIdWaterMark calculated with minOpenTxn 9223372036854775807, lowWaterMark 0
[DEBUG] 2024-04-23 23:37:42.770 [main] TxnHandler - Going to execute insert <INSERT INTO "TXNS" ("TXN_STATE", "TXN_STARTED", "TXN_LAST_HEARTBEAT", "TXN_USER", "TXN_HOST", "TXN_TYPE") VALUES(?,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,{ fn timestampdiff(sql_tsi_frac_second, timestamp('1970-01-01 01:00:00.0'), current_timestamp) } / 1000000,?,?,?)>
[DEBUG] 2024-04-23 23:37:42.773 [main] TxnHandler - Going to execute insert <insert into "MIN_HISTORY_LEVEL" ("MHL_TXNID", "MHL_MIN_OPEN_TXNID") values(1, 1)>
[INFO ] 2024-04-23 23:37:42.774 [main] TxnHandler - Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
[DEBUG] 2024-04-23 23:37:42.774 [main] TxnHandler - Going to commit
[DEBUG] 2024-04-23 23:37:42.774 [main] PoolBase - HikariPool-2 - Reset (autoCommit) on connection org.apache.derby.impl.jdbc.EmbedConnection@1381386227 (XID = 1564), (SESSIONID = 25), (DATABASE = memory:/home/alex/Repositories/hive/standalone-metastore/metastore-server/target/tmp/junit_metastore_db), (DRDAID = null) 
[DEBUG] 2024-04-23 23:37:42.774 [main] PerfLogger - </PERFLOG method=open_txns start=1713911862766 end=1713911862774 duration=8 from=org.apache.hadoop.hive.metastore.RetryingHMSHandler threadId=0 retryCount=0 error=false>
[INFO ] 2024-04-23 23:37:42.776 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:42.779 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.779 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.781 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:42.781 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.781 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.781 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:42.781 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:42.782 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:42.782 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:42.782 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:42.782 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:42.782 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:42.783 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:42.783 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:42.783 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[INFO ] 2024-04-23 23:37:42.788 [main] TestTxnDbUtil - Cleaning transactional tables
[DEBUG] 2024-04-23 23:37:42.790 [main] TestTxnDbUtil - Successfully truncated table TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.791 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_TXN_COMPONENTS
[DEBUG] 2024-04-23 23:37:42.792 [main] TestTxnDbUtil - Successfully truncated table TXNS
[DEBUG] 2024-04-23 23:37:42.792 [main] TestTxnDbUtil - Successfully truncated table TXN_TO_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.793 [main] TestTxnDbUtil - Successfully truncated table NEXT_WRITE_ID
[DEBUG] 2024-04-23 23:37:42.793 [main] TestTxnDbUtil - Successfully truncated table HIVE_LOCKS
[DEBUG] 2024-04-23 23:37:42.793 [main] TestTxnDbUtil - Successfully truncated table NEXT_LOCK_ID
[DEBUG] 2024-04-23 23:37:42.793 [main] TestTxnDbUtil - Successfully truncated table COMPACTION_QUEUE
[DEBUG] 2024-04-23 23:37:42.793 [main] TestTxnDbUtil - Successfully truncated table NEXT_COMPACTION_QUEUE_ID
[DEBUG] 2024-04-23 23:37:42.794 [main] TestTxnDbUtil - Successfully truncated table COMPLETED_COMPACTIONS
[DEBUG] 2024-04-23 23:37:42.794 [main] TestTxnDbUtil - Successfully truncated table AUX_TABLE
[DEBUG] 2024-04-23 23:37:42.794 [main] TestTxnDbUtil - Successfully truncated table WRITE_SET
[DEBUG] 2024-04-23 23:37:42.794 [main] TestTxnDbUtil - Successfully truncated table REPL_TXN_MAP
[DEBUG] 2024-04-23 23:37:42.794 [main] TestTxnDbUtil - Successfully truncated table MATERIALIZATION_REBUILD_LOCKS
[DEBUG] 2024-04-23 23:37:42.795 [main] TestTxnDbUtil - Successfully truncated table MIN_HISTORY_LEVEL
[DEBUG] 2024-04-23 23:37:42.805 [Thread-15] ShutdownHookManager - ShutdownHookManger complete shutdown.
