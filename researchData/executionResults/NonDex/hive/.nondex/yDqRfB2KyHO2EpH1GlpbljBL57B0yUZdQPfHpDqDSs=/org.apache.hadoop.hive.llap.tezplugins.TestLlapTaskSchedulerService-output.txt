DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,052582 seconds to load 241 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@36916eb0]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@36916eb0) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Missing dependencies for Yaml support, ConfigurationFactory org.apache.logging.log4j.core.config.yaml.YamlConfigurationFactory is inactive
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@5a45133e
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2
DEBUG StatusLogger Installed 1 script engine
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,002718 seconds to load 0 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 124 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/llap-tez/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/llap-tez/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={DRFA, console}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", PatternSelector=null, Configuration(HiveLog4j2Test), charset="null", header="null", disableAnsi="null", footer="null", noConsoleNoAnsi="null", alwaysWriteExceptions="null", Replace=null)
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(follow="null", direct="null", target="SYSTEM_ERR", bufferSize="null", bufferedIo="null", immediateFlush="null", name="console", Configuration(HiveLog4j2Test), PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ignoreExceptions="null", ={}, Filter=null)
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(Replace=null, PatternSelector=null, pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", Configuration(HiveLog4j2Test), footer="null", header="null", charset="null", disableAnsi="null", noConsoleNoAnsi="null", alwaysWriteExceptions="null")
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(modulate="true", maxRandomDelay="null", interval="1")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(tempCompressedFilePattern="null", max="30", fileIndex="null", min="null", stopCustomActionsOnError="null", compressionLevel="null", Configuration(HiveLog4j2Test), ={})
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(filePattern="/home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log.%d{yyyy-MM-dd}", advertiseURI="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), append="null", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), fileGroup="null", fileName="/home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log", fileOwner="null", advertise="null", filePermissions="null", immediateFlush="null", bufferSize="null", bufferedIo="null", ignoreExceptions="null", Configuration(HiveLog4j2Test), name="DRFA", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ={}, Filter=null)
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log seek to 498141
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/llap-tez/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 2 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T14:43:56.223-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-14:43:57.831, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-14:43:57.832, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@76a4ebf2 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@235834f2...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@235834f2 OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@7862f56
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@36916eb0
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/llap-tez/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@36916eb0) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@36916eb0] started OK.
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T14:43:58,544  INFO [Time-limited test] resource.ResourceUtils: Unable to find 'resource-types.xml'.
2024-04-23T14:43:58,917  INFO [Time-limited test] common.TezClassLoader: Created TezClassLoader with parent classloader: sun.misc.Launcher$AppClassLoader@330bedb4, thread: 14, system classloader: sun.misc.Launcher$AppClassLoader@330bedb4
2024-04-23T14:43:58,920  INFO [Time-limited test] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/llap-tez/target/testconf/hive-site.xml
2024-04-23T14:43:58,928  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3,host4, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:43:58,948  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3,host4
2024-04-23T14:43:58,959  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:58,960  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:58,981  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=4
2024-04-23T14:43:58,981  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:58,981  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:58,981  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=4
2024-04-23T14:43:58,982  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:58,982  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=4
2024-04-23T14:43:58,983  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host4, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:43:58,983  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host4, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=4. activeInstances.size=4
2024-04-23T14:43:58,986  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:43:58,988  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:58,989  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:43:58,990  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000000_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:58,991  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:58,991  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:58,991  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000001_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:58,991  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:58,992  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000002_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:58,992  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:58,992  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:43:58,994  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:59,010  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000000_0, priority=1, startTime=0, containerId=null, uniqueId=2, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:59,011  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000000_0; false
2024-04-23T14:43:59,011  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000000_0, true
2024-04-23T14:43:59,012  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host4:0, id=host-host4, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:43:59,012  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000001_0, priority=1, startTime=0, containerId=null, uniqueId=3, localityDelayTimeout=0} on node={host4:0, id=host-host4, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:59,013  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000001_0; false
2024-04-23T14:43:59,013  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000001_0, true
2024-04-23T14:43:59,014  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:43:59,014  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000002_0, priority=1, startTime=0, containerId=null, uniqueId=4, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:59,014  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000002_0; false
2024-04-23T14:43:59,015  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000002_0, true
2024-04-23T14:43:59,015  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,016  WARN [LlapScheduler] tezplugins.LlapTaskSchedulerService: Null NodeInfo when attempting to get available resources for inactive-host-null
2024-04-23T14:43:59,030  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:59,030  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:59,031  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:59,031  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:59,031  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:59,031  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:59,031  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:59,031  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:43:59,047  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:43:59,048  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:59,048  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:59,049  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:59,049  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:59,049  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,050  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:43:59,050  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:59,051  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,051  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000003_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:59,051  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:59,051  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000004_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:59,051  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:59,051  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000005_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:59,052  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:59,052  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:59,052  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000003_0, priority=1, startTime=0, containerId=null, uniqueId=5, localityDelayTimeout=78873904} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:59,052  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000003_0; false
2024-04-23T14:43:59,052  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000003_0, true
2024-04-23T14:43:59,053  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:59,053  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000004_0, priority=1, startTime=0, containerId=null, uniqueId=6, localityDelayTimeout=78873904} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:59,053  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000004_0; false
2024-04-23T14:43:59,053  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000004_0, true
2024-04-23T14:43:59,054  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,058  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:43:59,058  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000005_0, priority=1, startTime=0, containerId=null, uniqueId=7, localityDelayTimeout=78873904} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:43:59,058  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000005_0; false
2024-04-23T14:43:59,059  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000005_0, true
2024-04-23T14:43:59,059  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,060  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:43:59,060  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:43:59,060  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:43:59,060  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:59,060  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:43:59,060  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:43:59,060  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:43:59,060 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:43:59,073  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:43:59,074  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:43:59,075  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:43:59,075  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=2} with available capacity=2, pendingQueueSize=0, memory=4096
2024-04-23T14:43:59,075  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=2}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:43:59,075  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,075  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=2} with available capacity=2, pendingQueueSize=0, memory=4096
2024-04-23T14:43:59,076  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=2}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:43:59,076  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,076  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000006_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:59,077  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:59,077  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000007_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:59,077  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:59,077  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000008_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:43:59,077  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:59,077  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:59,078  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000006_0, priority=2, startTime=0, containerId=null, uniqueId=8, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:43:59,078  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000006_0; false
2024-04-23T14:43:59,078  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000006_0, true
2024-04-23T14:43:59,079  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:43:59,079  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000007_0, priority=2, startTime=0, containerId=null, uniqueId=9, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:43:59,079  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000007_0; false
2024-04-23T14:43:59,079  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000007_0, true
2024-04-23T14:43:59,080  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,081  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000009_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:43:59,081  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=2. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:43:59,082  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,083  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:43:59,084  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000007_0, priority=2, startTime=78863932, containerId=container_11111_0001_01_000005, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=9, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:43:59,085  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:43:59,085  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000006_0; false
2024-04-23T14:43:59,086  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000006_0, state=ASSIGNED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:43:59,086  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=false, disabled=true} for 2000 milli-seconds. commFailure=false
2024-04-23T14:43:59,093  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,087  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=false, disabled=true}
2024-04-23T14:44:01,088  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,089  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:01,089  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000009_0, priority=1, startTime=0, containerId=null, uniqueId=11, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:01,090  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000009_0; false
2024-04-23T14:44:01,090  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000009_0, true
2024-04-23T14:44:01,093  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:01,093  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:01,093  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:01,093  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:01,093  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:01,093  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:01,093  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:01,093  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:01,105  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:01,107  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:01,114  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:01,115  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:01,115  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:01,116  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,116  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:01,116  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:01,117  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,117  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000010_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:01,117  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:01,117  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000011_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:01,117  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:01,117  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000012_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:01,118  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:01,118  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:01,118  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000010_0, priority=1, startTime=0, containerId=null, uniqueId=12, localityDelayTimeout=78875970} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:01,118  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000010_0; false
2024-04-23T14:44:01,119  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000010_0, true
2024-04-23T14:44:01,120  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:01,120  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000011_0, priority=1, startTime=0, containerId=null, uniqueId=13, localityDelayTimeout=78875970} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:01,120  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000011_0; false
2024-04-23T14:44:01,120  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000011_0, true
2024-04-23T14:44:01,121  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,122  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.TestLlapTaskSchedulerService: Triggered getTask but the first element is not ready to execute
2024-04-23T14:44:01,123  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000010_0; false
2024-04-23T14:44:01,123  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000010_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:01,124  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:01,124  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000012_0, priority=1, startTime=0, containerId=null, uniqueId=14, localityDelayTimeout=78875970} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:01,124  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000012_0; false
2024-04-23T14:44:01,124  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000012_0, true
2024-04-23T14:44:01,125  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,126  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:01,126  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:01,126  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:01,126  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:01,127  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:01,127  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:01,127  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:01,127 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:01,138  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:01,139  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:01,140  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:01,140  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:01,141  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:01,141  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,141  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:01,141  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:01,141  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:01,142  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:01,142  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,142  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:01,142  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000013_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:01,143  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:01,143  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,143  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000014_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:01,143  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:01,143  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:01,144  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000013_0, priority=1, startTime=0, containerId=null, uniqueId=15, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:01,144  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000013_0; false
2024-04-23T14:44:01,144  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:01,145  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:01,145  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000014_0, priority=2, startTime=0, containerId=null, uniqueId=16, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:01,145  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000014_0; false
2024-04-23T14:44:01,145  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:01,146  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,146  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:01,146  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:01,146  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:01,146  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:01,146  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:01,146  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:01,146  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 2 (internal version -9223372036854775805); the delta to adjust by is 1
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is -1
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 2 levels
2024-04-23T14:44:01,147  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:01,148  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:01,148  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:01,148  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:01,148  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:01,148  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:01,148  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:01,148  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:01,148  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000014_0, true
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is 1
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000013_0 to update
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775801); the delta to adjust by is -1
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:01,149  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000013_0 to update - already pending
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Sending update to the same task in response handling attempt_1_0001_0_00_000013_0, false
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775800); the delta to adjust by is 1
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000013_0 to update - already pending
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:01,150  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:01,151  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:01,151  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:01,151  INFO [Time-limited test] GuaranteedTasks: Sending update to the same task in response handling attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:01,151  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000013_0, true
2024-04-23T14:44:01,151  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000013_0; true
2024-04-23T14:44:01,151  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000013_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:01,151  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:01,151  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:01,151  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000014_0 to update
2024-04-23T14:44:01,152  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000014_0; true
2024-04-23T14:44:01,152  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000014_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:01,152  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:01,152  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:01,152  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:01,152  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:01,152  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:01,152  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:01,153  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:01,153  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:01,153  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:01,153 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:01,164  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=5000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:01,165  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:01,166  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:01,166  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:01,167  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:01,167  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,167  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:01,167  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:01,167  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,167  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000015_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:01,168  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:01,168  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000016_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:01,168  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:01,168  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000017_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:01,168  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:01,169  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:01,169  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000015_0, priority=1, startTime=0, containerId=null, uniqueId=17, localityDelayTimeout=78876020} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:01,169  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000015_0; false
2024-04-23T14:44:01,169  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000015_0, true
2024-04-23T14:44:01,170  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:01,171  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000016_0, priority=1, startTime=0, containerId=null, uniqueId=18, localityDelayTimeout=78876020} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:01,171  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000016_0; false
2024-04-23T14:44:01,171  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000016_0, true
2024-04-23T14:44:01,171  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:01,173  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000015_0; false
2024-04-23T14:44:01,173  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000015_0, state=ASSIGNED, endReason=COMMUNICATION_ERROR
2024-04-23T14:44:01,173  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=true, disabled=true} for 5000 milli-seconds. commFailure=true
2024-04-23T14:44:01,174  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,174  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,174  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,176  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,177  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,177  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,177  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,179  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,179  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:03,194  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=20000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=9000} consistentSplits=true
2024-04-23T14:44:03,195  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:03,196  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,197  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,197  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:03,197  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,198  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,198  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:03,198  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,198  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000018_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,198  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,198  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000019_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,198  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,199  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000020_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,199  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,199  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,199  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000018_0, priority=1, startTime=0, containerId=null, uniqueId=20, localityDelayTimeout=78877052} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,199  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000018_0; false
2024-04-23T14:44:03,199  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000018_0, true
2024-04-23T14:44:03,200  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,201  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000019_0, priority=1, startTime=0, containerId=null, uniqueId=21, localityDelayTimeout=78877053} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,201  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000019_0; false
2024-04-23T14:44:03,201  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000019_0, true
2024-04-23T14:44:03,201  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,203  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000018_0; false
2024-04-23T14:44:03,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000018_0, state=ASSIGNED, endReason=COMMUNICATION_ERROR
2024-04-23T14:44:03,204  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=1, ac=1, commF=true, disabled=true} for 10000 milli-seconds. commFailure=true
2024-04-23T14:44:03,204  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,205  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:44:03,205  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000020_0, priority=1, startTime=0, containerId=null, uniqueId=22, localityDelayTimeout=78877054} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:03,205  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000020_0; false
2024-04-23T14:44:03,205  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000020_0, true
2024-04-23T14:44:03,206  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,206  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,207  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,207  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,207  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,207  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,207  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,207  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:03,220  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=10000} consistentSplits=true
2024-04-23T14:44:03,221  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:03,222  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,222  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:03,223  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:03,223  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,223  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000021_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,224  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,224  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000022_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,224  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,224  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000023_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,224  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,224  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,224  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000021_0, priority=1, startTime=0, containerId=null, uniqueId=23, localityDelayTimeout=78878076} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,225  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000021_0; false
2024-04-23T14:44:03,225  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000021_0, true
2024-04-23T14:44:03,226  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,226  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000022_0, priority=1, startTime=0, containerId=null, uniqueId=24, localityDelayTimeout=78878076} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,226  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000022_0; false
2024-04-23T14:44:03,226  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000022_0, true
2024-04-23T14:44:03,226  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,228  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.TestLlapTaskSchedulerService: Triggered getTask but the first element is not ready to execute
2024-04-23T14:44:03,228  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000021_0; false
2024-04-23T14:44:03,228  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000021_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:03,229  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,229  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000023_0, priority=1, startTime=0, containerId=null, uniqueId=25, localityDelayTimeout=78878076} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:03,229  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000023_0; false
2024-04-23T14:44:03,229  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000023_0, true
2024-04-23T14:44:03,229  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,230  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,230  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,231  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,231  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,231  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,231  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,231  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,232 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,243  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=1000} consistentSplits=true
2024-04-23T14:44:03,243  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:03,244  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,244  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:03,245  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:03,245  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,245  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000024_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,245  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,245  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,245  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000025_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,245  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,246  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,246  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000024_0, priority=1, startTime=0, containerId=null, uniqueId=26, localityDelayTimeout=78869099} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,246  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000024_0; false
2024-04-23T14:44:03,246  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000024_0, true
2024-04-23T14:44:03,247  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,247  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,247  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,247  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,247  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,248  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,248  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,248  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,248 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,261  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:03,261  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:03,262  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,263  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,263  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:03,263  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,263  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,263  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:03,263  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,263  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000026_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,264  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,264  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,264  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000027_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,264  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,264  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,264  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000026_0, priority=2, startTime=0, containerId=null, uniqueId=28, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,264  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000026_0; false
2024-04-23T14:44:03,264  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000026_0, true
2024-04-23T14:44:03,265  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,265  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000027_0, priority=2, startTime=0, containerId=null, uniqueId=29, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,265  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000027_0; false
2024-04-23T14:44:03,265  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000027_0, true
2024-04-23T14:44:03,266  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,267  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000028_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,267  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=2. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,267  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000029_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,267  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=2. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,268  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,268  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:44:03,269  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000027_0, priority=2, startTime=78868118, containerId=container_11111_0001_01_000005, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=29, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:03,269  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,270  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000027_0; false
2024-04-23T14:44:03,270  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000027_0, state=PREEMPTED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:44:03,271  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,271  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000028_0, priority=1, startTime=0, containerId=null, uniqueId=30, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:03,271  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000028_0; false
2024-04-23T14:44:03,271  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000028_0, true
2024-04-23T14:44:03,271  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,272  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000026_0, priority=2, startTime=78868117, containerId=container_11111_0001_01_000003, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=28, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:03,272  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,273  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000026_0; false
2024-04-23T14:44:03,273  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000026_0, state=PREEMPTED, endReason=INTERNAL_PREEMPTION
2024-04-23T14:44:03,273  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,274  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000029_0, priority=1, startTime=0, containerId=null, uniqueId=31, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:03,274  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000029_0; false
2024-04-23T14:44:03,274  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000029_0, true
2024-04-23T14:44:03,274  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,275  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,275  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,275  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,275  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,275  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,275  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,275  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,275 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,287  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,288  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,289  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,289  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,289  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,290  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,290  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,290  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,290  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,290  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,290  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,291  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000030_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,291  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,291  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,291  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000030_0, priority=1, startTime=0, containerId=null, uniqueId=32, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,291  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000030_0; false
2024-04-23T14:44:03,291  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000030_0, true
2024-04-23T14:44:03,292  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,293  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,293  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,293  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,293  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,293  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,293  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,293  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,293 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,304  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,305  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,306  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,306  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,307  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,307  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,307  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,307  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,307  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,307  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,307  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,308  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:03,308  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000031_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,308  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,308  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000032_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,308  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,308  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,308  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000033_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,308  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=2]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,309  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,309  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000031_0, priority=1, startTime=0, containerId=null, uniqueId=33, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,309  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000031_0; false
2024-04-23T14:44:03,309  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000031_0, true
2024-04-23T14:44:03,310  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,310  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000032_0, priority=2, startTime=0, containerId=null, uniqueId=34, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,310  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000032_0; false
2024-04-23T14:44:03,310  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000032_0, true
2024-04-23T14:44:03,310  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,310  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000033_0, priority=2, startTime=0, containerId=null, uniqueId=35, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:03,310  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000033_0; false
2024-04-23T14:44:03,310  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000033_0, true
2024-04-23T14:44:03,311  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 2 (internal version -9223372036854775806); the delta to adjust by is 2
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Distributing 2 among 2 levels
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000031_0 to update
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 2
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000033_0 to update
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Distributed 2
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Sending updates to 2 tasks
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 4 (internal version -9223372036854775805); the delta to adjust by is 2
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Distributing 2 among 1 levels
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000032_0 to update
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 6 (internal version -9223372036854775804); the delta to adjust by is 2
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Setting unused to 3 based on remaining delta 2
2024-04-23T14:44:03,311  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 5 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Setting unused to 2 based on full delta 1
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is -4
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Revoking 2 from 2 levels
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 2
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000032_0 to update - already pending
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000033_0 to update - already pending
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 2 / 2
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775801); the delta to adjust by is -1
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000031_0 to update - already pending
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000031_0; false
2024-04-23T14:44:03,312  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000031_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,312  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000032_0; false
2024-04-23T14:44:03,312  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000032_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,313  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000033_0; false
2024-04-23T14:44:03,313  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000033_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,313  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,313  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,313  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,313  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,313  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,313  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,313  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,313 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,325  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,325  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,326  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,326  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,326  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,327  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,327  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,327  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,327  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,327  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,327  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,327  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775807); the delta to adjust by is 1
2024-04-23T14:44:03,328  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:03,328  INFO [Time-limited test] GuaranteedTasks: Distributed 0
2024-04-23T14:44:03,328  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:03,328  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:03,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000034_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,328  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,328  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,328  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,328  INFO [LlapScheduler] GuaranteedTasks: Using an unused duck for attempt_1_0001_0_00_000034_0; unused is now 0
2024-04-23T14:44:03,328  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000034_0, priority=2, startTime=0, containerId=null, uniqueId=36, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000002
2024-04-23T14:44:03,328  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000034_0; true
2024-04-23T14:44:03,329  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000034_0, true
2024-04-23T14:44:03,329  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000035_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,329  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,330  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,330  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,330  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000035_0, priority=1, startTime=0, containerId=null, uniqueId=37, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000004
2024-04-23T14:44:03,330  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000035_0; true
2024-04-23T14:44:03,330  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000035_0, true
2024-04-23T14:44:03,330  INFO [LlapScheduler] GuaranteedTasks: Downgrading attempt_1_0001_0_00_000034_0
2024-04-23T14:44:03,330  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000035_0; true
2024-04-23T14:44:03,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000035_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,331  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:03,331  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,331  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:03,331  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000034_0 to update - already pending
2024-04-23T14:44:03,331  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000034_0; true
2024-04-23T14:44:03,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000034_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,331  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:03,331  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:03,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,331  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,331  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,331  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,331  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,332  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,332 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,342  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,343  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:03,344  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,344  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,344  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:03,344  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,344  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000036_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,345  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,345  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,345  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000037_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,345  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,345  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000038_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,345  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,345  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,345  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000036_0, priority=1, startTime=0, containerId=null, uniqueId=38, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,345  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000036_0; false
2024-04-23T14:44:03,345  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000036_0, true
2024-04-23T14:44:03,346  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,346  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000037_0, priority=1, startTime=0, containerId=null, uniqueId=39, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,346  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000037_0; false
2024-04-23T14:44:03,346  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000037_0, true
2024-04-23T14:44:03,347  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,347  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,347  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,347  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,347  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,347 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,360  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,361  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,362  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,362  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,362  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,362  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,363  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,363  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:03,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000039_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,363  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,364  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,364  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,364  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000039_0, priority=1, startTime=0, containerId=null, uniqueId=41, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,364  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000039_0; false
2024-04-23T14:44:03,364  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000039_0, true
2024-04-23T14:44:03,365  INFO [Time-limited test] GuaranteedTasks: Sending an update based on inconsistent state from heartbeat for attempt_1_0001_0_00_000039_0, false
2024-04-23T14:44:03,365  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000039_0, true
2024-04-23T14:44:03,365  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000039_0; false
2024-04-23T14:44:03,365  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000039_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,365  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,365  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,365  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,365  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,365  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,366  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,366  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,366  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,366 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,378  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,378  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,379  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,379  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:03,379  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,380  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,380  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:03,380  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,380  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=0, memory=4096
2024-04-23T14:44:03,380  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=1, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,381  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,381  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000040_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000041_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000042_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,382  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,383  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,383  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000040_0, priority=1, startTime=0, containerId=null, uniqueId=42, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,383  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000040_0; false
2024-04-23T14:44:03,383  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000040_0, true
2024-04-23T14:44:03,383  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:44:03,383  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000041_0, priority=1, startTime=0, containerId=null, uniqueId=43, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,384  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000041_0; false
2024-04-23T14:44:03,384  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000041_0, true
2024-04-23T14:44:03,384  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host2]
2024-04-23T14:44:03,384  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000042_0, priority=1, startTime=0, containerId=null, uniqueId=44, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:03,384  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000042_0; false
2024-04-23T14:44:03,384  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000042_0, true
2024-04-23T14:44:03,384  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,386  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,386  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,386  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,386  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,386  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,386  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,386  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,386 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,399  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:03,399  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:03,400  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,400  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:03,401  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:03,401  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000043_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,401  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,401  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,402  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,402  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000043_0, priority=2, startTime=0, containerId=null, uniqueId=45, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,402  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000043_0; false
2024-04-23T14:44:03,402  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000043_0, true
2024-04-23T14:44:03,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000044_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,404  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,404  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,404  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,404  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000044_0, priority=2, startTime=0, containerId=null, uniqueId=46, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,404  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000044_0; false
2024-04-23T14:44:03,404  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000044_0, true
2024-04-23T14:44:03,405  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000045_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,405  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=2. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,405  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,407  WARN [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: DAG info is not a DAG - cannot derive dependencies
2024-04-23T14:44:03,407  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,407  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Preempting TaskInfo{task=attempt_1_0001_0_00_000043_0, priority=2, startTime=10000, containerId=container_11111_0001_01_000003, assignedNode={host1:0, id=host-host1, canAcceptTask=false, st=2, ac=0, commF=false, disabled=false}, uniqueId=45, localityDelayTimeout=9223372036854775807} running at Host=host1
2024-04-23T14:44:03,408  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,408  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,408  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,408  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,408  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,408  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,408  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,408  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Scheduler thread interrupted after shutdown
2024-04-23T14:44:03,417  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,418  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,419  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,419  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,419  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,419  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,419  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,419  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,419  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,420  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,420  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,420  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:03,420  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000046_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,420  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,420  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000047_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,420  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,421  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000046_0, priority=1, startTime=0, containerId=null, uniqueId=48, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,421  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000046_0; false
2024-04-23T14:44:03,421  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000046_0, true
2024-04-23T14:44:03,421  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,421  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,422  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,422  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000047_0, priority=2, startTime=0, containerId=null, uniqueId=49, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,422  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000047_0; false
2024-04-23T14:44:03,422  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000047_0, true
2024-04-23T14:44:03,422  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,422  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:03,422  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:03,422  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,423  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000046_0 to update
2024-04-23T14:44:03,423  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:03,423  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:03,423  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:03,423  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000046_0; true
2024-04-23T14:44:03,423  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000046_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,423  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:03,423  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:03,423  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000047_0 to update
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000046_0, false
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000047_0, false
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000047_0, true
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels; on failure
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: Adding failed attempt_1_0001_0_00_000047_0 to update
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000047_0; true
2024-04-23T14:44:03,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000047_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:03,424  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:03,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,424  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,424  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,424  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,424  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,425  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,425 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,435  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:03,435  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:03,436  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,436  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,437  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:03,437  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,437  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,437  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:03,437  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,437  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000048_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,437  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,438  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000049_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,438  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,438  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000050_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,438  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,438  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,438  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000048_0, priority=1, startTime=0, containerId=null, uniqueId=50, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,438  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000048_0; false
2024-04-23T14:44:03,438  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000048_0, true
2024-04-23T14:44:03,439  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,439  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000049_0, priority=1, startTime=0, containerId=null, uniqueId=51, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,439  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000049_0; false
2024-04-23T14:44:03,439  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000049_0, true
2024-04-23T14:44:03,439  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,440  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,440  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,440  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,440  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,440  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,440  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,440 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,450  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=10000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,451  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,452  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,452  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,452  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,452  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,452  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,453  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000051_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,453  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,454  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,454  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000051_0, priority=1, startTime=0, containerId=null, uniqueId=53, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,454  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000051_0; false
2024-04-23T14:44:03,454  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000051_0, true
2024-04-23T14:44:03,455  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,455  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000051_0; false
2024-04-23T14:44:03,455  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000051_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:03,455  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 10000 milli-seconds. commFailure=false
2024-04-23T14:44:03,456  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000052_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,456  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,456  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=3, requestedHosts=[host1]
2024-04-23T14:44:03,456  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000052_0, priority=1, startTime=0, containerId=null, uniqueId=54, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,456  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000052_0; false
2024-04-23T14:44:03,456  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000052_0, true
2024-04-23T14:44:03,457  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,457  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,457  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,457  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,457  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,457  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,457  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,457  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,457 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,468  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:03,469  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:03,470  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,470  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,470  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:03,470  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:03,471  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000053_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000054_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000055_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000056_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,471  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,472  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=2
2024-04-23T14:44:03,472  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000053_0, priority=1, startTime=0, containerId=null, uniqueId=58, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,472  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000053_0; false
2024-04-23T14:44:03,472  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000053_0, true
2024-04-23T14:44:03,473  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=2
2024-04-23T14:44:03,473  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000054_0, priority=1, startTime=0, containerId=null, uniqueId=59, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,473  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000054_0; false
2024-04-23T14:44:03,473  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000054_0, true
2024-04-23T14:44:03,473  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:03,473  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000055_0, priority=1, startTime=0, containerId=null, uniqueId=60, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:03,473  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000055_0; false
2024-04-23T14:44:03,473  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000055_0, true
2024-04-23T14:44:03,473  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:03,474  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000056_0, priority=1, startTime=0, containerId=null, uniqueId=61, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:03,474  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000056_0; false
2024-04-23T14:44:03,474  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000056_0, true
2024-04-23T14:44:03,474  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,475  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,475  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,475  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,476  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,476  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,476  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,476  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,476 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,485  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,486  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,487  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,487  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,487  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,487  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,487  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,488  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,488  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:03,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000057_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000058_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,488  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,488  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=2. [p=1,c=1][p=2,c=1]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,489  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,489  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000057_0, priority=1, startTime=0, containerId=null, uniqueId=62, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,489  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000057_0; false
2024-04-23T14:44:03,489  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000057_0, true
2024-04-23T14:44:03,490  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,490  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000058_0, priority=2, startTime=0, containerId=null, uniqueId=63, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=13, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,490  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000058_0; false
2024-04-23T14:44:03,490  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000058_0, true
2024-04-23T14:44:03,490  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,491  INFO [test-update-thread] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:03,491  INFO [test-update-thread] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:03,491  INFO [test-update-thread] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,491  INFO [test-update-thread] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:03,491  INFO [test-update-thread] GuaranteedTasks: Distributed 1
2024-04-23T14:44:03,491  INFO [test-update-thread] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:03,491  INFO [test-update-thread] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000057_0 to update - already pending
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:03,492  INFO [test-update-thread] GuaranteedTasks: Not sending update to attempt_1_0001_0_00_000057_0
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is 1
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:03,492  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000057_0, true
2024-04-23T14:44:03,493  INFO [test-update-thread] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775803); the delta to adjust by is -1
2024-04-23T14:44:03,493  INFO [test-update-thread] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:03,493  INFO [test-update-thread] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,493  INFO [test-update-thread] GuaranteedTasks: Adding attempt_1_0001_0_00_000057_0 to update
2024-04-23T14:44:03,493  INFO [test-update-thread] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:03,493  INFO [test-update-thread] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775802); the delta to adjust by is 1
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000057_0 to update - already pending
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:03,493  INFO [test-update-thread] GuaranteedTasks: Not sending update to attempt_1_0001_0_00_000057_0
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000057_0; true
2024-04-23T14:44:03,493  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000057_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:03,493  INFO [Time-limited test] GuaranteedTasks: At priority 2 observing 1
2024-04-23T14:44:03,494  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000058_0 to update
2024-04-23T14:44:03,494  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000058_0; true
2024-04-23T14:44:03,494  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000058_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,494  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:03,494  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:03,494  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,494  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,494  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,494  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,494  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,494  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,494  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,494 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,504  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:03,505  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1
2024-04-23T14:44:03,511  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,512  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:03,513  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=1
2024-04-23T14:44:03,513  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,513  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000059_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,513  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,513  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,513  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000060_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,513  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,514  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:03,514  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000059_0, priority=1, startTime=0, containerId=null, uniqueId=64, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,514  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000059_0; false
2024-04-23T14:44:03,514  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000059_0, true
2024-04-23T14:44:03,514  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,515  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000060_0, priority=1, startTime=0, containerId=null, uniqueId=65, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,515  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000060_0; false
2024-04-23T14:44:03,515  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000060_0, true
2024-04-23T14:44:03,515  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,516  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,516  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,516  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,516  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,516  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,516  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,516  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,516 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,526  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,527  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,528  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,528  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,528  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,528  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,528  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,528  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,529  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,529  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,529  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,529  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:03,529  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000061_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,529  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,529  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,529  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000061_0, priority=1, startTime=0, containerId=null, uniqueId=66, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,530  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000061_0; false
2024-04-23T14:44:03,530  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000061_0, true
2024-04-23T14:44:03,530  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,530  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:03,530  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:03,530  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,530  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000061_0 to update
2024-04-23T14:44:03,530  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:03,530  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000061_0 to update - already pending
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000061_0, false
2024-04-23T14:44:03,531  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000061_0; false
2024-04-23T14:44:03,531  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000061_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,531  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,531  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,531  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,531  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,531  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,531  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,531  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,531  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,531 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,540  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,541  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,542  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,542  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,542  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,542  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,543  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,543  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,543  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,543  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,543  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,543  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775807); the delta to adjust by is 1
2024-04-23T14:44:03,543  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:03,543  INFO [Time-limited test] GuaranteedTasks: Distributed 0
2024-04-23T14:44:03,543  INFO [Time-limited test] GuaranteedTasks: Setting unused to 1 based on remaining delta 1
2024-04-23T14:44:03,543  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:03,543  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000062_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,543  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,543  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,544  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,544  INFO [LlapScheduler] GuaranteedTasks: Using an unused duck for attempt_1_0001_0_00_000062_0; unused is now 0
2024-04-23T14:44:03,544  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000062_0, priority=1, startTime=0, containerId=null, uniqueId=67, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000002
2024-04-23T14:44:03,544  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000062_0; true
2024-04-23T14:44:03,544  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000062_0, true
2024-04-23T14:44:03,545  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000063_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,545  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,545  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,545  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:03,545  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000063_0, priority=1, startTime=0, containerId=null, uniqueId=68, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,545  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000063_0; false
2024-04-23T14:44:03,545  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000063_0, true
2024-04-23T14:44:03,545  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000062_0; true
2024-04-23T14:44:03,545  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000062_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,545  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:03,545  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,545  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:03,545  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000063_0 to update
2024-04-23T14:44:03,546  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000063_0; true
2024-04-23T14:44:03,546  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000063_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:03,546  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 0 levels
2024-04-23T14:44:03,546  INFO [Time-limited test] GuaranteedTasks: Returning the unused duck; unused is now 1
2024-04-23T14:44:03,546  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:03,546  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:03,546  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:03,546  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,546  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:03,546  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:03,546  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:03,546 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:03,555  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=1000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:03,555  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:03,556  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:03,557  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,557  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:03,557  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,557  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,557  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:03,557  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:03,557  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:03,558  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,558  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000064_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,558  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,558  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000065_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,558  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,558  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000066_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,558  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,558  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,558  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000064_0, priority=1, startTime=0, containerId=null, uniqueId=69, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:03,558  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000064_0; false
2024-04-23T14:44:03,558  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000064_0, true
2024-04-23T14:44:03,559  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,559  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000065_0, priority=1, startTime=0, containerId=null, uniqueId=70, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:03,559  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000065_0; false
2024-04-23T14:44:03,559  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000065_0, true
2024-04-23T14:44:03,559  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host3. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:03,559  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000066_0, priority=1, startTime=0, containerId=null, uniqueId=71, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:03,559  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000066_0; false
2024-04-23T14:44:03,559  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000066_0, true
2024-04-23T14:44:03,559  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:03,560  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000064_0; false
2024-04-23T14:44:03,560  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000064_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:03,561  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:03,561  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000065_0; false
2024-04-23T14:44:03,561  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000065_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:03,561  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host2:0, id=host-host2, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:03,561  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000066_0; false
2024-04-23T14:44:03,561  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000066_0, state=ASSIGNED, endReason=EXECUTOR_BUSY
2024-04-23T14:44:03,561  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Disabling instance {host3:0, id=host-host3, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true} for 1000 milli-seconds. commFailure=false
2024-04-23T14:44:03,561  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000067_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,561  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000068_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000069_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:03,562  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:03,562  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,561  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host1:0, id=host-host1, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:04,561  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host3:0, id=host-host3, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:04,561  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: Attempting to re-enable node: {host2:0, id=host-host2, canAcceptTask=false, st=0, ac=14, commF=false, disabled=true}
2024-04-23T14:44:04,561  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,562  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,562  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000067_0, priority=1, startTime=0, containerId=null, uniqueId=72, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:04,562  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000067_0; false
2024-04-23T14:44:04,562  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000067_0, true
2024-04-23T14:44:04,562  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,563  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000068_0, priority=1, startTime=0, containerId=null, uniqueId=73, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:04,563  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000068_0; false
2024-04-23T14:44:04,563  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000068_0, true
2024-04-23T14:44:04,563  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for host3. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,563  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #6, task=TaskInfo{task=attempt_1_0001_0_00_000069_0, priority=1, startTime=0, containerId=null, uniqueId=74, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000013
2024-04-23T14:44:04,563  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000069_0; false
2024-04-23T14:44:04,563  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000069_0, true
2024-04-23T14:44:04,563  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,565  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:04,565  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:04,565  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,574  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:04,574  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:04,574  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:04,575  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,574 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:04,586  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:04,587  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:04,588  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:04,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:04,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:04,589  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:04,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:04,589  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000070_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,589  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,589  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000071_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,590  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,590  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000072_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,590  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,590  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000073_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,590  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,590  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000074_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,590  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=5]. runningTasks=0. totalPendingTasks=5. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,590  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,590  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000070_0, priority=1, startTime=0, containerId=null, uniqueId=75, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:04,590  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000070_0; false
2024-04-23T14:44:04,590  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000070_0, true
2024-04-23T14:44:04,591  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,591  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000071_0, priority=1, startTime=0, containerId=null, uniqueId=76, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:04,591  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000071_0; false
2024-04-23T14:44:04,591  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000071_0, true
2024-04-23T14:44:04,591  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} in consistent order when looking for first requested host, from #hosts=2, requestedHosts=[host1]
2024-04-23T14:44:04,591  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000072_0, priority=1, startTime=0, containerId=null, uniqueId=77, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:04,592  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000072_0; false
2024-04-23T14:44:04,592  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000072_0, true
2024-04-23T14:44:04,592  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,592  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000073_0, priority=1, startTime=0, containerId=null, uniqueId=78, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:04,592  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000073_0; false
2024-04-23T14:44:04,592  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000073_0, true
2024-04-23T14:44:04,592  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,594  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000070_0; false
2024-04-23T14:44:04,594  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000070_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:04,595  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:04,595  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000074_0, priority=1, startTime=0, containerId=null, uniqueId=79, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:04,595  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000074_0; false
2024-04-23T14:44:04,595  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000074_0, true
2024-04-23T14:44:04,595  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,596  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:04,596  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:04,596  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:04,596  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,596  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:04,596  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,596  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:04,596 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:04,605  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:04,606  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:04,607  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:04,607  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:04,607  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:04,607  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,607  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:04,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:04,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:04,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:04,608  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,608  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000075_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,609  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,609  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:04,609  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000075_0, priority=1, startTime=0, containerId=null, uniqueId=80, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:04,609  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000075_0; false
2024-04-23T14:44:04,609  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000075_0, true
2024-04-23T14:44:04,609  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,610  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:04,610  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:04,610  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:04,610  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,610  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:04,610  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,611  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:04,611 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:04,620  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=-1} consistentSplits=true
2024-04-23T14:44:04,621  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2
2024-04-23T14:44:04,622  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:04,622  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:04,622  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=2
2024-04-23T14:44:04,623  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,623  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=1} with available capacity=1, pendingQueueSize=1, memory=4096
2024-04-23T14:44:04,623  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=1}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=2, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=2
2024-04-23T14:44:04,623  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,623  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000076_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,623  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,623  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000077_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,623  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,623  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=2]. runningTasks=0. totalPendingTasks=2. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,623  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000078_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,624  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=3]. runningTasks=0. totalPendingTasks=3. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,624  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000079_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,624  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=4]. runningTasks=0. totalPendingTasks=4. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,624  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000080_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,624  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=5]. runningTasks=0. totalPendingTasks=5. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,624  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,624  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000076_0, priority=1, startTime=0, containerId=null, uniqueId=81, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:04,624  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000076_0; false
2024-04-23T14:44:04,624  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000076_0, true
2024-04-23T14:44:04,625  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,625  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000077_0, priority=1, startTime=0, containerId=null, uniqueId=82, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:04,625  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000077_0; false
2024-04-23T14:44:04,625  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000077_0, true
2024-04-23T14:44:04,626  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false} when looking for host2. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,626  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000079_0, priority=1, startTime=0, containerId=null, uniqueId=84, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=2, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:04,626  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000079_0; false
2024-04-23T14:44:04,626  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000079_0, true
2024-04-23T14:44:04,626  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for any host, from #hosts=1, requestedHosts=null
2024-04-23T14:44:04,627  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #4, task=TaskInfo{task=attempt_1_0001_0_00_000080_0, priority=1, startTime=0, containerId=null, uniqueId=85, localityDelayTimeout=9223372036854775807} on node={host2:0, id=host-host2, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000009
2024-04-23T14:44:04,627  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000080_0; false
2024-04-23T14:44:04,627  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000080_0, true
2024-04-23T14:44:04,627  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,629  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000076_0; false
2024-04-23T14:44:04,629  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000076_0, state=ASSIGNED, endReason=null
2024-04-23T14:44:04,630  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false} when looking for host1. local=true FirstRequestedHost=true, #prefLocations=1
2024-04-23T14:44:04,630  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #5, task=TaskInfo{task=attempt_1_0001_0_00_000078_0, priority=1, startTime=0, containerId=null, uniqueId=83, localityDelayTimeout=9223372036854775807} on node={host1:0, id=host-host1, canAcceptTask=true, st=1, ac=1, commF=false, disabled=false}, to container=container_11111_0001_01_000011
2024-04-23T14:44:04,630  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000078_0; false
2024-04-23T14:44:04,630  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000078_0, true
2024-04-23T14:44:04,630  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,631  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:04,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:04,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:04,633  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:04,633  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,633  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:04,633 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
2024-04-23T14:44:04,641  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Running with configuration: hosts=host1,host2,host3, numSchedulableTasksPerNode=0, nodeBlacklistConf=NodeBlacklistConf{minDelay=2000, maxDelay=10000, backoffFactor=1.5}, localityConf=LocalityDelayConf{nodeLocalityDelay=0} consistentSplits=true
2024-04-23T14:44:04,642  INFO [Time-limited test] impl.LlapRegistryService: Using LLAP registry type FixedRegistry hosts=host1,host2,host3
2024-04-23T14:44:04,643  WARN [Time-limited test] impl.LlapFixedRegistryImpl: Callbacks for instance state changes are not supported in fixed registry.
2024-04-23T14:44:04,643  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host1, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:04,643  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host1, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=1. activeInstances.size=3
2024-04-23T14:44:04,643  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,643  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host2, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:04,643  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host2, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=2. activeInstances.size=3
2024-04-23T14:44:04,643  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Setting up node: FixedServiceInstance{host=host3, memory=4096, vcores=4} with available capacity=4, pendingQueueSize=10, memory=4096
2024-04-23T14:44:04,644  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Adding new node: NodeInfo{instance=FixedServiceInstance{host=host3, memory=4096, vcores=4}, expireTimeMillis=-1, numSuccessfulTasks=0, numSuccessfulTasksAtLastBlacklist=-1, cumulativeBackoffFactor=1.0, numSchedulableTasks=14, numScheduledTasks=0, disabled=false, commFailures=false}. TotalNodeCount=3. activeInstances.size=3
2024-04-23T14:44:04,644  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,644  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775807); the delta to adjust by is 0
2024-04-23T14:44:04,644  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000081_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,644  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=0. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,644  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000082_0, priority=1, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,644  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:04,644  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #1, task=TaskInfo{task=attempt_1_0001_0_00_000081_0, priority=1, startTime=0, containerId=null, uniqueId=86, localityDelayTimeout=0} on node={host1:0, id=host-host1, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000003
2024-04-23T14:44:04,644  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000081_0; false
2024-04-23T14:44:04,644  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, true
2024-04-23T14:44:04,645  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,645  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=1,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,645  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:04,645  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #2, task=TaskInfo{task=attempt_1_0001_0_00_000082_0, priority=1, startTime=0, containerId=null, uniqueId=87, localityDelayTimeout=0} on node={host2:0, id=host-host2, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000005
2024-04-23T14:44:04,645  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000082_0; false
2024-04-23T14:44:04,645  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000082_0, true
2024-04-23T14:44:04,645  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,645  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775806); the delta to adjust by is 1
2024-04-23T14:44:04,645  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels
2024-04-23T14:44:04,645  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 2
2024-04-23T14:44:04,645  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000082_0 to update
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000082_0, false
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000082_0, true
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 1 levels; on failure
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 2
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 0 (internal version -9223372036854775805); the delta to adjust by is -1
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Revoking 1 from 1 levels
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Not adding attempt_1_0001_0_00_000081_0 to update - already pending
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0; revoked 1 / 1
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Sending updates to 0 tasks
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, false
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Unregistering attempt_1_0001_0_00_000082_0; false
2024-04-23T14:44:04,646  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Processing de-allocate request for task=attempt_1_0001_0_00_000082_0, state=ASSIGNED, endReason=CONTAINER_EXITED
2024-04-23T14:44:04,646  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: Received allocateRequest. task=attempt_1_0001_0_00_000083_0, priority=2, capability=<memory:1024, vCores:1>
2024-04-23T14:44:04,646  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PendingTasksInfo=numPriorityLevels=1. [p=2,c=1]. runningTasks=1. totalPendingTasks=1. delayedTaskQueueSize=0. highPriTaskQueueSize=0. preemptTaskQueueSize=0. pendingPreemptions=0
2024-04-23T14:44:04,646  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigning {host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false} when looking for any host, from #hosts=3, requestedHosts=null
2024-04-23T14:44:04,646  INFO [LlapScheduler] tezplugins.LlapTaskSchedulerService: Assigned #3, task=TaskInfo{task=attempt_1_0001_0_00_000083_0, priority=2, startTime=0, containerId=null, uniqueId=88, localityDelayTimeout=0} on node={host3:0, id=host-host3, canAcceptTask=true, st=0, ac=14, commF=false, disabled=false}, to container=container_11111_0001_01_000007
2024-04-23T14:44:04,646  INFO [LlapScheduler] GuaranteedTasks: Registering attempt_1_0001_0_00_000083_0; false
2024-04-23T14:44:04,646  INFO [LlapScheduler] GuaranteedTasks: Received response for attempt_1_0001_0_00_000083_0, true
2024-04-23T14:44:04,646  INFO [LlapScheduler] tezplugins.TestLlapTaskSchedulerService: Attempted schedulPendingTasks
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Received guaranteed tasks 1 (internal version -9223372036854775804); the delta to adjust by is 1
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Adding attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Distributed 1
2024-04-23T14:44:04,646  INFO [Time-limited test] GuaranteedTasks: Setting unused to 0 based on remaining delta 0
2024-04-23T14:44:04,647  INFO [Time-limited test] GuaranteedTasks: Sending updates to 1 tasks
2024-04-23T14:44:04,647  INFO [Time-limited test] GuaranteedTasks: Received response for attempt_1_0001_0_00_000081_0, false
2024-04-23T14:44:04,647  INFO [Time-limited test] GuaranteedTasks: Sending update to a different task in response handling attempt_1_0001_0_00_000081_0, true
2024-04-23T14:44:04,647  INFO [Time-limited test] GuaranteedTasks: Distributing 1 among 2 levels; on failure
2024-04-23T14:44:04,647  INFO [Time-limited test] GuaranteedTasks: At priority 1 observing 1
2024-04-23T14:44:04,647  INFO [Time-limited test] GuaranteedTasks: Adding failed attempt_1_0001_0_00_000081_0 to update
2024-04-23T14:44:04,647  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: NodeEnablerThread was cancelled
2024-04-23T14:44:04,647  INFO [LlapSchedulerNodeEnabler] tezplugins.LlapTaskSchedulerService: NodeEnabler thread interrupted after shutdown
2024-04-23T14:44:04,647  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: DelayedTaskSchedulerThread was cancelled
2024-04-23T14:44:04,647  INFO [LlapSchedulerDelayedTaskHandler] tezplugins.LlapTaskSchedulerService: DelayedTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,647  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: PreemptTaskSchedulerThread was cancelled
2024-04-23T14:44:04,647  INFO [LlapSchedulerPreemptTaskHandler] tezplugins.LlapTaskSchedulerService: PreemptTaskScheduler thread interrupted after shutdown
2024-04-23T14:44:04,647  INFO [Time-limited test] tezplugins.LlapTaskSchedulerService: SchedulerThread was cancelled
2024-04-23T14:44:04,647 ERROR [LlapScheduler] tezplugins.LlapTaskSchedulerService: Fatal error: scheduler thread has failed and will now exit
java.lang.RuntimeException: java.lang.InterruptedException
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2331) ~[test-classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2564) [classes/:?]
	at org.apache.hadoop.hive.llap.tezplugins.LlapTaskSchedulerService$SchedulerCallable.call(LlapTaskSchedulerService.java:2531) [classes/:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask$TrustedFutureInterruptibleTask.runInterruptibly(TrustedListenableFutureTask.java:108) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.InterruptibleTask.run(InterruptibleTask.java:41) [guava-19.0.jar:?]
	at com.google.common.util.concurrent.TrustedListenableFutureTask.run(TrustedListenableFutureTask.java:77) [guava-19.0.jar:?]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_402]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_402]
	at java.lang.Thread.run(Thread.java:750) [?:1.8.0_402]
Caused by: java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014) ~[?:1.8.0_402]
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.await(AbstractQueuedSynchronizer.java:2048) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.llap.tezplugins.TestLlapTaskSchedulerService$LlapTaskSchedulerServiceForTest.schedulePendingTasks(TestLlapTaskSchedulerService.java:2329) ~[test-classes/:?]
	... 8 more
