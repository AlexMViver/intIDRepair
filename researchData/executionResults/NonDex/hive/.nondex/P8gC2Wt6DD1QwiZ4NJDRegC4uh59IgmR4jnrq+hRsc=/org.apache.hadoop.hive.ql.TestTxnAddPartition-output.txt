SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/apache/logging/log4j/log4j-slf4j-impl/2.13.2/log4j-slf4j-impl-2.13.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/alex/.m2/repository/org/slf4j/slf4j-simple/1.7.27/slf4j-simple-1.7.27.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
DEBUG StatusLogger Using ShutdownCallbackRegistry class org.apache.logging.log4j.core.util.DefaultShutdownCallbackRegistry
DEBUG StatusLogger Took 0,073882 seconds to load 250 plugins from sun.misc.Launcher$AppClassLoader@330bedb4
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger Starting LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@35841320]...
DEBUG StatusLogger Reconfiguration started for context[name=330bedb4] at URI null (org.apache.logging.log4j.core.LoggerContext@35841320) with optional ClassLoader: null
DEBUG StatusLogger PluginManager 'ConfigurationFactory' found 6 plugins
DEBUG StatusLogger Using configurationFactory org.apache.logging.log4j.core.config.ConfigurationFactory$Factory@1807e3f6
DEBUG StatusLogger Apache Log4j Core 2.13.2 initializing configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1
DEBUG StatusLogger Installed 2 script engines
DEBUG StatusLogger Oracle Nashorn version: 1.8.0_402, language: ECMAScript, threading: Not Thread Safe, compile: true, names: [nashorn, Nashorn, js, JS, JavaScript, javascript, ECMAScript, ecmascript], factory class: jdk.nashorn.api.scripting.NashornScriptEngineFactory
DEBUG StatusLogger Groovy Scripting Engine version: 2.0, language: Groovy, threading: MULTITHREADED, compile: true, names: [groovy, Groovy], factory class: org.codehaus.groovy.jsr223.GroovyScriptEngineFactory
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/test-classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestLog4j2Appenders matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.TestSlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/ql/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.NullAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogInputFormat$Location matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogParser matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogStorageHandler matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.syslog.SyslogSerDe matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender$NameFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy$1 matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HiveEventCounter$EventCounts matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.LogDivertAppenderForTest$TestFilter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.SlidingFilenameRolloverStrategy matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PidFilePatternConverter matches criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.HushableRandomAccessFileAppender$1 matches criteria annotated with @Plugin
INFO StatusLogger Scanning for classes in '/home/alex/Repositories/hive/common/target/classes/org/apache/hadoop/hive/ql/log' matching criteria annotated with @Plugin
DEBUG StatusLogger Checking to see if class org.apache.hadoop.hive.ql.log.PerfLogger matches criteria annotated with @Plugin
DEBUG StatusLogger Took 0,018873 seconds to load 7 plugins from package org.apache.hadoop.hive.ql.log
DEBUG StatusLogger PluginManager 'Core' found 132 plugins
DEBUG StatusLogger PluginManager 'Level' found 0 plugins
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
TRACE StatusLogger TypeConverterRegistry initializing.
DEBUG StatusLogger PluginManager 'TypeConverter' found 26 plugins
DEBUG StatusLogger createProperty(name="hive.log.file", value="hive.log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.dir", value="/home/alex/Repositories/hive/ql/target/tmp/log")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.root.logger", value="DRFA")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.log.level", value="DEBUG")
DEBUG StatusLogger Building Plugin[name=property, class=org.apache.logging.log4j.core.config.Property].
DEBUG StatusLogger createProperty(name="hive.test.console.log.level", value="INFO")
DEBUG StatusLogger Building Plugin[name=properties, class=org.apache.logging.log4j.core.config.PropertiesPlugin].
DEBUG StatusLogger configureSubstitutor(={hive.log.file=hive.log, hive.log.dir=/home/alex/Repositories/hive/ql/target/tmp/log, hive.root.logger=DRFA, hive.log.level=DEBUG, hive.test.console.log.level=INFO}, Configuration(HiveLog4j2Test))
DEBUG StatusLogger PluginManager 'Lookup' found 17 plugins
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.ipc", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.security", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hdfs", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.hdfs.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.metrics2", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.mortbay", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.yarn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.hadoop.yarn.server", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.tez", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="org.apache.hadoop.conf.Configuration", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.zookeeper", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.ServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.server.NIOServerCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxn", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocket", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.zookeeper.ClientCnxnSocketNIO", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="DataNucleus", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="Datastore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="ERROR", name="JPOX", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.ql.exec.Operator", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.serde2.lazy", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.hadoop.hive.metastore.ObjectStore", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.calcite.plan.RelOptPlanner", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="com.amazonaws", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="INFO", name="org.apache.http", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.apache.thrift", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="org.eclipse.jetty", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="WARN", name="BlockStateChange", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=logger, class=org.apache.logging.log4j.core.config.LoggerConfig].
DEBUG StatusLogger createLogger(additivity="true", level="DEBUG", name="org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer", includeLocation="null", ={}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="DRFA", level="null", Filter=null)
DEBUG StatusLogger Building Plugin[name=AppenderRef, class=org.apache.logging.log4j.core.config.AppenderRef].
DEBUG StatusLogger createAppenderRef(ref="console", level="INFO", Filter=null)
DEBUG StatusLogger Building Plugin[name=root, class=org.apache.logging.log4j.core.config.LoggerConfig$RootLogger].
DEBUG StatusLogger createLogger(additivity="null", level="DEBUG", includeLocation="null", ={DRFA, console}, ={}, Configuration(HiveLog4j2Test), Filter=null)
DEBUG StatusLogger Building Plugin[name=loggers, class=org.apache.logging.log4j.core.config.LoggersPlugin].
DEBUG StatusLogger createLoggers(={org.apache.hadoop.ipc, org.apache.hadoop.security, org.apache.hadoop.hdfs, org.apache.hadoop.hdfs.server, org.apache.hadoop.metrics2, org.mortbay, org.apache.hadoop.yarn, org.apache.hadoop.yarn.server, org.apache.tez, org.apache.hadoop.conf.Configuration, org.apache.zookeeper, org.apache.zookeeper.server.ServerCnxn, org.apache.zookeeper.server.NIOServerCnxn, org.apache.zookeeper.ClientCnxn, org.apache.zookeeper.ClientCnxnSocket, org.apache.zookeeper.ClientCnxnSocketNIO, DataNucleus, Datastore, JPOX, org.apache.hadoop.hive.ql.exec.Operator, org.apache.hadoop.hive.serde2.lazy, org.apache.hadoop.hive.metastore.ObjectStore, org.apache.calcite.plan.RelOptPlanner, com.amazonaws, org.apache.http, org.apache.thrift, org.eclipse.jetty, BlockStateChange, org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer, root})
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(disableAnsi="null", Replace=null, Configuration(HiveLog4j2Test), footer="null", header="null", alwaysWriteExceptions="null", charset="null", PatternSelector=null, pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", noConsoleNoAnsi="null")
DEBUG StatusLogger PluginManager 'Converter' found 46 plugins
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.ConsoleAppender].
DEBUG StatusLogger ConsoleAppender$Builder(target="SYSTEM_ERR", direct="null", follow="null", immediateFlush="null", bufferedIo="null", bufferSize="null", ignoreExceptions="null", name="console", Configuration(HiveLog4j2Test), PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ={}, Filter=null)
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_ERR.false.false
DEBUG StatusLogger Building Plugin[name=layout, class=org.apache.logging.log4j.core.layout.PatternLayout].
DEBUG StatusLogger PatternLayout$Builder(alwaysWriteExceptions="null", disableAnsi="null", pattern="%d{ISO8601} %5p [%t] %c{2}: %m%n", charset="null", noConsoleNoAnsi="null", header="null", Replace=null, PatternSelector=null, footer="null", Configuration(HiveLog4j2Test))
DEBUG StatusLogger Building Plugin[name=TimeBasedTriggeringPolicy, class=org.apache.logging.log4j.core.appender.rolling.TimeBasedTriggeringPolicy].
DEBUG StatusLogger TimeBasedTriggeringPolicy$Builder(interval="1", modulate="true", maxRandomDelay="null")
DEBUG StatusLogger Building Plugin[name=Policies, class=org.apache.logging.log4j.core.appender.rolling.CompositeTriggeringPolicy].
DEBUG StatusLogger createPolicy(={TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)})
DEBUG StatusLogger Building Plugin[name=DefaultRolloverStrategy, class=org.apache.logging.log4j.core.appender.rolling.DefaultRolloverStrategy].
DEBUG StatusLogger DefaultRolloverStrategy$Builder(min="null", fileIndex="null", ={}, tempCompressedFilePattern="null", Configuration(HiveLog4j2Test), stopCustomActionsOnError="null", compressionLevel="null", max="30")
DEBUG StatusLogger Building Plugin[name=appender, class=org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender].
DEBUG StatusLogger RollingRandomAccessFileAppender$Builder(fileGroup="null", fileName="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log", filePattern="/home/alex/Repositories/hive/ql/target/tmp/log/hive.log.%d{yyyy-MM-dd}", DefaultRolloverStrategy(DefaultRolloverStrategy(min=1, max=30, useMax=true)), append="null", fileOwner="null", filePermissions="null", Policies(CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])), advertise="null", advertiseURI="null", bufferSize="null", immediateFlush="null", bufferedIo="null", Configuration(HiveLog4j2Test), name="DRFA", PatternLayout(%d{ISO8601} %5p [%t] %c{2}: %m%n), ignoreExceptions="null", ={}, Filter=null)
TRACE StatusLogger RandomAccessFile /home/alex/Repositories/hive/ql/target/tmp/log/hive.log seek to 2145160707
DEBUG StatusLogger Starting RollingRandomAccessFileManager /home/alex/Repositories/hive/ql/target/tmp/log/hive.log
DEBUG StatusLogger PluginManager 'FileConverter' found 3 plugins
DEBUG StatusLogger Setting prev file time to 2024-04-23T21:10:06.578-0700
DEBUG StatusLogger Initializing triggering policy CompositeTriggeringPolicy(policies=[TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)])
DEBUG StatusLogger Initializing triggering policy TimeBasedTriggeringPolicy(nextRolloverMillis=0, interval=1, modulate=true)
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=1969/12/31-16:00:00.000, current=2024/04/23-21:10:10.549, freq=DAILY
TRACE StatusLogger PatternProcessor.getNextTime returning 2024/04/24-00:00:00.000, nextFileTime=2024/04/23-00:00:00.000, prevFileTime=2024/04/23-00:00:00.000, current=2024/04/23-21:10:10.549, freq=DAILY
DEBUG StatusLogger Building Plugin[name=appenders, class=org.apache.logging.log4j.core.config.AppendersPlugin].
DEBUG StatusLogger createAppenders(={console, DRFA})
DEBUG StatusLogger Configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1 initialized
DEBUG StatusLogger Starting configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1
DEBUG StatusLogger Started configuration org.apache.logging.log4j.core.config.properties.PropertiesConfiguration@5c7bfdc1 OK.
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@2118cddf...
TRACE StatusLogger DefaultConfiguration notified 1 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger DefaultConfiguration stopping root LoggerConfig.
TRACE StatusLogger DefaultConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger DefaultConfiguration stopping remaining Appenders.
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.false.false-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.false.false-1, all resources released: true
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status true
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@2118cddf OK
TRACE StatusLogger Reregistering MBeans after reconfigure. Selector=org.apache.logging.log4j.core.selector.ClassLoaderContextSelector@25e2ab5a
TRACE StatusLogger Reregistering context (1/1): '330bedb4' org.apache.logging.log4j.core.LoggerContext@35841320
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=StatusLogger'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=ContextSelector'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncAppenders,name=*'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=AsyncLoggerRingBuffer'
TRACE StatusLogger Unregistering but no MBeans found matching 'org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=*,subtype=RingBuffer'
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=StatusLogger
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=ContextSelector
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.security
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=JPOX
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocketNIO
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=Datastore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.metastore.ObjectStore
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.NIOServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hdfs.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.serde2.lazy
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.exec.Operator
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.http
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.mortbay
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxnSocket
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.eclipse.jetty
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=BlockStateChange
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.hive.ql.optimizer.SharedWorkOptimizer
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=DataNucleus
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.calcite.plan.RelOptPlanner
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=com.amazonaws
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.thrift
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.metrics2
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.ClientCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.zookeeper.server.ServerCnxn
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.yarn.server
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.ipc
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.tez
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=org.apache.hadoop.conf.Configuration
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Loggers,name=
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=console
DEBUG StatusLogger Registering MBean org.apache.logging.log4j2:type=330bedb4,component=Appenders,name=DRFA
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
TRACE StatusLogger Using DummyNanoClock for nanosecond timestamps.
DEBUG StatusLogger Reconfiguration complete for context[name=330bedb4] at URI /home/alex/Repositories/hive/ql/target/testconf/hive-log4j2.properties (org.apache.logging.log4j.core.LoggerContext@35841320) with optional ClassLoader: null
DEBUG StatusLogger Shutdown hook enabled. Registering a new one.
DEBUG StatusLogger LoggerContext[name=330bedb4, org.apache.logging.log4j.core.LoggerContext@35841320] started OK.
2024-04-23T21:10:10,684  INFO [main] conf.HiveConf: Found configuration file file:/home/alex/Repositories/hive/ql/target/testconf/hive-site.xml
DEBUG StatusLogger AsyncLogger.ThreadNameStrategy=UNCACHED (user specified null, default is UNCACHED)
TRACE StatusLogger Using default SystemClock for timestamps.
DEBUG StatusLogger org.apache.logging.log4j.core.util.SystemClock does not support precise timestamps.
2024-04-23T21:10:11,031  WARN [main] util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2024-04-23T21:10:11,088  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:10:11,088  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:10:11,089  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:10:11,089  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:10:11,089  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:10:11,089  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:10:11,090  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:10:11,090  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:10:11,091  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:10:11,091  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:10:11,091  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:10:11,172  WARN [main] hikari.HikariConfig: HikariPool-1 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T21:10:11,180  INFO [main] hikari.HikariDataSource: HikariPool-1 - Starting...
2024-04-23T21:10:11,776  INFO [main] pool.PoolBase: HikariPool-1 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T21:10:11,779  INFO [main] hikari.HikariDataSource: HikariPool-1 - Start completed.
2024-04-23T21:10:11,781  WARN [main] hikari.HikariConfig: HikariPool-2 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T21:10:11,785  INFO [main] hikari.HikariDataSource: HikariPool-2 - Starting...
2024-04-23T21:10:11,789  INFO [main] pool.PoolBase: HikariPool-2 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T21:10:11,790  INFO [main] hikari.HikariDataSource: HikariPool-2 - Start completed.
2024-04-23T21:10:11,962  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
2024-04-23T21:10:11,969  INFO [main] utils.TestTxnDbUtil: Reinitializing the metastore db with hive-schema-4.0.0.derby.sql on the database jdbc:derby:memory:/home/alex/Repositories/hive/ql/target/tmp/junit_metastore_db;create=true
Hive Session ID = b53aa106-a8d7-4c38-a3b1-892d5f3e2227
2024-04-23T21:10:12,863  INFO [main] SessionState: Hive Session ID = b53aa106-a8d7-4c38-a3b1-892d5f3e2227
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:12,875  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
log4j: Trying to find [log4j.xml] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@706fe5c6.
log4j: Trying to find [log4j.xml] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.xml] using ClassLoader.getSystemResource().
log4j: Trying to find [log4j.properties] using context classloader org.apache.hadoop.hive.ql.exec.UDFClassLoader@706fe5c6.
log4j: Trying to find [log4j.properties] using sun.misc.Launcher$AppClassLoader@330bedb4 class loader.
log4j: Trying to find [log4j.properties] using ClassLoader.getSystemResource().
log4j: Could not find resource: [null].
log4j:WARN No appenders could be found for logger (org.apache.htrace.core.Tracer).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
2024-04-23T21:10:13,232  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b53aa106-a8d7-4c38-a3b1-892d5f3e2227
2024-04-23T21:10:13,236  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227
2024-04-23T21:10:13,240  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/_tmp_space.db
2024-04-23T21:10:13,274  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=b53aa106-a8d7-4c38-a3b1-892d5f3e2227, clientType=HIVECLI]
2024-04-23T21:10:13,308  INFO [main] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T21:10:13,434  INFO [main] metastore.HMSHandler: 0: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:10:13,466  INFO [main] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T21:10:13,470  INFO [main] metastore.PersistenceManagerProvider: Updating the pmf due to property change
2024-04-23T21:10:13,470  INFO [main] metastore.PersistenceManagerProvider: Current pmf properties are uninitialized
2024-04-23T21:10:13,474  WARN [main] hikari.HikariConfig: HikariPool-3 - leakDetectionThreshold is less than 2000ms or more than maxLifetime, disabling it.
2024-04-23T21:10:13,478  INFO [main] hikari.HikariDataSource: HikariPool-3 - Starting...
2024-04-23T21:10:13,480  INFO [main] pool.PoolBase: HikariPool-3 - Driver does not support get/set network timeout for connections. (Feature not implemented: No details.)
2024-04-23T21:10:13,481  INFO [main] hikari.HikariDataSource: HikariPool-3 - Start completed.
2024-04-23T21:10:13,892  INFO [main] metastore.PersistenceManagerProvider: Setting MetaStore object pin classes with hive.metastore.cache.pinobjtypes="Table,StorageDescriptor,SerDeInfo,Partition,Database,Type,FieldSchema,Order"
2024-04-23T21:10:13,892  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c479fdf, with PersistenceManager: null will be shutdown
2024-04-23T21:10:13,917  INFO [main] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c479fdf, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@2fe74516 created in the thread with id: 1
2024-04-23T21:10:16,288  INFO [main] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@6c479fdf from thread id: 1
2024-04-23T21:10:16,303  INFO [main] metastore.HMSHandler: Setting location of default catalog, as it hasn't been done after upgrade
2024-04-23T21:10:16,330  INFO [main] metastore.HMSHandler: Started creating a default database with name: default
2024-04-23T21:10:16,376  INFO [main] metastore.HMSHandler: Successfully created a default database with name: default
2024-04-23T21:10:16,404  INFO [main] metastore.HMSHandler: Added admin role in metastore
2024-04-23T21:10:16,409  INFO [main] metastore.HMSHandler: Added public role in metastore
2024-04-23T21:10:16,495  INFO [main] metastore.HMSHandler: Added hive_admin_user to admin role
2024-04-23T21:10:16,500  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ReplicationMetricsMaintTask service with frequency 86400000ms.
2024-04-23T21:10:16,501  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.events.EventCleanerTask service with frequency 0ms.
2024-04-23T21:10:16,502  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.ScheduledQueryExecutionsMaintTask service with frequency 60000ms.
2024-04-23T21:10:16,505  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.HiveProtoEventsCleanerTask service with frequency 86400000ms.
2024-04-23T21:10:16,506  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.RuntimeStatsCleanerTask service with frequency 3600000ms.
2024-04-23T21:10:16,510  INFO [main] metastore.HMSHandler: Scheduling for org.apache.hadoop.hive.metastore.metrics.AcidMetricService service with frequency 300000ms.
2024-04-23T21:10:16,514  INFO [main] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T21:10:16,636  INFO [main] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T21:10:16,680  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:16,710  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211016_0c9cfe60-90e6-45bd-8d54-2b9c5b6f84c9): drop table if exists acidTbl
2024-04-23T21:10:17,566  INFO [main] reflections.Reflections: Reflections took 192 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T21:10:17,722  INFO [main] reflections.Reflections: Reflections took 126 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T21:10:17,850  INFO [main] reflections.Reflections: Reflections took 122 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T21:10:17,880  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:10:17,893  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:10:17,904  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:18,058  INFO [main] reflections.Reflections: Reflections took 134 ms to scan 2 urls, producing 53 keys and 784 values 
2024-04-23T21:10:18,095  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,096  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,099  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,099  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=33, getValidTxns_(long)=7, flushCache_()=0}
2024-04-23T21:10:18,100  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211016_0c9cfe60-90e6-45bd-8d54-2b9c5b6f84c9); Time taken: 1.391 seconds
2024-04-23T21:10:18,102  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423211016_0c9cfe60-90e6-45bd-8d54-2b9c5b6f84c9
2024-04-23T21:10:18,103  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:18,105  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211016_0c9cfe60-90e6-45bd-8d54-2b9c5b6f84c9): drop table if exists acidTbl
2024-04-23T21:10:18,108  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,110  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:18,126  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:18,126  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:18,127  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211016_0c9cfe60-90e6-45bd-8d54-2b9c5b6f84c9); Time taken: 0.021 seconds
2024-04-23T21:10:18,127  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211016_0c9cfe60-90e6-45bd-8d54-2b9c5b6f84c9
2024-04-23T21:10:18,138  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:10:18,155  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:18,157  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:10:18,159  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:18,160  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211018_47205342-4c21-486a-b346-0bdaecc6cee2): drop table if exists acidTblPart
2024-04-23T21:10:18,165  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:10:18,166  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:10:18,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:18,174  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,174  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,174  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,175  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=31, openTxn_(String, TxnType)=5, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:10:18,175  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211018_47205342-4c21-486a-b346-0bdaecc6cee2); Time taken: 0.014 seconds
2024-04-23T21:10:18,175  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423211018_47205342-4c21-486a-b346-0bdaecc6cee2
2024-04-23T21:10:18,175  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:18,176  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211018_47205342-4c21-486a-b346-0bdaecc6cee2): drop table if exists acidTblPart
2024-04-23T21:10:18,176  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,177  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:18,181  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:18,181  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:18,181  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211018_47205342-4c21-486a-b346-0bdaecc6cee2); Time taken: 0.005 seconds
2024-04-23T21:10:18,182  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211018_47205342-4c21-486a-b346-0bdaecc6cee2
2024-04-23T21:10:18,189  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:10:18,198  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:18,198  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:10:18,200  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:18,201  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211018_2741ef19-1911-4aba-9d17-fad5001e1cfa): drop table if exists acidTbl2
2024-04-23T21:10:18,207  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:10:18,208  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:10:18,210  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:18,215  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,215  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,215  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,215  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=5, getValidTxns_(long)=1, flushCache_()=1}
2024-04-23T21:10:18,215  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211018_2741ef19-1911-4aba-9d17-fad5001e1cfa); Time taken: 0.014 seconds
2024-04-23T21:10:18,216  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423211018_2741ef19-1911-4aba-9d17-fad5001e1cfa
2024-04-23T21:10:18,216  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:18,216  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211018_2741ef19-1911-4aba-9d17-fad5001e1cfa): drop table if exists acidTbl2
2024-04-23T21:10:18,216  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:18,221  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:18,221  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:18,222  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211018_2741ef19-1911-4aba-9d17-fad5001e1cfa); Time taken: 0.005 seconds
2024-04-23T21:10:18,222  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211018_2741ef19-1911-4aba-9d17-fad5001e1cfa
2024-04-23T21:10:18,230  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:10:18,239  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:18,239  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:10:18,240  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:18,241  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211018_783685dc-bb16-49f6-bf20-ac1b13950108): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:18,246  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:10:18,247  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:10:18,249  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:18,254  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,254  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,255  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,255  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=18, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=4}
2024-04-23T21:10:18,255  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211018_783685dc-bb16-49f6-bf20-ac1b13950108); Time taken: 0.014 seconds
2024-04-23T21:10:18,256  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423211018_783685dc-bb16-49f6-bf20-ac1b13950108
2024-04-23T21:10:18,256  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:18,256  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211018_783685dc-bb16-49f6-bf20-ac1b13950108): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:18,256  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,257  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:18,263  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:18,263  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:18,263  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211018_783685dc-bb16-49f6-bf20-ac1b13950108); Time taken: 0.007 seconds
2024-04-23T21:10:18,263  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211018_783685dc-bb16-49f6-bf20-ac1b13950108
2024-04-23T21:10:18,272  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:10:18,284  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:18,284  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:10:18,286  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:18,287  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211018_c8f89cc3-6a4f-4117-9212-3f9940c2f828): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:18,291  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:10:18,291  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:10:18,293  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:18,297  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,297  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,297  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,297  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=21, flushCache_()=0, isCompatibleWith_(Configuration)=3, openTxn_(String, TxnType)=3}
2024-04-23T21:10:18,298  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211018_c8f89cc3-6a4f-4117-9212-3f9940c2f828); Time taken: 0.01 seconds
2024-04-23T21:10:18,298  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423211018_c8f89cc3-6a4f-4117-9212-3f9940c2f828
2024-04-23T21:10:18,298  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:18,298  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211018_c8f89cc3-6a4f-4117-9212-3f9940c2f828): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:18,298  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:18,303  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:18,303  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:18,304  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211018_c8f89cc3-6a4f-4117-9212-3f9940c2f828); Time taken: 0.005 seconds
2024-04-23T21:10:18,304  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211018_c8f89cc3-6a4f-4117-9212-3f9940c2f828
2024-04-23T21:10:18,314  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:10:18,326  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:18,327  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:10:18,328  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:18,329  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211018_827f5fe9-7c80-45ff-85dd-1d0a57de758d): drop table if exists nonAcidNonBucket
2024-04-23T21:10:18,334  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:10:18,335  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:10:18,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:18,343  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,343  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,343  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,344  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=23, openTxn_(String, TxnType)=5, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T21:10:18,344  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211018_827f5fe9-7c80-45ff-85dd-1d0a57de758d); Time taken: 0.014 seconds
2024-04-23T21:10:18,344  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423211018_827f5fe9-7c80-45ff-85dd-1d0a57de758d
2024-04-23T21:10:18,345  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:18,345  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211018_827f5fe9-7c80-45ff-85dd-1d0a57de758d): drop table if exists nonAcidNonBucket
2024-04-23T21:10:18,345  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:18,353  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:18,353  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:18,353  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211018_827f5fe9-7c80-45ff-85dd-1d0a57de758d); Time taken: 0.008 seconds
2024-04-23T21:10:18,353  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211018_827f5fe9-7c80-45ff-85dd-1d0a57de758d
2024-04-23T21:10:18,364  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:10:18,373  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:18,374  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:10:18,375  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:18,375  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211018_a84cbe40-62b2-4716-8bae-bdb77cb0fbc6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:18,446  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:10:18,446  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:10:18,447  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:18,450  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:18,467  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:10:18,510  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:18,521  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:18,521  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,521  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,521  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,521  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=5, getValidTxns_(long)=1, flushCache_()=0, getValidWriteIds_(List, String)=11, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=20, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:18,522  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211018_a84cbe40-62b2-4716-8bae-bdb77cb0fbc6); Time taken: 0.146 seconds
2024-04-23T21:10:18,522  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423211018_a84cbe40-62b2-4716-8bae-bdb77cb0fbc6
2024-04-23T21:10:18,529  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211018_a84cbe40-62b2-4716-8bae-bdb77cb0fbc6
2024-04-23T21:10:18,592  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211018_a84cbe40-62b2-4716-8bae-bdb77cb0fbc6 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:10:18,593  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:18,596  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211018_a84cbe40-62b2-4716-8bae-bdb77cb0fbc6): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:18,597  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,717  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931818, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0, numFiles=0, numRows=0, bucketing_version=2, totalSize=0, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:18,729  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtbl
2024-04-23T21:10:18,839  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:18,839  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=122}
2024-04-23T21:10:18,839  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211018_a84cbe40-62b2-4716-8bae-bdb77cb0fbc6); Time taken: 0.243 seconds
2024-04-23T21:10:18,840  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211018_a84cbe40-62b2-4716-8bae-bdb77cb0fbc6
2024-04-23T21:10:18,845  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:10:18,855  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:18,855  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:10:18,856  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:18,856  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211018_d4390c53-2fbc-4085-8f77-2c940c1e4b2c): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:18,861  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:10:18,862  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:10:18,863  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:18,863  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:18,867  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:10:18,867  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:18,870  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:18,870  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,870  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,870  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,871  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=16, getDatabase_(String)=3, getValidTxns_(long)=1}
2024-04-23T21:10:18,871  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211018_d4390c53-2fbc-4085-8f77-2c940c1e4b2c); Time taken: 0.014 seconds
2024-04-23T21:10:18,871  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423211018_d4390c53-2fbc-4085-8f77-2c940c1e4b2c
2024-04-23T21:10:18,872  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211018_d4390c53-2fbc-4085-8f77-2c940c1e4b2c
2024-04-23T21:10:18,898  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211018_d4390c53-2fbc-4085-8f77-2c940c1e4b2c LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:10:18,898  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:18,899  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211018_d4390c53-2fbc-4085-8f77-2c940c1e4b2c): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:18,899  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,901  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931818, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:18,910  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtblpart
2024-04-23T21:10:18,937  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:18,937  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=36}
2024-04-23T21:10:18,937  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211018_d4390c53-2fbc-4085-8f77-2c940c1e4b2c); Time taken: 0.038 seconds
2024-04-23T21:10:18,937  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211018_d4390c53-2fbc-4085-8f77-2c940c1e4b2c
2024-04-23T21:10:18,943  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:10:18,952  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:18,954  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:10:18,955  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:18,956  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211018_b65beefe-d139-413d-bbb8-9c831d272b60): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:18,960  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 2
2024-04-23T21:10:18,960  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:10:18,962  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:18,962  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:18,966  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:10:18,966  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:18,969  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:18,969  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:18,969  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:18,969  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:18,969  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, getDatabase_(String)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=18}
2024-04-23T21:10:18,969  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211018_b65beefe-d139-413d-bbb8-9c831d272b60); Time taken: 0.013 seconds
2024-04-23T21:10:18,970  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423211018_b65beefe-d139-413d-bbb8-9c831d272b60
2024-04-23T21:10:18,970  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211018_b65beefe-d139-413d-bbb8-9c831d272b60
2024-04-23T21:10:18,995  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211018_b65beefe-d139-413d-bbb8-9c831d272b60 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:10:18,995  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:18,996  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211018_b65beefe-d139-413d-bbb8-9c831d272b60): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:18,996  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:18,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931818, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, transactional=false, bucketing_version=2, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:19,005  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl
2024-04-23T21:10:19,044  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:19,045  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=47, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:19,045  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211018_b65beefe-d139-413d-bbb8-9c831d272b60); Time taken: 0.049 seconds
2024-04-23T21:10:19,045  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211018_b65beefe-d139-413d-bbb8-9c831d272b60
2024-04-23T21:10:19,052  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:10:19,063  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:19,064  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:10:19,065  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:19,065  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211019_20be939f-f56b-4502-831f-e59a4525be8a): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:19,070  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 2
2024-04-23T21:10:19,070  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:10:19,071  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:19,071  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:19,075  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:10:19,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:19,078  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:19,078  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:19,078  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:19,078  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:19,078  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=18, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, flushCache_()=0}
2024-04-23T21:10:19,078  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211019_20be939f-f56b-4502-831f-e59a4525be8a); Time taken: 0.013 seconds
2024-04-23T21:10:19,079  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423211019_20be939f-f56b-4502-831f-e59a4525be8a
2024-04-23T21:10:19,079  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211019_20be939f-f56b-4502-831f-e59a4525be8a
2024-04-23T21:10:19,109  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211019_20be939f-f56b-4502-831f-e59a4525be8a LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:10:19,110  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:19,110  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211019_20be939f-f56b-4502-831f-e59a4525be8a): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:19,110  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:19,112  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931819, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numFiles=0, totalSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:19,123  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl2
2024-04-23T21:10:19,154  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:19,154  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=42, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:19,155  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211019_20be939f-f56b-4502-831f-e59a4525be8a); Time taken: 0.044 seconds
2024-04-23T21:10:19,155  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211019_20be939f-f56b-4502-831f-e59a4525be8a
2024-04-23T21:10:19,160  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:10:19,169  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:19,169  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:10:19,170  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:19,171  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211019_1bd4e5f7-a679-4de0-9e13-67dc7bd2dc51): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:19,177  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 3
2024-04-23T21:10:19,177  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:10:19,179  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:19,179  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:19,183  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:10:19,184  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:19,186  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:19,186  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:19,186  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:19,186  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:19,186  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=4, flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:19,187  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211019_1bd4e5f7-a679-4de0-9e13-67dc7bd2dc51); Time taken: 0.015 seconds
2024-04-23T21:10:19,187  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423211019_1bd4e5f7-a679-4de0-9e13-67dc7bd2dc51
2024-04-23T21:10:19,187  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211019_1bd4e5f7-a679-4de0-9e13-67dc7bd2dc51
2024-04-23T21:10:19,214  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211019_1bd4e5f7-a679-4de0-9e13-67dc7bd2dc51 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:10:19,214  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:19,215  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211019_1bd4e5f7-a679-4de0-9e13-67dc7bd2dc51): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:19,216  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:19,218  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/_tmp_space.db/d976e59a-ef84-45e3-b681-c36db7448f06
2024-04-23T21:10:19,222  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:19,222  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=4, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:19,222  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211019_1bd4e5f7-a679-4de0-9e13-67dc7bd2dc51); Time taken: 0.007 seconds
2024-04-23T21:10:19,222  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211019_1bd4e5f7-a679-4de0-9e13-67dc7bd2dc51
2024-04-23T21:10:19,228  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:10:19,236  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:19,237  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:10:19,238  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:19,238  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211019_33fa9368-8c32-4836-a9fb-60cbd276c16f): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:19,242  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 4
2024-04-23T21:10:19,243  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:10:19,244  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:19,244  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:19,247  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:10:19,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:19,250  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:19,250  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:19,250  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:19,250  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:19,250  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1, getDatabase_(String)=3, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:19,250  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211019_33fa9368-8c32-4836-a9fb-60cbd276c16f); Time taken: 0.012 seconds
2024-04-23T21:10:19,251  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423211019_33fa9368-8c32-4836-a9fb-60cbd276c16f
2024-04-23T21:10:19,251  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211019_33fa9368-8c32-4836-a9fb-60cbd276c16f
2024-04-23T21:10:19,273  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211019_33fa9368-8c32-4836-a9fb-60cbd276c16f LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:10:19,273  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:19,274  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211019_33fa9368-8c32-4836-a9fb-60cbd276c16f): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:19,274  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:19,277  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931819, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, numFiles=0, totalSize=0, numFilesErasureCoded=0, bucketing_version=2, transactional=false, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:19,290  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidnonbucket
2024-04-23T21:10:19,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:19,315  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=39, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:19,316  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211019_33fa9368-8c32-4836-a9fb-60cbd276c16f); Time taken: 0.041 seconds
2024-04-23T21:10:19,316  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211019_33fa9368-8c32-4836-a9fb-60cbd276c16f
2024-04-23T21:10:19,321  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:10:19,329  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:19,329  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:10:19,330  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Initializing local cache in HiveMetaStoreClient...
2024-04-23T21:10:19,356  INFO [main] metastore.HiveMetaStoreClientWithLocalCache: Local cache initialized in HiveMetaStoreClient: com.github.benmanes.caffeine.cache.BoundedLocalCache$BoundedLocalManualCache@129b69b2
2024-04-23T21:10:19,356  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:10:19,357  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211019_c5561aca-a8e7-445a-9135-07485136d2e5): drop table if exists T
2024-04-23T21:10:19,361  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 7
2024-04-23T21:10:19,362  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:10:19,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:19,368  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:19,368  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:19,368  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:19,368  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=4, getValidTxns_(long)=1}
2024-04-23T21:10:19,369  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211019_c5561aca-a8e7-445a-9135-07485136d2e5); Time taken: 0.011 seconds
2024-04-23T21:10:19,369  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423211019_c5561aca-a8e7-445a-9135-07485136d2e5
2024-04-23T21:10:19,369  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:19,370  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211019_c5561aca-a8e7-445a-9135-07485136d2e5): drop table if exists T
2024-04-23T21:10:19,370  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:19,370  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:19,374  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:19,374  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:19,375  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211019_c5561aca-a8e7-445a-9135-07485136d2e5); Time taken: 0.005 seconds
2024-04-23T21:10:19,375  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211019_c5561aca-a8e7-445a-9135-07485136d2e5
2024-04-23T21:10:19,382  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:10:19,389  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:19,390  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:10:19,391  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T21:10:19,391  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211019_f99f02fb-67fe-4f97-85c6-4c599cefbd56): drop table if exists Tstage
2024-04-23T21:10:19,395  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 7
2024-04-23T21:10:19,395  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:10:19,397  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:19,401  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:19,401  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:19,401  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:19,401  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=3}
2024-04-23T21:10:19,402  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211019_f99f02fb-67fe-4f97-85c6-4c599cefbd56); Time taken: 0.01 seconds
2024-04-23T21:10:19,402  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423211019_f99f02fb-67fe-4f97-85c6-4c599cefbd56
2024-04-23T21:10:19,402  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:19,402  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211019_f99f02fb-67fe-4f97-85c6-4c599cefbd56): drop table if exists Tstage
2024-04-23T21:10:19,402  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:19,403  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:19,408  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:19,408  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:19,408  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211019_f99f02fb-67fe-4f97-85c6-4c599cefbd56); Time taken: 0.006 seconds
2024-04-23T21:10:19,408  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211019_f99f02fb-67fe-4f97-85c6-4c599cefbd56
2024-04-23T21:10:19,415  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:10:19,424  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:19,424  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:10:19,425  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T21:10:19,426  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211019_e2c21231-ed97-430b-b8f1-0202fb7a05d6): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T21:10:19,431  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 7
2024-04-23T21:10:19,431  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:10:19,433  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:19,433  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:19,438  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:10:19,438  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:19,442  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:19,442  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:19,442  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:19,442  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:19,443  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, getValidTxns_(long)=1, flushCache_()=0, getDatabase_(String)=4, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=16}
2024-04-23T21:10:19,443  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211019_e2c21231-ed97-430b-b8f1-0202fb7a05d6); Time taken: 0.016 seconds
2024-04-23T21:10:19,443  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423211019_e2c21231-ed97-430b-b8f1-0202fb7a05d6
2024-04-23T21:10:19,444  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211019_e2c21231-ed97-430b-b8f1-0202fb7a05d6
2024-04-23T21:10:19,482  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211019_e2c21231-ed97-430b-b8f1-0202fb7a05d6 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:10:19,482  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:19,484  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211019_e2c21231-ed97-430b-b8f1-0202fb7a05d6): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T21:10:19,484  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:19,486  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931819, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true, transactional_properties=insert_only}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:19,500  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:19,534  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:19,534  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=48, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:19,534  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211019_e2c21231-ed97-430b-b8f1-0202fb7a05d6); Time taken: 0.05 seconds
2024-04-23T21:10:19,535  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211019_e2c21231-ed97-430b-b8f1-0202fb7a05d6
2024-04-23T21:10:19,540  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:10:19,549  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:19,549  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:10:19,550  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:19,551  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211019_76bcde0f-21da-4d2a-8acf-7197c93f09bb): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:19,557  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-23T21:10:19,558  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:10:19,560  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:19,560  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:19,564  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T21:10:19,564  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:19,567  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:19,567  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:19,567  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:19,568  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:19,568  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=5, flushCache_()=1, isCompatibleWith_(Configuration)=0, getDatabase_(String)=3, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=2}
2024-04-23T21:10:19,568  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211019_76bcde0f-21da-4d2a-8acf-7197c93f09bb); Time taken: 0.017 seconds
2024-04-23T21:10:19,569  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423211019_76bcde0f-21da-4d2a-8acf-7197c93f09bb
2024-04-23T21:10:19,569  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211019_76bcde0f-21da-4d2a-8acf-7197c93f09bb
2024-04-23T21:10:19,590  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211019_76bcde0f-21da-4d2a-8acf-7197c93f09bb LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:10:19,590  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:19,591  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211019_76bcde0f-21da-4d2a-8acf-7197c93f09bb): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:19,591  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:19,592  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713931819, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, totalSize=0, numFilesErasureCoded=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:19,600  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:19,632  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:19,633  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=40}
2024-04-23T21:10:19,633  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211019_76bcde0f-21da-4d2a-8acf-7197c93f09bb); Time taken: 0.041 seconds
2024-04-23T21:10:19,633  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211019_76bcde0f-21da-4d2a-8acf-7197c93f09bb
2024-04-23T21:10:19,641  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:10:19,651  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:19,652  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:10:19,653  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:19,653  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66): insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:19,661  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 8
2024-04-23T21:10:19,661  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:10:19,663  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:19,663  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:20,282  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.cpc.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:10:20,288  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.hll.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:10:20,291  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.ExcludeSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:10:20,292  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.EstimateSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:10:20,292  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.IntersectSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:10:20,292  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.theta.UnionSketchUDF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:10:20,293  WARN [main] exec.FunctionRegistry: UDF Class org.apache.datasketches.hive.tuple.ArrayOfDoublesSketchToValuesUDTF does not have description. Please annotate the class with the org.apache.hadoop.hive.ql.exec.Description annotation and provide the description of the function.
2024-04-23T21:10:20,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:20,421  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:20,422  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:20,422  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:20,422  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:20,422  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:20,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:20,441  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:20,442  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:20,442  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:10:21,587  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:22,259  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:22,259  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:22,260  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:22,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:22,266  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:22,266  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:22,268  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:22,268  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:22,284  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:22,315  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1
2024-04-23T21:10:22,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:22,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:22,330  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:22,384  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:22,395  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:22,422  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:22,438  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:22,444  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T21:10:22,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:22,463  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:22,495  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:22,501  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:10:22,501  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:22,501  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:22,501  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:22,501  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:10:22,501  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:10:22,504  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:22,504  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:22,504  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:22,504  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:10:22,504  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:22,504  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=19, getNotNullConstraints_(NotNullConstraintsRequest)=3, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=3, getAllTableConstraints_(AllTableConstraintsRequest)=61, getValidWriteIds_(List, String)=7, getTable_(GetTableRequest)=145}
2024-04-23T21:10:22,504  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66); Time taken: 2.851 seconds
2024-04-23T21:10:22,505  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66
2024-04-23T21:10:22,505  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66
2024-04-23T21:10:22,529  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:10:22,529  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:22,529  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66): insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:22,530  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66
2024-04-23T21:10:22,530  INFO [main] ql.Driver: Query ID = alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66
Total jobs = 1
2024-04-23T21:10:22,530  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:22,530  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:22,678  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:10:22,678  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:10:22,686  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:22,689  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:10:22,689  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-19_653_7515408958213082554-1/dummy_path
2024-04-23T21:10:22,756  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:22,779  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,09KB
2024-04-23T21:10:22,885  INFO [main] beanutils.FluentPropertyBeanIntrospector: Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2024-04-23T21:10:22,899  WARN [main] impl.MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-jobtracker.properties,hadoop-metrics2.properties
2024-04-23T21:10:22,914  INFO [main] impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-04-23T21:10:22,914  INFO [main] impl.MetricsSystemImpl: JobTracker metrics system started
2024-04-23T21:10:22,926  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-19_653_7515408958213082554-1/-mr-10001
2024-04-23T21:10:22,943  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:22,984  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:22,991  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:22,997  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:10:22,997  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:10:22,997  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-19_653_7515408958213082554-1/dummy_path
2024-04-23T21:10:22,997  INFO [main] io.NullRowsInputFormat$NullRowsRecordReader: Using null rows input format
2024-04-23T21:10:23,002  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:10:23,031  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:10:23,102  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local676493733_0001
2024-04-23T21:10:23,102  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:23,256  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:23,258  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:23,258  INFO [Thread-78] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:23,260  INFO [Thread-78] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:23,273  INFO [Thread-78] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:23,276  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local676493733_0001_m_000000_0
2024-04-23T21:10:23,309  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:23,317  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-19_653_7515408958213082554-1/dummy_path/null:0+1
2024-04-23T21:10:23,324  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:23,349  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,09KB
2024-04-23T21:10:23,357  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:10:23,365  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:23,367  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:23,370  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:23,370  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:23,372  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:10:23,373  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:10:23,373  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:23,373  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:10:23,374  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:23,374  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local676493733_0001/job_local676493733_0001.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@4800bb27
2024-04-23T21:10:23,380  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:23,380  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:23,380  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:23,396  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:23,410  INFO [LocalJobRunner Map Task Executor #0] impl.HadoopShimsPre2_7: Can't get KeyProvider for ORC encryption from hadoop.security.key.provider.path.
2024-04-23T21:10:23,415  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:10:23,465  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:10:23,470  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:23,470  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:23,471  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:10:23,471  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:10:23,471  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:23,471  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:10:23,471  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:23,472  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:23,472  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:10:23,472  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:10:23,472  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:23,472  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:23,472  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:23,472  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:10:23,515  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_1_default.tstage:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:2, 
2024-04-23T21:10:23,518  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:23,527  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local676493733_0001_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:23,529  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:10:23,529  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local676493733_0001_m_000000_0' done.
2024-04-23T21:10:23,531  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local676493733_0001_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=6553
		FILE: Number of bytes written=1178228
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=919076864
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6148
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:23,532  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local676493733_0001_m_000000_0
2024-04-23T21:10:23,533  INFO [Thread-78] mapred.LocalJobRunner: map task executor complete.
2024-04-23 21:10:24,281 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:10:24,282  INFO [main] exec.Task: 2024-04-23 21:10:24,281 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local676493733_0001
2024-04-23T21:10:24,285  INFO [main] exec.Task: Ended Job = job_local676493733_0001
2024-04-23T21:10:24,320  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T21:10:24,321  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T21:10:24,321  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T21:10:24,322  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T21:10:24,322  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/-ext-10000
2024-04-23T21:10:24,323  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/-ext-10002
2024-04-23T21:10:24,328  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T21:10:24,329  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1/-ext-10000
2024-04-23T21:10:24,329  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:24,342  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,343  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:24,355  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,361  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:24,361  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:24,414  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:10:24,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:24,428  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,428  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:10:24,429  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-19_653_7515408958213082554-1/-mr-10001
2024-04-23T21:10:24,432  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:24,448  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,451  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T21:10:24,452  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T21:10:24,453  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:24,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:24,495  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T21:10:24,496  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:24,496  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=56, isCompatibleWith_(Configuration)=1, alter_table_(String, String, String, Table, EnvironmentContext, String)=93}
MapReduce Jobs Launched: 
2024-04-23T21:10:24,497  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:24,503  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:24,503  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:24,503  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66); Time taken: 1.967 seconds
2024-04-23T21:10:24,503  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211019_0cc0b497-0f33-478b-8474-c646374dab66
2024-04-23T21:10:24,508  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:10:24,515  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:24,516  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:10:24,516  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:24,517  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1
2024-04-23T21:10:24,517  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-19_653_7515408958213082554-1 on fs with scheme file
2024-04-23T21:10:24,518  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-19_653_7515408958213082554-1
2024-04-23T21:10:24,518  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-19_653_7515408958213082554-1 on fs with scheme file
2024-04-23T21:10:24,519  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211024_187f52f7-30a6-4d55-948f-2418938f77b3): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:24,521  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:24,533  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,537  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:10:24,538  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:10:24,546  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:24,558  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,561  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:24,561  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:24,562  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:24,562  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:24,565  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:24,565  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:24,565  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:24,566  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCurrentNotificationEventId_()=5, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=26, openTxn_(String, TxnType)=4}
2024-04-23T21:10:24,566  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211024_187f52f7-30a6-4d55-948f-2418938f77b3); Time taken: 0.046 seconds
2024-04-23T21:10:24,566  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423211024_187f52f7-30a6-4d55-948f-2418938f77b3
2024-04-23T21:10:24,567  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211024_187f52f7-30a6-4d55-948f-2418938f77b3
2024-04-23T21:10:24,592  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211024_187f52f7-30a6-4d55-948f-2418938f77b3 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:10:24,592  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:24,592  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211024_187f52f7-30a6-4d55-948f-2418938f77b3): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:24,593  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:24,593  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:24,593  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:24,593  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:24,593  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:24,632  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:24,638  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:24,639  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:24,639  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211024_187f52f7-30a6-4d55-948f-2418938f77b3); Time taken: 0.046 seconds
2024-04-23T21:10:24,639  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211024_187f52f7-30a6-4d55-948f-2418938f77b3
2024-04-23T21:10:24,645  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:10:24,653  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:24,653  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:10:24,654  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:24,655  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211024_c31ba822-8a2e-4b04-8560-0444e6f0508c): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:24,656  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:24,679  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,684  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:10:24,684  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:10:24,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:24,705  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,706  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:24,706  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:24,706  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:24,706  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:24,706  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:24,706  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:24,706  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:24,706  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, flushCache_()=0, openTxn_(String, TxnType)=4, getCurrentNotificationEventId_()=1, getTable_(GetTableRequest)=41, commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:24,707  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211024_c31ba822-8a2e-4b04-8560-0444e6f0508c); Time taken: 0.051 seconds
2024-04-23T21:10:24,707  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423211024_c31ba822-8a2e-4b04-8560-0444e6f0508c
2024-04-23T21:10:24,708  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211024_c31ba822-8a2e-4b04-8560-0444e6f0508c
2024-04-23T21:10:24,732  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211024_c31ba822-8a2e-4b04-8560-0444e6f0508c LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:10:24,732  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:24,732  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211024_c31ba822-8a2e-4b04-8560-0444e6f0508c): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:24,732  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:24,732  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:24,732  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:24,733  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:24,733  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:24,745  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:24,752  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:24,752  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:24,752  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211024_c31ba822-8a2e-4b04-8560-0444e6f0508c); Time taken: 0.02 seconds
2024-04-23T21:10:24,752  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211024_c31ba822-8a2e-4b04-8560-0444e6f0508c
2024-04-23T21:10:24,757  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:10:24,767  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:24,768  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:10:24,769  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:24,770  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211024_3cb69e73-4e0c-4f64-abe5-60a5daa6ce0f): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:24,776  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:10:24,777  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:10:24,779  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:24,792  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,822  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T21:10:24,822  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-23T21:10:24,826  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:24,826  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:24,827  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:24,827  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=14, allocateTableWriteId_(long, String, String)=11, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=17}
2024-04-23T21:10:24,827  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211024_3cb69e73-4e0c-4f64-abe5-60a5daa6ce0f); Time taken: 0.057 seconds
2024-04-23T21:10:24,827  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423211024_3cb69e73-4e0c-4f64-abe5-60a5daa6ce0f
2024-04-23T21:10:24,828  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211024_3cb69e73-4e0c-4f64-abe5-60a5daa6ce0f
2024-04-23T21:10:24,850  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211024_3cb69e73-4e0c-4f64-abe5-60a5daa6ce0f LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:10:24,850  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:24,856  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211024_3cb69e73-4e0c-4f64-abe5-60a5daa6ce0f): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:24,857  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:24,857  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:24,872  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:24,904  INFO [HMSHandler #2] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2
2024-04-23T21:10:24,904  INFO [HMSHandler #1] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1
2024-04-23T21:10:24,904  INFO [HMSHandler #0] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:24,970  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T21:10:24,970  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data
2024-04-23T21:10:24,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:24,985  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:24,987  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:25,013  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T21:10:25,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:25,014  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:25,030  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:25,031  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:25,047  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T21:10:25,053  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:25,053  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T21:10:25,120  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:25,165  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:25,182  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-23T21:10:25,182  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data
2024-04-23T21:10:25,182  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:25,197  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:25,199  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:25,217  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T21:10:25,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:25,217  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:25,231  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:25,231  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:25,249  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-23T21:10:25,255  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:25,255  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T21:10:25,304  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:25,328  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:25,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:25,361  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=126, validatePartitionNameCharacters_(List)=0, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=186, getValidWriteIds_(List, String)=1, getTable_(GetTableRequest)=74, add_partitions_(List, boolean, boolean)=97, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:25,362  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211024_3cb69e73-4e0c-4f64-abe5-60a5daa6ce0f); Time taken: 0.505 seconds
2024-04-23T21:10:25,362  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211024_3cb69e73-4e0c-4f64-abe5-60a5daa6ce0f
2024-04-23T21:10:25,367  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:10:25,375  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:25,375  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:10:25,376  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b from T order by p, a, b
2024-04-23T21:10:25,377  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149): select p, a, b from T order by p, a, b
2024-04-23T21:10:25,383  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T21:10:25,384  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:10:25,385  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:25,386  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:25,394  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:25,394  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:25,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:25,410  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:25,411  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:25,411  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:25,411  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:25,427  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:25,615  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:25,615  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:25,686  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:25,702  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:25,703  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:25,737  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:25,737  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:25,797  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:25,797  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:25,797  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:25,804  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-25_377_7565093623055308195-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-25_377_7565093623055308195-1
2024-04-23T21:10:25,838  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:25,846  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:10:25,846  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:10:25,847  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:25,857  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:25,870  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:25,872  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:25,872  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:25,893  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:25,893  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:10:25,893  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:25,893  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:25,893  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:25,893  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:25,894  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:25,894  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:25,894  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:25,894  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:25,894  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:25,894  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:25,894  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:25,894  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:10:25,899  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:10:25,901  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:25,901  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=8, flushCache_()=0, listPartitions_(String, String, short)=48, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14, getAllTableConstraints_(AllTableConstraintsRequest)=42, getAggrColStatsFor_(String, String, List, List, String, String)=49, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=16}
2024-04-23T21:10:25,901  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149); Time taken: 0.524 seconds
2024-04-23T21:10:25,901  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149
2024-04-23T21:10:25,903  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149
2024-04-23T21:10:25,937  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:10:25,937  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:25,939  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149): select p, a, b from T order by p, a, b
2024-04-23T21:10:25,939  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149
2024-04-23T21:10:25,939  INFO [main] ql.Driver: Query ID = alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149
Total jobs = 1
2024-04-23T21:10:25,939  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:25,939  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:26,106  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:10:26,106  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:26,106  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:26,106  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:26,106  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:26,106  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:26,107  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:26,107  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:26,110  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:26,110  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:10:26,110  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:26,121  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-25_377_7565093623055308195-1/-mr-10004/57e73ead-3ed1-4dd4-ba0a-cf34fa510f2b (false)
2024-04-23T21:10:26,132  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:26,149  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,99KB
2024-04-23T21:10:26,156  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:26,159  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,15KB
2024-04-23T21:10:26,161  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:26,169  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:26,178  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:26,183  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:26,184  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:10:26,184  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:10:26,184  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:26,201  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:10:26,208  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: insert_only 
2024-04-23T21:10:26,208  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:10:26,231  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:10:26,231  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 30 ms
2024-04-23T21:10:26,231  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T21:10:26,251  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T21:10:26,276  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2023473824_0002
2024-04-23T21:10:26,276  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:26,353  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:26,354  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:26,354  INFO [Thread-156] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:26,354  INFO [Thread-156] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:26,357  INFO [Thread-156] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:26,357  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2023473824_0002_m_000000_0
2024-04-23T21:10:26,358  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:26,359  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:26,360  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:26,368  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,99KB
2024-04-23T21:10:26,371  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:26,387  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:26,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:26,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:26,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:26,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:26,397  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:26,400  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:26,401  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:26,404  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:26,406  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:26,406  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:26,409  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:26,409  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:26,421  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:10:26,422  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:26,422  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:26,422  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, 
2024-04-23T21:10:26,422  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:26,422  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T21:10:26,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:26,438  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:26,443  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2023473824_0002_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:26,444  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:26,444  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2023473824_0002_m_000000_0' done.
2024-04-23T21:10:26,444  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2023473824_0002_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=18662
		FILE: Number of bytes written=2372936
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=922746880
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8134
2024-04-23T21:10:26,444  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2023473824_0002_m_000000_0
2024-04-23T21:10:26,444  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2023473824_0002_m_000001_0
2024-04-23T21:10:26,445  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:26,446  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:26,447  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:26,449  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,99KB
2024-04-23T21:10:26,451  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:26,452  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:26,457  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:26,457  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:26,457  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:26,457  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:26,457  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:26,458  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:26,458  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:26,458  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:26,459  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:26,459  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:26,459  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:26,460  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:26,460  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:10:26,460  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:26,461  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-23T21:10:26,462  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:26,462  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:26,462  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:26,462  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T21:10:26,462  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:26,470  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:26,474  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2023473824_0002_m_000001_0 is done. And is in the process of committing
2024-04-23T21:10:26,475  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:26,475  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2023473824_0002_m_000001_0' done.
2024-04-23T21:10:26,475  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2023473824_0002_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=27351
		FILE: Number of bytes written=2373026
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=922746880
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8134
2024-04-23T21:10:26,475  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2023473824_0002_m_000001_0
2024-04-23T21:10:26,476  INFO [Thread-156] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:26,479  INFO [Thread-156] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:26,479  INFO [pool-16-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2023473824_0002_r_000000_0
2024-04-23T21:10:26,483  INFO [pool-16-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:26,485  INFO [pool-16-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@404fe733
2024-04-23T21:10:26,487  WARN [pool-16-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:26,500  INFO [pool-16-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:26,502  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2023473824_0002_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:26,523  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local2023473824_0002_m_000001_0 decomp: 54 len: 58 to MEMORY
2024-04-23T21:10:26,525  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local2023473824_0002_m_000001_0
2024-04-23T21:10:26,527  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->54
2024-04-23T21:10:26,530  INFO [localfetcher#1] reduce.LocalFetcher: localfetcher#1 about to shuffle output of map attempt_local2023473824_0002_m_000000_0 decomp: 54 len: 58 to MEMORY
2024-04-23T21:10:26,530  INFO [localfetcher#1] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local2023473824_0002_m_000000_0
2024-04-23T21:10:26,530  INFO [localfetcher#1] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 2, commitMemory -> 54, usedMemory ->108
2024-04-23T21:10:26,531  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:26,531  INFO [pool-16-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:10:26,532  INFO [pool-16-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:26,543  INFO [pool-16-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T21:10:26,544  INFO [pool-16-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 64 bytes
2024-04-23T21:10:26,547  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 108 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:26,547  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merging 1 files, 110 bytes from disk
2024-04-23T21:10:26,548  INFO [pool-16-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:26,548  INFO [pool-16-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:26,548  INFO [pool-16-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 84 bytes
2024-04-23T21:10:26,549  INFO [pool-16-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:10:26,551  INFO [pool-16-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:26,553  INFO [pool-16-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,15KB
2024-04-23T21:10:26,555  INFO [pool-16-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:26,555  INFO [pool-16-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:26,556  INFO [pool-16-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<>>
2024-04-23T21:10:26,556  INFO [pool-16-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:26,557  INFO [pool-16-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@b1d7b72, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@1a96e298, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2] : [int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@250c9c82
2024-04-23T21:10:26,561  INFO [pool-16-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-25_377_7565093623055308195-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-25_377_7565093623055308195-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:26,561  INFO [pool-16-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-25_377_7565093623055308195-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-25_377_7565093623055308195-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:26,561  INFO [pool-16-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-25_377_7565093623055308195-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-25_377_7565093623055308195-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:26,581  INFO [pool-16-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:26,582  INFO [pool-16-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:26,582  INFO [pool-16-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T21:10:26,582  INFO [pool-16-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:26,582  INFO [pool-16-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T21:10:26,583  INFO [pool-16-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_0:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:26,583  INFO [pool-16-thread-1] mapred.Task: Task:attempt_local2023473824_0002_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:26,584  INFO [pool-16-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:26,585  INFO [pool-16-thread-1] mapred.Task: Task 'attempt_local2023473824_0002_r_000000_0' done.
2024-04-23T21:10:26,585  INFO [pool-16-thread-1] mapred.Task: Final Counters for attempt_local2023473824_0002_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=34858
		FILE: Number of bytes written=2373307
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=116
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=922746880
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:26,585  INFO [pool-16-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2023473824_0002_r_000000_0
2024-04-23T21:10:26,585  INFO [Thread-156] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:27,365 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:27,365  INFO [main] exec.Task: 2024-04-23 21:10:27,365 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2023473824_0002
2024-04-23T21:10:27,370  INFO [main] exec.Task: Ended Job = job_local2023473824_0002
2024-04-23T21:10:27,372  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:27,373  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:10:27,373  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:27,373  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:27,373  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:27,373  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149); Time taken: 1.433 seconds
2024-04-23T21:10:27,373  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211025_db2c9e35-8606-4a40-8334-437576b2b149
2024-04-23T21:10:27,380  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:10:27,392  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:27,392  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:10:27,400  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:10:27,419  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:10:27,419  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_7:4, 
2024-04-23T21:10:27,420  WARN [main] ql.TestTxnAddPartition: addPartitionMMVectorized: read data(add 2 parts w/data and 1 empty vect): 
2024-04-23T21:10:27,420  INFO [main] ql.TestTxnAddPartition: 0	0	2
0	0	4
1	0	2
1	0	4

2024-04-23T21:10:27,420  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T21:10:27,421  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-25_377_7565093623055308195-1
2024-04-23T21:10:27,422  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-25_377_7565093623055308195-1 on fs with scheme file
2024-04-23T21:10:27,423  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211027_d71d3221-7641-4972-bc8a-0a005ab13ef7): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T21:10:27,430  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T21:10:27,431  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:10:27,433  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:27,437  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:27,438  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:27,439  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:27,459  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:27,459  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:27,460  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:27,460  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:27,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:27,504  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:27,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:27,607  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:27,623  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:27,623  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:27,638  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:27,638  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:27,688  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:27,688  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:27,688  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:27,691  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:27,695  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T21:10:27,695  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:10:27,696  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:27,724  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:27,733  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:27,734  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:27,734  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:27,735  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:27,736  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:27,738  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:27,738  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T21:10:27,738  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:27,738  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAggrColStatsFor_(String, String, List, List, String, String)=30, openTxn_(String, TxnType)=4, getAllTableConstraints_(AllTableConstraintsRequest)=12, commitTxn_(CommitTxnRequest)=20, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=6, getValidTxns_(long)=2, listPartitions_(String, String, short)=15, flushCache_()=0, getTable_(GetTableRequest)=20}
2024-04-23T21:10:27,739  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211027_d71d3221-7641-4972-bc8a-0a005ab13ef7); Time taken: 0.315 seconds
2024-04-23T21:10:27,739  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211027_d71d3221-7641-4972-bc8a-0a005ab13ef7): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T21:10:27,739  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T21:10:27,766  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:27,767  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:10:27,767  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211027_d71d3221-7641-4972-bc8a-0a005ab13ef7); Time taken: 0.027 seconds
2024-04-23T21:10:27,767  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:10:27,773  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:10:27,780  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:27,781  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:10:27,783  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:27,783  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-27_422_5430780814794798031-1
2024-04-23T21:10:27,784  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-27_422_5430780814794798031-1 on fs with scheme file
2024-04-23T21:10:27,784  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211027_289a8fea-b3b3-47db-b195-3a1c3d7eee28): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:27,785  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:27,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:27,801  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T21:10:27,802  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:10:27,806  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:27,820  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:27,820  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:27,820  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:27,820  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:27,820  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:27,820  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:27,820  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:27,820  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:27,821  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=27, openTxn_(String, TxnType)=3, getCurrentNotificationEventId_()=3}
2024-04-23T21:10:27,821  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211027_289a8fea-b3b3-47db-b195-3a1c3d7eee28); Time taken: 0.036 seconds
2024-04-23T21:10:27,821  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423211027_289a8fea-b3b3-47db-b195-3a1c3d7eee28
2024-04-23T21:10:27,822  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211027_289a8fea-b3b3-47db-b195-3a1c3d7eee28
2024-04-23T21:10:27,842  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211027_289a8fea-b3b3-47db-b195-3a1c3d7eee28 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:10:27,842  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:27,842  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211027_289a8fea-b3b3-47db-b195-3a1c3d7eee28): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:27,842  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:27,842  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:27,842  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:27,842  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:27,842  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:27,854  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:27,860  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:27,860  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:27,860  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211027_289a8fea-b3b3-47db-b195-3a1c3d7eee28); Time taken: 0.018 seconds
2024-04-23T21:10:27,860  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211027_289a8fea-b3b3-47db-b195-3a1c3d7eee28
2024-04-23T21:10:27,865  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:10:27,873  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:27,873  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:10:27,875  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211027_d8d468b5-910d-4e92-8b8c-0bfede6db106): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:27,878  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T21:10:27,879  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:10:27,880  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:27,892  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:27,904  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-23T21:10:27,905  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-23T21:10:27,905  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:27,906  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:27,906  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:27,906  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=13, allocateTableWriteId_(long, String, String)=10, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1}
2024-04-23T21:10:27,906  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211027_d8d468b5-910d-4e92-8b8c-0bfede6db106); Time taken: 0.031 seconds
2024-04-23T21:10:27,906  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423211027_d8d468b5-910d-4e92-8b8c-0bfede6db106
2024-04-23T21:10:27,907  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211027_d8d468b5-910d-4e92-8b8c-0bfede6db106
2024-04-23T21:10:27,926  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211027_d8d468b5-910d-4e92-8b8c-0bfede6db106 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:10:27,926  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:27,931  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211027_d8d468b5-910d-4e92-8b8c-0bfede6db106): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:27,932  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:27,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:27,945  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:27,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:27,975 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:10:27,976 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:10:27,977 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-23T21:10:27,978 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMMVectorized(TestTxnAddPartition.java:152) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T21:10:27,982 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T21:10:27,982  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:27,982  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=13}
2024-04-23T21:10:27,983  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211027_d8d468b5-910d-4e92-8b8c-0bfede6db106); Time taken: 0.051 seconds
2024-04-23T21:10:27,983  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211027_d8d468b5-910d-4e92-8b8c-0bfede6db106
2024-04-23T21:10:27,986  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:27,997  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:27,998  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211027_18cd984b-13fb-4efc-9e8b-4340794cb7bd): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:28,001  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T21:10:28,002  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T21:10:28,003  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:28,016  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:28,018  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:28,034  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-23T21:10:28,051  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:28,063  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-23T21:10:28,064  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-23T21:10:28,065  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:28,065  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:28,065  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:28,065  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=30, rollbackTxn_(long)=13, flushCache_()=0, getTable_(GetTableRequest)=13, allocateTableWriteId_(long, String, String)=7, getValidTxns_(long)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:28,065  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211027_18cd984b-13fb-4efc-9e8b-4340794cb7bd); Time taken: 0.067 seconds
2024-04-23T21:10:28,065  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423211027_18cd984b-13fb-4efc-9e8b-4340794cb7bd
2024-04-23T21:10:28,065  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211027_18cd984b-13fb-4efc-9e8b-4340794cb7bd
2024-04-23T21:10:28,085  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211027_18cd984b-13fb-4efc-9e8b-4340794cb7bd LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:10:28,085  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:28,094  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211027_18cd984b-13fb-4efc-9e8b-4340794cb7bd): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:28,094  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:28,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:28,107  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:28,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:28,121  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T21:10:28,124  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T21:10:28,126  INFO [HMSHandler #3] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3
2024-04-23T21:10:28,157  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-23T21:10:28,158  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data
2024-04-23T21:10:28,158  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:28,170  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:28,171  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:28,184  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-23T21:10:28,184  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:28,185  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:28,195  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:28,196  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:28,208  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-23T21:10:28,213  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:28,213  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-23T21:10:28,262  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:28,294  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:28,306  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:28,307  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getPartitionWithAuthInfo_(String, String, List, String, List)=36, validatePartitionNameCharacters_(List)=0, getValidWriteIds_(List, String)=1, getTable_(GetTableRequest)=36, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=81, add_partitions_(List, boolean, boolean)=50, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:28,307  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211027_18cd984b-13fb-4efc-9e8b-4340794cb7bd); Time taken: 0.212 seconds
2024-04-23T21:10:28,307  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211027_18cd984b-13fb-4efc-9e8b-4340794cb7bd
2024-04-23T21:10:28,312  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T21:10:28,319  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:28,321  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T21:10:28,322  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b from T order by p, a, b
2024-04-23T21:10:28,323  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473): select p, a, b from T order by p, a, b
2024-04-23T21:10:28,333  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T21:10:28,334  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T21:10:28,337  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:28,337  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:28,344  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:28,344  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:28,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:28,358  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:28,359  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:28,359  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:28,359  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:28,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:28,418  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:28,418  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:28,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:28,489  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:28,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:28,512  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:28,512  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:28,566  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:28,567  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:28,567  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:28,568  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-28_323_9168023161596722502-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-28_323_9168023161596722502-1
2024-04-23T21:10:28,576  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:28,580  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:10:28,580  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T21:10:28,581  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:28,582  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:28,593  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:28,594  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:28,594  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:28,595  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:28,596  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:28,596  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:28,596  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:28,596  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:10:28,597  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:10:28,598  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:28,598  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=3, openTxn_(String, TxnType)=10, getValidWriteIds_(List, String)=9, listPartitions_(String, String, short)=36, getAllTableConstraints_(AllTableConstraintsRequest)=39, flushCache_()=1, getAggrColStatsFor_(String, String, List, List, String, String)=37, getTable_(GetTableRequest)=12}
2024-04-23T21:10:28,598  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473); Time taken: 0.274 seconds
2024-04-23T21:10:28,598  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473
2024-04-23T21:10:28,600  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473
2024-04-23T21:10:28,624  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473 LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T21:10:28,624  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:28,625  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473): select p, a, b from T order by p, a, b
2024-04-23T21:10:28,625  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473
2024-04-23T21:10:28,626  INFO [main] ql.Driver: Query ID = alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473
Total jobs = 1
2024-04-23T21:10:28,626  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:28,626  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:28,766  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:10:28,767  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:28,767  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:28,767  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:28,767  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:28,767  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:28,767  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:28,767  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:28,770  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:28,770  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:10:28,770  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:28,778  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-28_323_9168023161596722502-1/-mr-10004/59d9e035-42a3-4506-bddb-7dad73c8b637 (false)
2024-04-23T21:10:28,788  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:28,791  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,35KB
2024-04-23T21:10:28,796  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:28,798  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,15KB
2024-04-23T21:10:28,798  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:28,805  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:28,813  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:28,817  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:28,819  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:10:28,819  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:10:28,819  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:28,830  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:10:28,830  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: insert_only 
2024-04-23T21:10:28,830  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:10:28,838  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-23T21:10:28,838  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 8 ms
2024-04-23T21:10:28,838  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-23T21:10:28,857  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-23T21:10:28,884  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local219808428_0003
2024-04-23T21:10:28,884  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:28,951  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:28,952  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:28,952  INFO [Thread-250] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:28,952  INFO [Thread-250] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:28,954  INFO [Thread-250] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:28,954  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local219808428_0003_m_000000_0
2024-04-23T21:10:28,955  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:28,956  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:28,956  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:28,958  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-23T21:10:28,960  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:28,962  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:28,967  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:28,967  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:28,967  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:28,967  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:28,967  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:28,968  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:28,969  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:28,969  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:28,970  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:28,970  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:28,970  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:28,970  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:28,971  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-23T21:10:28,972  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:28,972  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:28,972  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:28,972  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T21:10:28,972  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:28,983  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:28,987  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local219808428_0003_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:28,987  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:28,987  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local219808428_0003_m_000000_0' done.
2024-04-23T21:10:28,988  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local219808428_0003_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=51497
		FILE: Number of bytes written=3566139
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=999292928
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-23T21:10:28,988  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local219808428_0003_m_000000_0
2024-04-23T21:10:28,988  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local219808428_0003_m_000001_0
2024-04-23T21:10:28,988  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:28,989  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:28,990  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:28,991  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-23T21:10:28,993  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:28,994  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:29,000  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:29,001  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:29,001  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:29,001  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:29,001  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:29,002  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:29,002  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:29,003  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:29,003  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:29,003  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:29,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:29,004  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:29,005  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:10:29,005  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:29,005  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:29,005  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:10:29,005  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:29,005  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:29,005  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:29,005  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:29,006  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:29,006  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:29,006  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:29,006  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:29,006  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:29,006  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:29,007  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T21:10:29,007  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:29,015  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:29,018  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local219808428_0003_m_000001_0 is done. And is in the process of committing
2024-04-23T21:10:29,020  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:29,020  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local219808428_0003_m_000001_0' done.
2024-04-23T21:10:29,020  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local219808428_0003_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=61071
		FILE: Number of bytes written=3566229
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=999292928
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-23T21:10:29,020  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local219808428_0003_m_000001_0
2024-04-23T21:10:29,020  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local219808428_0003_m_000002_0
2024-04-23T21:10:29,021  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:29,021  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:29,022  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:29,024  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,35KB
2024-04-23T21:10:29,026  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:29,028  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:29,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:29,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:29,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:29,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:29,048  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:29,049  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:29,050  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:29,050  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:29,051  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:29,051  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:29,051  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:29,051  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:29,052  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:10:29,052  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:29,052  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:29,053  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:10:29,053  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:29,053  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:29,053  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:29,053  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:29,053  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:29,053  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:29,053  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-23T21:10:29,054  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:29,054  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:29,054  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:29,054  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 48; bufvoid = 104857600
2024-04-23T21:10:29,054  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:29,062  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:29,066  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local219808428_0003_m_000002_0 is done. And is in the process of committing
2024-04-23T21:10:29,067  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:29,067  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local219808428_0003_m_000002_0' done.
2024-04-23T21:10:29,067  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local219808428_0003_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=70133
		FILE: Number of bytes written=3566319
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=48
		Map output materialized bytes=58
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=15
		Total committed heap usage (bytes)=999292928
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8495
2024-04-23T21:10:29,067  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local219808428_0003_m_000002_0
2024-04-23T21:10:29,067  INFO [Thread-250] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:29,068  INFO [Thread-250] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:29,069  INFO [pool-21-thread-1] mapred.LocalJobRunner: Starting task: attempt_local219808428_0003_r_000000_0
2024-04-23T21:10:29,069  INFO [pool-21-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:29,069  INFO [pool-21-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6e55ea16
2024-04-23T21:10:29,070  WARN [pool-21-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:29,071  INFO [pool-21-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:29,071  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local219808428_0003_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:29,074  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local219808428_0003_m_000001_0 decomp: 54 len: 58 to MEMORY
2024-04-23T21:10:29,075  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local219808428_0003_m_000001_0
2024-04-23T21:10:29,075  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->54
2024-04-23T21:10:29,077  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local219808428_0003_m_000000_0 decomp: 54 len: 58 to MEMORY
2024-04-23T21:10:29,077  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local219808428_0003_m_000000_0
2024-04-23T21:10:29,077  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 2, commitMemory -> 54, usedMemory ->108
2024-04-23T21:10:29,080  INFO [localfetcher#2] reduce.LocalFetcher: localfetcher#2 about to shuffle output of map attempt_local219808428_0003_m_000002_0 decomp: 54 len: 58 to MEMORY
2024-04-23T21:10:29,080  INFO [localfetcher#2] reduce.InMemoryMapOutput: Read 54 bytes from map-output for attempt_local219808428_0003_m_000002_0
2024-04-23T21:10:29,080  INFO [localfetcher#2] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 54, inMemoryMapOutputs.size() -> 3, commitMemory -> 108, usedMemory ->162
2024-04-23T21:10:29,081  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:29,081  INFO [pool-21-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T21:10:29,081  INFO [pool-21-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:29,088  INFO [pool-21-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-23T21:10:29,088  INFO [pool-21-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 96 bytes
2024-04-23T21:10:29,090  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 162 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:29,090  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merging 1 files, 162 bytes from disk
2024-04-23T21:10:29,090  INFO [pool-21-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:29,091  INFO [pool-21-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:29,091  INFO [pool-21-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 136 bytes
2024-04-23T21:10:29,091  INFO [pool-21-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T21:10:29,092  INFO [pool-21-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:29,093  INFO [pool-21-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,15KB
2024-04-23T21:10:29,094  INFO [pool-21-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:29,094  INFO [pool-21-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:29,094  INFO [pool-21-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<>>
2024-04-23T21:10:29,094  INFO [pool-21-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:29,094  INFO [pool-21-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@7b16602e, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@48f078b8, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2] : [int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@36e0b60
2024-04-23T21:10:29,095  INFO [pool-21-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-28_323_9168023161596722502-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-28_323_9168023161596722502-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:29,095  INFO [pool-21-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-28_323_9168023161596722502-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-28_323_9168023161596722502-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:29,095  INFO [pool-21-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-28_323_9168023161596722502-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-28_323_9168023161596722502-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:29,103  INFO [pool-21-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:29,103  INFO [pool-21-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:29,104  INFO [pool-21-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:29,104  INFO [pool-21-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:29,104  INFO [pool-21-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-23T21:10:29,104  INFO [pool-21-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, 
2024-04-23T21:10:29,105  INFO [pool-21-thread-1] mapred.Task: Task:attempt_local219808428_0003_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:29,106  INFO [pool-21-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:29,106  INFO [pool-21-thread-1] mapred.Task: Task 'attempt_local219808428_0003_r_000000_0' done.
2024-04-23T21:10:29,106  INFO [pool-21-thread-1] mapred.Task: Final Counters for attempt_local219808428_0003_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=77783
		FILE: Number of bytes written=3566688
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=174
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=999292928
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:29,106  INFO [pool-21-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local219808428_0003_r_000000_0
2024-04-23T21:10:29,106  INFO [Thread-250] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:29,957 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:29,957  INFO [main] exec.Task: 2024-04-23 21:10:29,957 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local219808428_0003
2024-04-23T21:10:29,959  INFO [main] exec.Task: Ended Job = job_local219808428_0003
2024-04-23T21:10:29,961  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:29,961  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:10:29,961  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:29,961  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:29,961  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:29,961  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473); Time taken: 1.336 seconds
2024-04-23T21:10:29,962  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211028_fa190a51-0986-4aea-b78a-2a3c43abf473
2024-04-23T21:10:29,967  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T21:10:29,976  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:29,976  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T21:10:29,982  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:10:29,983  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:10:29,984  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:29,984  WARN [main] ql.TestTxnAddPartition: addPartitionMMVectorized: read data(add 2 existing parts and 1 empty vect): 
2024-04-23T21:10:29,984  INFO [main] ql.TestTxnAddPartition: 0	0	2
0	0	4
1	0	2
1	0	4
3	0	2
3	0	4

2024-04-23T21:10:29,984  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T21:10:29,984  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-28_323_9168023161596722502-1
2024-04-23T21:10:29,986  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-28_323_9168023161596722502-1 on fs with scheme file
2024-04-23T21:10:29,986  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211029_469338f5-5a70-41b1-808e-933a64a689a6): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T21:10:29,991  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-23T21:10:29,992  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T21:10:29,994  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:29,997  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:29,997  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:29,998  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:30,010  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,011  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:30,011  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:30,011  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:30,024  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:30,039  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:30,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:30,069  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:30,092  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:30,116  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:30,116  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:30,176  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:30,177  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:30,177  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:30,179  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:30,181  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T21:10:30,182  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T21:10:30,182  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:30,205  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:30,215  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:30,216  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:30,216  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:30,217  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:30,217  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:30,218  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:30,218  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T21:10:30,218  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:30,218  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=2, getValidWriteIds_(List, String)=5, openTxn_(String, TxnType)=4, getTable_(GetTableRequest)=12, listPartitions_(String, String, short)=11, getAllTableConstraints_(AllTableConstraintsRequest)=7, getAggrColStatsFor_(String, String, List, List, String, String)=46, flushCache_()=0}
2024-04-23T21:10:30,218  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211029_469338f5-5a70-41b1-808e-933a64a689a6); Time taken: 0.232 seconds
2024-04-23T21:10:30,218  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211029_469338f5-5a70-41b1-808e-933a64a689a6): EXPLAIN VECTORIZATION DETAIL select p, a, b from T order by p, a, b
2024-04-23T21:10:30,219  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T21:10:30,231  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:30,231  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:10:30,231  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211029_469338f5-5a70-41b1-808e-933a64a689a6); Time taken: 0.013 seconds
2024-04-23T21:10:30,231  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:10:30,237  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T21:10:30,244  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:30,244  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T21:10:30,246  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:30,246  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-29_986_1752654526642798647-1
2024-04-23T21:10:30,246  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/b53aa106-a8d7-4c38-a3b1-892d5f3e2227/hive_2024-04-23_21-10-29_986_1752654526642798647-1 on fs with scheme file
2024-04-23T21:10:30,247  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211030_c720b7ae-3578-445d-8b3e-ebe4e6b3a3bf): drop table if exists acidTbl
2024-04-23T21:10:30,250  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-23T21:10:30,250  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T21:10:30,251  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:30,260  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,260  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:30,260  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:30,260  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:30,260  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T21:10:30,260  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211030_c720b7ae-3578-445d-8b3e-ebe4e6b3a3bf); Time taken: 0.013 seconds
2024-04-23T21:10:30,261  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423211030_c720b7ae-3578-445d-8b3e-ebe4e6b3a3bf
2024-04-23T21:10:30,261  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211030_c720b7ae-3578-445d-8b3e-ebe4e6b3a3bf
2024-04-23T21:10:30,280  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211030_c720b7ae-3578-445d-8b3e-ebe4e6b3a3bf LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T21:10:30,280  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:30,280  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211030_c720b7ae-3578-445d-8b3e-ebe4e6b3a3bf): drop table if exists acidTbl
2024-04-23T21:10:30,281  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:30,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:30,289  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:30,299  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,299  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:30,488  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:30,488  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=197, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:30,488  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211030_c720b7ae-3578-445d-8b3e-ebe4e6b3a3bf); Time taken: 0.208 seconds
2024-04-23T21:10:30,489  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211030_c720b7ae-3578-445d-8b3e-ebe4e6b3a3bf
2024-04-23T21:10:30,494  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T21:10:30,502  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:30,502  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T21:10:30,502  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:30,503  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211030_5dd396f6-1721-4191-b417-c98ac9220db3): drop table if exists acidTblPart
2024-04-23T21:10:30,506  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-23T21:10:30,506  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-23T21:10:30,508  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:30,534  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,535  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:30,535  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:30,535  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:30,535  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=13, getTable_(GetTableRequest)=28}
2024-04-23T21:10:30,535  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211030_5dd396f6-1721-4191-b417-c98ac9220db3); Time taken: 0.032 seconds
2024-04-23T21:10:30,535  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240423211030_5dd396f6-1721-4191-b417-c98ac9220db3
2024-04-23T21:10:30,536  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211030_5dd396f6-1721-4191-b417-c98ac9220db3
2024-04-23T21:10:30,560  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211030_5dd396f6-1721-4191-b417-c98ac9220db3 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T21:10:30,560  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:30,560  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211030_5dd396f6-1721-4191-b417-c98ac9220db3): drop table if exists acidTblPart
2024-04-23T21:10:30,560  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:30,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:30,569  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,569  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:30,578  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,578  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:30,638  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:30,638  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=68, getTable_(GetTableRequest)=9}
2024-04-23T21:10:30,638  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211030_5dd396f6-1721-4191-b417-c98ac9220db3); Time taken: 0.078 seconds
2024-04-23T21:10:30,638  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211030_5dd396f6-1721-4191-b417-c98ac9220db3
2024-04-23T21:10:30,643  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-23T21:10:30,651  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:30,651  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-23T21:10:30,652  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:30,652  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211030_fcaf79f7-eacd-4815-b5fd-2fc3cfd29d4d): drop table if exists acidTbl2
2024-04-23T21:10:30,655  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-23T21:10:30,656  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-23T21:10:30,657  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:30,657  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:30,657  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:30,657  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, flushCache_()=1, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=3, getValidTxns_(long)=1}
2024-04-23T21:10:30,657  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211030_fcaf79f7-eacd-4815-b5fd-2fc3cfd29d4d); Time taken: 0.005 seconds
2024-04-23T21:10:30,658  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240423211030_fcaf79f7-eacd-4815-b5fd-2fc3cfd29d4d
2024-04-23T21:10:30,658  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:30,658  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211030_fcaf79f7-eacd-4815-b5fd-2fc3cfd29d4d): drop table if exists acidTbl2
2024-04-23T21:10:30,658  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:30,659  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:10:30,659  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:30,660  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T21:10:30,660  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211030_fcaf79f7-eacd-4815-b5fd-2fc3cfd29d4d); Time taken: 0.001 seconds
2024-04-23T21:10:30,660  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211030_fcaf79f7-eacd-4815-b5fd-2fc3cfd29d4d
2024-04-23T21:10:30,666  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-23T21:10:30,673  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:30,674  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-23T21:10:30,674  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:30,675  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211030_dfc9ac2a-3795-408c-90d6-4cfbf9d70307): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:30,678  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-23T21:10:30,678  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-23T21:10:30,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:30,706  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,706  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:30,706  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:30,707  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:30,707  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=1, flushCache_()=0, getTable_(GetTableRequest)=27, openTxn_(String, TxnType)=3}
2024-04-23T21:10:30,707  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211030_dfc9ac2a-3795-408c-90d6-4cfbf9d70307); Time taken: 0.032 seconds
2024-04-23T21:10:30,707  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240423211030_dfc9ac2a-3795-408c-90d6-4cfbf9d70307
2024-04-23T21:10:30,708  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211030_dfc9ac2a-3795-408c-90d6-4cfbf9d70307
2024-04-23T21:10:30,728  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211030_dfc9ac2a-3795-408c-90d6-4cfbf9d70307 LockResponse(lockid:20, state:ACQUIRED)
2024-04-23T21:10:30,728  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:30,728  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211030_dfc9ac2a-3795-408c-90d6-4cfbf9d70307): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:30,728  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:30,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:30,741  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:30,752  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,753  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:30,829  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:30,830  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=12, dropTable_(String, String, boolean, boolean, boolean)=88}
2024-04-23T21:10:30,830  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211030_dfc9ac2a-3795-408c-90d6-4cfbf9d70307); Time taken: 0.101 seconds
2024-04-23T21:10:30,830  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211030_dfc9ac2a-3795-408c-90d6-4cfbf9d70307
2024-04-23T21:10:30,835  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-23T21:10:30,843  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:30,843  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-23T21:10:30,844  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:30,844  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211030_e1f341b8-19f2-41d6-a203-dd3c15e51a9e): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:30,847  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-23T21:10:30,847  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-23T21:10:30,848  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:30,860  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,861  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:30,861  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:30,861  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:30,861  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=12, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2}
2024-04-23T21:10:30,861  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211030_e1f341b8-19f2-41d6-a203-dd3c15e51a9e); Time taken: 0.017 seconds
2024-04-23T21:10:30,861  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240423211030_e1f341b8-19f2-41d6-a203-dd3c15e51a9e
2024-04-23T21:10:30,862  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211030_e1f341b8-19f2-41d6-a203-dd3c15e51a9e
2024-04-23T21:10:30,881  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211030_e1f341b8-19f2-41d6-a203-dd3c15e51a9e LockResponse(lockid:21, state:ACQUIRED)
2024-04-23T21:10:30,881  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:30,881  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211030_e1f341b8-19f2-41d6-a203-dd3c15e51a9e): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:30,882  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:30,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:30,894  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,894  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:30,905  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,905  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:30,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:30,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=12, dropTable_(String, String, boolean, boolean, boolean)=58}
2024-04-23T21:10:30,952  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211030_e1f341b8-19f2-41d6-a203-dd3c15e51a9e); Time taken: 0.071 seconds
2024-04-23T21:10:30,952  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211030_e1f341b8-19f2-41d6-a203-dd3c15e51a9e
2024-04-23T21:10:30,957  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-23T21:10:30,965  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:30,965  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-23T21:10:30,966  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:30,967  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211030_98da90da-ac5e-4f55-b799-153b5f06eff0): drop table if exists nonAcidNonBucket
2024-04-23T21:10:30,970  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-23T21:10:30,970  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-23T21:10:30,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:30,983  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:30,984  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:30,984  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:30,984  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:30,984  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=13, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:30,984  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211030_98da90da-ac5e-4f55-b799-153b5f06eff0); Time taken: 0.017 seconds
2024-04-23T21:10:30,984  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240423211030_98da90da-ac5e-4f55-b799-153b5f06eff0
2024-04-23T21:10:30,985  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211030_98da90da-ac5e-4f55-b799-153b5f06eff0
2024-04-23T21:10:31,005  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211030_98da90da-ac5e-4f55-b799-153b5f06eff0 LockResponse(lockid:22, state:ACQUIRED)
2024-04-23T21:10:31,005  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:31,005  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211030_98da90da-ac5e-4f55-b799-153b5f06eff0): drop table if exists nonAcidNonBucket
2024-04-23T21:10:31,005  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,005  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:31,018  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:31,018  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:31,033  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:31,033  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:31,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=13, dropTable_(String, String, boolean, boolean, boolean)=67, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,086  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211030_98da90da-ac5e-4f55-b799-153b5f06eff0); Time taken: 0.08 seconds
2024-04-23T21:10:31,086  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211030_98da90da-ac5e-4f55-b799-153b5f06eff0
2024-04-23T21:10:31,091  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-23T21:10:31,100  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,100  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-23T21:10:31,101  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T21:10:31,190  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:10:31,190  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:10:31,190  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:10:31,190  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:10:31,190  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:10:31,190  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:10:31,190  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:10:31,190  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:10:31,191  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:10:31,191  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:10:31,191  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:10:31,193  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 40d10671-0466-4ee6-9325-427a862b0433
2024-04-23T21:10:31,196  INFO [main] SessionState: Hive Session ID = 40d10671-0466-4ee6-9325-427a862b0433
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:31,197  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:31,203  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/40d10671-0466-4ee6-9325-427a862b0433
2024-04-23T21:10:31,205  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433
2024-04-23T21:10:31,208  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/40d10671-0466-4ee6-9325-427a862b0433/_tmp_space.db
2024-04-23T21:10:31,208  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=40d10671-0466-4ee6-9325-427a862b0433, clientType=HIVECLI]
2024-04-23T21:10:31,209  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:31,209  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_87aad960-51fd-4ee3-b3b7-581c16fa1518): drop table if exists acidTbl
2024-04-23T21:10:31,219  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:10:31,219  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:10:31,222  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:31,227  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,227  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,227  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,227  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, openTxn_(String, TxnType)=9, getValidTxns_(long)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:31,227  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_87aad960-51fd-4ee3-b3b7-581c16fa1518); Time taken: 0.018 seconds
2024-04-23T21:10:31,228  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423211031_87aad960-51fd-4ee3-b3b7-581c16fa1518
2024-04-23T21:10:31,228  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:31,228  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_87aad960-51fd-4ee3-b3b7-581c16fa1518): drop table if exists acidTbl
2024-04-23T21:10:31,228  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:31,232  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,233  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,233  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_87aad960-51fd-4ee3-b3b7-581c16fa1518); Time taken: 0.004 seconds
2024-04-23T21:10:31,233  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_87aad960-51fd-4ee3-b3b7-581c16fa1518
2024-04-23T21:10:31,240  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:10:31,247  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,247  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:10:31,248  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:31,248  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_624318d5-c903-420f-b4be-7ad4babc346a): drop table if exists acidTblPart
2024-04-23T21:10:31,251  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:10:31,252  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:10:31,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:31,257  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,257  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,257  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,257  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:10:31,257  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_624318d5-c903-420f-b4be-7ad4babc346a); Time taken: 0.009 seconds
2024-04-23T21:10:31,258  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423211031_624318d5-c903-420f-b4be-7ad4babc346a
2024-04-23T21:10:31,258  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:31,258  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_624318d5-c903-420f-b4be-7ad4babc346a): drop table if exists acidTblPart
2024-04-23T21:10:31,258  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,259  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:31,263  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,263  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,263  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_624318d5-c903-420f-b4be-7ad4babc346a); Time taken: 0.005 seconds
2024-04-23T21:10:31,263  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_624318d5-c903-420f-b4be-7ad4babc346a
2024-04-23T21:10:31,269  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:10:31,277  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,277  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:10:31,278  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:31,278  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_151b6be2-5466-4f44-8884-a2403a2222a8): drop table if exists acidTbl2
2024-04-23T21:10:31,281  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:10:31,281  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:10:31,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:31,287  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,287  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,287  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,287  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:10:31,287  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_151b6be2-5466-4f44-8884-a2403a2222a8); Time taken: 0.009 seconds
2024-04-23T21:10:31,288  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423211031_151b6be2-5466-4f44-8884-a2403a2222a8
2024-04-23T21:10:31,288  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:31,288  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_151b6be2-5466-4f44-8884-a2403a2222a8): drop table if exists acidTbl2
2024-04-23T21:10:31,288  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,288  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:31,292  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,292  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,292  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_151b6be2-5466-4f44-8884-a2403a2222a8); Time taken: 0.004 seconds
2024-04-23T21:10:31,293  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_151b6be2-5466-4f44-8884-a2403a2222a8
2024-04-23T21:10:31,299  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:10:31,306  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,306  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:10:31,307  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:31,308  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_951e0a8c-960c-4d64-bdfc-57b82421c995): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:31,310  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:10:31,311  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:10:31,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:31,315  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,315  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,316  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T21:10:31,316  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_951e0a8c-960c-4d64-bdfc-57b82421c995); Time taken: 0.007 seconds
2024-04-23T21:10:31,316  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423211031_951e0a8c-960c-4d64-bdfc-57b82421c995
2024-04-23T21:10:31,316  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:31,316  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_951e0a8c-960c-4d64-bdfc-57b82421c995): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:31,316  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,317  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:31,320  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,320  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,321  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_951e0a8c-960c-4d64-bdfc-57b82421c995); Time taken: 0.004 seconds
2024-04-23T21:10:31,321  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_951e0a8c-960c-4d64-bdfc-57b82421c995
2024-04-23T21:10:31,326  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:10:31,333  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,333  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:10:31,334  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:31,334  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_032a7144-588c-4549-9841-31f1c426d765): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:31,337  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:10:31,337  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:10:31,338  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:31,342  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,342  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,342  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,342  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:10:31,343  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_032a7144-588c-4549-9841-31f1c426d765); Time taken: 0.008 seconds
2024-04-23T21:10:31,343  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423211031_032a7144-588c-4549-9841-31f1c426d765
2024-04-23T21:10:31,343  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:31,343  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_032a7144-588c-4549-9841-31f1c426d765): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:31,343  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,343  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:31,347  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,347  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,348  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_032a7144-588c-4549-9841-31f1c426d765); Time taken: 0.004 seconds
2024-04-23T21:10:31,348  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_032a7144-588c-4549-9841-31f1c426d765
2024-04-23T21:10:31,354  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:10:31,361  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,362  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:10:31,362  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:31,363  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_773b3686-9fc0-44ff-a4ab-81cc3e62f816): drop table if exists nonAcidNonBucket
2024-04-23T21:10:31,366  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:10:31,366  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:10:31,367  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:31,371  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,371  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,371  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,371  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2}
2024-04-23T21:10:31,371  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_773b3686-9fc0-44ff-a4ab-81cc3e62f816); Time taken: 0.008 seconds
2024-04-23T21:10:31,372  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423211031_773b3686-9fc0-44ff-a4ab-81cc3e62f816
2024-04-23T21:10:31,372  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:31,372  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_773b3686-9fc0-44ff-a4ab-81cc3e62f816): drop table if exists nonAcidNonBucket
2024-04-23T21:10:31,372  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:31,376  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,376  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,376  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_773b3686-9fc0-44ff-a4ab-81cc3e62f816); Time taken: 0.004 seconds
2024-04-23T21:10:31,377  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_773b3686-9fc0-44ff-a4ab-81cc3e62f816
2024-04-23T21:10:31,383  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:10:31,390  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,390  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:10:31,391  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,391  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_4043ff29-43e4-4ee0-998e-0ebca25f7427): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,394  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:10:31,395  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:10:31,396  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:31,396  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:31,402  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:10:31,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:31,404  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:31,404  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,404  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,405  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,405  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=14, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=6, getValidTxns_(long)=1}
2024-04-23T21:10:31,405  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_4043ff29-43e4-4ee0-998e-0ebca25f7427); Time taken: 0.014 seconds
2024-04-23T21:10:31,405  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423211031_4043ff29-43e4-4ee0-998e-0ebca25f7427
2024-04-23T21:10:31,405  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211031_4043ff29-43e4-4ee0-998e-0ebca25f7427
2024-04-23T21:10:31,438  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211031_4043ff29-43e4-4ee0-998e-0ebca25f7427 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:10:31,438  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:31,439  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_4043ff29-43e4-4ee0-998e-0ebca25f7427): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,439  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,441  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931831, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=true, totalSize=0, numFilesErasureCoded=0, bucketing_version=2, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:31,448  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtbl
2024-04-23T21:10:31,518  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,518  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=77}
2024-04-23T21:10:31,518  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_4043ff29-43e4-4ee0-998e-0ebca25f7427); Time taken: 0.078 seconds
2024-04-23T21:10:31,518  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_4043ff29-43e4-4ee0-998e-0ebca25f7427
2024-04-23T21:10:31,524  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:10:31,534  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,534  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:10:31,535  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,536  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_6ac53a36-f37b-4cd0-a513-334478fc0a13): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,541  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:10:31,541  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:10:31,542  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:31,542  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:31,546  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:10:31,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:31,550  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:31,550  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,550  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,550  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,550  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=17, getDatabase_(String)=4, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, openTxn_(String, TxnType)=4, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,550  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_6ac53a36-f37b-4cd0-a513-334478fc0a13); Time taken: 0.014 seconds
2024-04-23T21:10:31,551  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423211031_6ac53a36-f37b-4cd0-a513-334478fc0a13
2024-04-23T21:10:31,551  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211031_6ac53a36-f37b-4cd0-a513-334478fc0a13
2024-04-23T21:10:31,576  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211031_6ac53a36-f37b-4cd0-a513-334478fc0a13 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:10:31,576  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:31,578  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_6ac53a36-f37b-4cd0-a513-334478fc0a13): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,578  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,579  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931831, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:31,590  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtblpart
2024-04-23T21:10:31,620  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,620  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=40, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,620  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_6ac53a36-f37b-4cd0-a513-334478fc0a13); Time taken: 0.042 seconds
2024-04-23T21:10:31,620  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_6ac53a36-f37b-4cd0-a513-334478fc0a13
2024-04-23T21:10:31,626  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:10:31,637  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,637  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:10:31,638  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,638  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_14ee45d4-6810-473b-b69c-0ef44d8a26dd): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,643  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:10:31,643  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:10:31,644  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:31,644  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:31,648  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:10:31,649  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:31,652  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:31,652  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,652  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,652  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,652  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=16, getDatabase_(String)=3, isCompatibleWith_(Configuration)=3, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=3, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:10:31,652  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_14ee45d4-6810-473b-b69c-0ef44d8a26dd); Time taken: 0.014 seconds
2024-04-23T21:10:31,653  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423211031_14ee45d4-6810-473b-b69c-0ef44d8a26dd
2024-04-23T21:10:31,653  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211031_14ee45d4-6810-473b-b69c-0ef44d8a26dd
2024-04-23T21:10:31,679  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211031_14ee45d4-6810-473b-b69c-0ef44d8a26dd LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:10:31,679  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:31,679  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_14ee45d4-6810-473b-b69c-0ef44d8a26dd): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,679  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,681  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931831, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, bucketing_version=2, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numFilesErasureCoded=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:31,692  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl
2024-04-23T21:10:31,714  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,715  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=34, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,715  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_14ee45d4-6810-473b-b69c-0ef44d8a26dd); Time taken: 0.035 seconds
2024-04-23T21:10:31,715  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_14ee45d4-6810-473b-b69c-0ef44d8a26dd
2024-04-23T21:10:31,721  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:10:31,732  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,732  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:10:31,733  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,734  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_ddc0a1f9-d95f-493b-942c-c09f94605e0d): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,738  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:10:31,739  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:10:31,740  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:31,740  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:31,744  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:10:31,745  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:31,748  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:31,748  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,748  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,748  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,748  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, getDatabase_(String)=3, isCompatibleWith_(Configuration)=0, flushCache_()=1, commitTxn_(CommitTxnRequest)=18, getValidWriteIds_(List, String)=4, getValidTxns_(long)=1}
2024-04-23T21:10:31,748  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_ddc0a1f9-d95f-493b-942c-c09f94605e0d); Time taken: 0.014 seconds
2024-04-23T21:10:31,749  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423211031_ddc0a1f9-d95f-493b-942c-c09f94605e0d
2024-04-23T21:10:31,749  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211031_ddc0a1f9-d95f-493b-942c-c09f94605e0d
2024-04-23T21:10:31,777  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211031_ddc0a1f9-d95f-493b-942c-c09f94605e0d LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:10:31,777  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:31,777  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_ddc0a1f9-d95f-493b-942c-c09f94605e0d): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,778  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,779  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931831, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, numFiles=0, totalSize=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numRows=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:31,790  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl2
2024-04-23T21:10:31,821  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,821  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=41, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:31,821  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_ddc0a1f9-d95f-493b-942c-c09f94605e0d); Time taken: 0.044 seconds
2024-04-23T21:10:31,821  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_ddc0a1f9-d95f-493b-942c-c09f94605e0d
2024-04-23T21:10:31,828  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:10:31,839  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,839  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:10:31,840  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,840  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_b4438088-4144-48a6-b18c-db6e5f698fd3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,844  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:10:31,844  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:10:31,845  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:31,845  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:31,848  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:10:31,849  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:31,851  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:31,851  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,851  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,851  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,851  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=17, flushCache_()=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2}
2024-04-23T21:10:31,851  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_b4438088-4144-48a6-b18c-db6e5f698fd3); Time taken: 0.011 seconds
2024-04-23T21:10:31,852  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423211031_b4438088-4144-48a6-b18c-db6e5f698fd3
2024-04-23T21:10:31,852  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211031_b4438088-4144-48a6-b18c-db6e5f698fd3
2024-04-23T21:10:31,870  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211031_b4438088-4144-48a6-b18c-db6e5f698fd3 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:10:31,870  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:31,871  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_b4438088-4144-48a6-b18c-db6e5f698fd3): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:31,872  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,873  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/40d10671-0466-4ee6-9325-427a862b0433/_tmp_space.db/c6667cca-3cd0-4f46-91e2-9f2f389daa48
2024-04-23T21:10:31,876  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,876  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T21:10:31,877  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_b4438088-4144-48a6-b18c-db6e5f698fd3); Time taken: 0.005 seconds
2024-04-23T21:10:31,877  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_b4438088-4144-48a6-b18c-db6e5f698fd3
2024-04-23T21:10:31,882  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:10:31,889  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,889  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:10:31,890  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,890  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_d95af00b-9c3b-4365-a69b-17f1ce66b414): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,893  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:10:31,894  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:10:31,894  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:31,894  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:31,897  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:10:31,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:31,899  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:31,899  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:31,900  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:31,900  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:31,900  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T21:10:31,900  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_d95af00b-9c3b-4365-a69b-17f1ce66b414); Time taken: 0.01 seconds
2024-04-23T21:10:31,900  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423211031_d95af00b-9c3b-4365-a69b-17f1ce66b414
2024-04-23T21:10:31,900  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211031_d95af00b-9c3b-4365-a69b-17f1ce66b414
2024-04-23T21:10:31,919  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211031_d95af00b-9c3b-4365-a69b-17f1ce66b414 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:10:31,919  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:31,919  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_d95af00b-9c3b-4365-a69b-17f1ce66b414): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:31,920  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:31,921  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931831, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numRows=0, totalSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, rawDataSize=0, transactional=false, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:31,930  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidnonbucket
2024-04-23T21:10:31,952  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:31,952  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=32}
2024-04-23T21:10:31,952  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_d95af00b-9c3b-4365-a69b-17f1ce66b414); Time taken: 0.033 seconds
2024-04-23T21:10:31,953  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_d95af00b-9c3b-4365-a69b-17f1ce66b414
2024-04-23T21:10:31,959  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:10:31,970  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:31,970  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:10:31,971  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:10:31,972  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211031_f33151ed-59c8-45e5-8ed3-978942174d01): drop table if exists T
2024-04-23T21:10:31,975  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:10:31,976  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:10:31,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:32,022  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,022  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:32,022  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:32,022  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:32,023  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=45, commitTxn_(CommitTxnRequest)=18, flushCache_()=0, openTxn_(String, TxnType)=4}
2024-04-23T21:10:32,023  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211031_f33151ed-59c8-45e5-8ed3-978942174d01); Time taken: 0.05 seconds
2024-04-23T21:10:32,023  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423211031_f33151ed-59c8-45e5-8ed3-978942174d01
2024-04-23T21:10:32,024  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211031_f33151ed-59c8-45e5-8ed3-978942174d01
2024-04-23T21:10:32,047  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211031_f33151ed-59c8-45e5-8ed3-978942174d01 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:10:32,047  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:32,047  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211031_f33151ed-59c8-45e5-8ed3-978942174d01): drop table if exists T
2024-04-23T21:10:32,047  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:32,048  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:32,059  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:32,071  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,071  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T21:10:32,256  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t does not exist; Force to delete it.
2024-04-23T21:10:32,256 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:32,256  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:32,256  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=197, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=11}
2024-04-23T21:10:32,256  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211031_f33151ed-59c8-45e5-8ed3-978942174d01); Time taken: 0.209 seconds
2024-04-23T21:10:32,256  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211031_f33151ed-59c8-45e5-8ed3-978942174d01
2024-04-23T21:10:32,261  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:10:32,270  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:32,272  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:10:32,272  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T21:10:32,273  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211032_801be220-f893-44df-8553-2a66ba36deff): drop table if exists Tstage
2024-04-23T21:10:32,284  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 3
2024-04-23T21:10:32,284  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:10:32,287  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:32,300  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,301  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:32,301  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:32,301  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:32,301  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=10, getTable_(GetTableRequest)=14, getValidTxns_(long)=3, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=15}
2024-04-23T21:10:32,301  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211032_801be220-f893-44df-8553-2a66ba36deff); Time taken: 0.028 seconds
2024-04-23T21:10:32,301  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423211032_801be220-f893-44df-8553-2a66ba36deff
2024-04-23T21:10:32,302  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211032_801be220-f893-44df-8553-2a66ba36deff
2024-04-23T21:10:32,322  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211032_801be220-f893-44df-8553-2a66ba36deff LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:10:32,322  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:32,322  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211032_801be220-f893-44df-8553-2a66ba36deff): drop table if exists Tstage
2024-04-23T21:10:32,322  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:32,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:32,334  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,334  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:32,346  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,347  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T21:10:32,394  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage does not exist; Force to delete it.
2024-04-23T21:10:32,394 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:32,394  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:32,394  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=60, getTable_(GetTableRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:32,395  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211032_801be220-f893-44df-8553-2a66ba36deff); Time taken: 0.072 seconds
2024-04-23T21:10:32,395  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211032_801be220-f893-44df-8553-2a66ba36deff
2024-04-23T21:10:32,400  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:10:32,408  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:32,408  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:10:32,409  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:32,409  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211032_fc876763-6c9c-4d65-b8dd-cc2303738761): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:32,412  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 8
2024-04-23T21:10:32,413  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:10:32,414  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:32,414  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:32,421  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:10:32,421  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:32,424  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:32,424  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:32,424  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:32,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:32,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=3, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=7}
2024-04-23T21:10:32,425  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211032_fc876763-6c9c-4d65-b8dd-cc2303738761); Time taken: 0.015 seconds
2024-04-23T21:10:32,425  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423211032_fc876763-6c9c-4d65-b8dd-cc2303738761
2024-04-23T21:10:32,425  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211032_fc876763-6c9c-4d65-b8dd-cc2303738761
2024-04-23T21:10:32,451  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211032_fc876763-6c9c-4d65-b8dd-cc2303738761 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:10:32,451  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:32,452  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211032_fc876763-6c9c-4d65-b8dd-cc2303738761): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:32,452  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:32,453  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931832, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:32,462  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:32,510  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:32,510  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=56}
2024-04-23T21:10:32,510  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211032_fc876763-6c9c-4d65-b8dd-cc2303738761); Time taken: 0.057 seconds
2024-04-23T21:10:32,510  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211032_fc876763-6c9c-4d65-b8dd-cc2303738761
2024-04-23T21:10:32,515  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:10:32,523  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:32,523  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:10:32,524  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:32,524  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211032_accbda37-6e9b-4d13-8935-d8de54be4dcc): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:32,528  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 8
2024-04-23T21:10:32,528  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:10:32,529  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:32,529  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:32,533  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T21:10:32,534  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:32,536  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:32,536  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:32,536  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:32,536  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:32,537  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=4, flushCache_()=0, getDatabase_(String)=3, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:10:32,537  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211032_accbda37-6e9b-4d13-8935-d8de54be4dcc); Time taken: 0.012 seconds
2024-04-23T21:10:32,537  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423211032_accbda37-6e9b-4d13-8935-d8de54be4dcc
2024-04-23T21:10:32,538  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211032_accbda37-6e9b-4d13-8935-d8de54be4dcc
2024-04-23T21:10:32,557  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211032_accbda37-6e9b-4d13-8935-d8de54be4dcc LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:10:32,557  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:32,557  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211032_accbda37-6e9b-4d13-8935-d8de54be4dcc): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:32,558  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:32,560  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713931832, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, totalSize=0, numRows=0, numFilesErasureCoded=0, numFiles=0, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:32,567  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:32,586  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:32,586  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=27, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:32,587  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211032_accbda37-6e9b-4d13-8935-d8de54be4dcc); Time taken: 0.029 seconds
2024-04-23T21:10:32,587  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211032_accbda37-6e9b-4d13-8935-d8de54be4dcc
2024-04-23T21:10:32,591  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:10:32,600  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:32,600  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:10:32,601  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:32,601  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521): insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:32,605  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 9
2024-04-23T21:10:32,605  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:10:32,606  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:32,606  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:32,611  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:32,624  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,624  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:32,624  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:32,624  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:32,624  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:32,625  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:32,636  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,636  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:32,636  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:10:32,659  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:32,751  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:32,751  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:32,751  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:32,752  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:32,756  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:32,756  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:32,756  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:32,756  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:32,769  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,772  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1
2024-04-23T21:10:32,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:32,777  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:32,779  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:32,782  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:32,782  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:32,792  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:32,804  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,804  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T21:10:32,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:32,817  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:32,819  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:32,819  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:10:32,819  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:32,819  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:32,819  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:32,819  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:10:32,819  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:10:32,821  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:32,821  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:32,821  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:32,821  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:10:32,821  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:32,821  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCheckConstraints_(CheckConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=6, flushCache_()=0, getAllTableConstraints_(AllTableConstraintsRequest)=34, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, getNotNullConstraints_(NotNullConstraintsRequest)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=64}
2024-04-23T21:10:32,821  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521); Time taken: 0.22 seconds
2024-04-23T21:10:32,822  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521
2024-04-23T21:10:32,822  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521
2024-04-23T21:10:32,840  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:10:32,840  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:32,840  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521): insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:32,842  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521
2024-04-23T21:10:32,842  INFO [main] ql.Driver: Query ID = alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521
Total jobs = 1
2024-04-23T21:10:32,842  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:32,842  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:32,971  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:10:32,971  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:10:32,974  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:32,974  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:10:32,974  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-32_601_4658595818272931544-1/dummy_path
2024-04-23T21:10:32,985  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:32,986  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,11KB
2024-04-23T21:10:32,987  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:32,991  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-32_601_4658595818272931544-1/-mr-10001
2024-04-23T21:10:32,996  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:33,004  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:33,009  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:33,010  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:10:33,010  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:10:33,010  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-32_601_4658595818272931544-1/dummy_path
2024-04-23T21:10:33,011  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:10:33,032  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:10:33,055  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1174233823_0004
2024-04-23T21:10:33,055  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:33,120  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:33,120  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:33,121  INFO [Thread-359] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:33,121  INFO [Thread-359] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:33,123  INFO [Thread-359] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:33,123  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1174233823_0004_m_000000_0
2024-04-23T21:10:33,126  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:33,126  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-32_601_4658595818272931544-1/dummy_path/null:0+1
2024-04-23T21:10:33,129  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:33,130  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,11KB
2024-04-23T21:10:33,130  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:10:33,133  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:33,133  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:33,134  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:33,134  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:33,134  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:10:33,134  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:10:33,134  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:33,134  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:10:33,135  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:33,135  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1174233823_0004/job_local1174233823_0004.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3c78e12b
2024-04-23T21:10:33,136  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:33,136  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:33,136  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:33,138  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:33,138  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:10:33,145  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:10:33,146  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:10:33,147  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:33,147  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:33,147  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:33,147  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:33,147  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:10:33,157  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_1_default.tstage:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:33,158  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:33,161  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1174233823_0004_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:33,161  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:10:33,161  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1174233823_0004_m_000000_0' done.
2024-04-23T21:10:33,162  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1174233823_0004_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=88104
		FILE: Number of bytes written=4752947
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=999292928
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6168
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:33,162  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1174233823_0004_m_000000_0
2024-04-23T21:10:33,162  INFO [Thread-359] mapred.LocalJobRunner: map task executor complete.
2024-04-23 21:10:34,123 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:10:34,123  INFO [main] exec.Task: 2024-04-23 21:10:34,123 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1174233823_0004
2024-04-23T21:10:34,123  INFO [main] exec.Task: Ended Job = job_local1174233823_0004
2024-04-23T21:10:34,125  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T21:10:34,125  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T21:10:34,125  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T21:10:34,125  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T21:10:34,125  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/-ext-10000
2024-04-23T21:10:34,126  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/-ext-10002
2024-04-23T21:10:34,126  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T21:10:34,126  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1/-ext-10000
2024-04-23T21:10:34,126  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:34,137  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:34,153  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,156  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:34,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:34,207  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:10:34,207  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:34,218  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,218  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:10:34,218  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-32_601_4658595818272931544-1/-mr-10001
2024-04-23T21:10:34,220  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:34,230  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,231  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T21:10:34,231  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T21:10:34,232  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:34,232  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:34,260  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T21:10:34,261  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:34,261  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=49, alter_table_(String, String, String, Table, EnvironmentContext, String)=78, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T21:10:34,261  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:34,262  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:34,262  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:34,262  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521); Time taken: 1.421 seconds
2024-04-23T21:10:34,262  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211032_6e358a4e-ade7-405a-9dd3-b1523b1e6521
2024-04-23T21:10:34,266  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:10:34,272  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:34,272  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:10:34,273  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:34,273  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-32_601_4658595818272931544-1
2024-04-23T21:10:34,274  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-32_601_4658595818272931544-1 on fs with scheme file
2024-04-23T21:10:34,274  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1
2024-04-23T21:10:34,274  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-32_601_4658595818272931544-1 on fs with scheme file
2024-04-23T21:10:34,274  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211034_38140f53-dcca-4976-93ae-b8949a33ff81): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:34,275  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:34,285  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,288  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:10:34,288  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:10:34,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:34,303  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,303  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:34,303  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:34,303  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:34,303  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:34,304  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:34,304  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:34,304  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:34,304  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getCurrentNotificationEventId_()=3, getTable_(GetTableRequest)=21, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T21:10:34,304  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211034_38140f53-dcca-4976-93ae-b8949a33ff81); Time taken: 0.03 seconds
2024-04-23T21:10:34,305  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423211034_38140f53-dcca-4976-93ae-b8949a33ff81
2024-04-23T21:10:34,305  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211034_38140f53-dcca-4976-93ae-b8949a33ff81
2024-04-23T21:10:34,322  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211034_38140f53-dcca-4976-93ae-b8949a33ff81 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:10:34,322  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:34,322  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211034_38140f53-dcca-4976-93ae-b8949a33ff81): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:34,323  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:34,323  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:34,323  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:34,323  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:34,323  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:34,334  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:34,339  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:34,339  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:34,339  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211034_38140f53-dcca-4976-93ae-b8949a33ff81); Time taken: 0.017 seconds
2024-04-23T21:10:34,339  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211034_38140f53-dcca-4976-93ae-b8949a33ff81
2024-04-23T21:10:34,344  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:10:34,470  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:34,470  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:10:34,471  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:34,471  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211034_495971a4-0522-4687-ab52-2833e2244d59): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:34,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:34,502  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,505  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:10:34,505  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:10:34,507  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:34,520  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,520  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:34,520  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:34,520  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:34,520  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:34,521  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:34,521  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:34,521  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:34,521  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, getCurrentNotificationEventId_()=1, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=130, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=43}
2024-04-23T21:10:34,521  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211034_495971a4-0522-4687-ab52-2833e2244d59); Time taken: 0.05 seconds
2024-04-23T21:10:34,522  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423211034_495971a4-0522-4687-ab52-2833e2244d59
2024-04-23T21:10:34,523  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211034_495971a4-0522-4687-ab52-2833e2244d59
2024-04-23T21:10:34,546  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211034_495971a4-0522-4687-ab52-2833e2244d59 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:10:34,546  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:34,546  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211034_495971a4-0522-4687-ab52-2833e2244d59): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:34,546  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:34,546  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:34,546  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:34,546  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:34,546  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:34,558  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:34,564  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:34,564  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:34,564  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211034_495971a4-0522-4687-ab52-2833e2244d59); Time taken: 0.018 seconds
2024-04-23T21:10:34,565  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211034_495971a4-0522-4687-ab52-2833e2244d59
2024-04-23T21:10:34,569  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:10:34,574  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:34,575  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:10:34,575  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:34,576  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211034_1ed6f5d6-57c7-4d04-b710-aa82256e3c60): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:34,579  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:10:34,580  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:10:34,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:34,589  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,600  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T21:10:34,601  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-23T21:10:34,603  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:34,603  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:34,603  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:34,604  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=9, allocateTableWriteId_(long, String, String)=9, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=1}
2024-04-23T21:10:34,604  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211034_1ed6f5d6-57c7-4d04-b710-aa82256e3c60); Time taken: 0.027 seconds
2024-04-23T21:10:34,604  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423211034_1ed6f5d6-57c7-4d04-b710-aa82256e3c60
2024-04-23T21:10:34,604  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211034_1ed6f5d6-57c7-4d04-b710-aa82256e3c60
2024-04-23T21:10:34,623  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211034_1ed6f5d6-57c7-4d04-b710-aa82256e3c60 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:10:34,623  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:34,627  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211034_1ed6f5d6-57c7-4d04-b710-aa82256e3c60): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:34,628  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:34,628  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:34,637  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,637  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:34,653  INFO [HMSHandler #5] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1
2024-04-23T21:10:34,653  INFO [HMSHandler #4] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:34,653  INFO [HMSHandler #6] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2
2024-04-23T21:10:34,692  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T21:10:34,693  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data
2024-04-23T21:10:34,693  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:34,701  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,701  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:34,720  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T21:10:34,720  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:34,720  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:34,728  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,729  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:34,742  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T21:10:34,747  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:34,747  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T21:10:34,785  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:34,811  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:34,824  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-23T21:10:34,824  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data
2024-04-23T21:10:34,824  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:34,834  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:34,849  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T21:10:34,849  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:34,850  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:34,859  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,860  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:34,874  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-23T21:10:34,879  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:34,879  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T21:10:34,916  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:34,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:34,946  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:34,946  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=119, getPartitionWithAuthInfo_(String, String, List, String, List)=85, validatePartitionNameCharacters_(List)=1, getValidWriteIds_(List, String)=0, add_partitions_(List, boolean, boolean)=55, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=45}
2024-04-23T21:10:34,946  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211034_1ed6f5d6-57c7-4d04-b710-aa82256e3c60); Time taken: 0.319 seconds
2024-04-23T21:10:34,946  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211034_1ed6f5d6-57c7-4d04-b710-aa82256e3c60
2024-04-23T21:10:34,951  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:10:34,958  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:34,959  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:10:34,960  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:34,960  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:34,964  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T21:10:34,964  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:10:34,967  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:34,967  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:34,974  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:34,974  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:34,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:34,983  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:34,984  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:34,984  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:34,984  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:34,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:35,037  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:35,038  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:35,081  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:35,092  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:35,092  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:35,109  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:35,109  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:35,160  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:35,160  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:35,160  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:35,162  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-34_960_6156170309207821754-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-34_960_6156170309207821754-1
2024-04-23T21:10:35,170  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:35,175  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col2=Column[_col4], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3]}
2024-04-23T21:10:35,175  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4]}
2024-04-23T21:10:35,176  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:35,177  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:35,192  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:35,192  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:35,193  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:35,193  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:35,193  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:35,194  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:35,194  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:35,194  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:35,194  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:35,194  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T21:10:35,196  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T21:10:35,196  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:35,196  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=33, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=27, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=10, getValidTxns_(long)=3, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3, getValidWriteIds_(List, String)=7, listPartitions_(String, String, short)=30}
2024-04-23T21:10:35,196  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2); Time taken: 0.236 seconds
2024-04-23T21:10:35,197  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2
2024-04-23T21:10:35,198  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2
2024-04-23T21:10:35,219  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:10:35,219  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:35,220  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:35,220  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2
2024-04-23T21:10:35,220  INFO [main] ql.Driver: Query ID = alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2
Total jobs = 1
2024-04-23T21:10:35,220  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:35,220  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:35,360  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:10:35,360  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:35,360  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:35,360  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:35,360  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:35,360  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:35,360  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:35,360  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:35,362  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:35,362  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:10:35,362  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:35,370  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-34_960_6156170309207821754-1/-mr-10004/1abf6104-4793-4482-8557-abd159888052 (false)
2024-04-23T21:10:35,379  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:35,380  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,08KB
2024-04-23T21:10:35,385  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:35,386  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T21:10:35,387  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:35,393  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:35,400  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:35,405  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:35,406  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:10:35,406  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:10:35,406  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:35,406  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:10:35,406  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:10:35,406  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:10:35,416  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:10:35,417  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 11 ms
2024-04-23T21:10:35,417  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T21:10:35,436  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T21:10:35,464  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1116519271_0005
2024-04-23T21:10:35,464  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:35,525  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:35,525  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:35,526  INFO [Thread-434] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:35,526  INFO [Thread-434] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:35,528  INFO [Thread-434] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:35,528  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1116519271_0005_m_000000_0
2024-04-23T21:10:35,529  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:35,529  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:35,530  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:35,531  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-23T21:10:35,538  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T21:10:35,539  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:35,544  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T21:10:35,544  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:35,549  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:35,549  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:35,549  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:35,549  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:35,549  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:35,549  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:35,550  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:35,553  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:35,554  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:35,554  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:35,554  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T21:10:35,554  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:10:35,554  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:35,555  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:10:35,556  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:35,557  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:35,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:35,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:35,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T21:10:35,557  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:35,568  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:35,571  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1116519271_0005_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:35,572  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:35,572  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1116519271_0005_m_000000_0' done.
2024-04-23T21:10:35,572  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1116519271_0005_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=99234
		FILE: Number of bytes written=5945988
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1142947840
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7213
2024-04-23T21:10:35,572  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1116519271_0005_m_000000_0
2024-04-23T21:10:35,572  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1116519271_0005_m_000001_0
2024-04-23T21:10:35,573  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:35,573  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:35,574  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:35,575  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,08KB
2024-04-23T21:10:35,576  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T21:10:35,576  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:35,580  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T21:10:35,580  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:35,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:35,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:35,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:35,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:35,584  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:35,585  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:35,585  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:35,588  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:35,589  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:35,589  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:35,589  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T21:10:35,589  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:10:35,589  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:35,590  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:35,590  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:10:35,590  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:35,590  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:10:35,591  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:35,592  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:35,592  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:35,592  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:35,592  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T21:10:35,592  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:35,600  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:35,603  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1116519271_0005_m_000001_0 is done. And is in the process of committing
2024-04-23T21:10:35,604  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:35,604  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1116519271_0005_m_000001_0' done.
2024-04-23T21:10:35,604  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1116519271_0005_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=107456
		FILE: Number of bytes written=5946436
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1142947840
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7213
2024-04-23T21:10:35,604  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1116519271_0005_m_000001_0
2024-04-23T21:10:35,604  INFO [Thread-434] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:35,605  INFO [Thread-434] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:35,606  INFO [pool-30-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1116519271_0005_r_000000_0
2024-04-23T21:10:35,607  INFO [pool-30-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:35,607  INFO [pool-30-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@49104312
2024-04-23T21:10:35,607  WARN [pool-30-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:35,608  INFO [pool-30-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:35,609  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1116519271_0005_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:35,613  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local1116519271_0005_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-23T21:10:35,614  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1116519271_0005_m_000000_0
2024-04-23T21:10:35,614  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-23T21:10:35,616  INFO [localfetcher#3] reduce.LocalFetcher: localfetcher#3 about to shuffle output of map attempt_local1116519271_0005_m_000001_0 decomp: 412 len: 416 to MEMORY
2024-04-23T21:10:35,616  INFO [localfetcher#3] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1116519271_0005_m_000001_0
2024-04-23T21:10:35,617  INFO [localfetcher#3] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 2, commitMemory -> 412, usedMemory ->824
2024-04-23T21:10:35,617  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:35,617  INFO [pool-30-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:10:35,617  INFO [pool-30-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:35,624  INFO [pool-30-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T21:10:35,624  INFO [pool-30-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 750 bytes
2024-04-23T21:10:35,626  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 824 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:35,627  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merging 1 files, 826 bytes from disk
2024-04-23T21:10:35,627  INFO [pool-30-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:35,627  INFO [pool-30-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:35,627  INFO [pool-30-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 785 bytes
2024-04-23T21:10:35,627  INFO [pool-30-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:10:35,628  INFO [pool-30-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:35,628  INFO [pool-30-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T21:10:35,630  INFO [pool-30-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:35,630  INFO [pool-30-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:35,630  INFO [pool-30-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-23T21:10:35,630  INFO [pool-30-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:35,631  INFO [pool-30-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@ab422f5, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@47a2d9a9>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@2e7b3c32, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@5b9ffb6a
2024-04-23T21:10:35,632  INFO [pool-30-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-34_960_6156170309207821754-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-34_960_6156170309207821754-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:35,632  INFO [pool-30-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-34_960_6156170309207821754-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-34_960_6156170309207821754-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:35,632  INFO [pool-30-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-34_960_6156170309207821754-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-34_960_6156170309207821754-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:35,640  INFO [pool-30-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:35,641  INFO [pool-30-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:35,641  INFO [pool-30-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:35,641  INFO [pool-30-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:35,641  INFO [pool-30-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T21:10:35,642  INFO [pool-30-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_0:4, 
2024-04-23T21:10:35,642  INFO [pool-30-thread-1] mapred.Task: Task:attempt_local1116519271_0005_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:35,643  INFO [pool-30-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:35,643  INFO [pool-30-thread-1] mapred.Task: Task 'attempt_local1116519271_0005_r_000000_0' done.
2024-04-23T21:10:35,643  INFO [pool-30-thread-1] mapred.Task: Final Counters for attempt_local1116519271_0005_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=115459
		FILE: Number of bytes written=5948137
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=832
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1142947840
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:35,643  INFO [pool-30-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1116519271_0005_r_000000_0
2024-04-23T21:10:35,643  INFO [Thread-434] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:36,535 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:36,536  INFO [main] exec.Task: 2024-04-23 21:10:36,535 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1116519271_0005
2024-04-23T21:10:36,541  INFO [main] exec.Task: Ended Job = job_local1116519271_0005
2024-04-23T21:10:36,550  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:36,550  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:10:36,550  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:36,550  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:36,550  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:36,551  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2); Time taken: 1.33 seconds
2024-04-23T21:10:36,551  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211034_0195cefa-dd39-482b-b8a3-2440554e44d2
2024-04-23T21:10:36,556  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:10:36,564  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:36,564  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:10:36,570  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:10:36,572  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T21:10:36,572  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:36,572  WARN [main] ql.TestTxnAddPartition: addPartition: read data(add 2 parts w/data and 1 empty): 
2024-04-23T21:10:36,572  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0

2024-04-23T21:10:36,572  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:36,572  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-34_960_6156170309207821754-1
2024-04-23T21:10:36,573  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-34_960_6156170309207821754-1 on fs with scheme file
2024-04-23T21:10:36,574  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211036_1c2a16d7-3b9a-45ad-8c76-c320c32322d3): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:36,577  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T21:10:36,577  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:10:36,578  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:36,581  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:36,581  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:36,581  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:36,588  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:36,589  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:36,589  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:36,589  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:36,601  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:36,614  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:36,615  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:36,635  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:36,648  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:36,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:36,662  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-23T21:10:36,662  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-23T21:10:36,711  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:36,711  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:36,711  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:36,714  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:36,718  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], VALUE._col2=Column[_col4]}
2024-04-23T21:10:36,719  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], VALUE._col2=Column[_col4], KEY.reducesinkkey0=Column[_col1], VALUE._col0=Column[_col2]}
2024-04-23T21:10:36,720  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:36,734  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:36,743  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:36,744  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:36,744  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:36,744  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:36,744  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T21:10:36,744  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:36,745  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=7, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, getAllTableConstraints_(AllTableConstraintsRequest)=7, listPartitions_(String, String, short)=9, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=27, getValidTxns_(long)=0}
2024-04-23T21:10:36,745  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211036_1c2a16d7-3b9a-45ad-8c76-c320c32322d3); Time taken: 0.17 seconds
2024-04-23T21:10:36,745  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211036_1c2a16d7-3b9a-45ad-8c76-c320c32322d3): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:36,745  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T21:10:36,755  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:36,755  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:10:36,755  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211036_1c2a16d7-3b9a-45ad-8c76-c320c32322d3); Time taken: 0.01 seconds
2024-04-23T21:10:36,755  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:10:36,760  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:10:36,765  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:36,766  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:10:36,767  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:36,767  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-36_574_1594000996900485376-1
2024-04-23T21:10:36,767  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-36_574_1594000996900485376-1 on fs with scheme file
2024-04-23T21:10:36,768  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211036_b0999baa-18a3-4256-931e-79cafc4a8783): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:36,768  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:36,787  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:36,789  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T21:10:36,790  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:10:36,794  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:36,807  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:36,808  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:36,808  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:36,808  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:36,808  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:36,808  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:36,808  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:36,809  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:36,809  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=34, getCurrentNotificationEventId_()=3, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T21:10:36,809  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211036_b0999baa-18a3-4256-931e-79cafc4a8783); Time taken: 0.041 seconds
2024-04-23T21:10:36,809  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423211036_b0999baa-18a3-4256-931e-79cafc4a8783
2024-04-23T21:10:36,810  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211036_b0999baa-18a3-4256-931e-79cafc4a8783
2024-04-23T21:10:36,830  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211036_b0999baa-18a3-4256-931e-79cafc4a8783 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:10:36,830  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:36,830  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211036_b0999baa-18a3-4256-931e-79cafc4a8783): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:36,830  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:36,830  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:36,830  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:36,830  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:36,830  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:36,842  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:36,848  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:36,848  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:36,848  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211036_b0999baa-18a3-4256-931e-79cafc4a8783); Time taken: 0.017 seconds
2024-04-23T21:10:36,848  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211036_b0999baa-18a3-4256-931e-79cafc4a8783
2024-04-23T21:10:36,852  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:10:36,858  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:36,858  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:10:36,859  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211036_e7041e4e-6272-4452-9009-6ecd1efaa76d): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:36,863  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T21:10:36,863  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:10:36,864  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:36,876  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:36,890  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-23T21:10:36,890  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-23T21:10:36,892  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:36,892  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:36,892  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:36,892  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=12, allocateTableWriteId_(long, String, String)=13, getValidTxns_(long)=1}
2024-04-23T21:10:36,892  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211036_e7041e4e-6272-4452-9009-6ecd1efaa76d); Time taken: 0.033 seconds
2024-04-23T21:10:36,893  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423211036_e7041e4e-6272-4452-9009-6ecd1efaa76d
2024-04-23T21:10:36,893  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211036_e7041e4e-6272-4452-9009-6ecd1efaa76d
2024-04-23T21:10:36,914  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211036_e7041e4e-6272-4452-9009-6ecd1efaa76d LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T21:10:36,914  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:36,918  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211036_e7041e4e-6272-4452-9009-6ecd1efaa76d): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:36,919  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:36,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:36,926  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:36,927  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:36,944 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:10:36,944 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:10:36,945 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-23T21:10:36,946 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:70) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T21:10:36,947 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T21:10:36,947  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:36,947  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:36,947  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211036_e7041e4e-6272-4452-9009-6ecd1efaa76d); Time taken: 0.029 seconds
2024-04-23T21:10:36,948  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211036_e7041e4e-6272-4452-9009-6ecd1efaa76d
2024-04-23T21:10:36,949  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:36,956  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:36,956  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211036_0a18dda1-8eb7-4dd9-bcb2-8acc76666b30): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:36,965  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T21:10:36,965  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T21:10:36,968  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:36,976  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:36,978  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:36,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-23T21:10:37,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:37,030  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-23T21:10:37,030  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-23T21:10:37,030  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:37,031  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:37,031  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:37,031  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, getValidTxns_(long)=2, getPartitionWithAuthInfo_(String, String, List, String, List)=34, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=8, allocateTableWriteId_(long, String, String)=8, rollbackTxn_(long)=8}
2024-04-23T21:10:37,031  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211036_0a18dda1-8eb7-4dd9-bcb2-8acc76666b30); Time taken: 0.075 seconds
2024-04-23T21:10:37,031  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423211036_0a18dda1-8eb7-4dd9-bcb2-8acc76666b30
2024-04-23T21:10:37,031  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211036_0a18dda1-8eb7-4dd9-bcb2-8acc76666b30
2024-04-23T21:10:37,054  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211036_0a18dda1-8eb7-4dd9-bcb2-8acc76666b30 LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T21:10:37,054  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:37,064  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211036_0a18dda1-8eb7-4dd9-bcb2-8acc76666b30): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:37,064  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:37,065  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:37,075  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:37,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:37,086  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T21:10:37,089  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T21:10:37,091  INFO [HMSHandler #7] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3
2024-04-23T21:10:37,113  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-23T21:10:37,113  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data
2024-04-23T21:10:37,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:37,121  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:37,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:37,139  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-23T21:10:37,140  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:37,140  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:37,152  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:37,152  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:37,164  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-23T21:10:37,169  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:37,169  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-23T21:10:37,211  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:37,246  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:37,262  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:37,262  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=1, getPartitionWithAuthInfo_(String, String, List, String, List)=43, validatePartitionNameCharacters_(List)=1, getTable_(GetTableRequest)=30, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=77, isCompatibleWith_(Configuration)=1, add_partitions_(List, boolean, boolean)=37}
2024-04-23T21:10:37,262  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211036_0a18dda1-8eb7-4dd9-bcb2-8acc76666b30); Time taken: 0.198 seconds
2024-04-23T21:10:37,262  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211036_0a18dda1-8eb7-4dd9-bcb2-8acc76666b30
2024-04-23T21:10:37,268  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T21:10:37,277  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:37,279  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T21:10:37,280  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:37,281  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:37,285  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T21:10:37,286  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T21:10:37,287  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:37,287  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:37,295  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:37,295  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:37,297  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:37,308  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:37,309  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:37,309  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:37,309  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:37,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:37,358  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:37,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:37,402  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:37,411  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:37,411  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:37,428  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-23T21:10:37,428  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-23T21:10:37,481  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:37,481  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:37,481  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:37,484  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-37_281_8198046773495225554-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-37_281_8198046773495225554-1
2024-04-23T21:10:37,492  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:37,496  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], VALUE._col0=Column[_col2]}
2024-04-23T21:10:37,496  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col2=Column[_col4], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1]}
2024-04-23T21:10:37,497  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:37,499  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:37,511  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:37,512  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:37,513  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:37,513  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:37,513  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:37,513  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:37,513  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:37,513  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:37,513  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T21:10:37,514  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T21:10:37,514  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:37,514  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, commitTxn_(CommitTxnRequest)=18, flushCache_()=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=11, listPartitions_(String, String, short)=27, getAllTableConstraints_(AllTableConstraintsRequest)=29, getValidTxns_(long)=1, getAggrColStatsFor_(String, String, List, List, String, String)=25, getValidWriteIds_(List, String)=8}
2024-04-23T21:10:37,515  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8); Time taken: 0.233 seconds
2024-04-23T21:10:37,515  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8
2024-04-23T21:10:37,516  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8
2024-04-23T21:10:37,534  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T21:10:37,534  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:37,535  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:37,536  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8
2024-04-23T21:10:37,536  INFO [main] ql.Driver: Query ID = alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8
Total jobs = 1
2024-04-23T21:10:37,536  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:37,536  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:37,683  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:10:37,684  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:37,684  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:37,684  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:37,684  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:37,684  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:37,684  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:37,684  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:37,686  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:37,686  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:10:37,686  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:37,694  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-37_281_8198046773495225554-1/-mr-10004/f532bbe3-3128-4e08-a42a-d3baccdea4cb (false)
2024-04-23T21:10:37,704  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:37,705  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,43KB
2024-04-23T21:10:37,711  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:37,712  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T21:10:37,714  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:37,720  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:37,729  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:37,733  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:37,735  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:10:37,735  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:10:37,735  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:37,735  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:10:37,735  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: default 
2024-04-23T21:10:37,735  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:10:37,746  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-23T21:10:37,746  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 11 ms
2024-04-23T21:10:37,746  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-23T21:10:37,766  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-23T21:10:37,788  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1388404879_0006
2024-04-23T21:10:37,788  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:37,855  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:37,855  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:37,856  INFO [Thread-528] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:37,856  INFO [Thread-528] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:37,858  INFO [Thread-528] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:37,858  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1388404879_0006_m_000000_0
2024-04-23T21:10:37,859  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:37,859  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:37,860  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:37,861  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-23T21:10:37,862  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T21:10:37,862  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:37,866  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T21:10:37,866  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:37,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:37,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:37,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:37,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:37,871  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:37,872  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:37,872  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:37,874  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:37,875  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:37,875  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:37,875  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T21:10:37,875  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:10:37,875  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:37,876  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T21:10:37,877  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:10:37,877  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:10:37,877  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:37,877  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:37,877  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:37,877  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:37,877  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T21:10:37,877  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:37,888  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:37,891  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1388404879_0006_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:37,892  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:37,892  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1388404879_0006_m_000000_0' done.
2024-04-23T21:10:37,892  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1388404879_0006_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=130949
		FILE: Number of bytes written=7143235
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1120403456
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-23T21:10:37,892  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1388404879_0006_m_000000_0
2024-04-23T21:10:37,892  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1388404879_0006_m_000001_0
2024-04-23T21:10:37,893  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:37,893  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:37,894  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:37,895  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-23T21:10:37,897  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T21:10:37,897  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:37,902  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T21:10:37,902  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:37,908  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:37,909  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:37,909  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:37,909  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:37,909  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:37,909  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:37,909  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:37,912  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:37,913  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:37,913  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:37,913  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T21:10:37,913  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:10:37,913  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:37,914  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:37,914  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:10:37,914  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:37,914  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:37,914  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:10:37,914  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-23T21:10:37,914  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:37,914  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:37,915  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:37,915  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:37,915  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:10:37,915  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:10:37,915  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:37,915  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:37,916  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:37,916  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:37,916  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T21:10:37,916  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:37,924  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:37,928  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1388404879_0006_m_000001_0 is done. And is in the process of committing
2024-04-23T21:10:37,928  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:37,928  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1388404879_0006_m_000001_0' done.
2024-04-23T21:10:37,928  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1388404879_0006_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=140021
		FILE: Number of bytes written=7143683
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1120403456
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-23T21:10:37,928  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1388404879_0006_m_000001_0
2024-04-23T21:10:37,929  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1388404879_0006_m_000002_0
2024-04-23T21:10:37,929  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:37,930  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:37,931  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:37,931  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,43KB
2024-04-23T21:10:37,933  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T21:10:37,933  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:37,937  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T21:10:37,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:37,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:37,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:37,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:37,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:37,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:37,943  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:37,944  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:37,946  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:37,947  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:37,947  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:37,947  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T21:10:37,947  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:10:37,947  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:37,947  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:37,948  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:10:37,948  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:37,948  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:37,948  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:10:37,948  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, DESERIALIZE_ERRORS:0, 
2024-04-23T21:10:37,948  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:37,948  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:37,948  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T21:10:37,949  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:37,958  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:37,962  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1388404879_0006_m_000002_0 is done. And is in the process of committing
2024-04-23T21:10:37,963  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:37,963  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1388404879_0006_m_000002_0' done.
2024-04-23T21:10:37,963  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1388404879_0006_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=148581
		FILE: Number of bytes written=7144131
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1120403456
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7566
2024-04-23T21:10:37,963  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1388404879_0006_m_000002_0
2024-04-23T21:10:37,963  INFO [Thread-528] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:37,964  INFO [Thread-528] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:37,965  INFO [pool-34-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1388404879_0006_r_000000_0
2024-04-23T21:10:37,965  INFO [pool-34-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:37,966  INFO [pool-34-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@17d4f235
2024-04-23T21:10:37,966  WARN [pool-34-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:37,967  INFO [pool-34-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:37,967  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1388404879_0006_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:37,968  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local1388404879_0006_m_000002_0 decomp: 412 len: 416 to MEMORY
2024-04-23T21:10:37,968  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1388404879_0006_m_000002_0
2024-04-23T21:10:37,968  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-23T21:10:37,971  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local1388404879_0006_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-23T21:10:37,971  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1388404879_0006_m_000000_0
2024-04-23T21:10:37,971  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 2, commitMemory -> 412, usedMemory ->824
2024-04-23T21:10:37,973  INFO [localfetcher#4] reduce.LocalFetcher: localfetcher#4 about to shuffle output of map attempt_local1388404879_0006_m_000001_0 decomp: 412 len: 416 to MEMORY
2024-04-23T21:10:37,973  INFO [localfetcher#4] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local1388404879_0006_m_000001_0
2024-04-23T21:10:37,973  INFO [localfetcher#4] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 3, commitMemory -> 824, usedMemory ->1236
2024-04-23T21:10:37,974  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:37,974  INFO [pool-34-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T21:10:37,974  INFO [pool-34-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:37,981  INFO [pool-34-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-23T21:10:37,981  INFO [pool-34-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 1125 bytes
2024-04-23T21:10:37,984  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 1236 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:37,984  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merging 1 files, 1236 bytes from disk
2024-04-23T21:10:37,984  INFO [pool-34-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:37,984  INFO [pool-34-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:37,984  INFO [pool-34-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 1195 bytes
2024-04-23T21:10:37,984  INFO [pool-34-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T21:10:37,985  INFO [pool-34-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:37,986  INFO [pool-34-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T21:10:37,987  INFO [pool-34-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:37,987  INFO [pool-34-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:37,987  INFO [pool-34-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-23T21:10:37,987  INFO [pool-34-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:37,988  INFO [pool-34-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@3288dd36, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@47a2d9a9>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@303342e8, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@27e89103
2024-04-23T21:10:37,988  INFO [pool-34-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-37_281_8198046773495225554-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-37_281_8198046773495225554-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:37,989  INFO [pool-34-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-37_281_8198046773495225554-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-37_281_8198046773495225554-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:37,989  INFO [pool-34-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-37_281_8198046773495225554-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-37_281_8198046773495225554-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:37,996  INFO [pool-34-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:37,997  INFO [pool-34-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:37,997  INFO [pool-34-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:37,997  INFO [pool-34-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:37,997  INFO [pool-34-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-23T21:10:37,997  INFO [pool-34-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_0:6, 
2024-04-23T21:10:37,998  INFO [pool-34-thread-1] mapred.Task: Task:attempt_local1388404879_0006_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:37,998  INFO [pool-34-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:37,999  INFO [pool-34-thread-1] mapred.Task: Task 'attempt_local1388404879_0006_r_000000_0' done.
2024-04-23T21:10:37,999  INFO [pool-34-thread-1] mapred.Task: Final Counters for attempt_local1388404879_0006_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=157443
		FILE: Number of bytes written=7146632
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=1248
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1120403456
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:37,999  INFO [pool-34-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1388404879_0006_r_000000_0
2024-04-23T21:10:37,999  INFO [Thread-528] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:38,865 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:38,865  INFO [main] exec.Task: 2024-04-23 21:10:38,865 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1388404879_0006
2024-04-23T21:10:38,867  INFO [main] exec.Task: Ended Job = job_local1388404879_0006
2024-04-23T21:10:38,869  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:38,869  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:10:38,869  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:38,870  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:38,870  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:38,870  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8); Time taken: 1.334 seconds
2024-04-23T21:10:38,870  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211037_a94798af-4966-4fa4-b610-b7803a5a48e8
2024-04-23T21:10:38,874  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T21:10:38,880  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:38,880  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T21:10:38,884  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:10:38,886  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T21:10:38,886  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:38,886  WARN [main] ql.TestTxnAddPartition: addPartition: read data(add 2 existing parts and 1 empty): 
2024-04-23T21:10:38,886  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
{"writeid":3,"bucketid":536870912,"rowid":0}	3	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0
{"writeid":3,"bucketid":536870912,"rowid":1}	3	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0

2024-04-23T21:10:38,886  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:38,886  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-37_281_8198046773495225554-1
2024-04-23T21:10:38,887  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-37_281_8198046773495225554-1 on fs with scheme file
2024-04-23T21:10:38,888  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211038_758e4f15-69f4-44ae-bd66-ee15607af033): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:38,894  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-23T21:10:38,894  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T21:10:38,896  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:38,899  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:38,899  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:38,900  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:38,908  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:38,909  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:38,909  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:38,909  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:38,922  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:38,934  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:38,935  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:38,962  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:38,971  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:38,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:38,981  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-23T21:10:38,982  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-23T21:10:39,029  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:39,029  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:39,029  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:39,031  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:39,034  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col0], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4]}
2024-04-23T21:10:39,034  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], VALUE._col2=Column[_col4], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1]}
2024-04-23T21:10:39,035  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:39,058  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:39,067  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:39,068  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:39,069  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:39,069  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,069  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T21:10:39,069  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,069  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=1, getAggrColStatsFor_(String, String, List, List, String, String)=20, getAllTableConstraints_(AllTableConstraintsRequest)=6, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=5, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0, listPartitions_(String, String, short)=9, flushCache_()=0}
2024-04-23T21:10:39,070  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211038_758e4f15-69f4-44ae-bd66-ee15607af033); Time taken: 0.181 seconds
2024-04-23T21:10:39,070  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211038_758e4f15-69f4-44ae-bd66-ee15607af033): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:39,070  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T21:10:39,080  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,080  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:10:39,080  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211038_758e4f15-69f4-44ae-bd66-ee15607af033); Time taken: 0.01 seconds
2024-04-23T21:10:39,080  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:10:39,086  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T21:10:39,091  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,091  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T21:10:39,092  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:39,093  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-38_888_146837454496878668-1
2024-04-23T21:10:39,093  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/40d10671-0466-4ee6-9325-427a862b0433/hive_2024-04-23_21-10-38_888_146837454496878668-1 on fs with scheme file
2024-04-23T21:10:39,093  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_f49908c0-5bda-4e0a-a331-ab0d0617b3fa): drop table if exists acidTbl
2024-04-23T21:10:39,096  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-23T21:10:39,096  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T21:10:39,098  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:39,105  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,105  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,105  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,105  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,105  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1, flushCache_()=0, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,105  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_f49908c0-5bda-4e0a-a331-ab0d0617b3fa); Time taken: 0.012 seconds
2024-04-23T21:10:39,106  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423211039_f49908c0-5bda-4e0a-a331-ab0d0617b3fa
2024-04-23T21:10:39,106  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211039_f49908c0-5bda-4e0a-a331-ab0d0617b3fa
2024-04-23T21:10:39,120  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211039_f49908c0-5bda-4e0a-a331-ab0d0617b3fa LockResponse(lockid:20, state:ACQUIRED)
2024-04-23T21:10:39,121  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:39,121  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_f49908c0-5bda-4e0a-a331-ab0d0617b3fa): drop table if exists acidTbl
2024-04-23T21:10:39,121  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:39,128  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,128  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:39,135  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:39,247  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,247  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=119, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:10:39,248  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_f49908c0-5bda-4e0a-a331-ab0d0617b3fa); Time taken: 0.126 seconds
2024-04-23T21:10:39,248  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_f49908c0-5bda-4e0a-a331-ab0d0617b3fa
2024-04-23T21:10:39,252  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T21:10:39,258  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,258  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T21:10:39,259  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:39,259  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_ee1d6282-343a-428a-86e8-d3c93ae6667c): drop table if exists acidTblPart
2024-04-23T21:10:39,262  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-23T21:10:39,262  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-23T21:10:39,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:39,271  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,271  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,271  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,271  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,271  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T21:10:39,271  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_ee1d6282-343a-428a-86e8-d3c93ae6667c); Time taken: 0.012 seconds
2024-04-23T21:10:39,272  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240423211039_ee1d6282-343a-428a-86e8-d3c93ae6667c
2024-04-23T21:10:39,272  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211039_ee1d6282-343a-428a-86e8-d3c93ae6667c
2024-04-23T21:10:39,291  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211039_ee1d6282-343a-428a-86e8-d3c93ae6667c LockResponse(lockid:21, state:ACQUIRED)
2024-04-23T21:10:39,291  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:39,291  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_ee1d6282-343a-428a-86e8-d3c93ae6667c): drop table if exists acidTblPart
2024-04-23T21:10:39,292  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,292  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:39,300  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,300  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:39,308  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:39,361  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,361  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=61}
2024-04-23T21:10:39,361  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_ee1d6282-343a-428a-86e8-d3c93ae6667c); Time taken: 0.07 seconds
2024-04-23T21:10:39,361  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_ee1d6282-343a-428a-86e8-d3c93ae6667c
2024-04-23T21:10:39,366  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-23T21:10:39,373  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,373  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-23T21:10:39,374  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:39,374  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_215e9258-e41e-4e21-9dbe-3714ae92b6e3): drop table if exists acidTbl2
2024-04-23T21:10:39,377  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-23T21:10:39,377  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-23T21:10:39,378  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,378  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,378  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,378  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:10:39,379  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_215e9258-e41e-4e21-9dbe-3714ae92b6e3); Time taken: 0.004 seconds
2024-04-23T21:10:39,379  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240423211039_215e9258-e41e-4e21-9dbe-3714ae92b6e3
2024-04-23T21:10:39,379  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:39,379  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_215e9258-e41e-4e21-9dbe-3714ae92b6e3): drop table if exists acidTbl2
2024-04-23T21:10:39,379  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,380  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:10:39,380  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,380  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0, getTable_(GetTableRequest)=1}
2024-04-23T21:10:39,381  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_215e9258-e41e-4e21-9dbe-3714ae92b6e3); Time taken: 0.001 seconds
2024-04-23T21:10:39,381  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_215e9258-e41e-4e21-9dbe-3714ae92b6e3
2024-04-23T21:10:39,387  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-23T21:10:39,393  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,393  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-23T21:10:39,394  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:39,394  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_20b0eb2b-a1eb-431a-a3b1-c8f2915ef1d9): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:39,398  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-23T21:10:39,398  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-23T21:10:39,399  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:39,424  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,424  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,424  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,424  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,424  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=25, flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,424  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_20b0eb2b-a1eb-431a-a3b1-c8f2915ef1d9); Time taken: 0.03 seconds
2024-04-23T21:10:39,425  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240423211039_20b0eb2b-a1eb-431a-a3b1-c8f2915ef1d9
2024-04-23T21:10:39,425  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211039_20b0eb2b-a1eb-431a-a3b1-c8f2915ef1d9
2024-04-23T21:10:39,442  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211039_20b0eb2b-a1eb-431a-a3b1-c8f2915ef1d9 LockResponse(lockid:22, state:ACQUIRED)
2024-04-23T21:10:39,443  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:39,443  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_20b0eb2b-a1eb-431a-a3b1-c8f2915ef1d9): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:39,443  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,443  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:39,460  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,461  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:39,478  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,478  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:39,532  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,532  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=17, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=71}
2024-04-23T21:10:39,532  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_20b0eb2b-a1eb-431a-a3b1-c8f2915ef1d9); Time taken: 0.089 seconds
2024-04-23T21:10:39,532  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_20b0eb2b-a1eb-431a-a3b1-c8f2915ef1d9
2024-04-23T21:10:39,536  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-23T21:10:39,541  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,542  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-23T21:10:39,542  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:39,543  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_11818320-f3ea-44f2-854f-5ab400229216): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:39,546  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-23T21:10:39,546  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-23T21:10:39,547  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:39,557  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,557  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,557  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=10, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:39,557  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_11818320-f3ea-44f2-854f-5ab400229216); Time taken: 0.014 seconds
2024-04-23T21:10:39,558  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240423211039_11818320-f3ea-44f2-854f-5ab400229216
2024-04-23T21:10:39,558  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211039_11818320-f3ea-44f2-854f-5ab400229216
2024-04-23T21:10:39,573  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211039_11818320-f3ea-44f2-854f-5ab400229216 LockResponse(lockid:23, state:ACQUIRED)
2024-04-23T21:10:39,573  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:39,573  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_11818320-f3ea-44f2-854f-5ab400229216): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:39,573  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,574  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:39,583  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:39,593  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:39,629  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,630  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=46, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,630  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_11818320-f3ea-44f2-854f-5ab400229216); Time taken: 0.056 seconds
2024-04-23T21:10:39,630  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_11818320-f3ea-44f2-854f-5ab400229216
2024-04-23T21:10:39,634  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-23T21:10:39,640  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,640  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-23T21:10:39,641  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:39,641  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_d4794b20-4867-429a-a500-ace4a658551d): drop table if exists nonAcidNonBucket
2024-04-23T21:10:39,644  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-23T21:10:39,644  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-23T21:10:39,645  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:39,655  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,655  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,655  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,656  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,656  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:10:39,656  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_d4794b20-4867-429a-a500-ace4a658551d); Time taken: 0.015 seconds
2024-04-23T21:10:39,656  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240423211039_d4794b20-4867-429a-a500-ace4a658551d
2024-04-23T21:10:39,657  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211039_d4794b20-4867-429a-a500-ace4a658551d
2024-04-23T21:10:39,672  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211039_d4794b20-4867-429a-a500-ace4a658551d LockResponse(lockid:24, state:ACQUIRED)
2024-04-23T21:10:39,672  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:39,672  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_d4794b20-4867-429a-a500-ace4a658551d): drop table if exists nonAcidNonBucket
2024-04-23T21:10:39,672  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,673  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:39,683  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:39,693  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:39,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:39,731  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,732  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=11, dropTable_(String, String, boolean, boolean, boolean)=47, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,732  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_d4794b20-4867-429a-a500-ace4a658551d); Time taken: 0.059 seconds
2024-04-23T21:10:39,732  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_d4794b20-4867-429a-a500-ace4a658551d
2024-04-23T21:10:39,736  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-23T21:10:39,742  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,742  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-23T21:10:39,743  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:10:39,844  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:10:39,846  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = c2faa818-f42f-4bea-a1f2-7fc9b59ff71d
2024-04-23T21:10:39,849  INFO [main] SessionState: Hive Session ID = c2faa818-f42f-4bea-a1f2-7fc9b59ff71d
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:39,850  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:39,856  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d
2024-04-23T21:10:39,859  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d
2024-04-23T21:10:39,862  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/_tmp_space.db
2024-04-23T21:10:39,863  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=c2faa818-f42f-4bea-a1f2-7fc9b59ff71d, clientType=HIVECLI]
2024-04-23T21:10:39,863  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:39,864  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_a81ca59f-3061-46d3-8e4a-5820efcfd6d3): drop table if exists acidTbl
2024-04-23T21:10:39,874  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:10:39,874  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:10:39,877  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:39,880  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,880  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,880  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,880  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=10, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:10:39,881  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_a81ca59f-3061-46d3-8e4a-5820efcfd6d3); Time taken: 0.016 seconds
2024-04-23T21:10:39,881  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423211039_a81ca59f-3061-46d3-8e4a-5820efcfd6d3
2024-04-23T21:10:39,881  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:39,881  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_a81ca59f-3061-46d3-8e4a-5820efcfd6d3): drop table if exists acidTbl
2024-04-23T21:10:39,881  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,881  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:39,885  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,885  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,886  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_a81ca59f-3061-46d3-8e4a-5820efcfd6d3); Time taken: 0.004 seconds
2024-04-23T21:10:39,886  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_a81ca59f-3061-46d3-8e4a-5820efcfd6d3
2024-04-23T21:10:39,892  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:10:39,900  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,900  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:10:39,901  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:39,901  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_f00cfe9a-4886-4c03-b7b0-9fce42d622a7): drop table if exists acidTblPart
2024-04-23T21:10:39,904  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:10:39,905  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:10:39,906  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:39,912  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,913  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,913  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,913  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=3}
2024-04-23T21:10:39,913  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_f00cfe9a-4886-4c03-b7b0-9fce42d622a7); Time taken: 0.012 seconds
2024-04-23T21:10:39,914  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423211039_f00cfe9a-4886-4c03-b7b0-9fce42d622a7
2024-04-23T21:10:39,914  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:39,914  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_f00cfe9a-4886-4c03-b7b0-9fce42d622a7): drop table if exists acidTblPart
2024-04-23T21:10:39,914  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:39,920  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,920  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,921  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_f00cfe9a-4886-4c03-b7b0-9fce42d622a7); Time taken: 0.006 seconds
2024-04-23T21:10:39,921  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_f00cfe9a-4886-4c03-b7b0-9fce42d622a7
2024-04-23T21:10:39,929  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:10:39,935  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,936  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:10:39,936  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:39,937  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_90466530-08bb-4443-ab92-b26618724e2c): drop table if exists acidTbl2
2024-04-23T21:10:39,939  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:10:39,940  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:10:39,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:39,945  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,945  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,945  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,945  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=1}
2024-04-23T21:10:39,945  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_90466530-08bb-4443-ab92-b26618724e2c); Time taken: 0.008 seconds
2024-04-23T21:10:39,946  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423211039_90466530-08bb-4443-ab92-b26618724e2c
2024-04-23T21:10:39,946  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:39,946  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_90466530-08bb-4443-ab92-b26618724e2c): drop table if exists acidTbl2
2024-04-23T21:10:39,946  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:39,951  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,951  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,951  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_90466530-08bb-4443-ab92-b26618724e2c); Time taken: 0.005 seconds
2024-04-23T21:10:39,951  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_90466530-08bb-4443-ab92-b26618724e2c
2024-04-23T21:10:39,956  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:10:39,961  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,962  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:10:39,962  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:39,963  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_106cd8b1-9c48-4a35-9bed-8e30be8f5a50): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:39,965  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:10:39,966  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:10:39,966  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:39,969  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,970  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,970  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,970  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3}
2024-04-23T21:10:39,970  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_106cd8b1-9c48-4a35-9bed-8e30be8f5a50); Time taken: 0.007 seconds
2024-04-23T21:10:39,970  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423211039_106cd8b1-9c48-4a35-9bed-8e30be8f5a50
2024-04-23T21:10:39,970  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:39,970  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_106cd8b1-9c48-4a35-9bed-8e30be8f5a50): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:39,971  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,971  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:39,974  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,974  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,974  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_106cd8b1-9c48-4a35-9bed-8e30be8f5a50); Time taken: 0.004 seconds
2024-04-23T21:10:39,974  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_106cd8b1-9c48-4a35-9bed-8e30be8f5a50
2024-04-23T21:10:39,980  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:10:39,987  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:39,987  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:10:39,987  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:39,988  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211039_b6e39ccb-cbe1-444c-8bc2-173bd2ffac9e): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:39,990  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:10:39,990  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:10:39,991  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:39,994  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:39,995  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:39,995  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:39,995  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-23T21:10:39,995  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211039_b6e39ccb-cbe1-444c-8bc2-173bd2ffac9e); Time taken: 0.007 seconds
2024-04-23T21:10:39,995  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423211039_b6e39ccb-cbe1-444c-8bc2-173bd2ffac9e
2024-04-23T21:10:39,995  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:39,995  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211039_b6e39ccb-cbe1-444c-8bc2-173bd2ffac9e): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:39,996  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:39,996  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:39,999  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:39,999  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:39,999  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211039_b6e39ccb-cbe1-444c-8bc2-173bd2ffac9e); Time taken: 0.004 seconds
2024-04-23T21:10:39,999  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211039_b6e39ccb-cbe1-444c-8bc2-173bd2ffac9e
2024-04-23T21:10:40,004  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:10:40,010  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,010  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:10:40,011  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:40,012  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_4bb6bec0-d19c-4a3d-98ec-3410b0104f85): drop table if exists nonAcidNonBucket
2024-04-23T21:10:40,015  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:10:40,015  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:10:40,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:40,021  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,021  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,021  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,021  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, flushCache_()=0}
2024-04-23T21:10:40,022  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_4bb6bec0-d19c-4a3d-98ec-3410b0104f85); Time taken: 0.009 seconds
2024-04-23T21:10:40,022  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423211040_4bb6bec0-d19c-4a3d-98ec-3410b0104f85
2024-04-23T21:10:40,022  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:40,022  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_4bb6bec0-d19c-4a3d-98ec-3410b0104f85): drop table if exists nonAcidNonBucket
2024-04-23T21:10:40,022  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,023  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:40,027  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,027  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:40,028  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_4bb6bec0-d19c-4a3d-98ec-3410b0104f85); Time taken: 0.005 seconds
2024-04-23T21:10:40,028  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_4bb6bec0-d19c-4a3d-98ec-3410b0104f85
2024-04-23T21:10:40,033  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:10:40,038  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,038  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:10:40,039  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,040  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_961b1f89-113f-43ae-9c1a-db0332863c49): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,043  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:10:40,043  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:10:40,044  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,044  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,050  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:10:40,050  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:40,052  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:40,052  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,052  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,053  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,053  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=5}
2024-04-23T21:10:40,053  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_961b1f89-113f-43ae-9c1a-db0332863c49); Time taken: 0.012 seconds
2024-04-23T21:10:40,053  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423211040_961b1f89-113f-43ae-9c1a-db0332863c49
2024-04-23T21:10:40,054  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_961b1f89-113f-43ae-9c1a-db0332863c49
2024-04-23T21:10:40,075  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_961b1f89-113f-43ae-9c1a-db0332863c49 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:10:40,075  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:40,076  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_961b1f89-113f-43ae-9c1a-db0332863c49): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,076  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,077  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931840, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, bucketing_version=2, numRows=0, transactional=true, numFiles=0, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:40,083  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtbl
2024-04-23T21:10:40,129  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,129  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=52, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:40,130  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_961b1f89-113f-43ae-9c1a-db0332863c49); Time taken: 0.053 seconds
2024-04-23T21:10:40,130  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_961b1f89-113f-43ae-9c1a-db0332863c49
2024-04-23T21:10:40,134  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:10:40,141  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,141  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:10:40,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_bc2c7c26-a373-40ef-a058-45845aa0d42d): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,146  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:10:40,146  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:10:40,148  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,148  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,151  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:10:40,152  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:40,155  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:40,155  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,155  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,155  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,155  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3, getDatabase_(String)=3, getValidWriteIds_(List, String)=3, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0}
2024-04-23T21:10:40,155  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_bc2c7c26-a373-40ef-a058-45845aa0d42d); Time taken: 0.013 seconds
2024-04-23T21:10:40,156  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423211040_bc2c7c26-a373-40ef-a058-45845aa0d42d
2024-04-23T21:10:40,156  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_bc2c7c26-a373-40ef-a058-45845aa0d42d
2024-04-23T21:10:40,174  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_bc2c7c26-a373-40ef-a058-45845aa0d42d LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:10:40,174  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:40,175  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_bc2c7c26-a373-40ef-a058-45845aa0d42d): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,175  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,176  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931840, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:40,182  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtblpart
2024-04-23T21:10:40,204  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,204  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=28}
2024-04-23T21:10:40,204  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_bc2c7c26-a373-40ef-a058-45845aa0d42d); Time taken: 0.029 seconds
2024-04-23T21:10:40,204  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_bc2c7c26-a373-40ef-a058-45845aa0d42d
2024-04-23T21:10:40,208  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:10:40,219  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,219  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:10:40,220  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,220  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_cddda1a7-22e3-420e-89cf-8952057e346b): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,223  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:10:40,223  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:10:40,224  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,224  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,226  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:10:40,226  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:40,228  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:40,228  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,228  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,228  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,228  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=15, isCompatibleWith_(Configuration)=1, flushCache_()=0}
2024-04-23T21:10:40,228  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_cddda1a7-22e3-420e-89cf-8952057e346b); Time taken: 0.008 seconds
2024-04-23T21:10:40,229  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423211040_cddda1a7-22e3-420e-89cf-8952057e346b
2024-04-23T21:10:40,229  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_cddda1a7-22e3-420e-89cf-8952057e346b
2024-04-23T21:10:40,243  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_cddda1a7-22e3-420e-89cf-8952057e346b LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:10:40,243  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:40,243  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_cddda1a7-22e3-420e-89cf-8952057e346b): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,243  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931840, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, rawDataSize=0, bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:40,250  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl
2024-04-23T21:10:40,269  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,269  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=24}
2024-04-23T21:10:40,269  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_cddda1a7-22e3-420e-89cf-8952057e346b); Time taken: 0.026 seconds
2024-04-23T21:10:40,269  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_cddda1a7-22e3-420e-89cf-8952057e346b
2024-04-23T21:10:40,274  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:10:40,282  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,282  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:10:40,283  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,283  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_4eb53928-ce3f-4ee3-92b4-8aecc36ab1ff): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,287  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:10:40,287  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:10:40,288  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,288  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,291  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:10:40,291  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:40,293  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:40,293  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,293  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,293  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,293  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=3, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T21:10:40,293  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_4eb53928-ce3f-4ee3-92b4-8aecc36ab1ff); Time taken: 0.01 seconds
2024-04-23T21:10:40,293  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423211040_4eb53928-ce3f-4ee3-92b4-8aecc36ab1ff
2024-04-23T21:10:40,294  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_4eb53928-ce3f-4ee3-92b4-8aecc36ab1ff
2024-04-23T21:10:40,307  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_4eb53928-ce3f-4ee3-92b4-8aecc36ab1ff LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:10:40,308  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:40,308  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_4eb53928-ce3f-4ee3-92b4-8aecc36ab1ff): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,308  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931840, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numFiles=0, numRows=0, transactional=false, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:40,316  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl2
2024-04-23T21:10:40,332  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,332  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=23}
2024-04-23T21:10:40,332  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_4eb53928-ce3f-4ee3-92b4-8aecc36ab1ff); Time taken: 0.024 seconds
2024-04-23T21:10:40,332  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_4eb53928-ce3f-4ee3-92b4-8aecc36ab1ff
2024-04-23T21:10:40,336  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:10:40,341  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,341  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:10:40,342  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,342  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_6649d000-549c-4f8b-8ee9-3a32250b1d4f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,345  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:10:40,346  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:10:40,346  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,346  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,349  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:10:40,349  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:40,351  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:40,351  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,351  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,351  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,351  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2}
2024-04-23T21:10:40,351  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_6649d000-549c-4f8b-8ee9-3a32250b1d4f); Time taken: 0.009 seconds
2024-04-23T21:10:40,352  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423211040_6649d000-549c-4f8b-8ee9-3a32250b1d4f
2024-04-23T21:10:40,352  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_6649d000-549c-4f8b-8ee9-3a32250b1d4f
2024-04-23T21:10:40,366  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_6649d000-549c-4f8b-8ee9-3a32250b1d4f LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:10:40,366  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:40,366  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_6649d000-549c-4f8b-8ee9-3a32250b1d4f): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:40,367  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,368  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/_tmp_space.db/b39402ab-03d6-4fc5-98f3-316273dbbc3a
2024-04-23T21:10:40,371  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,371  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:40,371  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_6649d000-549c-4f8b-8ee9-3a32250b1d4f); Time taken: 0.005 seconds
2024-04-23T21:10:40,371  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_6649d000-549c-4f8b-8ee9-3a32250b1d4f
2024-04-23T21:10:40,375  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:10:40,381  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,381  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:10:40,381  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,382  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_ac965caf-0872-4adc-9277-7b832f697883): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,385  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:10:40,385  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:10:40,386  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,386  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,389  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:10:40,389  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:40,390  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:40,390  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,391  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,391  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,391  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:10:40,391  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_ac965caf-0872-4adc-9277-7b832f697883); Time taken: 0.009 seconds
2024-04-23T21:10:40,391  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423211040_ac965caf-0872-4adc-9277-7b832f697883
2024-04-23T21:10:40,391  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_ac965caf-0872-4adc-9277-7b832f697883
2024-04-23T21:10:40,407  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_ac965caf-0872-4adc-9277-7b832f697883 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:10:40,408  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:40,408  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_ac965caf-0872-4adc-9277-7b832f697883): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:40,408  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,409  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931840, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=false, rawDataSize=0, numRows=0, numFilesErasureCoded=0, totalSize=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:40,415  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidnonbucket
2024-04-23T21:10:40,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T21:10:40,431  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_ac965caf-0872-4adc-9277-7b832f697883); Time taken: 0.022 seconds
2024-04-23T21:10:40,431  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_ac965caf-0872-4adc-9277-7b832f697883
2024-04-23T21:10:40,435  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:10:40,442  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,442  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:10:40,443  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:10:40,444  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_3f9bb6ea-fde5-4abc-b5f3-363d7d8cc5fe): drop table if exists T
2024-04-23T21:10:40,447  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:10:40,447  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:10:40,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:40,469  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:40,470  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,470  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,470  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,470  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=22, flushCache_()=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:40,470  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_3f9bb6ea-fde5-4abc-b5f3-363d7d8cc5fe); Time taken: 0.026 seconds
2024-04-23T21:10:40,470  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423211040_3f9bb6ea-fde5-4abc-b5f3-363d7d8cc5fe
2024-04-23T21:10:40,471  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_3f9bb6ea-fde5-4abc-b5f3-363d7d8cc5fe
2024-04-23T21:10:40,488  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_3f9bb6ea-fde5-4abc-b5f3-363d7d8cc5fe LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:10:40,488  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:40,488  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_3f9bb6ea-fde5-4abc-b5f3-363d7d8cc5fe): drop table if exists T
2024-04-23T21:10:40,489  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:40,496  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:40,496  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:40,504  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:40,504  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T21:10:40,651  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t does not exist; Force to delete it.
2024-04-23T21:10:40,651 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:40,651  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,651  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=155, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:40,652  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_3f9bb6ea-fde5-4abc-b5f3-363d7d8cc5fe); Time taken: 0.163 seconds
2024-04-23T21:10:40,652  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_3f9bb6ea-fde5-4abc-b5f3-363d7d8cc5fe
2024-04-23T21:10:40,656  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:10:40,662  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,664  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:10:40,664  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T21:10:40,665  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_b6f07b7f-a5d3-46a7-8409-78ad4a2bb992): drop table if exists Tstage
2024-04-23T21:10:40,674  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:10:40,674  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:10:40,677  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:40,700  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:40,700  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,700  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,700  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,700  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=2, openTxn_(String, TxnType)=9, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=23}
2024-04-23T21:10:40,700  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_b6f07b7f-a5d3-46a7-8409-78ad4a2bb992); Time taken: 0.035 seconds
2024-04-23T21:10:40,701  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423211040_b6f07b7f-a5d3-46a7-8409-78ad4a2bb992
2024-04-23T21:10:40,701  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_b6f07b7f-a5d3-46a7-8409-78ad4a2bb992
2024-04-23T21:10:40,716  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_b6f07b7f-a5d3-46a7-8409-78ad4a2bb992 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:10:40,717  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:40,717  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_b6f07b7f-a5d3-46a7-8409-78ad4a2bb992): drop table if exists Tstage
2024-04-23T21:10:40,717  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,717  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:40,727  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:40,728  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:40,738  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:40,738  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T21:10:40,777  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage does not exist; Force to delete it.
2024-04-23T21:10:40,777 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:40,777  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,778  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=10, dropTable_(String, String, boolean, boolean, boolean)=50}
2024-04-23T21:10:40,778  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_b6f07b7f-a5d3-46a7-8409-78ad4a2bb992); Time taken: 0.06 seconds
2024-04-23T21:10:40,778  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_b6f07b7f-a5d3-46a7-8409-78ad4a2bb992
2024-04-23T21:10:40,782  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:10:40,788  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,788  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:10:40,789  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:40,789  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_8b426db3-b299-4198-aa57-f8e5431b6a6a): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:40,792  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:10:40,792  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:10:40,793  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,793  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,798  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:10:40,799  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:40,800  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:40,800  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,800  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,800  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,801  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0, getDatabase_(String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:10:40,801  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_8b426db3-b299-4198-aa57-f8e5431b6a6a); Time taken: 0.011 seconds
2024-04-23T21:10:40,801  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423211040_8b426db3-b299-4198-aa57-f8e5431b6a6a
2024-04-23T21:10:40,801  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_8b426db3-b299-4198-aa57-f8e5431b6a6a
2024-04-23T21:10:40,816  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_8b426db3-b299-4198-aa57-f8e5431b6a6a LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:10:40,816  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:40,817  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_8b426db3-b299-4198-aa57-f8e5431b6a6a): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:40,817  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931840, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:40,824  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:40,855  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,855  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=37}
2024-04-23T21:10:40,855  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_8b426db3-b299-4198-aa57-f8e5431b6a6a); Time taken: 0.038 seconds
2024-04-23T21:10:40,855  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_8b426db3-b299-4198-aa57-f8e5431b6a6a
2024-04-23T21:10:40,859  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:10:40,864  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,864  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:10:40,865  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:40,865  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_d6b10011-11a2-4171-bdbb-31b08fbb812a): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:40,868  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T21:10:40,869  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:10:40,869  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,869  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,872  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T21:10:40,872  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:40,874  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:40,874  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:40,874  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:40,874  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:40,874  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, openTxn_(String, TxnType)=3, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:10:40,874  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_d6b10011-11a2-4171-bdbb-31b08fbb812a); Time taken: 0.009 seconds
2024-04-23T21:10:40,875  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423211040_d6b10011-11a2-4171-bdbb-31b08fbb812a
2024-04-23T21:10:40,875  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_d6b10011-11a2-4171-bdbb-31b08fbb812a
2024-04-23T21:10:40,889  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_d6b10011-11a2-4171-bdbb-31b08fbb812a LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:10:40,889  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:40,890  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_d6b10011-11a2-4171-bdbb-31b08fbb812a): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:40,890  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:40,891  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713931840, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, transactional=false, numFilesErasureCoded=0, numRows=0, numFiles=0, rawDataSize=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:40,897  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:40,916  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:40,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=25, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:40,916  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_d6b10011-11a2-4171-bdbb-31b08fbb812a); Time taken: 0.026 seconds
2024-04-23T21:10:40,916  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_d6b10011-11a2-4171-bdbb-31b08fbb812a
2024-04-23T21:10:40,920  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:10:40,926  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:40,927  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:10:40,927  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(1,4)
2024-04-23T21:10:40,928  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758): insert into Tstage values(0,2),(1,4)
2024-04-23T21:10:40,931  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 3
2024-04-23T21:10:40,931  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:10:40,932  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:40,932  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:40,936  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:40,946  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:40,946  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:40,946  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:40,946  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:40,946  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:40,946  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:40,956  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:40,956  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:40,956  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:10:40,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:41,057  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:41,057  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:41,057  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:41,058  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:41,060  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:41,060  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:41,060  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:41,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:41,070  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:41,073  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1
2024-04-23T21:10:41,075  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:41,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:41,079  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:41,083  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:10:41,083  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:10:41,085  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:41,086  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:41,097  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:41,108  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:41,108  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:41,109  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:41,109  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:41,109  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:41,109  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:41,109  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:10:41,109  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:41,109  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getNotNullConstraints_(NotNullConstraintsRequest)=1, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidWriteIds_(List, String)=5, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=2, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=42, getAllTableConstraints_(AllTableConstraintsRequest)=27}
2024-04-23T21:10:41,109  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758); Time taken: 0.181 seconds
2024-04-23T21:10:41,109  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758
2024-04-23T21:10:41,110  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758
2024-04-23T21:10:41,124  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:10:41,124  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:41,125  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758): insert into Tstage values(0,2),(1,4)
2024-04-23T21:10:41,125  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758
2024-04-23T21:10:41,125  INFO [main] ql.Driver: Query ID = alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758
Total jobs = 1
2024-04-23T21:10:41,125  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:41,125  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:41,260  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:10:41,260  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:41,260  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:41,260  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:41,260  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:41,260  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:41,260  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:41,260  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:41,263  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:41,263  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:10:41,263  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-40_927_8266466668565077407-1/dummy_path
2024-04-23T21:10:41,273  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:41,274  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:10:41,279  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:41,280  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T21:10:41,281  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:41,285  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-40_927_8266466668565077407-1/-mr-10001
2024-04-23T21:10:41,290  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:41,297  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:41,302  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:41,304  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:10:41,304  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:10:41,304  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-40_927_8266466668565077407-1/dummy_path
2024-04-23T21:10:41,304  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:10:41,323  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:10:41,345  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local381162337_0007
2024-04-23T21:10:41,345  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:41,413  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:41,414  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:41,414  INFO [Thread-642] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:41,414  INFO [Thread-642] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:41,416  INFO [Thread-642] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:41,416  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local381162337_0007_m_000000_0
2024-04-23T21:10:41,419  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:41,420  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-40_927_8266466668565077407-1/dummy_path/null:0+1
2024-04-23T21:10:41,423  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:41,424  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:10:41,424  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:10:41,429  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:41,429  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:41,429  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:41,429  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:41,429  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:41,430  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:41,430  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:41,431  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:41,432  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:41,432  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:41,432  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:10:41,432  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:10:41,432  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:41,432  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:10:41,433  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:10:41,433  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:41,433  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:10:41,434  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:10:41,434  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, 
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:10:41,435  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:10:41,436  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:41,438  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:41,439  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:41,439  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:41,439  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:10:41,439  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:41,449  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:41,456  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local381162337_0007_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:41,456  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:10:41,456  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local381162337_0007_m_000000_0' done.
2024-04-23T21:10:41,457  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local381162337_0007_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=167152
		FILE: Number of bytes written=8333703
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-23T21:10:41,457  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local381162337_0007_m_000000_0
2024-04-23T21:10:41,457  INFO [Thread-642] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:41,458  INFO [Thread-642] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:41,459  INFO [pool-37-thread-1] mapred.LocalJobRunner: Starting task: attempt_local381162337_0007_r_000000_0
2024-04-23T21:10:41,461  INFO [pool-37-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:41,461  INFO [pool-37-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@3bfacad5
2024-04-23T21:10:41,461  WARN [pool-37-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:41,463  INFO [pool-37-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:41,463  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local381162337_0007_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:41,466  INFO [localfetcher#5] reduce.LocalFetcher: localfetcher#5 about to shuffle output of map attempt_local381162337_0007_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:10:41,466  INFO [localfetcher#5] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local381162337_0007_m_000000_0
2024-04-23T21:10:41,466  INFO [localfetcher#5] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:10:41,467  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:41,467  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:41,467  INFO [pool-37-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:41,473  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:41,474  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:10:41,476  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:41,477  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:10:41,477  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:41,477  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:41,477  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:10:41,477  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:41,477  INFO [pool-37-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:41,478  INFO [pool-37-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T21:10:41,480  INFO [pool-37-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:41,480  INFO [pool-37-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:41,480  INFO [pool-37-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:10:41,481  INFO [pool-37-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:10:41,481  INFO [pool-37-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local381162337_0007/job_local381162337_0007.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@56ea4df3
2024-04-23T21:10:41,481  INFO [pool-37-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:41,481  INFO [pool-37-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:41,481  INFO [pool-37-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:10:41,481  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-23T21:10:41,482  INFO [pool-37-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/_tmp.-ext-10000/000000_0
2024-04-23T21:10:41,482  INFO [pool-37-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T21:10:41,482  INFO [pool-37-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/_tmp.-ext-10000/000000_0
2024-04-23T21:10:41,494  INFO [pool-37-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.tstage:0, RECORDS_OUT_OPERATOR_FS_6:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:41,495  INFO [pool-37-thread-1] mapred.Task: Task:attempt_local381162337_0007_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:41,495  INFO [pool-37-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:41,495  INFO [pool-37-thread-1] mapred.Task: Task 'attempt_local381162337_0007_r_000000_0' done.
2024-04-23T21:10:41,495  INFO [pool-37-thread-1] mapred.Task: Final Counters for attempt_local381162337_0007_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=173618
		FILE: Number of bytes written=8333769
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:41,495  INFO [pool-37-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local381162337_0007_r_000000_0
2024-04-23T21:10:41,495  INFO [pool-37-thread-1] mapred.LocalJobRunner: Starting task: attempt_local381162337_0007_r_000001_0
2024-04-23T21:10:41,496  INFO [pool-37-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:41,496  INFO [pool-37-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@795e400b
2024-04-23T21:10:41,496  WARN [pool-37-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:41,497  INFO [pool-37-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:41,498  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local381162337_0007_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:41,501  INFO [localfetcher#6] reduce.LocalFetcher: localfetcher#6 about to shuffle output of map attempt_local381162337_0007_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:10:41,501  INFO [localfetcher#6] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local381162337_0007_m_000000_0
2024-04-23T21:10:41,501  INFO [localfetcher#6] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:10:41,501  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:41,502  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:41,502  INFO [pool-37-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:41,508  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:41,508  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:10:41,510  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:41,510  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:10:41,510  INFO [pool-37-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:41,510  INFO [pool-37-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:41,510  INFO [pool-37-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:10:41,511  INFO [pool-37-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:41,511  INFO [pool-37-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:41,512  INFO [pool-37-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T21:10:41,513  INFO [pool-37-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:41,513  INFO [pool-37-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:41,513  INFO [pool-37-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:10:41,513  INFO [pool-37-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:10:41,513  INFO [pool-37-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local381162337_0007/job_local381162337_0007.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@565616e3
2024-04-23T21:10:41,514  INFO [pool-37-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/_tmp.-ext-10000/000001_0
2024-04-23T21:10:41,514  INFO [pool-37-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T21:10:41,514  INFO [pool-37-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/_tmp.-ext-10000/000001_0
2024-04-23T21:10:41,514  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:10:41,514  INFO [pool-37-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:10:41,519  INFO [pool-37-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:10:41,519  INFO [pool-37-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:41,520  INFO [pool-37-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:41,520  INFO [pool-37-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:10:41,520  INFO [pool-37-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:10:41,527  INFO [pool-37-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, 
2024-04-23T21:10:41,528  INFO [pool-37-thread-1] mapred.Task: Task:attempt_local381162337_0007_r_000001_0 is done. And is in the process of committing
2024-04-23T21:10:41,528  INFO [pool-37-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:41,528  INFO [pool-37-thread-1] mapred.Task: Task 'attempt_local381162337_0007_r_000001_0' done.
2024-04-23T21:10:41,528  INFO [pool-37-thread-1] mapred.Task: Final Counters for attempt_local381162337_0007_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=180114
		FILE: Number of bytes written=8334157
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:41,529  INFO [pool-37-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local381162337_0007_r_000001_0
2024-04-23T21:10:41,529  INFO [Thread-642] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:42,420 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:42,420  INFO [main] exec.Task: 2024-04-23 21:10:42,420 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local381162337_0007
2024-04-23T21:10:42,423  INFO [main] exec.Task: Ended Job = job_local381162337_0007
2024-04-23T21:10:42,425  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T21:10:42,425  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1/-ext-10000
2024-04-23T21:10:42,426  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:42,435  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,436  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:42,446  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,448  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:42,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:42,476  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:10:42,476  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:42,485  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,485  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:10:42,486  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-40_927_8266466668565077407-1/-mr-10001
2024-04-23T21:10:42,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:42,498  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,498  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T21:10:42,498  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T21:10:42,499  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:42,499  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:42,528  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=2, numRows=2, totalSize=252, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T21:10:42,528  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:42,528  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=57, getTable_(GetTableRequest)=39, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T21:10:42,529  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:42,529  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:42,529  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:42,529  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758); Time taken: 1.403 seconds
2024-04-23T21:10:42,529  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211040_3f6304c6-c031-4776-a1ba-174760c51758
2024-04-23T21:10:42,533  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:10:42,537  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:42,538  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:10:42,538  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:42,539  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-40_927_8266466668565077407-1
2024-04-23T21:10:42,539  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-40_927_8266466668565077407-1 on fs with scheme file
2024-04-23T21:10:42,540  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1
2024-04-23T21:10:42,540  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-40_927_8266466668565077407-1 on fs with scheme file
2024-04-23T21:10:42,540  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211042_5dabd3ac-8fa7-4143-94a8-9ea78e916eec): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:42,541  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:42,549  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,551  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:10:42,552  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:10:42,555  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:42,563  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,563  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:42,563  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:42,563  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:42,563  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:42,564  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:42,564  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:42,564  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:42,564  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=17, flushCache_()=0, openTxn_(String, TxnType)=2, getCurrentNotificationEventId_()=2, commitTxn_(CommitTxnRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:42,564  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211042_5dabd3ac-8fa7-4143-94a8-9ea78e916eec); Time taken: 0.024 seconds
2024-04-23T21:10:42,564  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423211042_5dabd3ac-8fa7-4143-94a8-9ea78e916eec
2024-04-23T21:10:42,565  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211042_5dabd3ac-8fa7-4143-94a8-9ea78e916eec
2024-04-23T21:10:42,579  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211042_5dabd3ac-8fa7-4143-94a8-9ea78e916eec LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:10:42,579  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:42,579  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211042_5dabd3ac-8fa7-4143-94a8-9ea78e916eec): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:42,579  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:42,579  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:42,579  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:42,579  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:42,579  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:42,590  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:42,599  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:42,599  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:42,599  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211042_5dabd3ac-8fa7-4143-94a8-9ea78e916eec); Time taken: 0.02 seconds
2024-04-23T21:10:42,599  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211042_5dabd3ac-8fa7-4143-94a8-9ea78e916eec
2024-04-23T21:10:42,603  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:10:42,609  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:42,609  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:10:42,609  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data'
2024-04-23T21:10:42,610  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211042_f9d08c96-d1f6-4e71-9bfa-4ca919423d04): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data'
2024-04-23T21:10:42,612  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:10:42,613  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:10:42,613  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:42,620  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,629  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 19
2024-04-23T21:10:42,630  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [19])
2024-04-23T21:10:42,631  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:42,631  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:42,631  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:42,631  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=3, commitTxn_(CommitTxnRequest)=9, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=7, allocateTableWriteId_(long, String, String)=7, openTxn_(String, TxnType)=2}
2024-04-23T21:10:42,631  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211042_f9d08c96-d1f6-4e71-9bfa-4ca919423d04); Time taken: 0.021 seconds
2024-04-23T21:10:42,632  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423211042_f9d08c96-d1f6-4e71-9bfa-4ca919423d04
2024-04-23T21:10:42,632  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211042_f9d08c96-d1f6-4e71-9bfa-4ca919423d04
2024-04-23T21:10:42,646  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211042_f9d08c96-d1f6-4e71-9bfa-4ca919423d04 LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:10:42,646  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:42,651  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211042_f9d08c96-d1f6-4e71-9bfa-4ca919423d04): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data'
2024-04-23T21:10:42,651  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:42,651  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:42,658  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,658  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:42,670  INFO [HMSHandler #8] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:42,694  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T21:10:42,694  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data
2024-04-23T21:10:42,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:42,702  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,703  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:42,720  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T21:10:42,720  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:42,720  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:42,728  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,728  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:42,738  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T21:10:42,743  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:42,743  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T21:10:42,779  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:42,805  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:42,814  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:42,815  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_partition_(String, String, String, Partition, EnvironmentContext, String)=61, getPartitionWithAuthInfo_(String, String, List, String, List)=36, validatePartitionNameCharacters_(List)=0, getValidWriteIds_(List, String)=1, add_partitions_(List, boolean, boolean)=36, getTable_(GetTableRequest)=23, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:42,815  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211042_f9d08c96-d1f6-4e71-9bfa-4ca919423d04); Time taken: 0.163 seconds
2024-04-23T21:10:42,815  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211042_f9d08c96-d1f6-4e71-9bfa-4ca919423d04
2024-04-23T21:10:42,819  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:10:42,825  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:42,825  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:10:42,826  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:42,826  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:42,830  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:10:42,830  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:10:42,831  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:42,831  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:42,837  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:42,838  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:42,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:42,845  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,846  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:42,846  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:42,846  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:42,859  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:42,895  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:42,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:42,916  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:42,925  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:42,925  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:42,940  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:42,940  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:42,991  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:42,991  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:42,991  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:42,993  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-42_826_7271511443377283326-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-42_826_7271511443377283326-1
2024-04-23T21:10:43,001  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:43,003  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col2=Column[_col4], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1], VALUE._col0=Column[_col2]}
2024-04-23T21:10:43,004  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], VALUE._col2=Column[_col4], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1]}
2024-04-23T21:10:43,005  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:43,015  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:43,016  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:43,016  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:43,016  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:43,016  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T21:10:43,017  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T21:10:43,017  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:43,017  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, getAllTableConstraints_(AllTableConstraintsRequest)=29, getTable_(GetTableRequest)=8, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=1, getAggrColStatsFor_(String, String, List, List, String, String)=24, listPartitions_(String, String, short)=12, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:10:43,017  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0); Time taken: 0.191 seconds
2024-04-23T21:10:43,018  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0
2024-04-23T21:10:43,018  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0
2024-04-23T21:10:43,034  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:10:43,034  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:43,034  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:43,035  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0
2024-04-23T21:10:43,035  INFO [main] ql.Driver: Query ID = alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0
Total jobs = 1
2024-04-23T21:10:43,035  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:43,035  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:43,167  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:10:43,167  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:43,167  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:43,167  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:43,167  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:43,167  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:43,167  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:43,167  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:43,169  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:43,169  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:10:43,170  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:43,179  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:43,180  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,34KB
2024-04-23T21:10:43,185  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:43,197  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T21:10:43,198  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:43,206  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:43,215  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:43,220  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:43,222  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:10:43,222  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:10:43,222  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:43,222  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:10:43,222  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 2 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:10:43,222  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:10:43,233  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:10:43,233  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 1). duration: 11 ms
2024-04-23T21:10:43,233  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:10:43,252  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:10:43,273  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local352146926_0008
2024-04-23T21:10:43,273  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:43,359  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:43,360  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:43,360  INFO [Thread-723] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:43,360  INFO [Thread-723] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:43,362  INFO [Thread-723] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:43,362  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local352146926_0008_m_000000_0
2024-04-23T21:10:43,362  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:43,363  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:43,363  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:43,364  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,34KB
2024-04-23T21:10:43,366  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T21:10:43,366  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0 with {include: [true, true, true], offset: 0, length: 252, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:43,372  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T21:10:43,372  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:43,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:43,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:43,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:43,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:43,383  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:43,384  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:43,384  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:43,386  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:43,386  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:43,386  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:43,386  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T21:10:43,386  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:10:43,386  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:43,387  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:43,387  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:10:43,387  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:43,387  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:43,387  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, 
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T21:10:43,388  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:43,399  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:43,402  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local352146926_0008_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:43,403  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:43,403  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local352146926_0008_m_000000_0' done.
2024-04-23T21:10:43,403  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local352146926_0008_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=188124
		FILE: Number of bytes written=9518728
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=7
		Total committed heap usage (bytes)=1122500608
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=6464
2024-04-23T21:10:43,403  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local352146926_0008_m_000000_0
2024-04-23T21:10:43,403  INFO [Thread-723] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:43,404  INFO [Thread-723] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:43,404  INFO [pool-43-thread-1] mapred.LocalJobRunner: Starting task: attempt_local352146926_0008_r_000000_0
2024-04-23T21:10:43,405  INFO [pool-43-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:43,405  INFO [pool-43-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@342475cf
2024-04-23T21:10:43,405  WARN [pool-43-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:43,406  INFO [pool-43-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:43,406  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local352146926_0008_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:43,407  INFO [localfetcher#7] reduce.LocalFetcher: localfetcher#7 about to shuffle output of map attempt_local352146926_0008_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-23T21:10:43,407  INFO [localfetcher#7] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local352146926_0008_m_000000_0
2024-04-23T21:10:43,407  INFO [localfetcher#7] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-23T21:10:43,408  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:43,408  INFO [pool-43-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:43,409  INFO [pool-43-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:43,415  INFO [pool-43-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:43,415  INFO [pool-43-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-23T21:10:43,417  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 412 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:43,417  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merging 1 files, 416 bytes from disk
2024-04-23T21:10:43,417  INFO [pool-43-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:43,417  INFO [pool-43-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:43,418  INFO [pool-43-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-23T21:10:43,418  INFO [pool-43-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:43,418  INFO [pool-43-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:43,422  INFO [pool-43-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T21:10:43,423  INFO [pool-43-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:43,423  INFO [pool-43-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:43,423  INFO [pool-43-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-23T21:10:43,424  INFO [pool-43-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:43,424  INFO [pool-43-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@959814f, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@47a2d9a9>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@73b57f21, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@1dd6b53f
2024-04-23T21:10:43,424  INFO [pool-43-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-42_826_7271511443377283326-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-42_826_7271511443377283326-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:43,424  INFO [pool-43-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-42_826_7271511443377283326-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-42_826_7271511443377283326-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:43,424  INFO [pool-43-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-42_826_7271511443377283326-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-42_826_7271511443377283326-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:43,433  INFO [pool-43-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:43,433  INFO [pool-43-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:43,433  INFO [pool-43-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:43,433  INFO [pool-43-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:43,433  INFO [pool-43-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:10:43,434  INFO [pool-43-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:2, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:43,434  INFO [pool-43-thread-1] mapred.Task: Task:attempt_local352146926_0008_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:43,434  INFO [pool-43-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:43,434  INFO [pool-43-thread-1] mapred.Task: Task 'attempt_local352146926_0008_r_000000_0' done.
2024-04-23T21:10:43,434  INFO [pool-43-thread-1] mapred.Task: Final Counters for attempt_local352146926_0008_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=195269
		FILE: Number of bytes written=9519629
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=416
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1122500608
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:43,435  INFO [pool-43-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local352146926_0008_r_000000_0
2024-04-23T21:10:43,435  INFO [Thread-723] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:44,363 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:44,363  INFO [main] exec.Task: 2024-04-23 21:10:44,363 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local352146926_0008
2024-04-23T21:10:44,366  INFO [main] exec.Task: Ended Job = job_local352146926_0008
2024-04-23T21:10:44,369  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:44,369  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:10:44,369  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:44,369  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:44,369  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:44,369  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0); Time taken: 1.334 seconds
2024-04-23T21:10:44,369  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211042_fbee7417-79ab-419f-980f-f4f7c0169df0
2024-04-23T21:10:44,374  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:10:44,379  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:44,379  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:10:44,384  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:10:44,385  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T21:10:44,385  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:2, 
2024-04-23T21:10:44,385  WARN [main] ql.TestTxnAddPartition: addPartitionBucketed: read data(add partition (p=0)): 
2024-04-23T21:10:44,385  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536936448,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0
{"writeid":1,"bucketid":536936448,"rowid":1}	0	1	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0

2024-04-23T21:10:44,385  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:44,385  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-42_826_7271511443377283326-1
2024-04-23T21:10:44,386  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/c2faa818-f42f-4bea-a1f2-7fc9b59ff71d/hive_2024-04-23_21-10-42_826_7271511443377283326-1 on fs with scheme file
2024-04-23T21:10:44,386  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211044_75af8ff1-0bdf-4eaf-a6a8-48e58bcb6a6c): drop table if exists acidTbl
2024-04-23T21:10:44,389  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-23T21:10:44,390  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:10:44,391  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:44,398  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,398  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:44,398  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:44,398  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:44,398  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, flushCache_()=0, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=3}
2024-04-23T21:10:44,398  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211044_75af8ff1-0bdf-4eaf-a6a8-48e58bcb6a6c); Time taken: 0.012 seconds
2024-04-23T21:10:44,399  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423211044_75af8ff1-0bdf-4eaf-a6a8-48e58bcb6a6c
2024-04-23T21:10:44,399  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211044_75af8ff1-0bdf-4eaf-a6a8-48e58bcb6a6c
2024-04-23T21:10:44,414  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211044_75af8ff1-0bdf-4eaf-a6a8-48e58bcb6a6c LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:10:44,414  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:44,414  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211044_75af8ff1-0bdf-4eaf-a6a8-48e58bcb6a6c): drop table if exists acidTbl
2024-04-23T21:10:44,414  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:44,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:44,422  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,423  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:44,430  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,431  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:44,533  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:44,533  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=110, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:44,533  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211044_75af8ff1-0bdf-4eaf-a6a8-48e58bcb6a6c); Time taken: 0.119 seconds
2024-04-23T21:10:44,533  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211044_75af8ff1-0bdf-4eaf-a6a8-48e58bcb6a6c
2024-04-23T21:10:44,538  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:10:44,545  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:44,545  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:10:44,546  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:44,546  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211044_90178659-1650-42ec-bab0-b04ce7e800d4): drop table if exists acidTblPart
2024-04-23T21:10:44,549  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 21
2024-04-23T21:10:44,549  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:10:44,550  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:44,558  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,558  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:44,559  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:44,559  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:44,559  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=8, getValidTxns_(long)=1}
2024-04-23T21:10:44,559  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211044_90178659-1650-42ec-bab0-b04ce7e800d4); Time taken: 0.013 seconds
2024-04-23T21:10:44,559  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423211044_90178659-1650-42ec-bab0-b04ce7e800d4
2024-04-23T21:10:44,560  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211044_90178659-1650-42ec-bab0-b04ce7e800d4
2024-04-23T21:10:44,575  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211044_90178659-1650-42ec-bab0-b04ce7e800d4 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:10:44,575  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:44,576  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211044_90178659-1650-42ec-bab0-b04ce7e800d4): drop table if exists acidTblPart
2024-04-23T21:10:44,576  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:44,576  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:44,584  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,584  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:44,592  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,593  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:44,641  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:44,642  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=57, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8}
2024-04-23T21:10:44,642  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211044_90178659-1650-42ec-bab0-b04ce7e800d4); Time taken: 0.065 seconds
2024-04-23T21:10:44,642  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211044_90178659-1650-42ec-bab0-b04ce7e800d4
2024-04-23T21:10:44,646  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:10:44,652  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:44,652  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:10:44,653  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:44,653  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211044_f1019dad-6861-4b09-95f8-2e97a82e6363): drop table if exists acidTbl2
2024-04-23T21:10:44,656  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 21
2024-04-23T21:10:44,656  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:10:44,657  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:44,657  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:44,657  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:44,658  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:44,658  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211044_f1019dad-6861-4b09-95f8-2e97a82e6363); Time taken: 0.004 seconds
2024-04-23T21:10:44,658  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423211044_f1019dad-6861-4b09-95f8-2e97a82e6363
2024-04-23T21:10:44,658  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:44,658  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211044_f1019dad-6861-4b09-95f8-2e97a82e6363): drop table if exists acidTbl2
2024-04-23T21:10:44,658  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:44,659  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:10:44,659  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:44,659  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-23T21:10:44,659  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211044_f1019dad-6861-4b09-95f8-2e97a82e6363); Time taken: 0.001 seconds
2024-04-23T21:10:44,659  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211044_f1019dad-6861-4b09-95f8-2e97a82e6363
2024-04-23T21:10:44,665  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:10:44,671  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:44,671  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:10:44,672  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:44,672  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211044_4bbe7e93-b731-4ef8-8c90-8fbd5e1b7f5f): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:44,674  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 21
2024-04-23T21:10:44,674  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:10:44,675  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:44,697  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,697  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:44,697  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:44,697  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:44,697  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=22, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:10:44,697  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211044_4bbe7e93-b731-4ef8-8c90-8fbd5e1b7f5f); Time taken: 0.025 seconds
2024-04-23T21:10:44,698  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423211044_4bbe7e93-b731-4ef8-8c90-8fbd5e1b7f5f
2024-04-23T21:10:44,698  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211044_4bbe7e93-b731-4ef8-8c90-8fbd5e1b7f5f
2024-04-23T21:10:44,713  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211044_4bbe7e93-b731-4ef8-8c90-8fbd5e1b7f5f LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T21:10:44,714  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:44,714  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211044_4bbe7e93-b731-4ef8-8c90-8fbd5e1b7f5f): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:44,714  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:44,714  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:44,724  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:44,735  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:44,825  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:44,826  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=101, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:44,826  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211044_4bbe7e93-b731-4ef8-8c90-8fbd5e1b7f5f); Time taken: 0.111 seconds
2024-04-23T21:10:44,826  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211044_4bbe7e93-b731-4ef8-8c90-8fbd5e1b7f5f
2024-04-23T21:10:44,830  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T21:10:44,836  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:44,837  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T21:10:44,838  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:44,838  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211044_3aca7195-237e-4ef6-89da-7d94bc4ff450): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:44,840  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 21
2024-04-23T21:10:44,841  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T21:10:44,842  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:44,851  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,851  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:44,851  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:44,851  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:44,852  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, getValidTxns_(long)=1}
2024-04-23T21:10:44,852  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211044_3aca7195-237e-4ef6-89da-7d94bc4ff450); Time taken: 0.013 seconds
2024-04-23T21:10:44,852  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423211044_3aca7195-237e-4ef6-89da-7d94bc4ff450
2024-04-23T21:10:44,853  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211044_3aca7195-237e-4ef6-89da-7d94bc4ff450
2024-04-23T21:10:44,873  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211044_3aca7195-237e-4ef6-89da-7d94bc4ff450 LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T21:10:44,873  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:44,873  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211044_3aca7195-237e-4ef6-89da-7d94bc4ff450): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:44,874  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:44,874  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:44,884  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:44,894  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:44,930  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:44,930  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=45, getTable_(GetTableRequest)=11}
2024-04-23T21:10:44,930  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211044_3aca7195-237e-4ef6-89da-7d94bc4ff450); Time taken: 0.057 seconds
2024-04-23T21:10:44,930  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211044_3aca7195-237e-4ef6-89da-7d94bc4ff450
2024-04-23T21:10:44,934  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T21:10:44,940  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:44,940  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T21:10:44,940  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:44,941  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211044_2b2b0347-d95f-4721-8334-24aca8c4ea5f): drop table if exists nonAcidNonBucket
2024-04-23T21:10:44,944  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 21
2024-04-23T21:10:44,944  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T21:10:44,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:44,954  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,954  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:44,954  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:44,955  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:44,955  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, flushCache_()=0, getTable_(GetTableRequest)=9}
2024-04-23T21:10:44,955  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211044_2b2b0347-d95f-4721-8334-24aca8c4ea5f); Time taken: 0.013 seconds
2024-04-23T21:10:44,955  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423211044_2b2b0347-d95f-4721-8334-24aca8c4ea5f
2024-04-23T21:10:44,956  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211044_2b2b0347-d95f-4721-8334-24aca8c4ea5f
2024-04-23T21:10:44,970  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211044_2b2b0347-d95f-4721-8334-24aca8c4ea5f LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T21:10:44,970  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:44,970  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211044_2b2b0347-d95f-4721-8334-24aca8c4ea5f): drop table if exists nonAcidNonBucket
2024-04-23T21:10:44,970  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:44,970  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:44,979  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:44,987  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:44,987  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:45,017  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,017  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=38, getTable_(GetTableRequest)=9}
2024-04-23T21:10:45,017  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211044_2b2b0347-d95f-4721-8334-24aca8c4ea5f); Time taken: 0.047 seconds
2024-04-23T21:10:45,017  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211044_2b2b0347-d95f-4721-8334-24aca8c4ea5f
2024-04-23T21:10:45,021  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T21:10:45,028  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,029  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T21:10:45,029  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T21:10:45,096  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:10:45,096  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:10:45,096  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:10:45,096  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:10:45,096  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:10:45,096  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:10:45,096  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:10:45,097  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:10:45,097  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:10:45,097  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:10:45,097  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:10:45,098  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 9ef691ee-ca9c-4c89-9ece-0fcb514eadae
2024-04-23T21:10:45,101  INFO [main] SessionState: Hive Session ID = 9ef691ee-ca9c-4c89-9ece-0fcb514eadae
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:45,101  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:45,107  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9ef691ee-ca9c-4c89-9ece-0fcb514eadae
2024-04-23T21:10:45,109  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9ef691ee-ca9c-4c89-9ece-0fcb514eadae
2024-04-23T21:10:45,111  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/_tmp_space.db
2024-04-23T21:10:45,111  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=9ef691ee-ca9c-4c89-9ece-0fcb514eadae, clientType=HIVECLI]
2024-04-23T21:10:45,112  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:45,112  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_443fa478-d825-46b6-b2de-ed7566323df6): drop table if exists acidTbl
2024-04-23T21:10:45,120  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:10:45,120  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:10:45,122  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:45,125  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,125  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,125  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,125  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=8, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,126  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_443fa478-d825-46b6-b2de-ed7566323df6); Time taken: 0.013 seconds
2024-04-23T21:10:45,126  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423211045_443fa478-d825-46b6-b2de-ed7566323df6
2024-04-23T21:10:45,126  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:45,126  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_443fa478-d825-46b6-b2de-ed7566323df6): drop table if exists acidTbl
2024-04-23T21:10:45,126  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,126  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:45,129  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,129  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,130  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_443fa478-d825-46b6-b2de-ed7566323df6); Time taken: 0.003 seconds
2024-04-23T21:10:45,130  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_443fa478-d825-46b6-b2de-ed7566323df6
2024-04-23T21:10:45,135  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:10:45,141  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,141  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:10:45,142  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:45,142  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_47ce6bfd-63a6-4f0b-92b0-8147a3af1bca): drop table if exists acidTblPart
2024-04-23T21:10:45,145  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:10:45,145  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:10:45,146  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:45,148  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,149  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,149  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,149  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12, flushCache_()=0}
2024-04-23T21:10:45,149  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_47ce6bfd-63a6-4f0b-92b0-8147a3af1bca); Time taken: 0.007 seconds
2024-04-23T21:10:45,149  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423211045_47ce6bfd-63a6-4f0b-92b0-8147a3af1bca
2024-04-23T21:10:45,149  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:45,149  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_47ce6bfd-63a6-4f0b-92b0-8147a3af1bca): drop table if exists acidTblPart
2024-04-23T21:10:45,150  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,150  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:45,153  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,153  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,153  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_47ce6bfd-63a6-4f0b-92b0-8147a3af1bca); Time taken: 0.004 seconds
2024-04-23T21:10:45,153  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_47ce6bfd-63a6-4f0b-92b0-8147a3af1bca
2024-04-23T21:10:45,158  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:10:45,163  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,163  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:10:45,164  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:45,164  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_d8f29517-d908-4a64-be86-d684f9cc3738): drop table if exists acidTbl2
2024-04-23T21:10:45,167  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:10:45,167  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:10:45,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:45,171  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,171  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,171  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,171  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:10:45,171  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_d8f29517-d908-4a64-be86-d684f9cc3738); Time taken: 0.007 seconds
2024-04-23T21:10:45,172  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423211045_d8f29517-d908-4a64-be86-d684f9cc3738
2024-04-23T21:10:45,172  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:45,172  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_d8f29517-d908-4a64-be86-d684f9cc3738): drop table if exists acidTbl2
2024-04-23T21:10:45,172  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,172  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:45,175  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,175  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,176  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_d8f29517-d908-4a64-be86-d684f9cc3738); Time taken: 0.003 seconds
2024-04-23T21:10:45,176  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_d8f29517-d908-4a64-be86-d684f9cc3738
2024-04-23T21:10:45,181  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:10:45,186  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,186  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:10:45,187  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:45,187  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_c7789f45-fc73-489d-a279-913522820d06): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:45,189  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:10:45,190  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:10:45,190  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:45,193  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,193  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,193  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,193  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T21:10:45,194  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_c7789f45-fc73-489d-a279-913522820d06); Time taken: 0.006 seconds
2024-04-23T21:10:45,194  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423211045_c7789f45-fc73-489d-a279-913522820d06
2024-04-23T21:10:45,194  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:45,194  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_c7789f45-fc73-489d-a279-913522820d06): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:45,194  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,194  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:45,197  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,197  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,198  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_c7789f45-fc73-489d-a279-913522820d06); Time taken: 0.003 seconds
2024-04-23T21:10:45,198  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_c7789f45-fc73-489d-a279-913522820d06
2024-04-23T21:10:45,202  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:10:45,208  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,208  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:10:45,208  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:45,209  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_efca6ed4-ba44-4752-9abd-4cdb5a90932a): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:45,211  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:10:45,211  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:10:45,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:45,215  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,215  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,215  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,215  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0}
2024-04-23T21:10:45,215  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_efca6ed4-ba44-4752-9abd-4cdb5a90932a); Time taken: 0.006 seconds
2024-04-23T21:10:45,215  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423211045_efca6ed4-ba44-4752-9abd-4cdb5a90932a
2024-04-23T21:10:45,215  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:45,216  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_efca6ed4-ba44-4752-9abd-4cdb5a90932a): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:45,216  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,216  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:45,219  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,219  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,219  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_efca6ed4-ba44-4752-9abd-4cdb5a90932a); Time taken: 0.003 seconds
2024-04-23T21:10:45,219  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_efca6ed4-ba44-4752-9abd-4cdb5a90932a
2024-04-23T21:10:45,224  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:10:45,229  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,229  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:10:45,230  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:45,230  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_199fe29b-0353-4ba1-9f55-efb36354fd82): drop table if exists nonAcidNonBucket
2024-04-23T21:10:45,232  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:10:45,233  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:10:45,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:45,237  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,237  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,237  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,237  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-23T21:10:45,237  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_199fe29b-0353-4ba1-9f55-efb36354fd82); Time taken: 0.007 seconds
2024-04-23T21:10:45,237  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423211045_199fe29b-0353-4ba1-9f55-efb36354fd82
2024-04-23T21:10:45,237  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:45,237  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_199fe29b-0353-4ba1-9f55-efb36354fd82): drop table if exists nonAcidNonBucket
2024-04-23T21:10:45,238  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,238  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:45,241  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,241  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,241  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_199fe29b-0353-4ba1-9f55-efb36354fd82); Time taken: 0.004 seconds
2024-04-23T21:10:45,241  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_199fe29b-0353-4ba1-9f55-efb36354fd82
2024-04-23T21:10:45,246  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:10:45,251  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,252  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:10:45,252  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,252  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_730ff72a-3712-4af4-a3b4-7d0e9aff1130): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,256  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:10:45,257  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:10:45,258  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:45,258  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:45,265  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:10:45,265  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:45,268  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:45,268  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,268  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,268  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,268  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=7, getDatabase_(String)=3}
2024-04-23T21:10:45,269  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_730ff72a-3712-4af4-a3b4-7d0e9aff1130); Time taken: 0.016 seconds
2024-04-23T21:10:45,269  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423211045_730ff72a-3712-4af4-a3b4-7d0e9aff1130
2024-04-23T21:10:45,269  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211045_730ff72a-3712-4af4-a3b4-7d0e9aff1130
2024-04-23T21:10:45,291  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211045_730ff72a-3712-4af4-a3b4-7d0e9aff1130 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:10:45,292  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:45,292  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_730ff72a-3712-4af4-a3b4-7d0e9aff1130): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,293  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,294  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931845, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, numRows=0, totalSize=0, numFiles=0, bucketing_version=2, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:45,300  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtbl
2024-04-23T21:10:45,344  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,344  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=51, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,344  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_730ff72a-3712-4af4-a3b4-7d0e9aff1130); Time taken: 0.052 seconds
2024-04-23T21:10:45,345  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_730ff72a-3712-4af4-a3b4-7d0e9aff1130
2024-04-23T21:10:45,349  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:10:45,355  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,356  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:10:45,356  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,357  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_4c00cb32-84f8-41e1-8594-724203013297): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,359  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:10:45,360  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:10:45,360  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:45,360  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:45,363  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:10:45,363  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:45,365  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:45,365  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,365  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,365  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,365  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=0}
2024-04-23T21:10:45,365  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_4c00cb32-84f8-41e1-8594-724203013297); Time taken: 0.008 seconds
2024-04-23T21:10:45,366  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423211045_4c00cb32-84f8-41e1-8594-724203013297
2024-04-23T21:10:45,366  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211045_4c00cb32-84f8-41e1-8594-724203013297
2024-04-23T21:10:45,380  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211045_4c00cb32-84f8-41e1-8594-724203013297 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:10:45,380  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:45,381  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_4c00cb32-84f8-41e1-8594-724203013297): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,381  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,382  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931845, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:45,388  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtblpart
2024-04-23T21:10:45,407  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,407  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,407  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_4c00cb32-84f8-41e1-8594-724203013297); Time taken: 0.025 seconds
2024-04-23T21:10:45,407  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_4c00cb32-84f8-41e1-8594-724203013297
2024-04-23T21:10:45,411  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:10:45,418  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,418  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:10:45,419  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,419  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_be3745e7-c79c-4141-b445-c5c0d87b024e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,422  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:10:45,422  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:10:45,423  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:45,423  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:45,426  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:10:45,426  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:45,428  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:45,428  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,428  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,428  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,428  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getDatabase_(String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2}
2024-04-23T21:10:45,428  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_be3745e7-c79c-4141-b445-c5c0d87b024e); Time taken: 0.009 seconds
2024-04-23T21:10:45,428  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423211045_be3745e7-c79c-4141-b445-c5c0d87b024e
2024-04-23T21:10:45,429  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211045_be3745e7-c79c-4141-b445-c5c0d87b024e
2024-04-23T21:10:45,445  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211045_be3745e7-c79c-4141-b445-c5c0d87b024e LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:10:45,445  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:45,445  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_be3745e7-c79c-4141-b445-c5c0d87b024e): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,445  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,446  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931845, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, bucketing_version=2, numFiles=0, rawDataSize=0, transactional=false, totalSize=0, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:45,453  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl
2024-04-23T21:10:45,472  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,472  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=26}
2024-04-23T21:10:45,472  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_be3745e7-c79c-4141-b445-c5c0d87b024e); Time taken: 0.027 seconds
2024-04-23T21:10:45,472  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_be3745e7-c79c-4141-b445-c5c0d87b024e
2024-04-23T21:10:45,476  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:10:45,482  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,482  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:10:45,483  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,483  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_61f02637-cb3d-4ae8-b6fb-ce3887575d57): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,486  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:10:45,486  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:10:45,487  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:45,487  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:45,490  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:10:45,490  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:45,492  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:45,492  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,492  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,492  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,492  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=1, openTxn_(String, TxnType)=2}
2024-04-23T21:10:45,492  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_61f02637-cb3d-4ae8-b6fb-ce3887575d57); Time taken: 0.009 seconds
2024-04-23T21:10:45,492  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423211045_61f02637-cb3d-4ae8-b6fb-ce3887575d57
2024-04-23T21:10:45,492  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211045_61f02637-cb3d-4ae8-b6fb-ce3887575d57
2024-04-23T21:10:45,510  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211045_61f02637-cb3d-4ae8-b6fb-ce3887575d57 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:10:45,510  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:45,510  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_61f02637-cb3d-4ae8-b6fb-ce3887575d57): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,510  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,512  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931845, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, totalSize=0, transactional=false, numFilesErasureCoded=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:45,523  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl2
2024-04-23T21:10:45,547  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,547  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=36}
2024-04-23T21:10:45,547  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_61f02637-cb3d-4ae8-b6fb-ce3887575d57); Time taken: 0.037 seconds
2024-04-23T21:10:45,547  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_61f02637-cb3d-4ae8-b6fb-ce3887575d57
2024-04-23T21:10:45,551  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:10:45,557  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,557  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:10:45,558  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,559  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_09209483-2bd7-451e-8028-3b48f4e47364): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,561  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:10:45,562  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:10:45,562  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:45,562  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:45,565  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:10:45,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:45,567  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:45,567  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,567  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,567  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,567  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:45,568  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_09209483-2bd7-451e-8028-3b48f4e47364); Time taken: 0.008 seconds
2024-04-23T21:10:45,568  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423211045_09209483-2bd7-451e-8028-3b48f4e47364
2024-04-23T21:10:45,568  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211045_09209483-2bd7-451e-8028-3b48f4e47364
2024-04-23T21:10:45,582  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211045_09209483-2bd7-451e-8028-3b48f4e47364 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:10:45,582  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:45,583  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_09209483-2bd7-451e-8028-3b48f4e47364): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:45,583  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,585  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/_tmp_space.db/c34e395d-98f8-49f6-aa6f-04d84508966a
2024-04-23T21:10:45,587  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,587  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,588  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_09209483-2bd7-451e-8028-3b48f4e47364); Time taken: 0.004 seconds
2024-04-23T21:10:45,588  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_09209483-2bd7-451e-8028-3b48f4e47364
2024-04-23T21:10:45,592  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:10:45,598  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,598  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:10:45,599  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,599  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_19f47e89-64ed-426a-b95e-230cac78162c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,601  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:10:45,602  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:10:45,602  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:45,602  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:45,605  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:10:45,605  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:45,607  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:45,607  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,607  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,607  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,607  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getDatabase_(String)=2, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,607  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_19f47e89-64ed-426a-b95e-230cac78162c); Time taken: 0.008 seconds
2024-04-23T21:10:45,608  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423211045_19f47e89-64ed-426a-b95e-230cac78162c
2024-04-23T21:10:45,608  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211045_19f47e89-64ed-426a-b95e-230cac78162c
2024-04-23T21:10:45,624  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211045_19f47e89-64ed-426a-b95e-230cac78162c LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:10:45,624  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:45,624  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_19f47e89-64ed-426a-b95e-230cac78162c): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:45,624  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,625  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931845, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, bucketing_version=2, transactional=false, numFilesErasureCoded=0, numFiles=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:45,631  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidnonbucket
2024-04-23T21:10:45,650  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,650  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=25}
2024-04-23T21:10:45,650  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_19f47e89-64ed-426a-b95e-230cac78162c); Time taken: 0.026 seconds
2024-04-23T21:10:45,650  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_19f47e89-64ed-426a-b95e-230cac78162c
2024-04-23T21:10:45,655  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:10:45,662  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,662  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:10:45,671  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:10:45,671  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_3c012b75-fa2a-4820-8b8c-e4dde306d087): drop table if exists T
2024-04-23T21:10:45,675  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:10:45,675  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:10:45,676  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:45,703  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:45,704  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,704  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,704  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,704  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=28, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,704  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_3c012b75-fa2a-4820-8b8c-e4dde306d087); Time taken: 0.033 seconds
2024-04-23T21:10:45,704  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423211045_3c012b75-fa2a-4820-8b8c-e4dde306d087
2024-04-23T21:10:45,705  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211045_3c012b75-fa2a-4820-8b8c-e4dde306d087
2024-04-23T21:10:45,726  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211045_3c012b75-fa2a-4820-8b8c-e4dde306d087 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:10:45,726  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:45,726  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_3c012b75-fa2a-4820-8b8c-e4dde306d087): drop table if exists T
2024-04-23T21:10:45,727  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:45,737  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:45,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:45,746  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:45,746  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T21:10:45,903  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t does not exist; Force to delete it.
2024-04-23T21:10:45,903 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:45,903  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:45,903  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=166, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:45,904  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_3c012b75-fa2a-4820-8b8c-e4dde306d087); Time taken: 0.177 seconds
2024-04-23T21:10:45,904  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_3c012b75-fa2a-4820-8b8c-e4dde306d087
2024-04-23T21:10:45,908  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:10:45,914  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:45,914  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:10:45,915  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T21:10:45,915  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211045_04938aed-941e-4a4a-8899-5031c4c41130): drop table if exists Tstage
2024-04-23T21:10:45,918  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:10:45,918  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:10:45,919  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:45,944  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:45,944  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:45,944  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:45,944  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:45,945  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getTable_(GetTableRequest)=25}
2024-04-23T21:10:45,945  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211045_04938aed-941e-4a4a-8899-5031c4c41130); Time taken: 0.029 seconds
2024-04-23T21:10:45,945  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423211045_04938aed-941e-4a4a-8899-5031c4c41130
2024-04-23T21:10:45,946  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211045_04938aed-941e-4a4a-8899-5031c4c41130
2024-04-23T21:10:45,961  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211045_04938aed-941e-4a4a-8899-5031c4c41130 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:10:45,961  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:45,961  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211045_04938aed-941e-4a4a-8899-5031c4c41130): drop table if exists Tstage
2024-04-23T21:10:45,961  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:45,961  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:45,971  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:45,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:45,980  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:45,981  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T21:10:46,022  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage does not exist; Force to delete it.
2024-04-23T21:10:46,022 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:46,023  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:46,023  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=51, getTable_(GetTableRequest)=10}
2024-04-23T21:10:46,023  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211045_04938aed-941e-4a4a-8899-5031c4c41130); Time taken: 0.062 seconds
2024-04-23T21:10:46,023  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211045_04938aed-941e-4a4a-8899-5031c4c41130
2024-04-23T21:10:46,028  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:10:46,035  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:46,035  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:10:46,036  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:46,036  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211046_9a44fa36-c364-425b-834f-a683f7c4060c): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:46,039  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:10:46,040  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:10:46,040  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:46,040  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:46,047  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:10:46,047  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:46,049  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:46,049  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:46,049  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:46,049  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:46,049  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-23T21:10:46,050  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211046_9a44fa36-c364-425b-834f-a683f7c4060c); Time taken: 0.013 seconds
2024-04-23T21:10:46,050  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423211046_9a44fa36-c364-425b-834f-a683f7c4060c
2024-04-23T21:10:46,050  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211046_9a44fa36-c364-425b-834f-a683f7c4060c
2024-04-23T21:10:46,070  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211046_9a44fa36-c364-425b-834f-a683f7c4060c LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:10:46,070  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:46,070  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211046_9a44fa36-c364-425b-834f-a683f7c4060c): create table T (a int, b int) partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:46,070  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:46,071  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931846, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:46,077  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:46,114  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:46,115  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:46,115  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211046_9a44fa36-c364-425b-834f-a683f7c4060c); Time taken: 0.044 seconds
2024-04-23T21:10:46,115  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211046_9a44fa36-c364-425b-834f-a683f7c4060c
2024-04-23T21:10:46,119  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:10:46,126  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:46,126  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:10:46,126  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:46,127  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211046_a6aeba1e-1b70-4267-864b-c31f933b0258): create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:46,130  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 2
2024-04-23T21:10:46,131  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:10:46,132  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:46,132  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:46,135  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T21:10:46,135  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:46,137  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:46,137  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:46,137  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:46,137  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:46,137  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=3, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getDatabase_(String)=2, getValidTxns_(long)=1, openTxn_(String, TxnType)=3}
2024-04-23T21:10:46,137  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211046_a6aeba1e-1b70-4267-864b-c31f933b0258); Time taken: 0.01 seconds
2024-04-23T21:10:46,138  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423211046_a6aeba1e-1b70-4267-864b-c31f933b0258
2024-04-23T21:10:46,138  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211046_a6aeba1e-1b70-4267-864b-c31f933b0258
2024-04-23T21:10:46,154  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211046_a6aeba1e-1b70-4267-864b-c31f933b0258 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:10:46,154  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:46,155  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211046_a6aeba1e-1b70-4267-864b-c31f933b0258): create table Tstage (a int, b int)  partitioned by (p int) clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:46,155  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:46,156  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713931846, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:46,162  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:46,185  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:46,185  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=28, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:46,185  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211046_a6aeba1e-1b70-4267-864b-c31f933b0258); Time taken: 0.03 seconds
2024-04-23T21:10:46,185  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211046_a6aeba1e-1b70-4267-864b-c31f933b0258
2024-04-23T21:10:46,189  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:10:46,195  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:46,195  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:10:46,196  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-23T21:10:46,196  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d): insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-23T21:10:46,200  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 5
2024-04-23T21:10:46,201  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:10:46,201  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:46,201  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:46,205  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:46,212  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:46,212  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:46,212  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:46,212  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:46,212  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:46,212  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:46,220  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:46,221  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T21:10:46,233  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:46,233  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:10:46,263  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:46,340  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:46,340  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:46,340  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:46,341  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:46,343  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:46,343  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:46,343  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:46,343  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:46,350  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:46,350  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T21:10:46,357  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:46,358  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:46,368  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 17
2024-04-23T21:10:46,368  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=tstage (txnIds: [17])
2024-04-23T21:10:46,369  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:46,372  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:10:46,372  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col1]}
2024-04-23T21:10:46,373  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:46,374  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:46,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:46,390  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:46,391  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:46,391  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:46,392  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:46,392  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:46,393  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions_ps_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T21:10:46,408  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:10:46,408  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:46,408  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, getAllTableConstraints_(AllTableConstraintsRequest)=29, flushCache_()=0, getValidTxns_(long)=0, allocateTableWriteId_(long, String, String)=8, getTable_(GetTableRequest)=30, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getNotNullConstraints_(NotNullConstraintsRequest)=1, listPartitionsWithAuthInfo_(String, String, List, short, String, List)=16, getValidWriteIds_(List, String)=2, getCheckConstraints_(CheckConstraintsRequest)=1}
2024-04-23T21:10:46,408  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d); Time taken: 0.212 seconds
2024-04-23T21:10:46,409  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d
2024-04-23T21:10:46,409  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d
2024-04-23T21:10:46,427  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:10:46,427  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:46,430  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d): insert into Tstage partition(p=1) values(0,2),(1,4)
2024-04-23T21:10:46,430  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d
2024-04-23T21:10:46,430  INFO [main] ql.Driver: Query ID = alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d
Total jobs = 1
2024-04-23T21:10:46,430  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:46,430  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:46,564  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:10:46,564  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:46,564  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:46,564  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:46,564  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:46,564  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:46,564  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:46,564  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:46,566  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:46,566  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:10:46,566  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/hive_2024-04-23_21-10-46_196_4774323572354484073-1/dummy_path
2024-04-23T21:10:46,576  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:46,576  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:10:46,581  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:46,583  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:10:46,584  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:46,588  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/hive_2024-04-23_21-10-46_196_4774323572354484073-1/-mr-10000
2024-04-23T21:10:46,590  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:46,597  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:46,602  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:46,603  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:10:46,603  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:10:46,603  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/hive_2024-04-23_21-10-46_196_4774323572354484073-1/dummy_path
2024-04-23T21:10:46,603  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:10:46,621  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:10:46,640  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1937837826_0009
2024-04-23T21:10:46,640  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:46,701  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:46,701  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:46,702  INFO [Thread-810] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:46,702  INFO [Thread-810] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:46,703  INFO [Thread-810] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:46,704  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1937837826_0009_m_000000_0
2024-04-23T21:10:46,706  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:46,707  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/hive_2024-04-23_21-10-46_196_4774323572354484073-1/dummy_path/null:0+1
2024-04-23T21:10:46,709  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:46,709  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:10:46,710  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:10:46,715  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:46,715  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:46,715  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:46,715  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:46,715  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:46,716  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:46,716  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:46,716  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:46,717  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:46,717  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:46,717  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:10:46,717  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:10:46,717  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:46,717  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:10:46,718  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:10:46,718  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:46,718  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:10:46,718  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:10:46,718  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:3, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:10:46,719  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_4:2, 
2024-04-23T21:10:46,722  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:46,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:46,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:46,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:10:46,722  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:46,733  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:46,738  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1937837826_0009_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:46,739  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:10:46,739  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1937837826_0009_m_000000_0' done.
2024-04-23T21:10:46,739  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1937837826_0009_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=201496
		FILE: Number of bytes written=10710286
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1122500608
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-23T21:10:46,739  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1937837826_0009_m_000000_0
2024-04-23T21:10:46,739  INFO [Thread-810] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:46,740  INFO [Thread-810] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:46,741  INFO [pool-46-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1937837826_0009_r_000000_0
2024-04-23T21:10:46,743  INFO [pool-46-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:46,743  INFO [pool-46-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@56972864
2024-04-23T21:10:46,743  WARN [pool-46-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:46,744  INFO [pool-46-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:46,744  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1937837826_0009_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:46,747  INFO [localfetcher#8] reduce.LocalFetcher: localfetcher#8 about to shuffle output of map attempt_local1937837826_0009_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:10:46,747  INFO [localfetcher#8] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1937837826_0009_m_000000_0
2024-04-23T21:10:46,747  INFO [localfetcher#8] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:10:46,748  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:46,748  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:46,748  INFO [pool-46-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:46,758  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:46,759  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:10:46,761  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:46,761  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:10:46,761  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:46,761  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:46,762  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:10:46,762  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:46,762  INFO [pool-46-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:46,763  INFO [pool-46-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:10:46,764  INFO [pool-46-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:46,764  INFO [pool-46-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:46,765  INFO [pool-46-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:10:46,765  INFO [pool-46-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:10:46,765  INFO [pool-46-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1937837826_0009/job_local1937837826_0009.xml], properties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@5624926e
2024-04-23T21:10:46,766  INFO [pool-46-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:46,766  INFO [pool-46-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:46,766  INFO [pool-46-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:10:46,766  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-23T21:10:46,766  INFO [pool-46-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1
2024-04-23T21:10:46,766  INFO [pool-46-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1
2024-04-23T21:10:46,766  INFO [pool-46-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:46,774  INFO [pool-46-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_1_default.tstage:0, RECORDS_OUT_OPERATOR_FS_6:0, 
2024-04-23T21:10:46,774  INFO [pool-46-thread-1] mapred.Task: Task:attempt_local1937837826_0009_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:46,774  INFO [pool-46-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:46,775  INFO [pool-46-thread-1] mapred.Task: Task 'attempt_local1937837826_0009_r_000000_0' done.
2024-04-23T21:10:46,775  INFO [pool-46-thread-1] mapred.Task: Final Counters for attempt_local1937837826_0009_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=207628
		FILE: Number of bytes written=10710348
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1122500608
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:46,775  INFO [pool-46-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1937837826_0009_r_000000_0
2024-04-23T21:10:46,775  INFO [pool-46-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1937837826_0009_r_000001_0
2024-04-23T21:10:46,775  INFO [pool-46-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:46,775  INFO [pool-46-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@57200f98
2024-04-23T21:10:46,776  WARN [pool-46-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:46,777  INFO [pool-46-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:46,777  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1937837826_0009_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:46,780  INFO [localfetcher#9] reduce.LocalFetcher: localfetcher#9 about to shuffle output of map attempt_local1937837826_0009_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:10:46,780  INFO [localfetcher#9] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1937837826_0009_m_000000_0
2024-04-23T21:10:46,780  INFO [localfetcher#9] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:10:46,780  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:46,781  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:46,781  INFO [pool-46-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:46,787  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:46,787  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:10:46,789  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:46,789  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:10:46,789  INFO [pool-46-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:46,789  INFO [pool-46-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:46,790  INFO [pool-46-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:10:46,790  INFO [pool-46-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:46,790  INFO [pool-46-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:46,791  INFO [pool-46-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,96KB
2024-04-23T21:10:46,792  INFO [pool-46-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:46,792  INFO [pool-46-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:46,792  INFO [pool-46-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:10:46,792  INFO [pool-46-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:10:46,792  INFO [pool-46-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1937837826_0009/job_local1937837826_0009.xml], properties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={transactional_properties=default, name=default.tstage, transactional=true, columns.types=int:int, bucket_field_name=a, columns=a,b, columns.comments= , partition_columns.types=int, partition_columns=p, bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@3a1bcae
2024-04-23T21:10:46,793  INFO [pool-46-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1
2024-04-23T21:10:46,793  INFO [pool-46-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1
2024-04-23T21:10:46,793  INFO [pool-46-thread-1] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:46,793  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:10:46,793  INFO [pool-46-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 blockSize: 268435456 compression: Compress: ZLIB buffer: 32768
2024-04-23T21:10:46,803  INFO [pool-46-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0 with stripeSize: 8388608 options: Compress: ZLIB buffer: 32768
2024-04-23T21:10:46,809  INFO [pool-46-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:46,809  INFO [pool-46-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:10:46,809  INFO [pool-46-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:10:46,809  INFO [pool-46-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:10:46,814  INFO [pool-46-thread-1] FileOperations: Writing manifest to file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest with [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0]
2024-04-23T21:10:46,826  INFO [pool-46-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_6:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, 
2024-04-23T21:10:46,826  INFO [pool-46-thread-1] mapred.Task: Task:attempt_local1937837826_0009_r_000001_0 is done. And is in the process of committing
2024-04-23T21:10:46,826  INFO [pool-46-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:46,826  INFO [pool-46-thread-1] mapred.Task: Task 'attempt_local1937837826_0009_r_000001_0' done.
2024-04-23T21:10:46,826  INFO [pool-46-thread-1] mapred.Task: Final Counters for attempt_local1937837826_0009_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=213790
		FILE: Number of bytes written=10711436
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1122500608
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:46,826  INFO [pool-46-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1937837826_0009_r_000001_0
2024-04-23T21:10:46,827  INFO [Thread-810] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:47,703 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:47,703  INFO [main] exec.Task: 2024-04-23 21:10:47,703 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1937837826_0009
2024-04-23T21:10:47,704  INFO [main] exec.Task: Ended Job = job_local1937837826_0009
2024-04-23T21:10:47,705  INFO [main] FileOperations: Found manifest file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest with attemptId 0.
2024-04-23T21:10:47,705  INFO [main] FileOperations: Looking at manifest file: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/_tmp.delta_0000001_0000001_0000/000001_0.manifest
2024-04-23T21:10:47,706  INFO [main] FileOperations: Deleting manifest directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/_tmp.delta_0000001_0000001_0000
2024-04-23T21:10:47,708  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage partition (p=1)
2024-04-23T21:10:47,708  INFO [main] exec.Task: Loading data to table default.tstage partition (p=1) from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1
2024-04-23T21:10:47,708  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:47,717  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:47,718  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T21:10:47,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:47,718  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:47,727  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:47,727  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T21:10:47,742  WARN [main] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:10:47,743  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partition : tbl=hive.default.tstage	
2024-04-23T21:10:47,781  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T21:10:47,813  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:10:47,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:47,820  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:47,821  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:10:47,821  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/hive_2024-04-23_21-10-46_196_4774323572354484073-1/-mr-10000
2024-04-23T21:10:47,823  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:47,831  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:47,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.tstage[1]	
2024-04-23T21:10:47,852  WARN [stats-updater-thread-0] FileOperations: Computing stats for an ACID table; stats may be inaccurate
2024-04-23T21:10:47,852  INFO [main] FileOperations: Read stats for default.tstage/p=1/, numRows, true, 2, false: 
2024-04-23T21:10:47,852  INFO [main] FileOperations: Read stats for default.tstage/p=1/, rawDataSize, true, 0, false: 
2024-04-23T21:10:47,852  INFO [main] stats.BasicStatsTask: Partition {p=1} stats: [numFiles=1, numRows=2, totalSize=692, rawDataSize=0, numFilesErasureCoded=0]
2024-04-23T21:10:47,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.tstage	
2024-04-23T21:10:47,853  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T21:10:47,920  INFO [main] FileOperations: Read stats for default.tstage/p=1/, insertCount, true, 2, false: 
2024-04-23T21:10:47,920  INFO [main] FileOperations: Read stats for default.tstage/p=1/, updateCount, true, 0, false: 
2024-04-23T21:10:47,920  INFO [main] FileOperations: Read stats for default.tstage/p=1/, deleteCount, true, 0, false: 
2024-04-23T21:10:47,923  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:47,924  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=0, add_partition_(Partition)=38, validatePartitionNameCharacters_(List)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=42, alter_partitions_(String, String, List, EnvironmentContext, String, long)=68, getTable_(GetTableRequest)=35, updateTransactionalStatistics_(UpdateTransactionalStatsRequest)=3, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T21:10:47,924  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:47,924  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:47,924  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:47,924  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d); Time taken: 1.493 seconds
2024-04-23T21:10:47,924  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211046_0c2a656c-c273-4304-816c-3be4e741e96d
2024-04-23T21:10:47,936  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:47,936  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:10:47,937  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0'
2024-04-23T21:10:47,937  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/hive_2024-04-23_21-10-46_196_4774323572354484073-1
2024-04-23T21:10:47,938  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/9ef691ee-ca9c-4c89-9ece-0fcb514eadae/hive_2024-04-23_21-10-46_196_4774323572354484073-1 on fs with scheme file
2024-04-23T21:10:47,938  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211047_e8de5a59-02d9-48ab-8574-89f95df153b4): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0'
2024-04-23T21:10:47,942  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:10:47,943  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:10:47,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:47,951  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
FAILED: SemanticException [Error 10413]: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
2024-04-23T21:10:47,953 ERROR [main] ql.Driver: FAILED: SemanticException [Error 10413]: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
org.apache.hadoop.hive.ql.parse.SemanticException: "file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/p=1/delta_0000001_0000001_0000/bucket_00001_0" was created by Acid write - it cannot be loaded into anther Acid table
	at org.apache.hadoop.hive.ql.io.AcidUtils.validateAcidFiles(AcidUtils.java:3072)
	at org.apache.hadoop.hive.ql.io.AcidUtils.validateAcidPartitionLocation(AcidUtils.java:3089)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionAnalyzer.postProcess(AlterTableAddPartitionAnalyzer.java:78)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AbstractAddPartitionAnalyzer.analyzeCommand(AbstractAddPartitionAnalyzer.java:78)
	at org.apache.hadoop.hive.ql.ddl.table.AbstractAlterTableAnalyzer.analyzeInternal(AbstractAlterTableAnalyzer.java:62)
	at org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer.analyze(BaseSemanticAnalyzer.java:317)
	at org.apache.hadoop.hive.ql.Compiler.analyze(Compiler.java:223)
	at org.apache.hadoop.hive.ql.Compiler.compile(Compiler.java:105)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:500)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:453)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:181)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriver(TxnCommandsBaseForTests.java:245)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionTransactional(TestTxnAddPartition.java:296)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:10:47,953  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:47,954  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3}
2024-04-23T21:10:47,954  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211047_e8de5a59-02d9-48ab-8574-89f95df153b4); Time taken: 0.015 seconds
2024-04-23T21:10:47,954  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:10:47,957  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:47,965  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:47,965  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211047_ea07bf1c-2778-4e7f-901f-6084def32ad6): drop table if exists acidTbl
2024-04-23T21:10:47,968  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:10:47,968  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:10:47,969  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:47,975  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:47,975  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:47,976  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:47,976  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:47,976  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, flushCache_()=0, openTxn_(String, TxnType)=3, getTable_(GetTableRequest)=6, rollbackTxn_(long)=10}
2024-04-23T21:10:47,976  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211047_ea07bf1c-2778-4e7f-901f-6084def32ad6); Time taken: 0.011 seconds
2024-04-23T21:10:47,976  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423211047_ea07bf1c-2778-4e7f-901f-6084def32ad6
2024-04-23T21:10:47,977  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211047_ea07bf1c-2778-4e7f-901f-6084def32ad6
2024-04-23T21:10:48,000  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211047_ea07bf1c-2778-4e7f-901f-6084def32ad6 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:10:48,000  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:48,001  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211047_ea07bf1c-2778-4e7f-901f-6084def32ad6): drop table if exists acidTbl
2024-04-23T21:10:48,001  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,001  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:48,008  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,009  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:48,016  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,016  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:48,113  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,113  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=104}
2024-04-23T21:10:48,113  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211047_ea07bf1c-2778-4e7f-901f-6084def32ad6); Time taken: 0.112 seconds
2024-04-23T21:10:48,113  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211047_ea07bf1c-2778-4e7f-901f-6084def32ad6
2024-04-23T21:10:48,117  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:10:48,123  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,125  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:10:48,125  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:48,126  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_c6f05e56-c84d-410f-a5d8-116f526b90ab): drop table if exists acidTblPart
2024-04-23T21:10:48,128  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:10:48,128  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:10:48,129  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:48,148  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,148  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,148  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,148  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,149  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=19, flushCache_()=0}
2024-04-23T21:10:48,149  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_c6f05e56-c84d-410f-a5d8-116f526b90ab); Time taken: 0.022 seconds
2024-04-23T21:10:48,149  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423211048_c6f05e56-c84d-410f-a5d8-116f526b90ab
2024-04-23T21:10:48,150  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211048_c6f05e56-c84d-410f-a5d8-116f526b90ab
2024-04-23T21:10:48,167  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211048_c6f05e56-c84d-410f-a5d8-116f526b90ab LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:10:48,167  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:48,167  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_c6f05e56-c84d-410f-a5d8-116f526b90ab): drop table if exists acidTblPart
2024-04-23T21:10:48,168  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,168  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:48,174  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,175  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:48,181  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,181  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:48,222  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,222  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=47, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:10:48,222  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_c6f05e56-c84d-410f-a5d8-116f526b90ab); Time taken: 0.055 seconds
2024-04-23T21:10:48,222  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_c6f05e56-c84d-410f-a5d8-116f526b90ab
2024-04-23T21:10:48,226  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:10:48,231  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,231  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:10:48,232  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:48,232  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_63264e58-839b-46f4-83c4-fd68d20cca62): drop table if exists acidTbl2
2024-04-23T21:10:48,235  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T21:10:48,235  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:10:48,236  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,236  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,236  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,236  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:10:48,236  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_63264e58-839b-46f4-83c4-fd68d20cca62); Time taken: 0.004 seconds
2024-04-23T21:10:48,237  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423211048_63264e58-839b-46f4-83c4-fd68d20cca62
2024-04-23T21:10:48,237  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:48,237  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_63264e58-839b-46f4-83c4-fd68d20cca62): drop table if exists acidTbl2
2024-04-23T21:10:48,237  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,237  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:10:48,238  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,238  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, dropTable_(String, String, boolean, boolean, boolean)=1, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,238  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_63264e58-839b-46f4-83c4-fd68d20cca62); Time taken: 0.001 seconds
2024-04-23T21:10:48,238  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_63264e58-839b-46f4-83c4-fd68d20cca62
2024-04-23T21:10:48,243  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:10:48,248  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,248  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:10:48,249  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:48,249  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_69ad738d-a757-4ae0-8b9a-7c5af529689a): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:48,252  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 18
2024-04-23T21:10:48,252  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:10:48,253  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:48,275  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,275  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,275  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,275  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,276  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=1, getTable_(GetTableRequest)=22, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T21:10:48,276  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_69ad738d-a757-4ae0-8b9a-7c5af529689a); Time taken: 0.026 seconds
2024-04-23T21:10:48,276  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423211048_69ad738d-a757-4ae0-8b9a-7c5af529689a
2024-04-23T21:10:48,277  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211048_69ad738d-a757-4ae0-8b9a-7c5af529689a
2024-04-23T21:10:48,291  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211048_69ad738d-a757-4ae0-8b9a-7c5af529689a LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:10:48,291  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:48,291  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_69ad738d-a757-4ae0-8b9a-7c5af529689a): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:48,291  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,291  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:48,300  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,300  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:48,309  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:48,340  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,341  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=40, getTable_(GetTableRequest)=9}
2024-04-23T21:10:48,341  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_69ad738d-a757-4ae0-8b9a-7c5af529689a); Time taken: 0.049 seconds
2024-04-23T21:10:48,341  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_69ad738d-a757-4ae0-8b9a-7c5af529689a
2024-04-23T21:10:48,345  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:10:48,350  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,350  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:10:48,351  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:48,352  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_13abc9f8-9f48-4b92-82e1-3c8b7f3a5339): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:48,354  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 18
2024-04-23T21:10:48,355  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:10:48,356  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:48,364  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,364  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,364  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,364  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,364  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,365  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_13abc9f8-9f48-4b92-82e1-3c8b7f3a5339); Time taken: 0.012 seconds
2024-04-23T21:10:48,365  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423211048_13abc9f8-9f48-4b92-82e1-3c8b7f3a5339
2024-04-23T21:10:48,365  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211048_13abc9f8-9f48-4b92-82e1-3c8b7f3a5339
2024-04-23T21:10:48,382  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211048_13abc9f8-9f48-4b92-82e1-3c8b7f3a5339 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:10:48,382  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:48,382  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_13abc9f8-9f48-4b92-82e1-3c8b7f3a5339): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:48,383  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,383  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:48,391  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,391  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:48,400  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,400  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:48,430  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,430  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=39, getTable_(GetTableRequest)=8}
2024-04-23T21:10:48,431  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_13abc9f8-9f48-4b92-82e1-3c8b7f3a5339); Time taken: 0.048 seconds
2024-04-23T21:10:48,431  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_13abc9f8-9f48-4b92-82e1-3c8b7f3a5339
2024-04-23T21:10:48,436  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:10:48,442  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,442  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:10:48,443  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:48,443  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_437321a9-d0f9-404a-abbb-4e4eecb7c02f): drop table if exists nonAcidNonBucket
2024-04-23T21:10:48,446  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 18
2024-04-23T21:10:48,446  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:10:48,447  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:48,456  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,456  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,456  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,456  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,456  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:10:48,457  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_437321a9-d0f9-404a-abbb-4e4eecb7c02f); Time taken: 0.013 seconds
2024-04-23T21:10:48,457  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423211048_437321a9-d0f9-404a-abbb-4e4eecb7c02f
2024-04-23T21:10:48,457  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211048_437321a9-d0f9-404a-abbb-4e4eecb7c02f
2024-04-23T21:10:48,471  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211048_437321a9-d0f9-404a-abbb-4e4eecb7c02f LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:10:48,471  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:48,471  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_437321a9-d0f9-404a-abbb-4e4eecb7c02f): drop table if exists nonAcidNonBucket
2024-04-23T21:10:48,472  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,472  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:48,480  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,481  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:48,489  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:48,489  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:48,520  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,520  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=40}
2024-04-23T21:10:48,520  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_437321a9-d0f9-404a-abbb-4e4eecb7c02f); Time taken: 0.049 seconds
2024-04-23T21:10:48,520  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_437321a9-d0f9-404a-abbb-4e4eecb7c02f
2024-04-23T21:10:48,524  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T21:10:48,529  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,529  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T21:10:48,530  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T21:10:48,596  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:10:48,596  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:10:48,596  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:10:48,596  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:10:48,596  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:10:48,596  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:10:48,597  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:10:48,597  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:10:48,597  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:10:48,597  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:10:48,602  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:10:48,604  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = ab76c071-02a1-4cb7-8efe-fcf226cd825e
2024-04-23T21:10:48,606  INFO [main] SessionState: Hive Session ID = ab76c071-02a1-4cb7-8efe-fcf226cd825e
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:48,607  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:48,612  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/ab76c071-02a1-4cb7-8efe-fcf226cd825e
2024-04-23T21:10:48,614  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e
2024-04-23T21:10:48,617  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/ab76c071-02a1-4cb7-8efe-fcf226cd825e/_tmp_space.db
2024-04-23T21:10:48,617  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=ab76c071-02a1-4cb7-8efe-fcf226cd825e, clientType=HIVECLI]
2024-04-23T21:10:48,617  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:48,618  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_ee1ed0e7-14ca-4771-84fc-6c2066b02a32): drop table if exists acidTbl
2024-04-23T21:10:48,627  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:10:48,627  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:10:48,630  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:48,639  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,639  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,639  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,640  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=2, openTxn_(String, TxnType)=9}
2024-04-23T21:10:48,640  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_ee1ed0e7-14ca-4771-84fc-6c2066b02a32); Time taken: 0.021 seconds
2024-04-23T21:10:48,640  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423211048_ee1ed0e7-14ca-4771-84fc-6c2066b02a32
2024-04-23T21:10:48,640  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:48,640  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_ee1ed0e7-14ca-4771-84fc-6c2066b02a32): drop table if exists acidTbl
2024-04-23T21:10:48,641  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,641  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:48,645  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,645  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,645  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_ee1ed0e7-14ca-4771-84fc-6c2066b02a32); Time taken: 0.005 seconds
2024-04-23T21:10:48,645  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_ee1ed0e7-14ca-4771-84fc-6c2066b02a32
2024-04-23T21:10:48,651  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:10:48,657  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,657  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:10:48,658  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:48,658  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_2d304343-ca18-4f15-953d-217c4c08d9e8): drop table if exists acidTblPart
2024-04-23T21:10:48,661  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:10:48,661  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:10:48,662  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:48,665  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,665  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,665  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,665  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:10:48,665  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_2d304343-ca18-4f15-953d-217c4c08d9e8); Time taken: 0.007 seconds
2024-04-23T21:10:48,665  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423211048_2d304343-ca18-4f15-953d-217c4c08d9e8
2024-04-23T21:10:48,665  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:48,665  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_2d304343-ca18-4f15-953d-217c4c08d9e8): drop table if exists acidTblPart
2024-04-23T21:10:48,666  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:48,669  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,669  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,669  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_2d304343-ca18-4f15-953d-217c4c08d9e8); Time taken: 0.004 seconds
2024-04-23T21:10:48,670  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_2d304343-ca18-4f15-953d-217c4c08d9e8
2024-04-23T21:10:48,675  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:10:48,680  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,680  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:10:48,681  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:48,681  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_41988bc3-837e-4db4-a9c6-df725e956545): drop table if exists acidTbl2
2024-04-23T21:10:48,684  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:10:48,684  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:10:48,685  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:48,687  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,687  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,687  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,688  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=2}
2024-04-23T21:10:48,688  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_41988bc3-837e-4db4-a9c6-df725e956545); Time taken: 0.006 seconds
2024-04-23T21:10:48,688  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423211048_41988bc3-837e-4db4-a9c6-df725e956545
2024-04-23T21:10:48,688  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:48,688  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_41988bc3-837e-4db4-a9c6-df725e956545): drop table if exists acidTbl2
2024-04-23T21:10:48,688  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:48,691  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,691  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,692  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_41988bc3-837e-4db4-a9c6-df725e956545); Time taken: 0.003 seconds
2024-04-23T21:10:48,692  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_41988bc3-837e-4db4-a9c6-df725e956545
2024-04-23T21:10:48,697  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:10:48,702  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,702  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:10:48,703  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:48,703  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_4ddc4766-3f2d-402d-a325-2cd7862d7a77): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:48,705  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:10:48,706  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:10:48,706  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:48,709  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,709  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,709  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,709  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:10:48,709  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_4ddc4766-3f2d-402d-a325-2cd7862d7a77); Time taken: 0.006 seconds
2024-04-23T21:10:48,710  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423211048_4ddc4766-3f2d-402d-a325-2cd7862d7a77
2024-04-23T21:10:48,710  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:48,710  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_4ddc4766-3f2d-402d-a325-2cd7862d7a77): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:48,710  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,710  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:48,715  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,715  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,716  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_4ddc4766-3f2d-402d-a325-2cd7862d7a77); Time taken: 0.005 seconds
2024-04-23T21:10:48,716  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_4ddc4766-3f2d-402d-a325-2cd7862d7a77
2024-04-23T21:10:48,723  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:10:48,729  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,729  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:10:48,730  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:48,730  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_d920df61-b611-4e5d-8c97-8e6dc041f9a3): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:48,732  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:10:48,733  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:10:48,733  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:48,736  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,736  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,736  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,736  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2}
2024-04-23T21:10:48,737  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_d920df61-b611-4e5d-8c97-8e6dc041f9a3); Time taken: 0.006 seconds
2024-04-23T21:10:48,737  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423211048_d920df61-b611-4e5d-8c97-8e6dc041f9a3
2024-04-23T21:10:48,737  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:48,737  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_d920df61-b611-4e5d-8c97-8e6dc041f9a3): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:48,737  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,737  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:48,740  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,740  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,741  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_d920df61-b611-4e5d-8c97-8e6dc041f9a3); Time taken: 0.003 seconds
2024-04-23T21:10:48,741  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_d920df61-b611-4e5d-8c97-8e6dc041f9a3
2024-04-23T21:10:48,745  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:10:48,751  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,751  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:10:48,752  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:48,752  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_de3ae92d-62f1-4626-bd6d-b6f15a1d069f): drop table if exists nonAcidNonBucket
2024-04-23T21:10:48,755  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:10:48,755  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:10:48,756  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:48,759  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,759  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,759  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,759  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2}
2024-04-23T21:10:48,759  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_de3ae92d-62f1-4626-bd6d-b6f15a1d069f); Time taken: 0.007 seconds
2024-04-23T21:10:48,759  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423211048_de3ae92d-62f1-4626-bd6d-b6f15a1d069f
2024-04-23T21:10:48,759  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:48,760  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_de3ae92d-62f1-4626-bd6d-b6f15a1d069f): drop table if exists nonAcidNonBucket
2024-04-23T21:10:48,760  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,760  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:48,763  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,763  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,763  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_de3ae92d-62f1-4626-bd6d-b6f15a1d069f); Time taken: 0.003 seconds
2024-04-23T21:10:48,763  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_de3ae92d-62f1-4626-bd6d-b6f15a1d069f
2024-04-23T21:10:48,768  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:10:48,773  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,773  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:10:48,774  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:48,774  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_03abc36c-9117-4229-9f8e-2bb0e2511b16): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:48,778  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:10:48,778  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:10:48,779  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:48,779  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:48,784  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:10:48,784  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:48,786  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:48,786  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,786  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,786  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,786  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getValidWriteIds_(List, String)=5, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:10:48,786  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_03abc36c-9117-4229-9f8e-2bb0e2511b16); Time taken: 0.012 seconds
2024-04-23T21:10:48,787  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423211048_03abc36c-9117-4229-9f8e-2bb0e2511b16
2024-04-23T21:10:48,787  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211048_03abc36c-9117-4229-9f8e-2bb0e2511b16
2024-04-23T21:10:48,806  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211048_03abc36c-9117-4229-9f8e-2bb0e2511b16 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:10:48,806  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:48,807  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_03abc36c-9117-4229-9f8e-2bb0e2511b16): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:48,807  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,808  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931848, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0, transactional=true, totalSize=0, bucketing_version=2, rawDataSize=0, numFilesErasureCoded=0, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:48,813  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtbl
2024-04-23T21:10:48,849  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,849  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=41, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,850  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_03abc36c-9117-4229-9f8e-2bb0e2511b16); Time taken: 0.042 seconds
2024-04-23T21:10:48,850  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_03abc36c-9117-4229-9f8e-2bb0e2511b16
2024-04-23T21:10:48,854  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:10:48,860  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,860  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:10:48,861  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:48,861  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_765921d9-2889-482e-80b2-8cb4647378f6): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:48,864  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:10:48,864  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:10:48,865  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:48,865  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:48,867  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:10:48,868  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:48,871  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:48,871  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,871  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,871  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,871  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=1}
2024-04-23T21:10:48,872  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_765921d9-2889-482e-80b2-8cb4647378f6); Time taken: 0.01 seconds
2024-04-23T21:10:48,872  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423211048_765921d9-2889-482e-80b2-8cb4647378f6
2024-04-23T21:10:48,872  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211048_765921d9-2889-482e-80b2-8cb4647378f6
2024-04-23T21:10:48,895  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211048_765921d9-2889-482e-80b2-8cb4647378f6 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:10:48,896  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:48,897  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_765921d9-2889-482e-80b2-8cb4647378f6): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:48,897  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,898  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931848, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:48,908  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtblpart
2024-04-23T21:10:48,926  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,926  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=28, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:48,926  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_765921d9-2889-482e-80b2-8cb4647378f6); Time taken: 0.029 seconds
2024-04-23T21:10:48,926  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_765921d9-2889-482e-80b2-8cb4647378f6
2024-04-23T21:10:48,931  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:10:48,937  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:48,937  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:10:48,938  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:48,939  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211048_f76758a1-f267-4b60-9160-72c00411137f): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:48,941  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:10:48,941  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:10:48,942  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:48,942  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:48,944  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:10:48,945  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:48,946  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:48,946  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:48,946  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:48,946  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:48,947  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=2, getValidTxns_(long)=0, getValidWriteIds_(List, String)=2}
2024-04-23T21:10:48,947  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211048_f76758a1-f267-4b60-9160-72c00411137f); Time taken: 0.007 seconds
2024-04-23T21:10:48,947  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423211048_f76758a1-f267-4b60-9160-72c00411137f
2024-04-23T21:10:48,947  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211048_f76758a1-f267-4b60-9160-72c00411137f
2024-04-23T21:10:48,962  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211048_f76758a1-f267-4b60-9160-72c00411137f LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:10:48,962  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:48,962  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211048_f76758a1-f267-4b60-9160-72c00411137f): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:48,962  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:48,964  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931848, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, rawDataSize=0, numFiles=0, totalSize=0, bucketing_version=2, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:48,969  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl
2024-04-23T21:10:48,990  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:48,991  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=27, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:48,991  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211048_f76758a1-f267-4b60-9160-72c00411137f); Time taken: 0.028 seconds
2024-04-23T21:10:48,991  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211048_f76758a1-f267-4b60-9160-72c00411137f
2024-04-23T21:10:48,995  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:10:49,003  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:49,003  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:10:49,004  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:49,004  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211049_d859ad85-1575-4405-838a-84e24288e60d): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:49,006  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:10:49,007  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:10:49,007  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:49,007  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:49,010  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:10:49,010  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:49,012  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:49,012  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:49,012  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:49,012  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:49,012  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=2, getDatabase_(String)=2, flushCache_()=0, getValidWriteIds_(List, String)=2}
2024-04-23T21:10:49,012  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211049_d859ad85-1575-4405-838a-84e24288e60d); Time taken: 0.008 seconds
2024-04-23T21:10:49,012  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423211049_d859ad85-1575-4405-838a-84e24288e60d
2024-04-23T21:10:49,013  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211049_d859ad85-1575-4405-838a-84e24288e60d
2024-04-23T21:10:49,028  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211049_d859ad85-1575-4405-838a-84e24288e60d LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:10:49,028  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:49,028  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211049_d859ad85-1575-4405-838a-84e24288e60d): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:49,028  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:49,029  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931849, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=false, totalSize=0, rawDataSize=0, numFiles=0, numRows=0, bucketing_version=2, numFilesErasureCoded=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:49,035  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl2
2024-04-23T21:10:49,050  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:49,050  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T21:10:49,050  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211049_d859ad85-1575-4405-838a-84e24288e60d); Time taken: 0.022 seconds
2024-04-23T21:10:49,050  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211049_d859ad85-1575-4405-838a-84e24288e60d
2024-04-23T21:10:49,054  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:10:49,060  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:49,060  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:10:49,060  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:49,061  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211049_200d8f87-9fd2-4618-94ef-3a1fa31c90bd): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:49,063  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:10:49,064  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:10:49,064  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:49,064  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:49,067  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:10:49,067  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:49,069  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:49,069  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:49,069  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:49,069  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:49,069  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=0, getDatabase_(String)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:10:49,069  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211049_200d8f87-9fd2-4618-94ef-3a1fa31c90bd); Time taken: 0.008 seconds
2024-04-23T21:10:49,070  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423211049_200d8f87-9fd2-4618-94ef-3a1fa31c90bd
2024-04-23T21:10:49,070  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211049_200d8f87-9fd2-4618-94ef-3a1fa31c90bd
2024-04-23T21:10:49,085  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211049_200d8f87-9fd2-4618-94ef-3a1fa31c90bd LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:10:49,085  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:49,085  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211049_200d8f87-9fd2-4618-94ef-3a1fa31c90bd): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:49,086  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:49,087  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/ab76c071-02a1-4cb7-8efe-fcf226cd825e/_tmp_space.db/03923158-1c5c-40c4-a270-3d75fbc472cf
2024-04-23T21:10:49,089  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:49,090  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:49,090  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211049_200d8f87-9fd2-4618-94ef-3a1fa31c90bd); Time taken: 0.004 seconds
2024-04-23T21:10:49,090  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211049_200d8f87-9fd2-4618-94ef-3a1fa31c90bd
2024-04-23T21:10:49,094  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:10:49,099  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:49,100  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:10:49,100  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:49,101  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211049_9f7b3fcb-8fc7-4b02-801a-0687fb9126a6): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:49,103  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:10:49,104  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:10:49,105  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:49,105  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:49,107  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:10:49,107  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:49,109  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:49,109  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:49,109  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:49,109  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:49,109  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:10:49,109  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211049_9f7b3fcb-8fc7-4b02-801a-0687fb9126a6); Time taken: 0.008 seconds
2024-04-23T21:10:49,110  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423211049_9f7b3fcb-8fc7-4b02-801a-0687fb9126a6
2024-04-23T21:10:49,110  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211049_9f7b3fcb-8fc7-4b02-801a-0687fb9126a6
2024-04-23T21:10:49,124  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211049_9f7b3fcb-8fc7-4b02-801a-0687fb9126a6 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:10:49,124  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:49,124  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211049_9f7b3fcb-8fc7-4b02-801a-0687fb9126a6): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:49,124  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:49,125  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931849, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, transactional=false, bucketing_version=2, numFiles=0, numFilesErasureCoded=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:49,131  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidnonbucket
2024-04-23T21:10:49,145  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:49,146  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T21:10:49,146  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211049_9f7b3fcb-8fc7-4b02-801a-0687fb9126a6); Time taken: 0.021 seconds
2024-04-23T21:10:49,146  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211049_9f7b3fcb-8fc7-4b02-801a-0687fb9126a6
2024-04-23T21:10:49,150  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:10:49,155  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:49,155  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:10:49,156  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:10:49,157  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211049_7be74d4f-9ecb-44a1-a483-f58543e08800): drop table if exists T
2024-04-23T21:10:49,159  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:10:49,159  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:10:49,160  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:49,178  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,178  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:49,178  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:49,178  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:49,179  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=18, openTxn_(String, TxnType)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1}
2024-04-23T21:10:49,179  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211049_7be74d4f-9ecb-44a1-a483-f58543e08800); Time taken: 0.021 seconds
2024-04-23T21:10:49,179  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423211049_7be74d4f-9ecb-44a1-a483-f58543e08800
2024-04-23T21:10:49,180  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211049_7be74d4f-9ecb-44a1-a483-f58543e08800
2024-04-23T21:10:49,194  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211049_7be74d4f-9ecb-44a1-a483-f58543e08800 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:10:49,194  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:49,194  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211049_7be74d4f-9ecb-44a1-a483-f58543e08800): drop table if exists T
2024-04-23T21:10:49,195  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:49,195  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:49,202  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,202  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:49,209  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,209  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T21:10:49,314  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t does not exist; Force to delete it.
2024-04-23T21:10:49,314 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:49,315  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:49,315  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=112, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:49,315  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211049_7be74d4f-9ecb-44a1-a483-f58543e08800); Time taken: 0.121 seconds
2024-04-23T21:10:49,315  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211049_7be74d4f-9ecb-44a1-a483-f58543e08800
2024-04-23T21:10:49,319  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:10:49,325  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:49,325  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:10:49,326  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T21:10:49,327  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211049_55b1b123-3879-4062-80fd-d29d7ecf5005): drop table if exists Tstage
2024-04-23T21:10:49,331  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:10:49,331  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:10:49,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:49,339  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,339  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:49,339  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:49,339  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:49,339  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=4, getValidTxns_(long)=1, getTable_(GetTableRequest)=7, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:49,340  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211049_55b1b123-3879-4062-80fd-d29d7ecf5005); Time taken: 0.012 seconds
2024-04-23T21:10:49,340  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423211049_55b1b123-3879-4062-80fd-d29d7ecf5005
2024-04-23T21:10:49,340  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211049_55b1b123-3879-4062-80fd-d29d7ecf5005
2024-04-23T21:10:49,354  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211049_55b1b123-3879-4062-80fd-d29d7ecf5005 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:10:49,354  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:49,354  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211049_55b1b123-3879-4062-80fd-d29d7ecf5005): drop table if exists Tstage
2024-04-23T21:10:49,355  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:49,355  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:49,362  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,362  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:49,369  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,369  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T21:10:49,453  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage does not exist; Force to delete it.
2024-04-23T21:10:49,453 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:49,453  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:49,453  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=91, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:10:49,454  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211049_55b1b123-3879-4062-80fd-d29d7ecf5005); Time taken: 0.099 seconds
2024-04-23T21:10:49,454  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211049_55b1b123-3879-4062-80fd-d29d7ecf5005
2024-04-23T21:10:49,460  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:10:49,470  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:49,472  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:10:49,473  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:49,473  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211049_07c957ef-94cf-4d1d-8e69-d43df6b6519d): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:49,477  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:10:49,478  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:10:49,478  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:49,479  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:49,487  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:10:49,487  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:49,490  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:49,490  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:49,490  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:49,490  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:49,490  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=19, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=4, flushCache_()=0, getValidWriteIds_(List, String)=7, getValidTxns_(long)=0, getDatabase_(String)=2}
2024-04-23T21:10:49,490  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211049_07c957ef-94cf-4d1d-8e69-d43df6b6519d); Time taken: 0.017 seconds
2024-04-23T21:10:49,491  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423211049_07c957ef-94cf-4d1d-8e69-d43df6b6519d
2024-04-23T21:10:49,491  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211049_07c957ef-94cf-4d1d-8e69-d43df6b6519d
2024-04-23T21:10:49,519  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211049_07c957ef-94cf-4d1d-8e69-d43df6b6519d LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:10:49,519  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:49,520  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211049_07c957ef-94cf-4d1d-8e69-d43df6b6519d): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:49,521  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:49,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931849, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:49,528  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:49,561  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:49,561  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=39, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:49,562  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211049_07c957ef-94cf-4d1d-8e69-d43df6b6519d); Time taken: 0.041 seconds
2024-04-23T21:10:49,562  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211049_07c957ef-94cf-4d1d-8e69-d43df6b6519d
2024-04-23T21:10:49,567  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:10:49,573  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:49,573  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:10:49,574  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:49,574  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211049_7ffd361f-d151-476e-9a77-463099a2ceaf): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:49,578  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T21:10:49,578  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:10:49,579  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:49,579  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:49,582  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T21:10:49,582  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:49,584  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:49,584  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:49,584  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:49,584  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:49,584  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, getDatabase_(String)=2, getValidTxns_(long)=1, getValidWriteIds_(List, String)=3, flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:10:49,584  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211049_7ffd361f-d151-476e-9a77-463099a2ceaf); Time taken: 0.01 seconds
2024-04-23T21:10:49,584  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423211049_7ffd361f-d151-476e-9a77-463099a2ceaf
2024-04-23T21:10:49,585  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211049_7ffd361f-d151-476e-9a77-463099a2ceaf
2024-04-23T21:10:49,601  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211049_7ffd361f-d151-476e-9a77-463099a2ceaf LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:10:49,601  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:49,601  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211049_7ffd361f-d151-476e-9a77-463099a2ceaf): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:49,601  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:49,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713931849, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, numFilesErasureCoded=0, bucketing_version=2, totalSize=0, numRows=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:49,607  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:49,623  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:49,623  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:49,623  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211049_7ffd361f-d151-476e-9a77-463099a2ceaf); Time taken: 0.022 seconds
2024-04-23T21:10:49,623  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211049_7ffd361f-d151-476e-9a77-463099a2ceaf
2024-04-23T21:10:49,627  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:10:49,634  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:49,634  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:10:49,635  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:49,635  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e): insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:49,638  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 2
2024-04-23T21:10:49,638  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:10:49,639  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:49,639  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:49,643  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:49,677  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,677  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:49,677  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:49,677  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:49,677  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:49,677  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:49,687  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,687  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:49,687  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:10:49,710  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:49,817  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:49,817  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:49,817  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:49,818  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:49,821  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:49,821  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:49,821  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:49,821  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:49,830  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,832  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1
2024-04-23T21:10:49,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:49,836  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:49,838  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:49,841  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:49,842  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:49,852  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:49,868  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,869  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T21:10:49,870  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:49,888  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:49,890  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:49,890  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:10:49,890  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:49,890  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:49,890  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:49,890  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:10:49,890  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:10:49,892  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:49,892  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:49,892  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:49,892  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:10:49,892  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:49,892  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=40, getNotNullConstraints_(NotNullConstraintsRequest)=1, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=3, getValidTxns_(long)=1, getCheckConstraints_(CheckConstraintsRequest)=1, flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=89, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:10:49,892  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e); Time taken: 0.257 seconds
2024-04-23T21:10:49,893  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e
2024-04-23T21:10:49,893  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e
2024-04-23T21:10:49,930  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:10:49,930  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:49,930  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e): insert into Tstage values(0,2),(0,4)
2024-04-23T21:10:49,931  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e
2024-04-23T21:10:49,931  INFO [main] ql.Driver: Query ID = alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e
Total jobs = 1
2024-04-23T21:10:49,931  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:49,931  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:50,102  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:10:50,102  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:10:50,105  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:50,105  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:10:50,105  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-49_635_1241518360581916563-1/dummy_path
2024-04-23T21:10:50,115  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:50,117  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,11KB
2024-04-23T21:10:50,118  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:50,122  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-49_635_1241518360581916563-1/-mr-10001
2024-04-23T21:10:50,127  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:50,135  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:50,140  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:50,141  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:10:50,141  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:10:50,141  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-49_635_1241518360581916563-1/dummy_path
2024-04-23T21:10:50,141  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:10:50,162  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:10:50,183  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1338162991_0010
2024-04-23T21:10:50,183  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:50,254  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:50,255  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:50,255  INFO [Thread-919] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:50,255  INFO [Thread-919] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:50,257  INFO [Thread-919] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:50,257  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1338162991_0010_m_000000_0
2024-04-23T21:10:50,261  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:50,262  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-49_635_1241518360581916563-1/dummy_path/null:0+1
2024-04-23T21:10:50,265  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:50,265  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,11KB
2024-04-23T21:10:50,266  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:10:50,269  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:50,269  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:50,270  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:50,270  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:50,270  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:10:50,270  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:10:50,271  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:50,271  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:10:50,271  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:50,271  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1338162991_0010/job_local1338162991_0010.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@598b9795
2024-04-23T21:10:50,272  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:50,272  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:50,272  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:50,274  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:50,275  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:3, 
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_OPERATOR_UDTF_2:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:50,283  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:10:50,291  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_1_default.tstage:2, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:50,292  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:50,295  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1338162991_0010_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:50,295  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:10:50,295  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1338162991_0010_m_000000_0' done.
2024-04-23T21:10:50,295  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1338162991_0010_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=221476
		FILE: Number of bytes written=11894094
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6168
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:50,295  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1338162991_0010_m_000000_0
2024-04-23T21:10:50,296  INFO [Thread-919] mapred.LocalJobRunner: map task executor complete.
2024-04-23 21:10:51,257 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:10:51,257  INFO [main] exec.Task: 2024-04-23 21:10:51,257 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1338162991_0010
2024-04-23T21:10:51,258  INFO [main] exec.Task: Ended Job = job_local1338162991_0010
2024-04-23T21:10:51,261  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T21:10:51,261  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T21:10:51,261  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T21:10:51,261  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T21:10:51,261  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/-ext-10000
2024-04-23T21:10:51,261  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/-ext-10002
2024-04-23T21:10:51,262  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T21:10:51,262  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1/-ext-10000
2024-04-23T21:10:51,262  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:51,272  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,272  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:51,280  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,282  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:51,282  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:51,309  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:10:51,310  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:51,319  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,319  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:10:51,319  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-49_635_1241518360581916563-1/-mr-10001
2024-04-23T21:10:51,320  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:51,329  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,330  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T21:10:51,330  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T21:10:51,330  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:51,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:51,356  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T21:10:51,357  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:51,357  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=37, alter_table_(String, String, String, Table, EnvironmentContext, String)=53}
MapReduce Jobs Launched: 
2024-04-23T21:10:51,357  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:51,357  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:51,358  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:51,358  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e); Time taken: 1.427 seconds
2024-04-23T21:10:51,358  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211049_84267442-93fd-43c7-a703-dc0c7c394e5e
2024-04-23T21:10:51,362  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:10:51,369  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:51,369  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:10:51,370  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:51,370  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1
2024-04-23T21:10:51,370  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-49_635_1241518360581916563-1 on fs with scheme file
2024-04-23T21:10:51,370  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-49_635_1241518360581916563-1
2024-04-23T21:10:51,371  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-49_635_1241518360581916563-1 on fs with scheme file
2024-04-23T21:10:51,371  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211051_a958015f-983a-4a76-bffc-721f40e72fbb): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:51,372  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:51,381  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,384  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:10:51,385  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:10:51,388  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:51,398  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,398  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:51,398  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:51,398  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:51,398  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:51,399  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:51,399  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:51,399  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:51,399  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=20, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, getCurrentNotificationEventId_()=2, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:10:51,399  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211051_a958015f-983a-4a76-bffc-721f40e72fbb); Time taken: 0.028 seconds
2024-04-23T21:10:51,399  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423211051_a958015f-983a-4a76-bffc-721f40e72fbb
2024-04-23T21:10:51,400  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211051_a958015f-983a-4a76-bffc-721f40e72fbb
2024-04-23T21:10:51,415  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211051_a958015f-983a-4a76-bffc-721f40e72fbb LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:10:51,415  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:51,415  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211051_a958015f-983a-4a76-bffc-721f40e72fbb): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:51,416  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:51,416  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:51,416  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:51,416  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:51,416  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:51,428  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:51,433  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:51,433  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:51,434  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211051_a958015f-983a-4a76-bffc-721f40e72fbb); Time taken: 0.018 seconds
2024-04-23T21:10:51,434  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211051_a958015f-983a-4a76-bffc-721f40e72fbb
2024-04-23T21:10:51,439  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:10:51,446  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:51,448  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:10:51,449  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:51,449  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211051_19882e13-5565-47dc-864d-f8a0c46134ab): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:51,449  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:51,460  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,462  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:10:51,462  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:10:51,464  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:51,472  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,472  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:51,472  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:51,472  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:51,472  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:51,472  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:51,472  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:51,473  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:51,473  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getCurrentNotificationEventId_()=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=14, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=19, getValidTxns_(long)=1}
2024-04-23T21:10:51,473  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211051_19882e13-5565-47dc-864d-f8a0c46134ab); Time taken: 0.023 seconds
2024-04-23T21:10:51,473  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423211051_19882e13-5565-47dc-864d-f8a0c46134ab
2024-04-23T21:10:51,474  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211051_19882e13-5565-47dc-864d-f8a0c46134ab
2024-04-23T21:10:51,488  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211051_19882e13-5565-47dc-864d-f8a0c46134ab LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:10:51,488  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:51,488  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211051_19882e13-5565-47dc-864d-f8a0c46134ab): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:10:51,488  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:51,488  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:51,488  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:51,488  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:51,488  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:10:51,499  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:51,504  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:51,504  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:51,504  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211051_19882e13-5565-47dc-864d-f8a0c46134ab); Time taken: 0.015 seconds
2024-04-23T21:10:51,504  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211051_19882e13-5565-47dc-864d-f8a0c46134ab
2024-04-23T21:10:51,508  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:10:51,513  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:51,513  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:10:51,514  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:51,514  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211051_88967d82-0c34-43a8-a05b-803826861679): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:51,517  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:10:51,517  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:10:51,518  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:51,524  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,533  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T21:10:51,533  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-23T21:10:51,535  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:51,535  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:51,535  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:51,535  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=8, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=6, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0}
2024-04-23T21:10:51,536  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211051_88967d82-0c34-43a8-a05b-803826861679); Time taken: 0.021 seconds
2024-04-23T21:10:51,536  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423211051_88967d82-0c34-43a8-a05b-803826861679
2024-04-23T21:10:51,536  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211051_88967d82-0c34-43a8-a05b-803826861679
2024-04-23T21:10:51,550  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211051_88967d82-0c34-43a8-a05b-803826861679 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:10:51,550  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:51,553  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211051_88967d82-0c34-43a8-a05b-803826861679): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:10:51,554  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:51,554  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:51,560  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,561  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:51,573  INFO [HMSHandler #9] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:51,573  INFO [HMSHandler #10] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1
2024-04-23T21:10:51,573  INFO [HMSHandler #11] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2
2024-04-23T21:10:51,603  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T21:10:51,604  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data
2024-04-23T21:10:51,604  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:51,610  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,611  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:51,627  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T21:10:51,627  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:51,627  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:51,634  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,634  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:51,643  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T21:10:51,647  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:51,647  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T21:10:51,684  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:51,703  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:51,715  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-23T21:10:51,715  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data
2024-04-23T21:10:51,715  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:51,725  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,726  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:51,741  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T21:10:51,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:51,741  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:51,749  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,749  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:51,759  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-23T21:10:51,763  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:51,763  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T21:10:51,793  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:51,806  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:10:51,815  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:51,815  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {add_partitions_(List, boolean, boolean)=42, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=37, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=98, getPartitionWithAuthInfo_(String, String, List, String, List)=70, validatePartitionNameCharacters_(List)=0, getValidWriteIds_(List, String)=0}
2024-04-23T21:10:51,815  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211051_88967d82-0c34-43a8-a05b-803826861679); Time taken: 0.262 seconds
2024-04-23T21:10:51,815  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211051_88967d82-0c34-43a8-a05b-803826861679
2024-04-23T21:10:51,819  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:10:51,824  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:51,824  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:10:51,825  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:51,826  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:51,835  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T21:10:51,835  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:10:51,837  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:51,837  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:51,842  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:51,842  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:51,843  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:51,850  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,850  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:51,850  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:51,850  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:51,863  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:51,894  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:51,894  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:51,932  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:51,941  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:51,941  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:51,954  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:51,954  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:51,999  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:52,000  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:52,000  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:52,001  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-51_825_9091668238037287408-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-51_825_9091668238037287408-1
2024-04-23T21:10:52,009  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:52,012  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], VALUE._col0=Column[_col2]}
2024-04-23T21:10:52,012  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col1], VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T21:10:52,012  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:52,013  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:52,023  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:52,023  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:52,023  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:52,024  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:52,024  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:10:52,025  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:52,025  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:52,025  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:52,025  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:52,025  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:52,025  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:52,025  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:52,025  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:52,025  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:52,025  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:52,025  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:52,025  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:10:52,026  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:10:52,026  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:52,026  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=9, getAllTableConstraints_(AllTableConstraintsRequest)=25, openTxn_(String, TxnType)=8, getTable_(GetTableRequest)=7, getValidTxns_(long)=2, getValidWriteIds_(List, String)=7, getAggrColStatsFor_(String, String, List, List, String, String)=22, listPartitions_(String, String, short)=27, flushCache_()=0, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:52,027  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee); Time taken: 0.2 seconds
2024-04-23T21:10:52,027  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee
2024-04-23T21:10:52,028  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee
2024-04-23T21:10:52,048  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:10:52,049  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:52,049  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:52,050  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee
2024-04-23T21:10:52,050  INFO [main] ql.Driver: Query ID = alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee
Total jobs = 1
2024-04-23T21:10:52,050  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:52,050  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:52,190  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:10:52,190  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:52,190  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:52,190  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:52,190  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:52,190  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:52,190  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:52,190  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:52,193  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:52,193  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:10:52,193  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:52,201  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-51_825_9091668238037287408-1/-mr-10004/1d73f881-d050-4a7d-bca8-d91392cad6cd (false)
2024-04-23T21:10:52,210  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:52,215  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,06KB
2024-04-23T21:10:52,219  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:52,221  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T21:10:52,221  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:52,227  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:52,234  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:52,238  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:52,240  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:10:52,240  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:10:52,240  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:52,240  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:10:52,240  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:10:52,240  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:10:52,252  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:10:52,252  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 12 ms
2024-04-23T21:10:52,252  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T21:10:52,270  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T21:10:52,298  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local413713728_0011
2024-04-23T21:10:52,298  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:52,357  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:52,357  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:52,358  INFO [Thread-996] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:52,358  INFO [Thread-996] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:52,360  INFO [Thread-996] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:52,360  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local413713728_0011_m_000000_0
2024-04-23T21:10:52,361  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:52,361  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:52,362  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:52,364  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,06KB
2024-04-23T21:10:52,365  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:52,367  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:52,369  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:52,372  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:52,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:52,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:52,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:52,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:52,373  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:52,374  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:52,374  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:52,375  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:52,375  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:52,375  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:52,376  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:52,376  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:52,376  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:52,377  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-23T21:10:52,378  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:52,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:52,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:52,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T21:10:52,378  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:52,392  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:52,400  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local413713728_0011_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:52,401  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:52,401  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local413713728_0011_m_000000_0' done.
2024-04-23T21:10:52,401  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local413713728_0011_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=233640
		FILE: Number of bytes written=13084108
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1142423552
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8203
2024-04-23T21:10:52,401  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local413713728_0011_m_000000_0
2024-04-23T21:10:52,402  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local413713728_0011_m_000001_0
2024-04-23T21:10:52,403  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:52,404  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:52,405  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:52,407  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,06KB
2024-04-23T21:10:52,408  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:1:9223372036854775807:::OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:52,410  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:52,412  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:52,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:52,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:52,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:52,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:52,423  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:52,424  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:52,425  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:52,425  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:52,426  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:52,427  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:52,427  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:52,427  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:52,428  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:52,429  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-23T21:10:52,429  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:52,429  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:52,429  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:52,430  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T21:10:52,430  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:52,443  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:52,450  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local413713728_0011_m_000001_0 is done. And is in the process of committing
2024-04-23T21:10:52,452  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:52,452  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local413713728_0011_m_000001_0' done.
2024-04-23T21:10:52,452  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local413713728_0011_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=242384
		FILE: Number of bytes written=13084232
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1142423552
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8203
2024-04-23T21:10:52,452  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local413713728_0011_m_000001_0
2024-04-23T21:10:52,452  INFO [Thread-996] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:52,454  INFO [Thread-996] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:52,455  INFO [pool-58-thread-1] mapred.LocalJobRunner: Starting task: attempt_local413713728_0011_r_000000_0
2024-04-23T21:10:52,456  INFO [pool-58-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:52,456  INFO [pool-58-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@26888f41
2024-04-23T21:10:52,456  WARN [pool-58-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:52,458  INFO [pool-58-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:52,460  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local413713728_0011_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:52,467  INFO [localfetcher#10] reduce.LocalFetcher: localfetcher#10 about to shuffle output of map attempt_local413713728_0011_m_000001_0 decomp: 88 len: 92 to MEMORY
2024-04-23T21:10:52,467  INFO [localfetcher#10] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local413713728_0011_m_000001_0
2024-04-23T21:10:52,467  INFO [localfetcher#10] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->88
2024-04-23T21:10:52,472  INFO [localfetcher#10] reduce.LocalFetcher: localfetcher#10 about to shuffle output of map attempt_local413713728_0011_m_000000_0 decomp: 88 len: 92 to MEMORY
2024-04-23T21:10:52,472  INFO [localfetcher#10] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local413713728_0011_m_000000_0
2024-04-23T21:10:52,472  INFO [localfetcher#10] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 2, commitMemory -> 88, usedMemory ->176
2024-04-23T21:10:52,473  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:52,473  INFO [pool-58-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:10:52,474  INFO [pool-58-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:52,485  INFO [pool-58-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T21:10:52,485  INFO [pool-58-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 104 bytes
2024-04-23T21:10:52,492  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 176 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:52,492  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merging 1 files, 178 bytes from disk
2024-04-23T21:10:52,492  INFO [pool-58-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:52,492  INFO [pool-58-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:52,492  INFO [pool-58-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 138 bytes
2024-04-23T21:10:52,493  INFO [pool-58-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:10:52,494  INFO [pool-58-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:52,496  INFO [pool-58-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T21:10:52,499  INFO [pool-58-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:52,499  INFO [pool-58-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:52,499  INFO [pool-58-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int>>
2024-04-23T21:10:52,499  INFO [pool-58-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:52,500  INFO [pool-58-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@d136d78, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@715a1414, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@21525175
2024-04-23T21:10:52,502  INFO [pool-58-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-51_825_9091668238037287408-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-51_825_9091668238037287408-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:52,502  INFO [pool-58-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-51_825_9091668238037287408-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-51_825_9091668238037287408-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:52,502  INFO [pool-58-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-51_825_9091668238037287408-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-51_825_9091668238037287408-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:52,520  INFO [pool-58-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:52,521  INFO [pool-58-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:52,522  INFO [pool-58-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:52,522  INFO [pool-58-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:52,522  INFO [pool-58-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T21:10:52,522  INFO [pool-58-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_FS_4:4, RECORDS_OUT_0:4, 
2024-04-23T21:10:52,523  INFO [pool-58-thread-1] mapred.Task: Task:attempt_local413713728_0011_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:52,524  INFO [pool-58-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:52,524  INFO [pool-58-thread-1] mapred.Task: Task 'attempt_local413713728_0011_r_000000_0' done.
2024-04-23T21:10:52,525  INFO [pool-58-thread-1] mapred.Task: Final Counters for attempt_local413713728_0011_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=250292
		FILE: Number of bytes written=13084637
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=184
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1142423552
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:52,525  INFO [pool-58-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local413713728_0011_r_000000_0
2024-04-23T21:10:52,525  INFO [Thread-996] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23T21:10:52,775  INFO [Heartbeater-3] lockmgr.DbTxnManager: Sending heartbeat for txnid:21 and lockid:0 queryId=null txnid:0
2024-04-23T21:10:52,779  INFO [Heartbeater-3] metastore.HiveMetaStoreClient: HMS client filtering is enabled.
2024-04-23T21:10:52,783  INFO [Heartbeater-3] metastore.HMSHandler: 1: Opening raw store with implementation class:org.apache.hadoop.hive.metastore.ObjectStore
2024-04-23T21:10:52,783  INFO [Heartbeater-3] metastore.PersistenceManagerProvider: Configuration datanucleus.autoStartMechanismMode is not set. Defaulting to 'ignored'
2024-04-23T21:10:52,784  INFO [Heartbeater-3] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@267d2a21, with PersistenceManager: null will be shutdown
2024-04-23T21:10:52,786  INFO [Heartbeater-3] metastore.ObjectStore: RawStore: org.apache.hadoop.hive.metastore.ObjectStore@267d2a21, with PersistenceManager: org.datanucleus.api.jdo.JDOPersistenceManager@6b8826d9 created in the thread with id: 55
2024-04-23T21:10:52,851  INFO [Heartbeater-3] metastore.HMSHandler: Created RawStore: org.apache.hadoop.hive.metastore.ObjectStore@267d2a21 from thread id: 55
2024-04-23T21:10:52,851  INFO [Heartbeater-3] metastore.HMSHandler: HMS server filtering is disabled by configuration
2024-04-23T21:10:52,851  INFO [Heartbeater-3] metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=alex (auth:SIMPLE) retries=1 delay=1 lifetime=0
2024-04-23T21:10:52,854  INFO [Heartbeater-3] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_functions	
2024-04-23 21:10:53,360 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:53,360  INFO [main] exec.Task: 2024-04-23 21:10:53,360 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local413713728_0011
2024-04-23T21:10:53,363  INFO [main] exec.Task: Ended Job = job_local413713728_0011
2024-04-23T21:10:53,365  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:53,365  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:10:53,365  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:53,365  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:53,365  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:53,365  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee); Time taken: 1.316 seconds
2024-04-23T21:10:53,365  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211051_66d1e5d7-d566-446c-af6f-dadcff84c4ee
2024-04-23T21:10:53,369  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:10:53,375  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:53,375  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:10:53,379  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:10:53,380  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:10:53,380  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:53,380  WARN [main] ql.TestTxnAddPartition: addPartitionVectorized: read data(add 2 parts w/data and 1 empty vect): 
2024-04-23T21:10:53,380  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4

2024-04-23T21:10:53,380  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:53,380  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-51_825_9091668238037287408-1
2024-04-23T21:10:53,381  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-51_825_9091668238037287408-1 on fs with scheme file
2024-04-23T21:10:53,382  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211053_26846ae8-c5f7-4dad-80f0-1769b44487d3): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:53,386  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T21:10:53,386  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:10:53,387  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:53,389  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:53,389  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:53,390  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:53,398  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,398  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:53,398  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:53,398  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:53,414  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:53,426  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:53,427  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:53,448  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:53,457  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,457  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:53,467  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-23T21:10:53,467  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-23T21:10:53,512  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:53,512  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:53,512  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:53,515  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:53,517  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T21:10:53,518  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T21:10:53,519  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:53,534  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:53,543  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:53,543  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:53,543  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:53,544  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:53,545  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:53,545  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:53,545  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T21:10:53,545  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:53,545  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAggrColStatsFor_(String, String, List, List, String, String)=18, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=6, getValidWriteIds_(List, String)=2, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=9, flushCache_()=1, openTxn_(String, TxnType)=3, listPartitions_(String, String, short)=11, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:53,545  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211053_26846ae8-c5f7-4dad-80f0-1769b44487d3); Time taken: 0.163 seconds
2024-04-23T21:10:53,545  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211053_26846ae8-c5f7-4dad-80f0-1769b44487d3): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:53,546  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T21:10:53,556  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:53,556  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:10:53,556  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211053_26846ae8-c5f7-4dad-80f0-1769b44487d3); Time taken: 0.011 seconds
2024-04-23T21:10:53,556  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:10:53,562  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:10:53,569  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:53,569  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:10:53,570  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:53,570  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_382_6087844263858509635-1
2024-04-23T21:10:53,570  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_382_6087844263858509635-1 on fs with scheme file
2024-04-23T21:10:53,571  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211053_73ce32f8-c830-40e9-83ee-a71ac8591bf7): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:53,571  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:53,593  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,595  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T21:10:53,595  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:10:53,598  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:53,607  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,607  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:53,607  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:53,607  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:53,607  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:53,608  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:53,608  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:53,608  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:53,608  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, getCurrentNotificationEventId_()=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=31, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:53,608  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211053_73ce32f8-c830-40e9-83ee-a71ac8591bf7); Time taken: 0.037 seconds
2024-04-23T21:10:53,608  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423211053_73ce32f8-c830-40e9-83ee-a71ac8591bf7
2024-04-23T21:10:53,609  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211053_73ce32f8-c830-40e9-83ee-a71ac8591bf7
2024-04-23T21:10:53,623  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211053_73ce32f8-c830-40e9-83ee-a71ac8591bf7 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:10:53,623  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:53,623  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211053_73ce32f8-c830-40e9-83ee-a71ac8591bf7): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:10:53,623  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:53,623  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:53,623  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:53,623  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:53,623  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:10:53,634  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:53,639  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:53,639  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:53,639  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211053_73ce32f8-c830-40e9-83ee-a71ac8591bf7); Time taken: 0.016 seconds
2024-04-23T21:10:53,639  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211053_73ce32f8-c830-40e9-83ee-a71ac8591bf7
2024-04-23T21:10:53,644  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:10:53,650  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:53,650  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:10:53,651  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211053_ed6d40da-c360-4ad0-a52f-97861943b849): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:53,653  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T21:10:53,654  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:10:53,655  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:53,665  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,676  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-23T21:10:53,676  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-23T21:10:53,677  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:53,677  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:53,677  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:53,677  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=1, getTable_(GetTableRequest)=10, allocateTableWriteId_(long, String, String)=9}
2024-04-23T21:10:53,677  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211053_ed6d40da-c360-4ad0-a52f-97861943b849); Time taken: 0.026 seconds
2024-04-23T21:10:53,677  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423211053_ed6d40da-c360-4ad0-a52f-97861943b849
2024-04-23T21:10:53,677  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211053_ed6d40da-c360-4ad0-a52f-97861943b849
2024-04-23T21:10:53,692  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211053_ed6d40da-c360-4ad0-a52f-97861943b849 LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T21:10:53,692  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:53,697  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211053_ed6d40da-c360-4ad0-a52f-97861943b849): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:53,697  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:53,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:53,704  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,705  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:53,725 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:10:53,725 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:10:53,726 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-23T21:10:53,727 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartition(TestTxnAddPartition.java:118) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionVectorized(TestTxnAddPartition.java:76) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T21:10:53,728 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T21:10:53,728  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:53,728  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7}
2024-04-23T21:10:53,729  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211053_ed6d40da-c360-4ad0-a52f-97861943b849); Time taken: 0.031 seconds
2024-04-23T21:10:53,729  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211053_ed6d40da-c360-4ad0-a52f-97861943b849
2024-04-23T21:10:53,731  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:53,738  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:53,738  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211053_7af5bcd2-775e-4cb3-803e-6c632cd1b39f): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:53,741  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T21:10:53,741  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T21:10:53,742  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:53,749  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:53,764  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-23T21:10:53,777  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:53,787  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-23T21:10:53,788  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-23T21:10:53,788  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:53,788  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:53,788  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:53,789  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, getPartitionWithAuthInfo_(String, String, List, String, List)=24, openTxn_(String, TxnType)=2, allocateTableWriteId_(long, String, String)=6, flushCache_()=0, rollbackTxn_(long)=9, isCompatibleWith_(Configuration)=2, getValidTxns_(long)=0}
2024-04-23T21:10:53,789  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211053_7af5bcd2-775e-4cb3-803e-6c632cd1b39f); Time taken: 0.05 seconds
2024-04-23T21:10:53,789  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423211053_7af5bcd2-775e-4cb3-803e-6c632cd1b39f
2024-04-23T21:10:53,789  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211053_7af5bcd2-775e-4cb3-803e-6c632cd1b39f
2024-04-23T21:10:53,805  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211053_7af5bcd2-775e-4cb3-803e-6c632cd1b39f LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T21:10:53,805  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:53,813  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211053_7af5bcd2-775e-4cb3-803e-6c632cd1b39f): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:10:53,813  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:53,813  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:53,820  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,821  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:53,830  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T21:10:53,832  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T21:10:53,834  INFO [HMSHandler #12] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3
2024-04-23T21:10:53,856  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-23T21:10:53,856  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data
2024-04-23T21:10:53,856  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:53,864  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,865  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:53,875  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-23T21:10:53,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:53,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:53,882  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:53,882  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:53,892  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-23T21:10:53,897  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:53,897  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-23T21:10:53,934  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:53,957  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:10:53,967  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:53,967  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=1, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=60, getTable_(GetTableRequest)=22, add_partitions_(List, boolean, boolean)=34, getPartitionWithAuthInfo_(String, String, List, String, List)=29, validatePartitionNameCharacters_(List)=0}
2024-04-23T21:10:53,968  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211053_7af5bcd2-775e-4cb3-803e-6c632cd1b39f); Time taken: 0.154 seconds
2024-04-23T21:10:53,968  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211053_7af5bcd2-775e-4cb3-803e-6c632cd1b39f
2024-04-23T21:10:53,973  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T21:10:53,981  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:53,981  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T21:10:53,982  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:53,982  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:53,985  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T21:10:53,986  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T21:10:53,986  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:53,986  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:53,992  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:53,992  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:53,993  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:54,000  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:54,000  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:54,000  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:54,000  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:54,013  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:54,052  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:54,052  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:54,102  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:54,111  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:54,111  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:54,126  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:54,126  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:54,183  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:54,183  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:54,183  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:54,185  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_982_8904205520421002089-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-53_982_8904205520421002089-1
2024-04-23T21:10:54,192  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:54,195  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1]}
2024-04-23T21:10:54,195  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col0=Column[_col2]}
2024-04-23T21:10:54,196  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:54,197  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:54,206  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:54,206  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:54,207  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:54,208  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:54,208  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:54,208  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:54,209  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:54,209  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], properties:null)
2024-04-23T21:10:54,210  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[7]
2024-04-23T21:10:54,210  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:54,210  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=14, flushCache_()=0, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=1, getAggrColStatsFor_(String, String, List, List, String, String)=22, listPartitions_(String, String, short)=32, getAllTableConstraints_(AllTableConstraintsRequest)=33, getValidTxns_(long)=0, getValidWriteIds_(List, String)=7}
2024-04-23T21:10:54,210  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72); Time taken: 0.228 seconds
2024-04-23T21:10:54,211  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72
2024-04-23T21:10:54,212  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72
2024-04-23T21:10:54,227  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T21:10:54,227  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:54,228  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72): select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:54,228  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72
2024-04-23T21:10:54,228  INFO [main] ql.Driver: Query ID = alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72
Total jobs = 1
2024-04-23T21:10:54,229  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:54,229  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:54,358  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:10:54,358  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:54,358  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:54,358  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:54,358  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:54,358  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:54,358  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:54,358  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:54,361  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:54,361  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:10:54,361  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:54,369  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_982_8904205520421002089-1/-mr-10004/a7ffbbcd-eeca-4ad6-9be4-5e5d69d19fad (false)
2024-04-23T21:10:54,378  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:54,379  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T21:10:54,383  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:54,384  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T21:10:54,385  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:54,391  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:54,399  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:54,404  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:54,405  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:10:54,405  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:10:54,405  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:54,405  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:10:54,405  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: true sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: default 
2024-04-23T21:10:54,406  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:10:54,419  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-23T21:10:54,419  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 14 ms
2024-04-23T21:10:54,419  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-23T21:10:54,437  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-23T21:10:54,457  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local2024294613_0012
2024-04-23T21:10:54,457  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:54,519  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:54,519  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:54,519  INFO [Thread-1091] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:54,519  INFO [Thread-1091] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:54,521  INFO [Thread-1091] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:54,521  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2024294613_0012_m_000000_0
2024-04-23T21:10:54,522  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:54,522  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,523  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:54,524  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T21:10:54,525  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,526  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:54,526  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:54,539  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:54,539  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:54,539  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:54,539  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:54,539  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:54,540  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:54,541  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:54,541  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:54,542  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:54,542  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:54,542  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:54,542  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:54,543  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:54,543  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:54,543  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:54,543  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, 
2024-04-23T21:10:54,543  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:54,543  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:54,543  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:2, 
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T21:10:54,544  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:54,555  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:54,558  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2024294613_0012_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:54,559  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,559  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2024294613_0012_m_000000_0' done.
2024-04-23T21:10:54,559  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2024294613_0012_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=267317
		FILE: Number of bytes written=14283065
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=8
		Total committed heap usage (bytes)=1144520704
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-23T21:10:54,559  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2024294613_0012_m_000000_0
2024-04-23T21:10:54,559  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2024294613_0012_m_000001_0
2024-04-23T21:10:54,559  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:54,560  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,560  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:54,561  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T21:10:54,562  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,563  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:54,564  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:54,568  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:54,568  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:54,568  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:54,568  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:54,568  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:54,569  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:54,569  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:54,569  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:54,570  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:54,570  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:54,570  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:54,570  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:54,571  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:54,571  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:54,571  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:54,571  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, DESERIALIZE_ERRORS:0, RECORDS_IN:2, 
2024-04-23T21:10:54,572  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:54,572  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:54,572  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:54,572  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:54,572  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:54,572  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:54,572  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_6:2, 
2024-04-23T21:10:54,572  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:54,573  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:54,573  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:54,573  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T21:10:54,573  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:54,582  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:54,584  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2024294613_0012_m_000001_0 is done. And is in the process of committing
2024-04-23T21:10:54,585  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,585  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2024294613_0012_m_000001_0' done.
2024-04-23T21:10:54,585  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2024294613_0012_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=276931
		FILE: Number of bytes written=14283189
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1144520704
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-23T21:10:54,585  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2024294613_0012_m_000001_0
2024-04-23T21:10:54,585  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local2024294613_0012_m_000002_0
2024-04-23T21:10:54,586  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:54,586  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,587  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:54,587  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T21:10:54,588  INFO [LocalJobRunner Map Task Executor #0] orc.VectorizedOrcAcidRowBatchReader: Read ValidWriteIdList: default.t:3:9223372036854775807::2:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,589  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:54,589  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:54,594  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:54,594  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:54,594  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:54,594  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:54,594  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:54,595  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:54,595  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:54,595  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:54,596  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:54,596  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:54,596  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Initializing Operator: RS[6]
2024-04-23T21:10:54,596  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Using tag = -1
2024-04-23T21:10:54,596  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:54,596  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: records written - 1
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] vector.VectorMapOperator: RECORDS_IN:2, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] vector.VectorSelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: Closing Operator: RS[6]
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RS[6]: Total records written - 2. abort - false
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] vector.VectorReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_6:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:54,597  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:54,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:54,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:54,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 82; bufvoid = 104857600
2024-04-23T21:10:54,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:54,606  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:54,609  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local2024294613_0012_m_000002_0 is done. And is in the process of committing
2024-04-23T21:10:54,609  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:54,609  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local2024294613_0012_m_000002_0' done.
2024-04-23T21:10:54,610  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local2024294613_0012_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=286033
		FILE: Number of bytes written=14283313
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=1
		Map output records=2
		Map output bytes=82
		Map output materialized bytes=92
		Input split bytes=513
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1144520704
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=8556
2024-04-23T21:10:54,610  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local2024294613_0012_m_000002_0
2024-04-23T21:10:54,610  INFO [Thread-1091] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:54,610  INFO [Thread-1091] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:54,611  INFO [pool-63-thread-1] mapred.LocalJobRunner: Starting task: attempt_local2024294613_0012_r_000000_0
2024-04-23T21:10:54,611  INFO [pool-63-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:54,611  INFO [pool-63-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@285342e
2024-04-23T21:10:54,611  WARN [pool-63-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:54,612  INFO [pool-63-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:54,613  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local2024294613_0012_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:54,614  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local2024294613_0012_m_000002_0 decomp: 88 len: 92 to MEMORY
2024-04-23T21:10:54,614  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local2024294613_0012_m_000002_0
2024-04-23T21:10:54,614  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->88
2024-04-23T21:10:54,617  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local2024294613_0012_m_000001_0 decomp: 88 len: 92 to MEMORY
2024-04-23T21:10:54,617  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local2024294613_0012_m_000001_0
2024-04-23T21:10:54,617  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 2, commitMemory -> 88, usedMemory ->176
2024-04-23T21:10:54,619  INFO [localfetcher#11] reduce.LocalFetcher: localfetcher#11 about to shuffle output of map attempt_local2024294613_0012_m_000000_0 decomp: 88 len: 92 to MEMORY
2024-04-23T21:10:54,619  INFO [localfetcher#11] reduce.InMemoryMapOutput: Read 88 bytes from map-output for attempt_local2024294613_0012_m_000000_0
2024-04-23T21:10:54,619  INFO [localfetcher#11] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 88, inMemoryMapOutputs.size() -> 3, commitMemory -> 176, usedMemory ->264
2024-04-23T21:10:54,620  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:54,620  INFO [pool-63-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T21:10:54,620  INFO [pool-63-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:54,627  INFO [pool-63-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-23T21:10:54,627  INFO [pool-63-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 156 bytes
2024-04-23T21:10:54,630  INFO [pool-63-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 264 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:54,630  INFO [pool-63-thread-1] reduce.MergeManagerImpl: Merging 1 files, 264 bytes from disk
2024-04-23T21:10:54,630  INFO [pool-63-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:54,630  INFO [pool-63-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:54,630  INFO [pool-63-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 224 bytes
2024-04-23T21:10:54,630  INFO [pool-63-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T21:10:54,631  INFO [pool-63-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:54,632  INFO [pool-63-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 7,41KB
2024-04-23T21:10:54,633  INFO [pool-63-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:54,633  INFO [pool-63-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:54,633  INFO [pool-63-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int>>
2024-04-23T21:10:54,633  INFO [pool-63-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:54,633  INFO [pool-63-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@51922a5, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@291e6693, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@2596bdd
2024-04-23T21:10:54,634  INFO [pool-63-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_982_8904205520421002089-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-53_982_8904205520421002089-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:54,634  INFO [pool-63-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_982_8904205520421002089-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-53_982_8904205520421002089-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:54,634  INFO [pool-63-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_982_8904205520421002089-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-53_982_8904205520421002089-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:54,641  INFO [pool-63-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:54,641  INFO [pool-63-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:54,642  INFO [pool-63-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:6, 
2024-04-23T21:10:54,642  INFO [pool-63-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:54,642  INFO [pool-63-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-23T21:10:54,642  INFO [pool-63-thread-1] exec.FileSinkOperator: RECORDS_OUT_0:6, RECORDS_OUT_OPERATOR_FS_4:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:54,643  INFO [pool-63-thread-1] mapred.Task: Task:attempt_local2024294613_0012_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:54,643  INFO [pool-63-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:54,643  INFO [pool-63-thread-1] mapred.Task: Task 'attempt_local2024294613_0012_r_000000_0' done.
2024-04-23T21:10:54,643  INFO [pool-63-thread-1] mapred.Task: Final Counters for attempt_local2024294613_0012_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=294152
		FILE: Number of bytes written=14283868
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=276
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1144520704
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:54,643  INFO [pool-63-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local2024294613_0012_r_000000_0
2024-04-23T21:10:54,643  INFO [Thread-1091] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:55,520 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:55,520  INFO [main] exec.Task: 2024-04-23 21:10:55,520 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local2024294613_0012
2024-04-23T21:10:55,521  INFO [main] exec.Task: Ended Job = job_local2024294613_0012
2024-04-23T21:10:55,523  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:55,523  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:10:55,524  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:55,524  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:55,524  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:55,524  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72); Time taken: 1.295 seconds
2024-04-23T21:10:55,524  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211053_6e68f1e2-8594-425c-95e0-c9ea1bd0dd72
2024-04-23T21:10:55,528  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T21:10:55,534  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:55,535  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T21:10:55,539  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:10:55,540  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[7]
2024-04-23T21:10:55,541  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_7:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:55,541  WARN [main] ql.TestTxnAddPartition: addPartitionVectorized: read data(add 2 existing parts and 1 empty vect): 
2024-04-23T21:10:55,541  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536870912,"rowid":0}	0	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	0	0	4
{"writeid":1,"bucketid":536870912,"rowid":0}	1	0	2
{"writeid":1,"bucketid":536870912,"rowid":1}	1	0	4
{"writeid":3,"bucketid":536870912,"rowid":0}	3	0	2
{"writeid":3,"bucketid":536870912,"rowid":1}	3	0	4

2024-04-23T21:10:55,541  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:55,541  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_982_8904205520421002089-1
2024-04-23T21:10:55,542  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-53_982_8904205520421002089-1 on fs with scheme file
2024-04-23T21:10:55,542  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211055_63fa36a0-cd4d-4c19-90d6-45a0f95ee86d): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:55,545  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-23T21:10:55,545  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T21:10:55,546  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:55,549  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:55,549  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:55,549  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:55,556  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:55,556  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:55,556  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:55,557  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:55,569  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:55,580  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:55,580  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:55,608  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:55,617  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:55,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:55,627  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:10:55,628  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:10:55,677  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:55,677  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:55,677  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:55,679  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:55,682  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col2], VALUE._col1=Column[_col3], KEY.reducesinkkey1=Column[_col0], KEY.reducesinkkey0=Column[_col1]}
2024-04-23T21:10:55,682  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col0=Column[_col2], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3]}
2024-04-23T21:10:55,683  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:55,705  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:55,715  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:55,715  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:55,715  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:55,716  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:55,716  INFO [main] physical.Vectorizer: Map vectorized: true
2024-04-23T21:10:55,716  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:55,717  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:55,717  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:55,717  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:55,717  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:55,717  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:55,717  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:55,717  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:55,717  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:55,717  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:55,717  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T21:10:55,717  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:55,717  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, isCompatibleWith_(Configuration)=1, listPartitions_(String, String, short)=10, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, getTable_(GetTableRequest)=7, commitTxn_(CommitTxnRequest)=11, getAggrColStatsFor_(String, String, List, List, String, String)=19, getAllTableConstraints_(AllTableConstraintsRequest)=5}
2024-04-23T21:10:55,717  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211055_63fa36a0-cd4d-4c19-90d6-45a0f95ee86d); Time taken: 0.175 seconds
2024-04-23T21:10:55,718  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211055_63fa36a0-cd4d-4c19-90d6-45a0f95ee86d): EXPLAIN VECTORIZATION DETAIL select ROW__ID, p, a, b from T order by p, ROW__ID
2024-04-23T21:10:55,718  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T21:10:55,730  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:55,730  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:10:55,730  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211055_63fa36a0-cd4d-4c19-90d6-45a0f95ee86d); Time taken: 0.012 seconds
2024-04-23T21:10:55,730  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:10:55,737  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T21:10:55,744  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:55,745  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T21:10:55,745  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:55,746  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-55_542_4062479164412559446-1
2024-04-23T21:10:55,746  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/ab76c071-02a1-4cb7-8efe-fcf226cd825e/hive_2024-04-23_21-10-55_542_4062479164412559446-1 on fs with scheme file
2024-04-23T21:10:55,746  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211055_3fcec964-912e-4a9b-925b-3f435ea4e6e5): drop table if exists acidTbl
2024-04-23T21:10:55,749  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-23T21:10:55,750  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T21:10:55,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:55,762  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:55,762  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:55,762  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:55,762  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:55,762  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=11, openTxn_(String, TxnType)=3, flushCache_()=1}
2024-04-23T21:10:55,763  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211055_3fcec964-912e-4a9b-925b-3f435ea4e6e5); Time taken: 0.016 seconds
2024-04-23T21:10:55,763  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423211055_3fcec964-912e-4a9b-925b-3f435ea4e6e5
2024-04-23T21:10:55,764  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211055_3fcec964-912e-4a9b-925b-3f435ea4e6e5
2024-04-23T21:10:55,785  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211055_3fcec964-912e-4a9b-925b-3f435ea4e6e5 LockResponse(lockid:20, state:ACQUIRED)
2024-04-23T21:10:55,785  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:55,785  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211055_3fcec964-912e-4a9b-925b-3f435ea4e6e5): drop table if exists acidTbl
2024-04-23T21:10:55,785  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:55,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:55,798  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:55,798  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:55,810  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:55,810  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:55,965  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:55,965  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=12, dropTable_(String, String, boolean, boolean, boolean)=167, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:55,965  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211055_3fcec964-912e-4a9b-925b-3f435ea4e6e5); Time taken: 0.18 seconds
2024-04-23T21:10:55,965  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211055_3fcec964-912e-4a9b-925b-3f435ea4e6e5
2024-04-23T21:10:55,969  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T21:10:55,976  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:55,976  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T21:10:55,977  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:55,977  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211055_c6832ebe-e802-4bcf-9f47-1c2e486af1b2): drop table if exists acidTblPart
2024-04-23T21:10:55,980  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-23T21:10:55,981  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-23T21:10:55,984  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:56,005  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,006  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,006  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,006  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,006  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=4, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=23, getValidTxns_(long)=2}
2024-04-23T21:10:56,006  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211055_c6832ebe-e802-4bcf-9f47-1c2e486af1b2); Time taken: 0.029 seconds
2024-04-23T21:10:56,007  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240423211055_c6832ebe-e802-4bcf-9f47-1c2e486af1b2
2024-04-23T21:10:56,007  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211055_c6832ebe-e802-4bcf-9f47-1c2e486af1b2
2024-04-23T21:10:56,023  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211055_c6832ebe-e802-4bcf-9f47-1c2e486af1b2 LockResponse(lockid:21, state:ACQUIRED)
2024-04-23T21:10:56,023  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:56,023  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211055_c6832ebe-e802-4bcf-9f47-1c2e486af1b2): drop table if exists acidTblPart
2024-04-23T21:10:56,023  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,023  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:56,031  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,032  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:56,042  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,042  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:56,086  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,086  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=54, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T21:10:56,086  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211055_c6832ebe-e802-4bcf-9f47-1c2e486af1b2); Time taken: 0.063 seconds
2024-04-23T21:10:56,086  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211055_c6832ebe-e802-4bcf-9f47-1c2e486af1b2
2024-04-23T21:10:56,090  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-23T21:10:56,096  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,096  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-23T21:10:56,097  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:56,097  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_b13c5612-5224-4c1d-b729-3e8bef2c0b46): drop table if exists acidTbl2
2024-04-23T21:10:56,099  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-23T21:10:56,100  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-23T21:10:56,101  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,101  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,101  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,101  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=1, isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, openTxn_(String, TxnType)=3}
2024-04-23T21:10:56,101  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_b13c5612-5224-4c1d-b729-3e8bef2c0b46); Time taken: 0.004 seconds
2024-04-23T21:10:56,101  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240423211056_b13c5612-5224-4c1d-b729-3e8bef2c0b46
2024-04-23T21:10:56,102  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:56,102  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_b13c5612-5224-4c1d-b729-3e8bef2c0b46): drop table if exists acidTbl2
2024-04-23T21:10:56,102  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,102  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:10:56,103  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,103  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T21:10:56,103  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_b13c5612-5224-4c1d-b729-3e8bef2c0b46); Time taken: 0.001 seconds
2024-04-23T21:10:56,103  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_b13c5612-5224-4c1d-b729-3e8bef2c0b46
2024-04-23T21:10:56,109  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-23T21:10:56,116  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,116  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-23T21:10:56,116  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:56,117  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_87c4409f-a3f1-4b28-bf52-305569a7f889): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:56,120  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-23T21:10:56,120  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-23T21:10:56,121  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:56,144  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,145  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,145  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,145  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,145  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=13, flushCache_()=0, openTxn_(String, TxnType)=3, getValidTxns_(long)=1, getTable_(GetTableRequest)=23}
2024-04-23T21:10:56,145  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_87c4409f-a3f1-4b28-bf52-305569a7f889); Time taken: 0.028 seconds
2024-04-23T21:10:56,145  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240423211056_87c4409f-a3f1-4b28-bf52-305569a7f889
2024-04-23T21:10:56,146  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211056_87c4409f-a3f1-4b28-bf52-305569a7f889
2024-04-23T21:10:56,166  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211056_87c4409f-a3f1-4b28-bf52-305569a7f889 LockResponse(lockid:22, state:ACQUIRED)
2024-04-23T21:10:56,166  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:56,166  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_87c4409f-a3f1-4b28-bf52-305569a7f889): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:56,166  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,166  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:56,182  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,182  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:56,198  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,198  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:56,268  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,268  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=16, dropTable_(String, String, boolean, boolean, boolean)=86, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,269  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_87c4409f-a3f1-4b28-bf52-305569a7f889); Time taken: 0.102 seconds
2024-04-23T21:10:56,269  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_87c4409f-a3f1-4b28-bf52-305569a7f889
2024-04-23T21:10:56,273  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-23T21:10:56,279  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,279  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-23T21:10:56,280  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:56,281  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_fb63cb0f-655d-4230-89ee-497ba18ad50d): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:56,283  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-23T21:10:56,284  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-23T21:10:56,285  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:56,293  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,293  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,293  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,294  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,294  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:10:56,294  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_fb63cb0f-655d-4230-89ee-497ba18ad50d); Time taken: 0.012 seconds
2024-04-23T21:10:56,294  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240423211056_fb63cb0f-655d-4230-89ee-497ba18ad50d
2024-04-23T21:10:56,295  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211056_fb63cb0f-655d-4230-89ee-497ba18ad50d
2024-04-23T21:10:56,309  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211056_fb63cb0f-655d-4230-89ee-497ba18ad50d LockResponse(lockid:23, state:ACQUIRED)
2024-04-23T21:10:56,309  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:56,309  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_fb63cb0f-655d-4230-89ee-497ba18ad50d): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:56,309  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,309  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:56,318  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,318  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:56,327  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,327  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:56,359  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,359  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=40}
2024-04-23T21:10:56,359  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_fb63cb0f-655d-4230-89ee-497ba18ad50d); Time taken: 0.049 seconds
2024-04-23T21:10:56,359  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_fb63cb0f-655d-4230-89ee-497ba18ad50d
2024-04-23T21:10:56,365  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-23T21:10:56,373  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,373  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-23T21:10:56,373  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:56,374  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_21d1999a-274a-4d97-abb6-94a40c9b685d): drop table if exists nonAcidNonBucket
2024-04-23T21:10:56,377  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-23T21:10:56,377  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-23T21:10:56,378  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:56,389  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,389  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,389  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,390  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,390  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14, getTable_(GetTableRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,390  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_21d1999a-274a-4d97-abb6-94a40c9b685d); Time taken: 0.016 seconds
2024-04-23T21:10:56,390  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240423211056_21d1999a-274a-4d97-abb6-94a40c9b685d
2024-04-23T21:10:56,390  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211056_21d1999a-274a-4d97-abb6-94a40c9b685d
2024-04-23T21:10:56,406  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211056_21d1999a-274a-4d97-abb6-94a40c9b685d LockResponse(lockid:24, state:ACQUIRED)
2024-04-23T21:10:56,406  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:56,406  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_21d1999a-274a-4d97-abb6-94a40c9b685d): drop table if exists nonAcidNonBucket
2024-04-23T21:10:56,406  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,406  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:56,415  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,415  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:56,424  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:56,424  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:56,457  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,457  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=42, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T21:10:56,457  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_21d1999a-274a-4d97-abb6-94a40c9b685d); Time taken: 0.051 seconds
2024-04-23T21:10:56,457  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_21d1999a-274a-4d97-abb6-94a40c9b685d
2024-04-23T21:10:56,462  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-23T21:10:56,468  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,469  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-23T21:10:56,470  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:10:56,537  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:10:56,539  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = d9d7f120-6c95-4a52-969b-230f6ddecfe3
2024-04-23T21:10:56,541  INFO [main] SessionState: Hive Session ID = d9d7f120-6c95-4a52-969b-230f6ddecfe3
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:56,542  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:10:56,547  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d9d7f120-6c95-4a52-969b-230f6ddecfe3
2024-04-23T21:10:56,549  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3
2024-04-23T21:10:56,552  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d9d7f120-6c95-4a52-969b-230f6ddecfe3/_tmp_space.db
2024-04-23T21:10:56,552  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=d9d7f120-6c95-4a52-969b-230f6ddecfe3, clientType=HIVECLI]
2024-04-23T21:10:56,552  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:10:56,553  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_33c4d848-9842-4cec-850c-36bcf948d4e6): drop table if exists acidTbl
2024-04-23T21:10:56,561  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:10:56,561  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:10:56,563  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:56,572  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,572  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,572  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,572  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, isCompatibleWith_(Configuration)=1, flushCache_()=0, openTxn_(String, TxnType)=8, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:10:56,572  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_33c4d848-9842-4cec-850c-36bcf948d4e6); Time taken: 0.019 seconds
2024-04-23T21:10:56,572  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423211056_33c4d848-9842-4cec-850c-36bcf948d4e6
2024-04-23T21:10:56,572  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:56,572  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_33c4d848-9842-4cec-850c-36bcf948d4e6): drop table if exists acidTbl
2024-04-23T21:10:56,573  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,573  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:10:56,576  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,576  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,576  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_33c4d848-9842-4cec-850c-36bcf948d4e6); Time taken: 0.004 seconds
2024-04-23T21:10:56,576  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_33c4d848-9842-4cec-850c-36bcf948d4e6
2024-04-23T21:10:56,582  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:10:56,587  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,588  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:10:56,588  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:10:56,589  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_0d0a3216-86ae-4899-8689-29f395a99218): drop table if exists acidTblPart
2024-04-23T21:10:56,591  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:10:56,591  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:10:56,592  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:56,595  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,595  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,595  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,595  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:10:56,595  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_0d0a3216-86ae-4899-8689-29f395a99218); Time taken: 0.006 seconds
2024-04-23T21:10:56,595  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423211056_0d0a3216-86ae-4899-8689-29f395a99218
2024-04-23T21:10:56,595  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:56,595  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_0d0a3216-86ae-4899-8689-29f395a99218): drop table if exists acidTblPart
2024-04-23T21:10:56,596  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,596  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:10:56,598  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,598  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,599  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_0d0a3216-86ae-4899-8689-29f395a99218); Time taken: 0.003 seconds
2024-04-23T21:10:56,599  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_0d0a3216-86ae-4899-8689-29f395a99218
2024-04-23T21:10:56,604  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:10:56,609  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,610  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:10:56,610  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:10:56,611  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_b958410b-98c9-4c68-9940-1177792a6aeb): drop table if exists acidTbl2
2024-04-23T21:10:56,613  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:10:56,613  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:10:56,613  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:56,616  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,616  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,616  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,616  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:10:56,617  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_b958410b-98c9-4c68-9940-1177792a6aeb); Time taken: 0.005 seconds
2024-04-23T21:10:56,617  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423211056_b958410b-98c9-4c68-9940-1177792a6aeb
2024-04-23T21:10:56,617  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:56,617  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_b958410b-98c9-4c68-9940-1177792a6aeb): drop table if exists acidTbl2
2024-04-23T21:10:56,617  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,617  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:10:56,620  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,620  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,620  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_b958410b-98c9-4c68-9940-1177792a6aeb); Time taken: 0.003 seconds
2024-04-23T21:10:56,620  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_b958410b-98c9-4c68-9940-1177792a6aeb
2024-04-23T21:10:56,625  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:10:56,631  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,631  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:10:56,631  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:10:56,632  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_2f57f8db-9c96-44a7-b20f-4dca1309489b): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:56,634  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:10:56,634  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:10:56,634  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:56,637  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,637  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,637  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,637  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:10:56,637  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_2f57f8db-9c96-44a7-b20f-4dca1309489b); Time taken: 0.005 seconds
2024-04-23T21:10:56,638  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423211056_2f57f8db-9c96-44a7-b20f-4dca1309489b
2024-04-23T21:10:56,638  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:56,638  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_2f57f8db-9c96-44a7-b20f-4dca1309489b): drop table if exists nonAcidOrcTbl
2024-04-23T21:10:56,638  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,638  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:10:56,641  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,641  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,641  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_2f57f8db-9c96-44a7-b20f-4dca1309489b); Time taken: 0.003 seconds
2024-04-23T21:10:56,641  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_2f57f8db-9c96-44a7-b20f-4dca1309489b
2024-04-23T21:10:56,647  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:10:56,652  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,652  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:10:56,653  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:56,653  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_b90053e6-71ff-4cc3-922e-8354f79f121d): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:56,655  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:10:56,656  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:10:56,657  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:56,659  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,659  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,660  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,660  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, openTxn_(String, TxnType)=3, flushCache_()=0}
2024-04-23T21:10:56,660  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_b90053e6-71ff-4cc3-922e-8354f79f121d); Time taken: 0.007 seconds
2024-04-23T21:10:56,660  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423211056_b90053e6-71ff-4cc3-922e-8354f79f121d
2024-04-23T21:10:56,660  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:56,660  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_b90053e6-71ff-4cc3-922e-8354f79f121d): drop table if exists nonAcidOrcTbl2
2024-04-23T21:10:56,660  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,660  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:10:56,664  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,664  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,664  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_b90053e6-71ff-4cc3-922e-8354f79f121d); Time taken: 0.004 seconds
2024-04-23T21:10:56,664  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_b90053e6-71ff-4cc3-922e-8354f79f121d
2024-04-23T21:10:56,669  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:10:56,675  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,675  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:10:56,676  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:10:56,676  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_2d18c15d-591f-4456-a9dc-df837c304b78): drop table if exists nonAcidNonBucket
2024-04-23T21:10:56,679  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:10:56,679  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:10:56,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:56,682  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,682  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,682  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,683  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:10:56,683  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_2d18c15d-591f-4456-a9dc-df837c304b78); Time taken: 0.006 seconds
2024-04-23T21:10:56,683  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423211056_2d18c15d-591f-4456-a9dc-df837c304b78
2024-04-23T21:10:56,683  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:10:56,683  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_2d18c15d-591f-4456-a9dc-df837c304b78): drop table if exists nonAcidNonBucket
2024-04-23T21:10:56,683  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,684  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:10:56,686  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,686  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,686  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_2d18c15d-591f-4456-a9dc-df837c304b78); Time taken: 0.003 seconds
2024-04-23T21:10:56,686  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_2d18c15d-591f-4456-a9dc-df837c304b78
2024-04-23T21:10:56,692  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:10:56,698  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,698  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:10:56,699  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,699  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_83d4bc07-0d9f-4fbc-9100-d9cf81ebddbd): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,702  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:10:56,702  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:10:56,703  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:56,703  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:56,710  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:10:56,710  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:56,712  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:56,712  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,712  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,712  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,712  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=7, isCompatibleWith_(Configuration)=0, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, getDatabase_(String)=2}
2024-04-23T21:10:56,712  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_83d4bc07-0d9f-4fbc-9100-d9cf81ebddbd); Time taken: 0.013 seconds
2024-04-23T21:10:56,713  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423211056_83d4bc07-0d9f-4fbc-9100-d9cf81ebddbd
2024-04-23T21:10:56,713  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211056_83d4bc07-0d9f-4fbc-9100-d9cf81ebddbd
2024-04-23T21:10:56,732  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211056_83d4bc07-0d9f-4fbc-9100-d9cf81ebddbd LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:10:56,732  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:56,733  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_83d4bc07-0d9f-4fbc-9100-d9cf81ebddbd): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,733  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,735  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931856, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, transactional=true, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFilesErasureCoded=0, numFiles=0, totalSize=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:56,740  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtbl
2024-04-23T21:10:56,777  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,777  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, createTable_(Table)=43}
2024-04-23T21:10:56,778  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_83d4bc07-0d9f-4fbc-9100-d9cf81ebddbd); Time taken: 0.044 seconds
2024-04-23T21:10:56,778  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_83d4bc07-0d9f-4fbc-9100-d9cf81ebddbd
2024-04-23T21:10:56,782  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:10:56,787  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,788  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:10:56,789  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,790  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_f3190202-6c99-456c-831b-837bc0e25ddf): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,792  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:10:56,793  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:10:56,793  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:56,793  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:56,796  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:10:56,796  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:56,798  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:56,798  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,798  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,798  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,798  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11, getValidTxns_(long)=0, getValidWriteIds_(List, String)=3, openTxn_(String, TxnType)=2}
2024-04-23T21:10:56,798  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_f3190202-6c99-456c-831b-837bc0e25ddf); Time taken: 0.008 seconds
2024-04-23T21:10:56,799  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423211056_f3190202-6c99-456c-831b-837bc0e25ddf
2024-04-23T21:10:56,799  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211056_f3190202-6c99-456c-831b-837bc0e25ddf
2024-04-23T21:10:56,813  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211056_f3190202-6c99-456c-831b-837bc0e25ddf LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:10:56,813  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:56,814  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_f3190202-6c99-456c-831b-837bc0e25ddf): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,814  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,815  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931856, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:56,821  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtblpart
2024-04-23T21:10:56,837  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,837  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=22}
2024-04-23T21:10:56,837  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_f3190202-6c99-456c-831b-837bc0e25ddf); Time taken: 0.023 seconds
2024-04-23T21:10:56,837  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_f3190202-6c99-456c-831b-837bc0e25ddf
2024-04-23T21:10:56,841  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:10:56,846  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,847  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:10:56,847  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:56,848  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_64c52dd7-568b-43f4-96d7-a0caf6cbf0ec): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:56,850  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:10:56,850  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:10:56,851  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:56,851  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:56,853  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:10:56,853  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:56,855  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:56,855  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,855  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,856  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,856  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, flushCache_()=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=9, openTxn_(String, TxnType)=2, getValidWriteIds_(List, String)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:56,856  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_64c52dd7-568b-43f4-96d7-a0caf6cbf0ec); Time taken: 0.007 seconds
2024-04-23T21:10:56,856  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423211056_64c52dd7-568b-43f4-96d7-a0caf6cbf0ec
2024-04-23T21:10:56,856  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211056_64c52dd7-568b-43f4-96d7-a0caf6cbf0ec
2024-04-23T21:10:56,871  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211056_64c52dd7-568b-43f4-96d7-a0caf6cbf0ec LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:10:56,871  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:56,872  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_64c52dd7-568b-43f4-96d7-a0caf6cbf0ec): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:56,872  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931856, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFiles=0, numFilesErasureCoded=0, totalSize=0, rawDataSize=0, bucketing_version=2, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:56,879  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl
2024-04-23T21:10:56,896  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,897  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=23, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,897  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_64c52dd7-568b-43f4-96d7-a0caf6cbf0ec); Time taken: 0.025 seconds
2024-04-23T21:10:56,897  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_64c52dd7-568b-43f4-96d7-a0caf6cbf0ec
2024-04-23T21:10:56,901  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:10:56,907  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,907  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:10:56,908  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:56,908  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_3b067c96-0243-4f47-be0c-992c0154f6f1): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:56,911  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:10:56,911  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:10:56,912  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:56,912  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:56,914  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:10:56,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:56,916  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:56,916  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,916  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,916  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,916  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=1, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=11}
2024-04-23T21:10:56,916  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_3b067c96-0243-4f47-be0c-992c0154f6f1); Time taken: 0.008 seconds
2024-04-23T21:10:56,917  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423211056_3b067c96-0243-4f47-be0c-992c0154f6f1
2024-04-23T21:10:56,917  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211056_3b067c96-0243-4f47-be0c-992c0154f6f1
2024-04-23T21:10:56,932  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211056_3b067c96-0243-4f47-be0c-992c0154f6f1 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:10:56,932  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:56,932  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_3b067c96-0243-4f47-be0c-992c0154f6f1): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:56,932  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,934  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931856, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, totalSize=0, numFiles=0, numRows=0, bucketing_version=2, numFilesErasureCoded=0, transactional=false, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:56,940  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl2
2024-04-23T21:10:56,958  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:56,958  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=1}
2024-04-23T21:10:56,958  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_3b067c96-0243-4f47-be0c-992c0154f6f1); Time taken: 0.025 seconds
2024-04-23T21:10:56,958  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_3b067c96-0243-4f47-be0c-992c0154f6f1
2024-04-23T21:10:56,962  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:10:56,969  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:56,969  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:10:56,970  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,970  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211056_f21dd774-5f2f-4bbe-a914-e9775378ae92): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,973  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:10:56,973  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:10:56,974  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:56,974  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:56,976  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:10:56,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:56,979  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:56,979  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:56,979  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:56,979  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:56,979  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, getValidWriteIds_(List, String)=2, flushCache_()=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:56,979  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211056_f21dd774-5f2f-4bbe-a914-e9775378ae92); Time taken: 0.009 seconds
2024-04-23T21:10:56,979  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423211056_f21dd774-5f2f-4bbe-a914-e9775378ae92
2024-04-23T21:10:56,980  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211056_f21dd774-5f2f-4bbe-a914-e9775378ae92
2024-04-23T21:10:56,994  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211056_f21dd774-5f2f-4bbe-a914-e9775378ae92 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:10:56,994  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:56,995  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211056_f21dd774-5f2f-4bbe-a914-e9775378ae92): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:10:56,995  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:56,997  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/d9d7f120-6c95-4a52-969b-230f6ddecfe3/_tmp_space.db/307d1ff6-097d-40a1-822b-f5e481310fad
2024-04-23T21:10:57,000  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:57,000  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=4}
2024-04-23T21:10:57,001  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211056_f21dd774-5f2f-4bbe-a914-e9775378ae92); Time taken: 0.005 seconds
2024-04-23T21:10:57,001  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211056_f21dd774-5f2f-4bbe-a914-e9775378ae92
2024-04-23T21:10:57,005  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:10:57,011  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:57,011  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:10:57,011  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:57,012  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211057_381de6ce-320d-4ec2-a66e-7aaac613fc72): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:57,014  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:10:57,014  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:10:57,015  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:57,015  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:57,017  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:10:57,017  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:57,019  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:57,019  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:57,019  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:57,019  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:57,020  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0, getValidTxns_(long)=1, getValidWriteIds_(List, String)=2, getDatabase_(String)=2, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:57,020  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211057_381de6ce-320d-4ec2-a66e-7aaac613fc72); Time taken: 0.007 seconds
2024-04-23T21:10:57,020  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423211057_381de6ce-320d-4ec2-a66e-7aaac613fc72
2024-04-23T21:10:57,020  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211057_381de6ce-320d-4ec2-a66e-7aaac613fc72
2024-04-23T21:10:57,037  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211057_381de6ce-320d-4ec2-a66e-7aaac613fc72 LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:10:57,037  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:57,037  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211057_381de6ce-320d-4ec2-a66e-7aaac613fc72): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:10:57,038  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:57,039  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931857, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, bucketing_version=2, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, rawDataSize=0, numFilesErasureCoded=0, numRows=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:57,045  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidnonbucket
2024-04-23T21:10:57,062  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:57,062  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=24, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:57,062  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211057_381de6ce-320d-4ec2-a66e-7aaac613fc72); Time taken: 0.025 seconds
2024-04-23T21:10:57,063  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211057_381de6ce-320d-4ec2-a66e-7aaac613fc72
2024-04-23T21:10:57,067  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:10:57,074  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:57,074  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:10:57,075  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:10:57,075  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211057_6610dbd2-7acf-477c-8700-a512cf460972): drop table if exists T
2024-04-23T21:10:57,078  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:10:57,079  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:10:57,079  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:57,101  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,102  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:57,102  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:57,102  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:57,102  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=23, commitTxn_(CommitTxnRequest)=12}
2024-04-23T21:10:57,102  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211057_6610dbd2-7acf-477c-8700-a512cf460972); Time taken: 0.027 seconds
2024-04-23T21:10:57,102  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423211057_6610dbd2-7acf-477c-8700-a512cf460972
2024-04-23T21:10:57,103  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211057_6610dbd2-7acf-477c-8700-a512cf460972
2024-04-23T21:10:57,124  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211057_6610dbd2-7acf-477c-8700-a512cf460972 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:10:57,124  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:57,124  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211057_6610dbd2-7acf-477c-8700-a512cf460972): drop table if exists T
2024-04-23T21:10:57,124  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:57,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:57,131  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,131  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:57,138  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,138  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T21:10:57,272  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t does not exist; Force to delete it.
2024-04-23T21:10:57,272 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:57,272  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:57,272  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=141}
2024-04-23T21:10:57,272  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211057_6610dbd2-7acf-477c-8700-a512cf460972); Time taken: 0.148 seconds
2024-04-23T21:10:57,272  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211057_6610dbd2-7acf-477c-8700-a512cf460972
2024-04-23T21:10:57,276  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:10:57,283  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:57,283  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:10:57,284  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T21:10:57,284  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211057_3390b323-7a4c-4192-bd35-d720c9b68e22): drop table if exists Tstage
2024-04-23T21:10:57,287  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:10:57,288  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:10:57,290  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:57,310  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,310  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:57,310  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:57,310  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:57,310  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=2, getTable_(GetTableRequest)=20, flushCache_()=0, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=3}
2024-04-23T21:10:57,311  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211057_3390b323-7a4c-4192-bd35-d720c9b68e22); Time taken: 0.026 seconds
2024-04-23T21:10:57,311  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423211057_3390b323-7a4c-4192-bd35-d720c9b68e22
2024-04-23T21:10:57,311  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211057_3390b323-7a4c-4192-bd35-d720c9b68e22
2024-04-23T21:10:57,327  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211057_3390b323-7a4c-4192-bd35-d720c9b68e22 LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:10:57,327  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:10:57,327  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211057_3390b323-7a4c-4192-bd35-d720c9b68e22): drop table if exists Tstage
2024-04-23T21:10:57,328  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:57,328  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:57,337  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,337  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:57,345  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,346  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T21:10:57,375  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage does not exist; Force to delete it.
2024-04-23T21:10:57,375 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:57,375  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:57,376  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=38, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:57,376  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211057_3390b323-7a4c-4192-bd35-d720c9b68e22); Time taken: 0.048 seconds
2024-04-23T21:10:57,376  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211057_3390b323-7a4c-4192-bd35-d720c9b68e22
2024-04-23T21:10:57,380  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:10:57,385  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:57,385  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:10:57,386  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:57,386  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211057_a04d1f13-7a41-4550-b71e-a47d5e8908ee): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:57,389  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:10:57,389  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:10:57,390  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:57,390  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:57,395  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:10:57,395  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:57,397  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:57,397  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:57,397  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:57,397  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:57,397  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, flushCache_()=0, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=5}
2024-04-23T21:10:57,397  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211057_a04d1f13-7a41-4550-b71e-a47d5e8908ee); Time taken: 0.011 seconds
2024-04-23T21:10:57,397  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423211057_a04d1f13-7a41-4550-b71e-a47d5e8908ee
2024-04-23T21:10:57,398  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211057_a04d1f13-7a41-4550-b71e-a47d5e8908ee
2024-04-23T21:10:57,415  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211057_a04d1f13-7a41-4550-b71e-a47d5e8908ee LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:10:57,415  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:57,416  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211057_a04d1f13-7a41-4550-b71e-a47d5e8908ee): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true')
2024-04-23T21:10:57,416  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:57,417  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931857, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:10:57,423  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:10:57,459  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:57,460  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=42, isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:57,460  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211057_a04d1f13-7a41-4550-b71e-a47d5e8908ee); Time taken: 0.043 seconds
2024-04-23T21:10:57,460  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211057_a04d1f13-7a41-4550-b71e-a47d5e8908ee
2024-04-23T21:10:57,464  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:10:57,469  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:57,470  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:10:57,470  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:57,471  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211057_c981e11a-32a3-4770-8d5d-49bc486a5215): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:57,473  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 1
2024-04-23T21:10:57,474  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:10:57,474  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:57,474  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:57,477  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T21:10:57,477  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:10:57,478  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:57,478  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:57,478  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:57,479  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:57,479  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=1, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:10:57,479  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211057_c981e11a-32a3-4770-8d5d-49bc486a5215); Time taken: 0.009 seconds
2024-04-23T21:10:57,479  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423211057_c981e11a-32a3-4770-8d5d-49bc486a5215
2024-04-23T21:10:57,479  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211057_c981e11a-32a3-4770-8d5d-49bc486a5215
2024-04-23T21:10:57,493  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211057_c981e11a-32a3-4770-8d5d-49bc486a5215 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:10:57,493  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:10:57,493  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211057_c981e11a-32a3-4770-8d5d-49bc486a5215): create table Tstage (a int, b int)  clustered by (a) into 2 buckets stored as orc tblproperties('transactional'='false')
2024-04-23T21:10:57,494  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:57,495  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713931857, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=0, numFiles=0, numFilesErasureCoded=0, numRows=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:10:57,500  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:10:57,515  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:57,516  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=21}
2024-04-23T21:10:57,516  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211057_c981e11a-32a3-4770-8d5d-49bc486a5215); Time taken: 0.022 seconds
2024-04-23T21:10:57,516  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211057_c981e11a-32a3-4770-8d5d-49bc486a5215
2024-04-23T21:10:57,520  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:10:57,525  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:57,526  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:10:57,526  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(1,4)
2024-04-23T21:10:57,527  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1): insert into Tstage values(0,2),(1,4)
2024-04-23T21:10:57,529  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 1
2024-04-23T21:10:57,530  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:10:57,530  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:57,530  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:57,533  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:57,542  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,542  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:57,542  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:57,542  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:57,542  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:57,543  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:57,551  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,551  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:57,551  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:10:57,572  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:57,660  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:57,660  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:57,660  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:57,661  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:10:57,663  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:57,663  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:57,663  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:57,663  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:57,673  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,676  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1
2024-04-23T21:10:57,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:57,680  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T21:10:57,682  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:57,687  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 oldColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:10:57,687  INFO [main] optimizer.ColumnPrunerProcFactory: RS 4 newColExprMap: {VALUE._col0=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:10:57,688  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:57,688  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:57,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:57,708  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:57,709  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:57,709  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:57,709  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:57,709  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:57,709  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:10:57,709  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:57,709  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getValidTxns_(long)=0, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getCheckConstraints_(CheckConstraintsRequest)=1, getTable_(GetTableRequest)=38, getAllTableConstraints_(AllTableConstraintsRequest)=27, openTxn_(String, TxnType)=3, getNotNullConstraints_(NotNullConstraintsRequest)=2}
2024-04-23T21:10:57,710  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1); Time taken: 0.183 seconds
2024-04-23T21:10:57,710  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1
2024-04-23T21:10:57,710  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1
2024-04-23T21:10:57,725  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1 LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:10:57,725  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:57,725  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1): insert into Tstage values(0,2),(1,4)
2024-04-23T21:10:57,725  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1
2024-04-23T21:10:57,725  INFO [main] ql.Driver: Query ID = alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1
Total jobs = 1
2024-04-23T21:10:57,726  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:57,726  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:57,896  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 2
2024-04-23T21:10:57,896  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 2
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:57,896  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:57,897  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:57,897  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:57,897  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:57,897  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:57,897  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:57,899  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:57,899  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:10:57,899  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-57_526_1708785409032619996-1/dummy_path
2024-04-23T21:10:57,909  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:57,910  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:10:57,915  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:57,916  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T21:10:57,916  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:57,920  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-57_526_1708785409032619996-1/-mr-10001
2024-04-23T21:10:57,925  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:57,933  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:57,937  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:57,939  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:10:57,939  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:10:57,939  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-57_526_1708785409032619996-1/dummy_path
2024-04-23T21:10:57,939  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:10:57,958  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:10:57,980  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1616411474_0013
2024-04-23T21:10:57,980  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:58,047  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:58,047  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:58,047  INFO [Thread-1202] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:58,048  INFO [Thread-1202] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:58,049  INFO [Thread-1202] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:58,049  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1616411474_0013_m_000000_0
2024-04-23T21:10:58,052  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:58,053  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-57_526_1708785409032619996-1/dummy_path/null:0+1
2024-04-23T21:10:58,056  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:58,056  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:10:58,057  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 2
2024-04-23T21:10:58,064  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:58,065  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:58,065  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:58,065  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:58,065  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:58,065  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:58,066  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:58,066  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:58,067  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:58,067  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:58,068  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:10:58,068  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:10:58,068  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:58,068  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:10:58,068  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[4]
2024-04-23T21:10:58,068  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:58,069  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0] num distributions: 1
2024-04-23T21:10:58,069  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: records written - 1
2024-04-23T21:10:58,069  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:1, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[4]
2024-04-23T21:10:58,070  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[4]: Total records written - 2. abort - false
2024-04-23T21:10:58,071  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_4:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:10:58,074  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:58,074  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:58,074  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:58,075  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 32; bufvoid = 104857600
2024-04-23T21:10:58,075  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:58,099  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:58,119  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1616411474_0013_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:58,120  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:10:58,120  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1616411474_0013_m_000000_0' done.
2024-04-23T21:10:58,120  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1616411474_0013_m_000000_0: Counters: 26
	File System Counters
		FILE: Number of bytes read=304016
		FILE: Number of bytes written=15476888
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=2
		Map output bytes=32
		Map output materialized bytes=48
		Input split bytes=361
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_4=2
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
	File Input Format Counters 
		Bytes Read=5337
2024-04-23T21:10:58,120  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1616411474_0013_m_000000_0
2024-04-23T21:10:58,120  INFO [Thread-1202] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:58,122  INFO [Thread-1202] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:58,122  INFO [pool-66-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1616411474_0013_r_000000_0
2024-04-23T21:10:58,125  INFO [pool-66-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:58,126  INFO [pool-66-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6f62e6ab
2024-04-23T21:10:58,126  WARN [pool-66-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:58,127  INFO [pool-66-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:58,128  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1616411474_0013_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:58,130  INFO [localfetcher#12] reduce.LocalFetcher: localfetcher#12 about to shuffle output of map attempt_local1616411474_0013_m_000000_0 decomp: 2 len: 6 to MEMORY
2024-04-23T21:10:58,131  INFO [localfetcher#12] reduce.InMemoryMapOutput: Read 2 bytes from map-output for attempt_local1616411474_0013_m_000000_0
2024-04-23T21:10:58,131  INFO [localfetcher#12] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 2, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->2
2024-04-23T21:10:58,131  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:58,131  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:58,131  INFO [pool-66-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:58,137  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:58,138  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:10:58,140  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 2 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:58,141  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 1 files, 6 bytes from disk
2024-04-23T21:10:58,141  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:58,141  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:58,141  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 0 segments left of total size: 0 bytes
2024-04-23T21:10:58,141  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:58,142  INFO [pool-66-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:58,142  INFO [pool-66-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T21:10:58,143  INFO [pool-66-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:58,143  INFO [pool-66-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:58,143  INFO [pool-66-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:10:58,143  INFO [pool-66-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:10:58,144  INFO [pool-66-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1616411474_0013/job_local1616411474_0013.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@36a975c7
2024-04-23T21:10:58,144  INFO [pool-66-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:58,144  INFO [pool-66-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_5:0, 
2024-04-23T21:10:58,144  INFO [pool-66-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:10:58,144  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 0
2024-04-23T21:10:58,144  INFO [pool-66-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/_tmp.-ext-10000/000000_0
2024-04-23T21:10:58,144  INFO [pool-66-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/_task_tmp.-ext-10000/_tmp.000000_0
2024-04-23T21:10:58,144  INFO [pool-66-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/_tmp.-ext-10000/000000_0
2024-04-23T21:10:58,157  INFO [pool-66-thread-1] exec.FileSinkOperator: RECORDS_OUT_1_default.tstage:0, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:0, RECORDS_OUT_OPERATOR_FS_6:0, 
2024-04-23T21:10:58,157  INFO [pool-66-thread-1] mapred.Task: Task:attempt_local1616411474_0013_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:58,158  INFO [pool-66-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:58,158  INFO [pool-66-thread-1] mapred.Task: Task 'attempt_local1616411474_0013_r_000000_0' done.
2024-04-23T21:10:58,158  INFO [pool-66-thread-1] mapred.Task: Final Counters for attempt_local1616411474_0013_r_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=310482
		FILE: Number of bytes written=15476954
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=0
		Reduce shuffle bytes=6
		Reduce input records=0
		Reduce output records=0
		Spilled Records=0
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:58,158  INFO [pool-66-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1616411474_0013_r_000000_0
2024-04-23T21:10:58,158  INFO [pool-66-thread-1] mapred.LocalJobRunner: Starting task: attempt_local1616411474_0013_r_000001_0
2024-04-23T21:10:58,159  INFO [pool-66-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:58,159  INFO [pool-66-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@373b847b
2024-04-23T21:10:58,159  WARN [pool-66-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:58,160  INFO [pool-66-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:58,160  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local1616411474_0013_r_000001_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:58,163  INFO [localfetcher#13] reduce.LocalFetcher: localfetcher#13 about to shuffle output of map attempt_local1616411474_0013_m_000000_0 decomp: 38 len: 42 to MEMORY
2024-04-23T21:10:58,164  INFO [localfetcher#13] reduce.InMemoryMapOutput: Read 38 bytes from map-output for attempt_local1616411474_0013_m_000000_0
2024-04-23T21:10:58,164  INFO [localfetcher#13] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 38, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->38
2024-04-23T21:10:58,164  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:58,165  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:58,165  INFO [pool-66-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:58,174  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:58,175  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:10:58,179  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 38 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:58,180  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 1 files, 42 bytes from disk
2024-04-23T21:10:58,180  INFO [pool-66-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:58,180  INFO [pool-66-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:58,180  INFO [pool-66-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 26 bytes
2024-04-23T21:10:58,180  INFO [pool-66-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:58,180  INFO [pool-66-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:58,181  INFO [pool-66-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,29KB
2024-04-23T21:10:58,182  INFO [pool-66-thread-1] ExecReducer: 
<SEL>Id =5
  <Children>
    <FS>Id =6
      <Children>
      <\Children>
      <Parent>Id = 5 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:58,182  INFO [pool-66-thread-1] exec.SelectOperator: Initializing Operator: SEL[5]
2024-04-23T21:10:58,182  INFO [pool-66-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int>,value:struct<_col0:int>>
2024-04-23T21:10:58,182  INFO [pool-66-thread-1] exec.FileSinkOperator: Initializing Operator: FS[6]
2024-04-23T21:10:58,183  INFO [pool-66-thread-1] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1616411474_0013/job_local1616411474_0013.xml], properties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, bucket_field_name=a, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, bucket_count=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@23617542
2024-04-23T21:10:58,184  INFO [pool-66-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/_tmp.-ext-10000/000001_0
2024-04-23T21:10:58,184  INFO [pool-66-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/_task_tmp.-ext-10000/_tmp.000001_0
2024-04-23T21:10:58,184  INFO [pool-66-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/_tmp.-ext-10000/000001_0
2024-04-23T21:10:58,184  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 1
2024-04-23T21:10:58,185  INFO [pool-66-thread-1] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:10:58,190  INFO [pool-66-thread-1] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/_task_tmp.-ext-10000/_tmp.000001_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:10:58,190  INFO [pool-66-thread-1] exec.SelectOperator: Closing Operator: SEL[5]
2024-04-23T21:10:58,191  INFO [pool-66-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:58,191  INFO [pool-66-thread-1] exec.FileSinkOperator: Closing Operator: FS[6]
2024-04-23T21:10:58,191  INFO [pool-66-thread-1] exec.FileSinkOperator: FS[6]: records written - 2
2024-04-23T21:10:58,199  INFO [pool-66-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_6:2, RECORDS_OUT_INTERMEDIATE:0, TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, 
2024-04-23T21:10:58,199  INFO [pool-66-thread-1] mapred.Task: Task:attempt_local1616411474_0013_r_000001_0 is done. And is in the process of committing
2024-04-23T21:10:58,200  INFO [pool-66-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:58,200  INFO [pool-66-thread-1] mapred.Task: Task 'attempt_local1616411474_0013_r_000001_0' done.
2024-04-23T21:10:58,200  INFO [pool-66-thread-1] mapred.Task: Final Counters for attempt_local1616411474_0013_r_000001_0: Counters: 30
	File System Counters
		FILE: Number of bytes read=316978
		FILE: Number of bytes written=15477342
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=42
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_6=2
		RECORDS_OUT_OPERATOR_SEL_5=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:58,200  INFO [pool-66-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local1616411474_0013_r_000001_0
2024-04-23T21:10:58,200  INFO [Thread-1202] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:10:59,050 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:10:59,051  INFO [main] exec.Task: 2024-04-23 21:10:59,050 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local1616411474_0013
2024-04-23T21:10:59,053  INFO [main] exec.Task: Ended Job = job_local1616411474_0013
2024-04-23T21:10:59,055  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T21:10:59,056  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1/-ext-10000
2024-04-23T21:10:59,056  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:59,065  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,065  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:59,074  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,076  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:59,076  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:59,103  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:10:59,103  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:59,111  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,112  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:10:59,112  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-57_526_1708785409032619996-1/-mr-10001
2024-04-23T21:10:59,113  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:10:59,121  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,122  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T21:10:59,122  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T21:10:59,123  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:10:59,123  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:10:59,147  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=2, numRows=2, totalSize=252, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T21:10:59,147  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:59,148  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=36, isCompatibleWith_(Configuration)=0, alter_table_(String, String, String, Table, EnvironmentContext, String)=51}
MapReduce Jobs Launched: 
2024-04-23T21:10:59,148  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:10:59,148  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:59,148  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:10:59,148  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1); Time taken: 1.422 seconds
2024-04-23T21:10:59,148  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211057_72604182-ac0b-4d9a-b89f-d4653af2f6b1
2024-04-23T21:10:59,152  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:10:59,157  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:59,158  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:10:59,158  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:59,159  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1
2024-04-23T21:10:59,159  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-10-57_526_1708785409032619996-1 on fs with scheme file
2024-04-23T21:10:59,159  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-57_526_1708785409032619996-1
2024-04-23T21:10:59,160  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-57_526_1708785409032619996-1 on fs with scheme file
2024-04-23T21:10:59,160  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211059_f7c3b87e-695d-4715-b26d-de4bc05e7e65): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:59,160  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:59,169  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,171  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:10:59,171  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:10:59,174  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:10:59,183  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,183  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:59,183  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:59,183  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:59,183  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:59,183  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:59,183  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:59,183  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:59,183  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, getCurrentNotificationEventId_()=2, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=18, flushCache_()=0}
2024-04-23T21:10:59,184  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211059_f7c3b87e-695d-4715-b26d-de4bc05e7e65); Time taken: 0.023 seconds
2024-04-23T21:10:59,184  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423211059_f7c3b87e-695d-4715-b26d-de4bc05e7e65
2024-04-23T21:10:59,184  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211059_f7c3b87e-695d-4715-b26d-de4bc05e7e65
2024-04-23T21:10:59,198  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211059_f7c3b87e-695d-4715-b26d-de4bc05e7e65 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:10:59,198  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:10:59,198  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211059_f7c3b87e-695d-4715-b26d-de4bc05e7e65): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:10:59,199  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:10:59,199  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:59,199  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:59,199  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:59,199  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:10:59,209  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:10:59,218  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:59,218  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:10:59,218  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211059_f7c3b87e-695d-4715-b26d-de4bc05e7e65); Time taken: 0.02 seconds
2024-04-23T21:10:59,218  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211059_f7c3b87e-695d-4715-b26d-de4bc05e7e65
2024-04-23T21:10:59,222  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:10:59,228  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:59,229  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:10:59,230  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data'
2024-04-23T21:10:59,230  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211059_8808d4d4-c5c5-4081-92bd-0758338c9a9f): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data'
2024-04-23T21:10:59,233  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:10:59,233  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:10:59,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:10:59,243  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,252  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 19
2024-04-23T21:10:59,252  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [19])
2024-04-23T21:10:59,253  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:59,253  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:10:59,253  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:59,253  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=1, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=11, allocateTableWriteId_(long, String, String)=7}
2024-04-23T21:10:59,253  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211059_8808d4d4-c5c5-4081-92bd-0758338c9a9f); Time taken: 0.023 seconds
2024-04-23T21:10:59,253  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423211059_8808d4d4-c5c5-4081-92bd-0758338c9a9f
2024-04-23T21:10:59,254  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211059_8808d4d4-c5c5-4081-92bd-0758338c9a9f
2024-04-23T21:10:59,269  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211059_8808d4d4-c5c5-4081-92bd-0758338c9a9f LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:10:59,269  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:10:59,274  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211059_8808d4d4-c5c5-4081-92bd-0758338c9a9f): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data'
2024-04-23T21:10:59,274  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:10:59,274  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:59,281  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,281  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:10:59,291  INFO [HMSHandler #13] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:59,312  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T21:10:59,312  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data
2024-04-23T21:10:59,312  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:59,318  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,319  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:59,335  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T21:10:59,335  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:10:59,335  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:59,341  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,342  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:59,351  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T21:10:59,355  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:10:59,355  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T21:10:59,387  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:10:59,407  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:10:59,419  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:10:59,420  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=20, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=1, add_partitions_(List, boolean, boolean)=30, getPartitionWithAuthInfo_(String, String, List, String, List)=35, validatePartitionNameCharacters_(List)=0, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=52}
2024-04-23T21:10:59,420  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211059_8808d4d4-c5c5-4081-92bd-0758338c9a9f); Time taken: 0.145 seconds
2024-04-23T21:10:59,420  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211059_8808d4d4-c5c5-4081-92bd-0758338c9a9f
2024-04-23T21:10:59,426  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:10:59,432  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:10:59,432  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:10:59,433  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:59,433  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:59,436  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:10:59,436  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:10:59,437  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:10:59,437  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:10:59,444  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:10:59,444  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:59,445  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:59,455  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,456  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:59,456  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:59,456  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:10:59,469  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:10:59,502  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:10:59,503  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:10:59,522  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:10:59,530  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:10:59,530  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:10:59,542  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-23T21:10:59,542  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-23T21:10:59,583  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:10:59,584  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:10:59,584  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:10:59,585  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-59_433_1831339714356342654-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-59_433_1831339714356342654-1
2024-04-23T21:10:59,592  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:10:59,595  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col1], VALUE._col2=Column[_col4], VALUE._col0=Column[_col2], KEY.reducesinkkey1=Column[_col0], VALUE._col1=Column[_col3]}
2024-04-23T21:10:59,595  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {VALUE._col1=Column[_col3], VALUE._col0=Column[_col2], VALUE._col2=Column[_col4], KEY.reducesinkkey0=Column[_col1], KEY.reducesinkkey1=Column[_col0]}
2024-04-23T21:10:59,596  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:10:59,597  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:10:59,607  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:10:59,607  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:59,607  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:10:59,608  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:10:59,608  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:10:59,608  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:10:59,608  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:10:59,608  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:row__id, type:struct<writeid:bigint,bucketid:int,rowid:bigint>, comment:null), FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T21:10:59,609  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T21:10:59,610  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:10:59,610  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {listPartitions_(String, String, short)=10, openTxn_(String, TxnType)=2, flushCache_()=0, getTable_(GetTableRequest)=11, isCompatibleWith_(Configuration)=1, getValidWriteIds_(List, String)=8, getAggrColStatsFor_(String, String, List, List, String, String)=21, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=13, getAllTableConstraints_(AllTableConstraintsRequest)=28}
2024-04-23T21:10:59,610  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80); Time taken: 0.176 seconds
2024-04-23T21:10:59,610  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80
2024-04-23T21:10:59,611  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80
2024-04-23T21:10:59,627  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:10:59,627  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:10:59,628  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80): select ROW__ID, p, a, b, INPUT__FILE__NAME from T order by p, ROW__ID
2024-04-23T21:10:59,628  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80
2024-04-23T21:10:59,629  INFO [main] ql.Driver: Query ID = alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80
Total jobs = 1
2024-04-23T21:10:59,629  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:10:59,629  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:10:59,763  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:10:59,763  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:10:59,763  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:10:59,763  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:10:59,763  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:10:59,763  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:10:59,763  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:10:59,763  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:10:59,765  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:10:59,766  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:10:59,766  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:59,775  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:10:59,776  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:10:59,781  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:10:59,782  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T21:10:59,783  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:59,789  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:59,797  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:10:59,801  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:10:59,803  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:10:59,803  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:10:59,803  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:10:59,803  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:10:59,803  INFO [main] orc.OrcInputFormat: Context:: isAcid: true isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: default 
2024-04-23T21:10:59,803  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:10:59,813  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:10:59,813  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 1). duration: 10 ms
2024-04-23T21:10:59,813  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:10:59,832  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:10:59,851  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local934294321_0014
2024-04-23T21:10:59,851  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:10:59,914  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:10:59,915  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:10:59,915  INFO [Thread-1283] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:59,915  INFO [Thread-1283] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:10:59,917  INFO [Thread-1283] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:10:59,917  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local934294321_0014_m_000000_0
2024-04-23T21:10:59,918  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:59,918  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:59,919  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:10:59,920  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,28KB
2024-04-23T21:10:59,921  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: min key = null, max key = null
2024-04-23T21:10:59,921  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0 with {include: [true, true, true], offset: 0, length: 252, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:10:59,928  INFO [LocalJobRunner Map Task Executor #0] orc.OrcRawRecordMerger: updated min key = null, max key = null
2024-04-23T21:10:59,928  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:10:59,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:10:59,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:10:59,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:10:59,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:10:59,932  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:10:59,933  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:10:59,933  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:10:59,934  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:10:59,935  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:10:59,935  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:10:59,935  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,row__id:struct<writeid:bigint,bucketid:int,rowid:bigint>,input__file__name:string>
2024-04-23T21:10:59,935  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:10:59,935  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1] num distributions: 2
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_1:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:10:59,936  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-23T21:10:59,937  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:10:59,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:10:59,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:10:59,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 404; bufvoid = 104857600
2024-04-23T21:10:59,937  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:10:59,948  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:10:59,951  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local934294321_0014_m_000000_0 is done. And is in the process of committing
2024-04-23T21:10:59,952  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0, start=0, length=252, isOriginal=true, fileLength=252, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:10:59,952  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local934294321_0014_m_000000_0' done.
2024-04-23T21:10:59,952  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local934294321_0014_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=325197
		FILE: Number of bytes written=16661852
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=404
		Map output materialized bytes=416
		Input split bytes=493
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=6405
2024-04-23T21:10:59,952  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local934294321_0014_m_000000_0
2024-04-23T21:10:59,952  INFO [Thread-1283] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:10:59,953  INFO [Thread-1283] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:10:59,953  INFO [pool-72-thread-1] mapred.LocalJobRunner: Starting task: attempt_local934294321_0014_r_000000_0
2024-04-23T21:10:59,953  INFO [pool-72-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:10:59,953  INFO [pool-72-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@2699a5e0
2024-04-23T21:10:59,953  WARN [pool-72-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:10:59,954  INFO [pool-72-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:10:59,955  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local934294321_0014_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:10:59,956  INFO [localfetcher#14] reduce.LocalFetcher: localfetcher#14 about to shuffle output of map attempt_local934294321_0014_m_000000_0 decomp: 412 len: 416 to MEMORY
2024-04-23T21:10:59,956  INFO [localfetcher#14] reduce.InMemoryMapOutput: Read 412 bytes from map-output for attempt_local934294321_0014_m_000000_0
2024-04-23T21:10:59,956  INFO [localfetcher#14] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 412, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->412
2024-04-23T21:10:59,957  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:10:59,957  INFO [pool-72-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:59,957  INFO [pool-72-thread-1] reduce.MergeManagerImpl: finalMerge called with 1 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:10:59,963  INFO [pool-72-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:59,963  INFO [pool-72-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-23T21:10:59,966  INFO [pool-72-thread-1] reduce.MergeManagerImpl: Merged 1 segments, 412 bytes to disk to satisfy reduce memory limit
2024-04-23T21:10:59,966  INFO [pool-72-thread-1] reduce.MergeManagerImpl: Merging 1 files, 416 bytes from disk
2024-04-23T21:10:59,966  INFO [pool-72-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:10:59,966  INFO [pool-72-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:10:59,966  INFO [pool-72-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 375 bytes
2024-04-23T21:10:59,967  INFO [pool-72-thread-1] mapred.LocalJobRunner: 1 / 1 copied.
2024-04-23T21:10:59,967  INFO [pool-72-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:10:59,967  INFO [pool-72-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,22KB
2024-04-23T21:10:59,968  INFO [pool-72-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:10:59,968  INFO [pool-72-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:10:59,968  INFO [pool-72-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:struct<writeid:bigint,bucketid:int,rowid:bigint>>,value:struct<_col0:int,_col1:int,_col2:string>>
2024-04-23T21:10:59,969  INFO [pool-72-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:10:59,969  INFO [pool-72-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@6173c4c1, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyLongObjectInspector@6bd9a104>,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@47a2d9a9>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@d0247da, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3, _col4] : [struct<writeid:bigint,bucketid:int,rowid:bigint>, int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@24879458
2024-04-23T21:10:59,970  INFO [pool-72-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-59_433_1831339714356342654-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-59_433_1831339714356342654-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:59,970  INFO [pool-72-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-59_433_1831339714356342654-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-59_433_1831339714356342654-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:10:59,970  INFO [pool-72-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-59_433_1831339714356342654-1/-mr-10001/.hive-staging_hive_2024-04-23_21-10-59_433_1831339714356342654-1/_tmp.-ext-10002/000000_0
2024-04-23T21:10:59,977  INFO [pool-72-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:10:59,977  INFO [pool-72-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:10:59,977  INFO [pool-72-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:10:59,977  INFO [pool-72-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:10:59,977  INFO [pool-72-thread-1] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:10:59,978  INFO [pool-72-thread-1] exec.FileSinkOperator: RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:2, 
2024-04-23T21:10:59,978  INFO [pool-72-thread-1] mapred.Task: Task:attempt_local934294321_0014_r_000000_0 is done. And is in the process of committing
2024-04-23T21:10:59,978  INFO [pool-72-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:10:59,978  INFO [pool-72-thread-1] mapred.Task: Task 'attempt_local934294321_0014_r_000000_0' done.
2024-04-23T21:10:59,978  INFO [pool-72-thread-1] mapred.Task: Final Counters for attempt_local934294321_0014_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=332340
		FILE: Number of bytes written=16662753
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=2
		Reduce shuffle bytes=416
		Reduce input records=2
		Reduce output records=0
		Spilled Records=2
		Shuffled Maps =1
		Failed Shuffles=0
		Merged Map outputs=1
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1143472128
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_SEL_3=2
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:10:59,979  INFO [pool-72-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local934294321_0014_r_000000_0
2024-04-23T21:10:59,979  INFO [Thread-1283] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:11:00,918 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:11:00,918  INFO [main] exec.Task: 2024-04-23 21:11:00,918 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local934294321_0014
2024-04-23T21:11:00,920  INFO [main] exec.Task: Ended Job = job_local934294321_0014
2024-04-23T21:11:00,923  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:00,923  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:11:00,923  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:11:00,923  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:11:00,923  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:11:00,923  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80); Time taken: 1.295 seconds
2024-04-23T21:11:00,923  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211059_c584389b-8284-4ec3-ab7d-5d1c561f2c80
2024-04-23T21:11:00,927  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:11:00,933  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:00,933  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:11:00,937  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:11:00,938  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T21:11:00,939  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:11:00,939  WARN [main] ql.TestTxnAddPartition: addPartitionRename: read data(add partition (p=0)): 
2024-04-23T21:11:00,939  INFO [main] ql.TestTxnAddPartition: {"writeid":1,"bucketid":536936448,"rowid":0}	0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0
{"writeid":1,"bucketid":536936448,"rowid":1}	0	1	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000001_0

2024-04-23T21:11:00,939  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:11:00,939  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-59_433_1831339714356342654-1
2024-04-23T21:11:00,940  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/d9d7f120-6c95-4a52-969b-230f6ddecfe3/hive_2024-04-23_21-10-59_433_1831339714356342654-1 on fs with scheme file
2024-04-23T21:11:00,940  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211100_6cd9d383-d27d-4293-981d-81da20867f87): drop table if exists acidTbl
2024-04-23T21:11:00,944  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 21
2024-04-23T21:11:00,944  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:11:00,948  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:00,954  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:00,954  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:00,954  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:00,955  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:00,955  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=3, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:11:00,955  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211100_6cd9d383-d27d-4293-981d-81da20867f87); Time taken: 0.014 seconds
2024-04-23T21:11:00,955  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423211100_6cd9d383-d27d-4293-981d-81da20867f87
2024-04-23T21:11:00,956  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211100_6cd9d383-d27d-4293-981d-81da20867f87
2024-04-23T21:11:00,971  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211100_6cd9d383-d27d-4293-981d-81da20867f87 LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:11:00,971  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:00,971  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211100_6cd9d383-d27d-4293-981d-81da20867f87): drop table if exists acidTbl
2024-04-23T21:11:00,971  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:00,972  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:00,978  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:00,979  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:00,986  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:00,986  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:01,079  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,079  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=7, dropTable_(String, String, boolean, boolean, boolean)=101}
2024-04-23T21:11:01,079  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211100_6cd9d383-d27d-4293-981d-81da20867f87); Time taken: 0.108 seconds
2024-04-23T21:11:01,079  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211100_6cd9d383-d27d-4293-981d-81da20867f87
2024-04-23T21:11:01,084  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:11:01,089  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,090  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:11:01,090  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:11:01,090  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_55f1892b-5bdd-420d-9ec9-4a96a2c98da3): drop table if exists acidTblPart
2024-04-23T21:11:01,092  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 21
2024-04-23T21:11:01,093  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:11:01,094  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:01,100  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,100  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,100  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,100  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,101  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:11:01,101  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_55f1892b-5bdd-420d-9ec9-4a96a2c98da3); Time taken: 0.01 seconds
2024-04-23T21:11:01,101  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:22 for queryId=alex_20240423211101_55f1892b-5bdd-420d-9ec9-4a96a2c98da3
2024-04-23T21:11:01,101  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211101_55f1892b-5bdd-420d-9ec9-4a96a2c98da3
2024-04-23T21:11:01,120  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211101_55f1892b-5bdd-420d-9ec9-4a96a2c98da3 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:11:01,120  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:01,120  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_55f1892b-5bdd-420d-9ec9-4a96a2c98da3): drop table if exists acidTblPart
2024-04-23T21:11:01,120  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,120  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:01,127  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,127  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:01,134  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,134  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:01,174  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,174  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=7, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=47}
2024-04-23T21:11:01,175  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_55f1892b-5bdd-420d-9ec9-4a96a2c98da3); Time taken: 0.054 seconds
2024-04-23T21:11:01,175  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_55f1892b-5bdd-420d-9ec9-4a96a2c98da3
2024-04-23T21:11:01,179  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:11:01,184  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,185  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:11:01,185  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:11:01,185  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_80cfaaba-8c6e-4566-acd5-0c936cb68a8c): drop table if exists acidTbl2
2024-04-23T21:11:01,188  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 21
2024-04-23T21:11:01,188  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:11:01,189  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,189  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,189  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,189  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, getTable_(GetTableRequest)=0, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=1}
2024-04-23T21:11:01,189  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_80cfaaba-8c6e-4566-acd5-0c936cb68a8c); Time taken: 0.004 seconds
2024-04-23T21:11:01,190  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423211101_80cfaaba-8c6e-4566-acd5-0c936cb68a8c
2024-04-23T21:11:01,190  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:11:01,190  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_80cfaaba-8c6e-4566-acd5-0c936cb68a8c): drop table if exists acidTbl2
2024-04-23T21:11:01,190  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,190  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:11:01,191  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,191  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=1, getTable_(GetTableRequest)=0}
2024-04-23T21:11:01,191  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_80cfaaba-8c6e-4566-acd5-0c936cb68a8c); Time taken: 0.001 seconds
2024-04-23T21:11:01,191  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_80cfaaba-8c6e-4566-acd5-0c936cb68a8c
2024-04-23T21:11:01,196  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:11:01,202  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,202  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:11:01,202  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:11:01,202  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_96463f3d-20e0-4a5d-96ee-faf60cbf0603): drop table if exists nonAcidOrcTbl
2024-04-23T21:11:01,205  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 21
2024-04-23T21:11:01,205  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:11:01,206  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:01,225  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,225  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,225  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,225  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,225  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, getTable_(GetTableRequest)=20, openTxn_(String, TxnType)=2}
2024-04-23T21:11:01,225  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_96463f3d-20e0-4a5d-96ee-faf60cbf0603); Time taken: 0.023 seconds
2024-04-23T21:11:01,225  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423211101_96463f3d-20e0-4a5d-96ee-faf60cbf0603
2024-04-23T21:11:01,226  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211101_96463f3d-20e0-4a5d-96ee-faf60cbf0603
2024-04-23T21:11:01,240  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211101_96463f3d-20e0-4a5d-96ee-faf60cbf0603 LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T21:11:01,240  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:01,240  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_96463f3d-20e0-4a5d-96ee-faf60cbf0603): drop table if exists nonAcidOrcTbl
2024-04-23T21:11:01,240  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:01,248  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,248  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:01,256  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,256  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:01,311  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,311  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=63}
2024-04-23T21:11:01,311  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_96463f3d-20e0-4a5d-96ee-faf60cbf0603); Time taken: 0.071 seconds
2024-04-23T21:11:01,311  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_96463f3d-20e0-4a5d-96ee-faf60cbf0603
2024-04-23T21:11:01,315  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:24
2024-04-23T21:11:01,320  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,322  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:24
2024-04-23T21:11:01,322  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:01,323  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_9a3b3522-4a33-4dea-9260-e07c8cf6350c): drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:01,331  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 21
2024-04-23T21:11:01,331  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T21:11:01,332  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:01,340  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,340  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,341  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,341  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,341  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=8, commitTxn_(CommitTxnRequest)=11, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:11:01,341  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_9a3b3522-4a33-4dea-9260-e07c8cf6350c); Time taken: 0.018 seconds
2024-04-23T21:11:01,341  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423211101_9a3b3522-4a33-4dea-9260-e07c8cf6350c
2024-04-23T21:11:01,342  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211101_9a3b3522-4a33-4dea-9260-e07c8cf6350c
2024-04-23T21:11:01,357  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211101_9a3b3522-4a33-4dea-9260-e07c8cf6350c LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T21:11:01,357  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:01,357  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_9a3b3522-4a33-4dea-9260-e07c8cf6350c): drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:01,357  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,357  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:01,366  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:01,375  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,375  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:01,406  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,406  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=40}
2024-04-23T21:11:01,406  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_9a3b3522-4a33-4dea-9260-e07c8cf6350c); Time taken: 0.049 seconds
2024-04-23T21:11:01,406  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_9a3b3522-4a33-4dea-9260-e07c8cf6350c
2024-04-23T21:11:01,410  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T21:11:01,419  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,419  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T21:11:01,420  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:11:01,420  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_0516f7aa-a3f1-496f-b1ad-d0ea68a82656): drop table if exists nonAcidNonBucket
2024-04-23T21:11:01,424  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 21
2024-04-23T21:11:01,424  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T21:11:01,425  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:01,438  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,439  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,439  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,439  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,439  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, getTable_(GetTableRequest)=14, flushCache_()=0, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3, commitTxn_(CommitTxnRequest)=13}
2024-04-23T21:11:01,439  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_0516f7aa-a3f1-496f-b1ad-d0ea68a82656); Time taken: 0.019 seconds
2024-04-23T21:11:01,439  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423211101_0516f7aa-a3f1-496f-b1ad-d0ea68a82656
2024-04-23T21:11:01,440  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211101_0516f7aa-a3f1-496f-b1ad-d0ea68a82656
2024-04-23T21:11:01,455  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211101_0516f7aa-a3f1-496f-b1ad-d0ea68a82656 LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T21:11:01,455  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:01,455  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_0516f7aa-a3f1-496f-b1ad-d0ea68a82656): drop table if exists nonAcidNonBucket
2024-04-23T21:11:01,456  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,456  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:01,465  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,465  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:01,474  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:01,474  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:01,505  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,505  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=40, getTable_(GetTableRequest)=9}
2024-04-23T21:11:01,506  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_0516f7aa-a3f1-496f-b1ad-d0ea68a82656); Time taken: 0.05 seconds
2024-04-23T21:11:01,506  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_0516f7aa-a3f1-496f-b1ad-d0ea68a82656
2024-04-23T21:11:01,510  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T21:11:01,516  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,516  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T21:11:01,516  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T21:11:01,583  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.arena.size does not exist
2024-04-23T21:11:01,583  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.recordStats does not exist
2024-04-23T21:11:01,583  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.client.cache.maxSize does not exist
2024-04-23T21:11:01,583  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.max does not exist
2024-04-23T21:11:01,584  WARN [main] conf.HiveConf: HiveConf of name hive.metastore.metadb.dir does not exist
2024-04-23T21:11:01,584  WARN [main] conf.HiveConf: HiveConf of name hive.stats.key.prefix.reserve.length does not exist
2024-04-23T21:11:01,584  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.hivesite does not exist
2024-04-23T21:11:01,584  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.alloc.min does not exist
2024-04-23T21:11:01,584  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.override does not exist
2024-04-23T21:11:01,584  WARN [main] conf.HiveConf: HiveConf of name hive.llap.io.cache.orc.size does not exist
2024-04-23T21:11:01,584  WARN [main] conf.HiveConf: HiveConf of name hive.dummyparam.test.server.specific.config.metastoresite does not exist
2024-04-23T21:11:01,586  INFO [main] utils.TestTxnDbUtil: Creating transactional tables
Hive Session ID = 1b56dd34-1895-41e7-abc9-e1cc47c2ae7e
2024-04-23T21:11:01,588  INFO [main] SessionState: Hive Session ID = 1b56dd34-1895-41e7-abc9-e1cc47c2ae7e
ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:11:01,589  INFO [main] DependencyResolver: ivysettings.xml file not found in HIVE_HOME or HIVE_CONF_DIR,/home/alex/Repositories/hive/conf/ivysettings.xml will be used
2024-04-23T21:11:01,617  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e
2024-04-23T21:11:01,619  INFO [main] session.SessionState: Created local directory: /home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e
2024-04-23T21:11:01,622  INFO [main] session.SessionState: Created HDFS directory: /home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/_tmp_space.db
2024-04-23T21:11:01,622  INFO [main] sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=1b56dd34-1895-41e7-abc9-e1cc47c2ae7e, clientType=HIVECLI]
2024-04-23T21:11:01,623  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:11:01,623  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_ece6be29-8ba9-4196-bb54-0e378e63f0fe): drop table if exists acidTbl
2024-04-23T21:11:01,637  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([1]) with min_open_txn: 1
2024-04-23T21:11:01,637  INFO [main] lockmgr.DbTxnManager: Opened txnid:1
2024-04-23T21:11:01,641  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:01,646  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,647  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,647  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,647  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=2, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=3, flushCache_()=1, openTxn_(String, TxnType)=13}
2024-04-23T21:11:01,647  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_ece6be29-8ba9-4196-bb54-0e378e63f0fe); Time taken: 0.024 seconds
2024-04-23T21:11:01,648  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:1 for queryId=alex_20240423211101_ece6be29-8ba9-4196-bb54-0e378e63f0fe
2024-04-23T21:11:01,648  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:11:01,648  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_ece6be29-8ba9-4196-bb54-0e378e63f0fe): drop table if exists acidTbl
2024-04-23T21:11:01,648  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,648  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:01,652  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,652  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:01,653  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_ece6be29-8ba9-4196-bb54-0e378e63f0fe); Time taken: 0.004 seconds
2024-04-23T21:11:01,653  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_ece6be29-8ba9-4196-bb54-0e378e63f0fe
2024-04-23T21:11:01,659  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:1
2024-04-23T21:11:01,667  INFO [main] txn.TxnHandler: Removed transactions: ([1]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,667  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:1
2024-04-23T21:11:01,667  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:11:01,668  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_99c42bbb-dff0-4f6a-9b21-d04f7533cfa9): drop table if exists acidTblPart
2024-04-23T21:11:01,670  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([2]) with min_open_txn: 1
2024-04-23T21:11:01,670  INFO [main] lockmgr.DbTxnManager: Opened txnid:2
2024-04-23T21:11:01,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:01,673  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,674  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,674  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,674  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=14, flushCache_()=0}
2024-04-23T21:11:01,674  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_99c42bbb-dff0-4f6a-9b21-d04f7533cfa9); Time taken: 0.006 seconds
2024-04-23T21:11:01,674  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:2 for queryId=alex_20240423211101_99c42bbb-dff0-4f6a-9b21-d04f7533cfa9
2024-04-23T21:11:01,674  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:11:01,674  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_99c42bbb-dff0-4f6a-9b21-d04f7533cfa9): drop table if exists acidTblPart
2024-04-23T21:11:01,674  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,674  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:01,677  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,677  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:01,678  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_99c42bbb-dff0-4f6a-9b21-d04f7533cfa9); Time taken: 0.003 seconds
2024-04-23T21:11:01,678  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_99c42bbb-dff0-4f6a-9b21-d04f7533cfa9
2024-04-23T21:11:01,683  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:2
2024-04-23T21:11:01,690  INFO [main] txn.TxnHandler: Removed transactions: ([2]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,690  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:2
2024-04-23T21:11:01,691  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:11:01,691  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_6c232cbc-1110-4df7-bc4d-3633b6255af0): drop table if exists acidTbl2
2024-04-23T21:11:01,693  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([3]) with min_open_txn: 1
2024-04-23T21:11:01,694  INFO [main] lockmgr.DbTxnManager: Opened txnid:3
2024-04-23T21:11:01,694  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:11:01,697  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,697  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,697  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,697  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=1}
2024-04-23T21:11:01,698  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_6c232cbc-1110-4df7-bc4d-3633b6255af0); Time taken: 0.006 seconds
2024-04-23T21:11:01,698  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:3 for queryId=alex_20240423211101_6c232cbc-1110-4df7-bc4d-3633b6255af0
2024-04-23T21:11:01,698  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:11:01,698  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_6c232cbc-1110-4df7-bc4d-3633b6255af0): drop table if exists acidTbl2
2024-04-23T21:11:01,698  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,698  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl2	
2024-04-23T21:11:01,701  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,701  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:01,701  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_6c232cbc-1110-4df7-bc4d-3633b6255af0); Time taken: 0.003 seconds
2024-04-23T21:11:01,702  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_6c232cbc-1110-4df7-bc4d-3633b6255af0
2024-04-23T21:11:01,707  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:3
2024-04-23T21:11:01,714  INFO [main] txn.TxnHandler: Removed transactions: ([3]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,714  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:3
2024-04-23T21:11:01,715  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:11:01,715  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_45112708-a009-4837-90d3-0eb8015dc524): drop table if exists nonAcidOrcTbl
2024-04-23T21:11:01,718  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([4]) with min_open_txn: 1
2024-04-23T21:11:01,718  INFO [main] lockmgr.DbTxnManager: Opened txnid:4
2024-04-23T21:11:01,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:01,723  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,723  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,723  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,723  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, flushCache_()=0, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=12, openTxn_(String, TxnType)=3}
2024-04-23T21:11:01,723  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_45112708-a009-4837-90d3-0eb8015dc524); Time taken: 0.008 seconds
2024-04-23T21:11:01,724  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:4 for queryId=alex_20240423211101_45112708-a009-4837-90d3-0eb8015dc524
2024-04-23T21:11:01,724  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:11:01,724  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_45112708-a009-4837-90d3-0eb8015dc524): drop table if exists nonAcidOrcTbl
2024-04-23T21:11:01,724  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,724  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:01,727  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,727  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:01,727  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_45112708-a009-4837-90d3-0eb8015dc524); Time taken: 0.003 seconds
2024-04-23T21:11:01,727  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_45112708-a009-4837-90d3-0eb8015dc524
2024-04-23T21:11:01,733  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:4
2024-04-23T21:11:01,739  INFO [main] txn.TxnHandler: Removed transactions: ([4]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,739  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:4
2024-04-23T21:11:01,740  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:01,740  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_15946f92-3355-4913-ab6c-126fbc410be2): drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:01,742  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([5]) with min_open_txn: 1
2024-04-23T21:11:01,743  INFO [main] lockmgr.DbTxnManager: Opened txnid:5
2024-04-23T21:11:01,744  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:01,747  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,747  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,747  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,747  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=13, getValidTxns_(long)=0, flushCache_()=0}
2024-04-23T21:11:01,747  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_15946f92-3355-4913-ab6c-126fbc410be2); Time taken: 0.007 seconds
2024-04-23T21:11:01,748  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:5 for queryId=alex_20240423211101_15946f92-3355-4913-ab6c-126fbc410be2
2024-04-23T21:11:01,748  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:11:01,748  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_15946f92-3355-4913-ab6c-126fbc410be2): drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:01,748  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,748  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:01,752  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,752  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:01,752  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_15946f92-3355-4913-ab6c-126fbc410be2); Time taken: 0.004 seconds
2024-04-23T21:11:01,752  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_15946f92-3355-4913-ab6c-126fbc410be2
2024-04-23T21:11:01,759  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:5
2024-04-23T21:11:01,766  INFO [main] txn.TxnHandler: Removed transactions: ([5]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,766  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:5
2024-04-23T21:11:01,767  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:11:01,767  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_8bff241b-855c-4d58-90b6-4b7cc571302e): drop table if exists nonAcidNonBucket
2024-04-23T21:11:01,769  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([6]) with min_open_txn: 1
2024-04-23T21:11:01,770  INFO [main] lockmgr.DbTxnManager: Opened txnid:6
2024-04-23T21:11:01,770  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:01,773  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,773  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,773  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,774  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=15, getValidTxns_(long)=0, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:11:01,774  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_8bff241b-855c-4d58-90b6-4b7cc571302e); Time taken: 0.006 seconds
2024-04-23T21:11:01,774  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:6 for queryId=alex_20240423211101_8bff241b-855c-4d58-90b6-4b7cc571302e
2024-04-23T21:11:01,774  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:11:01,774  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_8bff241b-855c-4d58-90b6-4b7cc571302e): drop table if exists nonAcidNonBucket
2024-04-23T21:11:01,774  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,775  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:01,777  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,777  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:01,778  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_8bff241b-855c-4d58-90b6-4b7cc571302e); Time taken: 0.003 seconds
2024-04-23T21:11:01,778  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_8bff241b-855c-4d58-90b6-4b7cc571302e
2024-04-23T21:11:01,783  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:6
2024-04-23T21:11:01,789  INFO [main] txn.TxnHandler: Removed transactions: ([6]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,789  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:6
2024-04-23T21:11:01,790  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:01,790  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_346d2ecb-6387-45e8-8f14-5f2cb2ea4374): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:01,793  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([7]) with min_open_txn: 1
2024-04-23T21:11:01,793  INFO [main] lockmgr.DbTxnManager: Opened txnid:7
2024-04-23T21:11:01,794  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:01,794  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:01,800  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl position=13
2024-04-23T21:11:01,800  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:11:01,802  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:01,802  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,802  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,802  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,803  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=2, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0}
2024-04-23T21:11:01,803  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_346d2ecb-6387-45e8-8f14-5f2cb2ea4374); Time taken: 0.012 seconds
2024-04-23T21:11:01,803  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:7 for queryId=alex_20240423211101_346d2ecb-6387-45e8-8f14-5f2cb2ea4374
2024-04-23T21:11:01,804  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211101_346d2ecb-6387-45e8-8f14-5f2cb2ea4374
2024-04-23T21:11:01,823  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211101_346d2ecb-6387-45e8-8f14-5f2cb2ea4374 LockResponse(lockid:1, state:ACQUIRED)
2024-04-23T21:11:01,823  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:11:01,824  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_346d2ecb-6387-45e8-8f14-5f2cb2ea4374): create table acidTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:01,824  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,825  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTbl, dbName:default, owner:alex, createTime:1713931861, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{transactional=true, rawDataSize=0, bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFiles=0, numFilesErasureCoded=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:11:01,831  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtbl
2024-04-23T21:11:01,874  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,875  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=49, isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:01,875  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_346d2ecb-6387-45e8-8f14-5f2cb2ea4374); Time taken: 0.05 seconds
2024-04-23T21:11:01,875  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_346d2ecb-6387-45e8-8f14-5f2cb2ea4374
2024-04-23T21:11:01,879  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:7
2024-04-23T21:11:01,887  INFO [main] txn.TxnHandler: Removed transactions: ([7]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,887  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:7
2024-04-23T21:11:01,888  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:01,888  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_bc2f3daf-7b63-4d45-8122-779090fbc439): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:01,891  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([8]) with min_open_txn: 1
2024-04-23T21:11:01,891  INFO [main] lockmgr.DbTxnManager: Opened txnid:8
2024-04-23T21:11:01,892  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:01,892  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:01,894  INFO [main] parse.CalcitePlanner: Creating table default.acidTblPart position=13
2024-04-23T21:11:01,895  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:11:01,896  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:01,896  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,896  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,896  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,897  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=2, getDatabase_(String)=2, flushCache_()=0, commitTxn_(CommitTxnRequest)=13, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1}
2024-04-23T21:11:01,897  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_bc2f3daf-7b63-4d45-8122-779090fbc439); Time taken: 0.008 seconds
2024-04-23T21:11:01,897  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:8 for queryId=alex_20240423211101_bc2f3daf-7b63-4d45-8122-779090fbc439
2024-04-23T21:11:01,897  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211101_bc2f3daf-7b63-4d45-8122-779090fbc439
2024-04-23T21:11:01,912  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211101_bc2f3daf-7b63-4d45-8122-779090fbc439 LockResponse(lockid:2, state:ACQUIRED)
2024-04-23T21:11:01,912  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:11:01,913  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_bc2f3daf-7b63-4d45-8122-779090fbc439): create table acidTblPart(a int, b int) partitioned by (p string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:01,913  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,914  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:acidTblPart, dbName:default, owner:alex, createTime:1713931861, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:string, comment:null)], parameters:{transactional=true, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:11:01,920  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/acidtblpart
2024-04-23T21:11:01,935  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,936  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=22, isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:01,936  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_bc2f3daf-7b63-4d45-8122-779090fbc439); Time taken: 0.022 seconds
2024-04-23T21:11:01,936  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_bc2f3daf-7b63-4d45-8122-779090fbc439
2024-04-23T21:11:01,940  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:8
2024-04-23T21:11:01,947  INFO [main] txn.TxnHandler: Removed transactions: ([8]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:01,947  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:8
2024-04-23T21:11:01,948  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:01,948  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211101_a8078e56-ffb4-4dff-9e65-a66fad957458): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:01,951  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([9]) with min_open_txn: 1
2024-04-23T21:11:01,951  INFO [main] lockmgr.DbTxnManager: Opened txnid:9
2024-04-23T21:11:01,952  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:01,952  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:01,954  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl position=13
2024-04-23T21:11:01,954  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:11:01,956  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:01,956  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:01,956  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:01,956  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:01,956  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=2, getValidWriteIds_(List, String)=2, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=1}
2024-04-23T21:11:01,957  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211101_a8078e56-ffb4-4dff-9e65-a66fad957458); Time taken: 0.008 seconds
2024-04-23T21:11:01,957  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:9 for queryId=alex_20240423211101_a8078e56-ffb4-4dff-9e65-a66fad957458
2024-04-23T21:11:01,957  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211101_a8078e56-ffb4-4dff-9e65-a66fad957458
2024-04-23T21:11:01,976  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211101_a8078e56-ffb4-4dff-9e65-a66fad957458 LockResponse(lockid:3, state:ACQUIRED)
2024-04-23T21:11:01,976  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:11:01,976  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211101_a8078e56-ffb4-4dff-9e65-a66fad957458): create table nonAcidOrcTbl(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:01,976  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:01,977  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl, dbName:default, owner:alex, createTime:1713931861, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{numFilesErasureCoded=0, rawDataSize=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numRows=0, totalSize=0, transactional=false, numFiles=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:11:01,983  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl
2024-04-23T21:11:01,998  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:01,998  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=21, isCompatibleWith_(Configuration)=1}
2024-04-23T21:11:01,998  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211101_a8078e56-ffb4-4dff-9e65-a66fad957458); Time taken: 0.022 seconds
2024-04-23T21:11:01,998  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211101_a8078e56-ffb4-4dff-9e65-a66fad957458
2024-04-23T21:11:02,002  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:9
2024-04-23T21:11:02,011  INFO [main] txn.TxnHandler: Removed transactions: ([9]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:02,011  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:9
2024-04-23T21:11:02,012  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:02,012  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211102_5079632e-098d-4c63-8d87-fa25de276ad0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:02,016  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([10]) with min_open_txn: 1
2024-04-23T21:11:02,016  INFO [main] lockmgr.DbTxnManager: Opened txnid:10
2024-04-23T21:11:02,017  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:02,017  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:02,021  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidOrcTbl2 position=13
2024-04-23T21:11:02,021  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:11:02,024  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:02,024  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:02,024  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:02,024  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:02,024  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getDatabase_(String)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidWriteIds_(List, String)=4, commitTxn_(CommitTxnRequest)=14, getValidTxns_(long)=0, openTxn_(String, TxnType)=3}
2024-04-23T21:11:02,024  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211102_5079632e-098d-4c63-8d87-fa25de276ad0); Time taken: 0.012 seconds
2024-04-23T21:11:02,025  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:10 for queryId=alex_20240423211102_5079632e-098d-4c63-8d87-fa25de276ad0
2024-04-23T21:11:02,025  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211102_5079632e-098d-4c63-8d87-fa25de276ad0
2024-04-23T21:11:02,048  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211102_5079632e-098d-4c63-8d87-fa25de276ad0 LockResponse(lockid:4, state:ACQUIRED)
2024-04-23T21:11:02,048  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:11:02,048  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211102_5079632e-098d-4c63-8d87-fa25de276ad0): create table nonAcidOrcTbl2(a int, b int) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:02,049  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:02,050  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidOrcTbl2, dbName:default, owner:alex, createTime:1713931862, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:2, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[a], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, totalSize=0, numFilesErasureCoded=0, bucketing_version=2, transactional=false, numFiles=0, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:11:02,059  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidorctbl2
2024-04-23T21:11:02,076  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:02,076  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=26}
2024-04-23T21:11:02,076  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211102_5079632e-098d-4c63-8d87-fa25de276ad0); Time taken: 0.028 seconds
2024-04-23T21:11:02,076  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211102_5079632e-098d-4c63-8d87-fa25de276ad0
2024-04-23T21:11:02,080  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:10
2024-04-23T21:11:02,087  INFO [main] txn.TxnHandler: Removed transactions: ([10]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:02,087  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:10
2024-04-23T21:11:02,088  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:02,088  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211102_c98ced9d-44e0-49f7-b476-0588b14cb650): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:02,091  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([11]) with min_open_txn: 1
2024-04-23T21:11:02,091  INFO [main] lockmgr.DbTxnManager: Opened txnid:11
2024-04-23T21:11:02,092  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:02,092  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:02,094  INFO [main] parse.CalcitePlanner: Creating table default.acidTbl2 position=24
2024-04-23T21:11:02,095  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:11:02,096  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:02,096  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:02,096  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:02,096  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:02,097  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=2, flushCache_()=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1}
2024-04-23T21:11:02,097  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211102_c98ced9d-44e0-49f7-b476-0588b14cb650); Time taken: 0.008 seconds
2024-04-23T21:11:02,097  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:11 for queryId=alex_20240423211102_c98ced9d-44e0-49f7-b476-0588b14cb650
2024-04-23T21:11:02,097  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211102_c98ced9d-44e0-49f7-b476-0588b14cb650
2024-04-23T21:11:02,114  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211102_c98ced9d-44e0-49f7-b476-0588b14cb650 LockResponse(lockid:5, state:ACQUIRED)
2024-04-23T21:11:02,114  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:11:02,114  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211102_c98ced9d-44e0-49f7-b476-0588b14cb650): create temporary  table acidTbl2(a int, b int, c int) clustered by (c) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
2024-04-23T21:11:02,115  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:02,116  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/scratchdir/alex/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/_tmp_space.db/989a7f7e-f7cf-4304-8cdc-6b5f16ccf8a5
2024-04-23T21:11:02,118  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:02,118  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=3}
2024-04-23T21:11:02,119  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211102_c98ced9d-44e0-49f7-b476-0588b14cb650); Time taken: 0.004 seconds
2024-04-23T21:11:02,119  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211102_c98ced9d-44e0-49f7-b476-0588b14cb650
2024-04-23T21:11:02,123  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:11
2024-04-23T21:11:02,129  INFO [main] txn.TxnHandler: Removed transactions: ([11]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:02,130  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:11
2024-04-23T21:11:02,130  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:02,130  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211102_ac2af927-e649-48cf-9660-cb7ca33d78eb): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:02,133  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([12]) with min_open_txn: 1
2024-04-23T21:11:02,133  INFO [main] lockmgr.DbTxnManager: Opened txnid:12
2024-04-23T21:11:02,134  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:02,134  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:02,136  INFO [main] parse.CalcitePlanner: Creating table default.nonAcidNonBucket position=13
2024-04-23T21:11:02,137  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:11:02,138  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:02,138  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:02,138  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:02,138  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:02,139  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidWriteIds_(List, String)=2, getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=11, flushCache_()=0, openTxn_(String, TxnType)=2, getDatabase_(String)=1}
2024-04-23T21:11:02,139  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211102_ac2af927-e649-48cf-9660-cb7ca33d78eb); Time taken: 0.008 seconds
2024-04-23T21:11:02,139  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:12 for queryId=alex_20240423211102_ac2af927-e649-48cf-9660-cb7ca33d78eb
2024-04-23T21:11:02,139  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211102_ac2af927-e649-48cf-9660-cb7ca33d78eb
2024-04-23T21:11:02,154  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211102_ac2af927-e649-48cf-9660-cb7ca33d78eb LockResponse(lockid:6, state:ACQUIRED)
2024-04-23T21:11:02,154  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:11:02,154  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211102_ac2af927-e649-48cf-9660-cb7ca33d78eb): create table nonAcidNonBucket(a int, b int) stored as orc TBLPROPERTIES ('transactional'='false')
2024-04-23T21:11:02,154  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:02,155  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:nonAcidNonBucket, dbName:default, owner:alex, createTime:1713931862, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{bucketing_version=2, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, numFiles=0, numFilesErasureCoded=0, transactional=false, totalSize=0, rawDataSize=0, numRows=0}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:11:02,161  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/nonacidnonbucket
2024-04-23T21:11:02,175  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:02,175  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=20, isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:02,176  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211102_ac2af927-e649-48cf-9660-cb7ca33d78eb); Time taken: 0.021 seconds
2024-04-23T21:11:02,176  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211102_ac2af927-e649-48cf-9660-cb7ca33d78eb
2024-04-23T21:11:02,180  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:12
2024-04-23T21:11:02,187  INFO [main] txn.TxnHandler: Removed transactions: ([12]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:02,187  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:12
2024-04-23T21:11:02,188  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists T
2024-04-23T21:11:02,188  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211102_10a0e01a-bce2-4259-a624-7ea61057b433): drop table if exists T
2024-04-23T21:11:02,190  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([13]) with min_open_txn: 1
2024-04-23T21:11:02,191  INFO [main] lockmgr.DbTxnManager: Opened txnid:13
2024-04-23T21:11:02,191  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:11:02,213  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,213  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:02,213  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:02,213  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:02,213  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, getTable_(GetTableRequest)=22, openTxn_(String, TxnType)=2, getValidTxns_(long)=0}
2024-04-23T21:11:02,214  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211102_10a0e01a-bce2-4259-a624-7ea61057b433); Time taken: 0.025 seconds
2024-04-23T21:11:02,214  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:13 for queryId=alex_20240423211102_10a0e01a-bce2-4259-a624-7ea61057b433
2024-04-23T21:11:02,214  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211102_10a0e01a-bce2-4259-a624-7ea61057b433
2024-04-23T21:11:02,236  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211102_10a0e01a-bce2-4259-a624-7ea61057b433 LockResponse(lockid:7, state:ACQUIRED)
2024-04-23T21:11:02,236  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:02,236  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211102_10a0e01a-bce2-4259-a624-7ea61057b433): drop table if exists T
2024-04-23T21:11:02,236  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:02,236  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:11:02,244  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,244  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:11:02,251  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,252  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.T	
2024-04-23T21:11:02,414  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t does not exist; Force to delete it.
2024-04-23T21:11:02,414 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:11:02,414  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:02,415  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=170}
2024-04-23T21:11:02,415  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211102_10a0e01a-bce2-4259-a624-7ea61057b433); Time taken: 0.178 seconds
2024-04-23T21:11:02,415  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211102_10a0e01a-bce2-4259-a624-7ea61057b433
2024-04-23T21:11:02,420  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:13
2024-04-23T21:11:02,427  INFO [main] txn.TxnHandler: Removed transactions: ([13]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:02,429  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:13
2024-04-23T21:11:02,430  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists Tstage
2024-04-23T21:11:02,430  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211102_30c1ae5b-6679-416a-8649-c6994d864b2c): drop table if exists Tstage
2024-04-23T21:11:02,440  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([14]) with min_open_txn: 1
2024-04-23T21:11:02,441  INFO [main] lockmgr.DbTxnManager: Opened txnid:14
2024-04-23T21:11:02,442  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:02,465  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,465  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:02,465  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:02,465  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:02,466  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, flushCache_()=0, getTable_(GetTableRequest)=24, getValidTxns_(long)=0, openTxn_(String, TxnType)=10}
2024-04-23T21:11:02,466  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211102_30c1ae5b-6679-416a-8649-c6994d864b2c); Time taken: 0.035 seconds
2024-04-23T21:11:02,466  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:14 for queryId=alex_20240423211102_30c1ae5b-6679-416a-8649-c6994d864b2c
2024-04-23T21:11:02,466  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211102_30c1ae5b-6679-416a-8649-c6994d864b2c
2024-04-23T21:11:02,482  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211102_30c1ae5b-6679-416a-8649-c6994d864b2c LockResponse(lockid:8, state:ACQUIRED)
2024-04-23T21:11:02,482  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:02,482  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211102_30c1ae5b-6679-416a-8649-c6994d864b2c): drop table if exists Tstage
2024-04-23T21:11:02,482  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:02,483  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:02,492  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,492  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:02,501  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,501  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.Tstage	
2024-04-23T21:11:02,535  WARN [main] utils.FileUtils: File file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage does not exist; Force to delete it.
2024-04-23T21:11:02,535 ERROR [main] utils.FileUtils: Failed to delete file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:11:02,535  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:02,536  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=43, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:02,536  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211102_30c1ae5b-6679-416a-8649-c6994d864b2c); Time taken: 0.053 seconds
2024-04-23T21:11:02,536  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211102_30c1ae5b-6679-416a-8649-c6994d864b2c
2024-04-23T21:11:02,540  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:14
2024-04-23T21:11:02,547  INFO [main] txn.TxnHandler: Removed transactions: ([14]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:02,547  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:14
2024-04-23T21:11:02,548  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T21:11:02,548  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211102_cfb9a973-027a-4c82-a22d-27f524c4a066): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T21:11:02,551  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([15]) with min_open_txn: 1
2024-04-23T21:11:02,552  INFO [main] lockmgr.DbTxnManager: Opened txnid:15
2024-04-23T21:11:02,552  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:02,552  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:02,559  INFO [main] parse.CalcitePlanner: Creating table default.T position=13
2024-04-23T21:11:02,559  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:11:02,561  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:02,561  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:02,561  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:02,561  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:02,561  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, flushCache_()=0, getDatabase_(String)=2, commitTxn_(CommitTxnRequest)=12, getValidWriteIds_(List, String)=6, isCompatibleWith_(Configuration)=1, openTxn_(String, TxnType)=3}
2024-04-23T21:11:02,562  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211102_cfb9a973-027a-4c82-a22d-27f524c4a066); Time taken: 0.013 seconds
2024-04-23T21:11:02,562  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:15 for queryId=alex_20240423211102_cfb9a973-027a-4c82-a22d-27f524c4a066
2024-04-23T21:11:02,562  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211102_cfb9a973-027a-4c82-a22d-27f524c4a066
2024-04-23T21:11:02,581  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211102_cfb9a973-027a-4c82-a22d-27f524c4a066 LockResponse(lockid:9, state:ACQUIRED)
2024-04-23T21:11:02,581  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:11:02,582  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211102_cfb9a973-027a-4c82-a22d-27f524c4a066): create table T (a int, b int) partitioned by (p int) stored as orc tblproperties('transactional'='true', 'transactional_properties'='insert_only')
2024-04-23T21:11:02,582  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:02,583  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:T, dbName:default, owner:alex, createTime:1713931862, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[FieldSchema(name:p, type:int, comment:null)], parameters:{transactional_properties=insert_only, bucketing_version=2, transactional=true}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER, writeId:0)	
2024-04-23T21:11:02,589  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t
2024-04-23T21:11:02,627  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:02,627  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {createTable_(Table)=43, isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:02,627  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211102_cfb9a973-027a-4c82-a22d-27f524c4a066); Time taken: 0.045 seconds
2024-04-23T21:11:02,627  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211102_cfb9a973-027a-4c82-a22d-27f524c4a066
2024-04-23T21:11:02,631  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:15
2024-04-23T21:11:02,639  INFO [main] txn.TxnHandler: Removed transactions: ([15]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:02,639  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:15
2024-04-23T21:11:02,639  INFO [main] ql.TxnCommandsBaseForTests: Running the query: create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:11:02,640  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211102_ec291694-4bac-4665-b77d-8163961c6031): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:11:02,642  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([16]) with min_open_txn: 2
2024-04-23T21:11:02,643  INFO [main] lockmgr.DbTxnManager: Opened txnid:16
2024-04-23T21:11:02,644  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:02,644  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:02,646  INFO [main] parse.CalcitePlanner: Creating table default.Tstage position=13
2024-04-23T21:11:02,646  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_database: default	
2024-04-23T21:11:02,648  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:02,648  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:02,648  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:02,648  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:02,649  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, getDatabase_(String)=2, getValidWriteIds_(List, String)=2, openTxn_(String, TxnType)=3, flushCache_()=0, commitTxn_(CommitTxnRequest)=12, isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:02,649  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211102_ec291694-4bac-4665-b77d-8163961c6031); Time taken: 0.008 seconds
2024-04-23T21:11:02,649  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:16 for queryId=alex_20240423211102_ec291694-4bac-4665-b77d-8163961c6031
2024-04-23T21:11:02,649  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211102_ec291694-4bac-4665-b77d-8163961c6031
2024-04-23T21:11:02,665  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211102_ec291694-4bac-4665-b77d-8163961c6031 LockResponse(lockid:10, state:ACQUIRED)
2024-04-23T21:11:02,665  INFO [main] ql.Driver: Operation CREATETABLE obtained 1 locks
2024-04-23T21:11:02,665  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211102_ec291694-4bac-4665-b77d-8163961c6031): create table Tstage (a int, b int) stored as orc tblproperties('transactional'='false')
2024-04-23T21:11:02,665  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:02,666  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=create_table_req: Table(tableName:Tstage, dbName:default, owner:alex, createTime:1713931862, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:null, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{rawDataSize=0, totalSize=0, numFilesErasureCoded=0, numFiles=0, COLUMN_STATS_ACCURATE={"BASIC_STATS":"true","COLUMN_STATS":{"a":"true","b":"true"}}, bucketing_version=2, numRows=0, transactional=false}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, privileges:PrincipalPrivilegeSet(userPrivileges:{alex=[PrivilegeGrantInfo(privilege:INSERT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:SELECT, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:UPDATE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true), PrivilegeGrantInfo(privilege:DELETE, createTime:-1, grantor:alex, grantorType:USER, grantOption:true)]}, groupPrivileges:null, rolePrivileges:null), temporary:false, catName:hive, ownerType:USER)	
2024-04-23T21:11:02,671  INFO [main] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage
2024-04-23T21:11:02,686  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:02,686  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, createTable_(Table)=20}
2024-04-23T21:11:02,686  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211102_ec291694-4bac-4665-b77d-8163961c6031); Time taken: 0.021 seconds
2024-04-23T21:11:02,686  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211102_ec291694-4bac-4665-b77d-8163961c6031
2024-04-23T21:11:02,691  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:16
2024-04-23T21:11:02,698  INFO [main] txn.TxnHandler: Removed transactions: ([16]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:02,698  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:16
2024-04-23T21:11:02,699  INFO [main] ql.TxnCommandsBaseForTests: Running the query: insert into Tstage values(0,2),(0,4)
2024-04-23T21:11:02,699  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd): insert into Tstage values(0,2),(0,4)
2024-04-23T21:11:02,702  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([17]) with min_open_txn: 4
2024-04-23T21:11:02,703  INFO [main] lockmgr.DbTxnManager: Opened txnid:17
2024-04-23T21:11:02,703  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:02,703  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:02,707  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:02,718  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,718  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:11:02,718  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:02,719  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:02,719  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:02,719  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:02,729  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,730  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:11:02,730  INFO [main] parse.CalcitePlanner: Disabling LLAP IO encode as ETL query is detected
2024-04-23T21:11:02,751  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:11:02,829  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:02,829  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:02,829  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:02,829  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive._dummy_database._dummy_table	
2024-04-23T21:11:02,832  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:02,832  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:02,832  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:02,832  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:02,841  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,843  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1
2024-04-23T21:11:02,846  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_not_null_constraints : tbl=hive.default.tstage	
2024-04-23T21:11:02,847  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_check_constraints : tbl=hive.default.tstage	
2024-04-23T21:11:02,848  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:11:02,852  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:11:02,852  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:11:02,861  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:11:02,872  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,872  INFO [main] optimizer.GenMRFileSink1: using CombineHiveInputformat for the merge job
2024-04-23T21:11:02,873  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:11:02,882  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:02,884  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:11:02,884  INFO [main] physical.Vectorizer: Map vectorization enabled: false
2024-04-23T21:11:02,884  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:11:02,884  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:11:02,884  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:11:02,884  INFO [main] physical.Vectorizer: Map enabledConditionsNotMet: [Could not enable vectorization due to partition column names size 1 is greater than the number of table column names size 0 IS false]
2024-04-23T21:11:02,884  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.NullRowsInputFormat]
2024-04-23T21:11:02,885  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:11:02,885  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:02,885  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:02,885  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:col1, type:int, comment:null), FieldSchema(name:col2, type:int, comment:null)], properties:null)
2024-04-23T21:11:02,885  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:02,885  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAllTableConstraints_(AllTableConstraintsRequest)=29, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=1, flushCache_()=0, getValidWriteIds_(List, String)=2, getTable_(GetTableRequest)=51, commitTxn_(CommitTxnRequest)=12, getNotNullConstraints_(NotNullConstraintsRequest)=2, getCheckConstraints_(CheckConstraintsRequest)=1, getValidTxns_(long)=0}
2024-04-23T21:11:02,885  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd); Time taken: 0.186 seconds
2024-04-23T21:11:02,885  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:17 for queryId=alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd
2024-04-23T21:11:02,885  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd
2024-04-23T21:11:02,901  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd LockResponse(lockid:11, state:ACQUIRED)
2024-04-23T21:11:02,901  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:11:02,901  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd): insert into Tstage values(0,2),(0,4)
2024-04-23T21:11:02,902  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd
2024-04-23T21:11:02,902  INFO [main] ql.Driver: Query ID = alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd
Total jobs = 1
2024-04-23T21:11:02,902  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:11:02,902  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:11:03,053  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:11:03,053  INFO [main] exec.Task: Number of reduce tasks is set to 0 since there's no reduce operator
2024-04-23T21:11:03,056  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:11:03,056  INFO [main] exec.Utilities: Processing alias $hdt$_0:_dummy_table
2024-04-23T21:11:03,056  INFO [main] exec.Utilities: Adding 1 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-02_699_3306056114266184913-1/dummy_path
2024-04-23T21:11:03,067  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:11:03,068  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,09KB
2024-04-23T21:11:03,069  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:11:03,074  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-02_699_3306056114266184913-1/-mr-10001
2024-04-23T21:11:03,079  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:11:03,088  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:11:03,093  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:11:03,094  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 
2024-04-23T21:11:03,094  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = 
2024-04-23T21:11:03,094  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-02_699_3306056114266184913-1/dummy_path
2024-04-23T21:11:03,095  INFO [main] io.HiveInputFormat: number of splits 1
2024-04-23T21:11:03,116  INFO [main] mapreduce.JobSubmitter: number of splits:1
2024-04-23T21:11:03,138  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local1024153801_0015
2024-04-23T21:11:03,138  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:11:03,210  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:11:03,211  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:11:03,211  INFO [Thread-1370] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:11:03,211  INFO [Thread-1370] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:11:03,213  INFO [Thread-1370] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:11:03,213  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local1024153801_0015_m_000000_0
2024-04-23T21:11:03,217  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:11:03,217  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.NullRowsInputFormat:file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-02_699_3306056114266184913-1/dummy_path/null:0+1
2024-04-23T21:11:03,220  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:11:03,220  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,09KB
2024-04-23T21:11:03,221  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 0
2024-04-23T21:11:03,224  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:11:03,224  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:11:03,224  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:11:03,225  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:11:03,225  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT null
2024-04-23T21:11:03,225  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Initializing Operator: UDTF[2]
2024-04-23T21:11:03,225  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:11:03,225  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<col1:int,col2:int>
2024-04-23T21:11:03,225  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:11:03,225  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Using serializer : AbstractSerDe [log=org.apache.logging.slf4j.Log4jLogger@594061ec, configuration=Optional[Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-site.xml, file:/home/alex/Repositories/hive/ql/target/tmp/TestTxnAddPartition/mapred/local/localRunner/alex/job_local1024153801_0015/job_local1024153801_0015.xml], properties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, column.name.delimiter=,}, tableProperties={name=default.tstage, columns.types=int:int, serialization.format=1, columns=a,b, numFilesErasureCoded=0, columns.comments= , bucketing_version=2, serialization.lib=org.apache.hadoop.hive.ql.io.orc.OrcSerde, file.inputformat=org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, location=file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage, file.outputformat=org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, column.name.delimiter=,}, partitionProperties=Optional.empty, columnNames=[a, b], columnTypes=[int, int], getClass()=class org.apache.hadoop.hive.ql.io.orc.OrcSerde] and formatter : org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat@675b2474
2024-04-23T21:11:03,226  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/_tmp.-ext-10002/000000_0
2024-04-23T21:11:03,226  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:11:03,226  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/_tmp.-ext-10002/000000_0
2024-04-23T21:11:03,228  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:11:03,228  INFO [LocalJobRunner Map Task Executor #0] impl.PhysicalFsWriter: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 blockSize: 268435456 compression: Compress: ZLIB buffer: 262144
2024-04-23T21:11:03,236  INFO [LocalJobRunner Map Task Executor #0] impl.WriterImpl: ORC writer created for path: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/_task_tmp.-ext-10002/_tmp.000000_0 with stripeSize: 67108864 options: Compress: ZLIB buffer: 262144
2024-04-23T21:11:03,236  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 3. abort - false
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:3, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:1, 
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:1, 
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: Closing Operator: UDTF[2]
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.UDTFOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_UDTF_2:2, 
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:2, 
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:11:03,237  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: FS[4]: records written - 2
2024-04-23T21:11:03,246  INFO [LocalJobRunner Map Task Executor #0] exec.FileSinkOperator: TOTAL_TABLE_ROWS_WRITTEN:2, RECORDS_OUT_1_default.tstage:2, RECORDS_OUT_OPERATOR_FS_4:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:11:03,247  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:11:03,250  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local1024153801_0015_m_000000_0 is done. And is in the process of committing
2024-04-23T21:11:03,251  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:11:03,251  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local1024153801_0015_m_000000_0' done.
2024-04-23T21:11:03,251  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local1024153801_0015_m_000000_0: Counters: 27
	File System Counters
		FILE: Number of bytes read=339378
		FILE: Number of bytes written=17845455
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=4
		Map output records=0
		Input split bytes=361
		Spilled Records=0
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1145569280
	HIVE
		CREATED_FILES=1
		DESERIALIZE_ERRORS=0
		RECORDS_IN=3
		RECORDS_OUT_1_default.tstage=2
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_SEL_1=1
		RECORDS_OUT_OPERATOR_SEL_3=2
		RECORDS_OUT_OPERATOR_TS_0=1
		RECORDS_OUT_OPERATOR_UDTF_2=2
		TOTAL_TABLE_ROWS_WRITTEN=2
	File Input Format Counters 
		Bytes Read=6148
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:11:03,251  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local1024153801_0015_m_000000_0
2024-04-23T21:11:03,251  INFO [Thread-1370] mapred.LocalJobRunner: map task executor complete.
2024-04-23 21:11:04,212 Stage-1 map = 100%,  reduce = 0%
2024-04-23T21:11:04,212  INFO [main] exec.Task: 2024-04-23 21:11:04,212 Stage-1 map = 100%,  reduce = 0%
Ended Job = job_local1024153801_0015
2024-04-23T21:11:04,214  INFO [main] exec.Task: Ended Job = job_local1024153801_0015
2024-04-23T21:11:04,216  INFO [main] ql.Driver: Starting task [Stage-7:CONDITIONAL] in serial mode
Stage-4 is selected by condition resolver.
2024-04-23T21:11:04,217  INFO [main] exec.Task: Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
2024-04-23T21:11:04,217  INFO [main] exec.Task: Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
2024-04-23T21:11:04,217  INFO [main] exec.Task: Stage-5 is filtered out by condition resolver.
2024-04-23T21:11:04,217  INFO [main] ql.Driver: Starting task [Stage-4:MOVE] in serial mode
Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/-ext-10000
2024-04-23T21:11:04,217  INFO [main] exec.Task: Moving data to directory file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/-ext-10000 from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/-ext-10002
2024-04-23T21:11:04,217  INFO [main] ql.Driver: Starting task [Stage-0:MOVE] in serial mode
Loading data to table default.tstage
2024-04-23T21:11:04,217  INFO [main] exec.Task: Loading data to table default.tstage from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1/-ext-10000
2024-04-23T21:11:04,218  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:11:04,228  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,228  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:11:04,238  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,240  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:11:04,240  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:11:04,269  INFO [main] ql.Driver: Starting task [Stage-2:STATS] in serial mode
2024-04-23T21:11:04,270  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:11:04,278  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,278  INFO [main] stats.BasicStatsTask: Executing stats task
2024-04-23T21:11:04,278  INFO [main] fs.FSStatsPublisher: created : file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-02_699_3306056114266184913-1/-mr-10001
2024-04-23T21:11:04,279  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.tstage	
2024-04-23T21:11:04,288  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,289  INFO [main] FileOperations: Read stats for default.tstage/, numRows, true, 2, false: 
2024-04-23T21:11:04,289  INFO [main] FileOperations: Read stats for default.tstage/, rawDataSize, true, 16, false: 
2024-04-23T21:11:04,289  WARN [main] metadata.Hive: Cannot get a table snapshot for tstage
2024-04-23T21:11:04,289  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_table: hive.default.tstage newtbl=tstage	
2024-04-23T21:11:04,317  INFO [main] stats.BasicStatsTask: Table default.tstage stats: [numFiles=1, numRows=2, totalSize=254, rawDataSize=16, numFilesErasureCoded=0]
2024-04-23T21:11:04,317  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:04,317  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {alter_table_(String, String, String, Table, EnvironmentContext, String)=57, getTable_(GetTableRequest)=38, isCompatibleWith_(Configuration)=0}
MapReduce Jobs Launched: 
2024-04-23T21:11:04,318  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:11:04,318  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:11:04,318  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:11:04,318  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd); Time taken: 1.416 seconds
2024-04-23T21:11:04,318  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211102_98a03a29-b656-45b8-aa87-74ebf26149cd
2024-04-23T21:11:04,322  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:17
2024-04-23T21:11:04,328  INFO [main] txn.TxnHandler: Removed transactions: ([17]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:04,328  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:17
2024-04-23T21:11:04,329  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:11:04,329  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-02_699_3306056114266184913-1
2024-04-23T21:11:04,330  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-02_699_3306056114266184913-1 on fs with scheme file
2024-04-23T21:11:04,330  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1
2024-04-23T21:11:04,330  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/tstage/.hive-staging_hive_2024-04-23_21-11-02_699_3306056114266184913-1 on fs with scheme file
2024-04-23T21:11:04,331  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211104_d420fc5f-a79d-4252-8f1a-7bd2575d9846): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:11:04,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:04,340  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,342  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([18]) with min_open_txn: 18
2024-04-23T21:11:04,342  INFO [main] lockmgr.DbTxnManager: Opened txnid:18
2024-04-23T21:11:04,345  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:04,353  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,353  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:11:04,353  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:11:04,353  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:11:04,353  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:11:04,353  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:04,353  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:04,354  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:04,354  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=11, getCurrentNotificationEventId_()=3, openTxn_(String, TxnType)=2, getValidTxns_(long)=0, flushCache_()=0, getTable_(GetTableRequest)=17}
2024-04-23T21:11:04,354  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211104_d420fc5f-a79d-4252-8f1a-7bd2575d9846); Time taken: 0.022 seconds
2024-04-23T21:11:04,354  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:18 for queryId=alex_20240423211104_d420fc5f-a79d-4252-8f1a-7bd2575d9846
2024-04-23T21:11:04,355  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211104_d420fc5f-a79d-4252-8f1a-7bd2575d9846
2024-04-23T21:11:04,369  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211104_d420fc5f-a79d-4252-8f1a-7bd2575d9846 LockResponse(lockid:12, state:ACQUIRED)
2024-04-23T21:11:04,369  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:11:04,369  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211104_d420fc5f-a79d-4252-8f1a-7bd2575d9846): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1'
2024-04-23T21:11:04,369  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:11:04,369  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:11:04,369  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:11:04,369  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:11:04,369  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1
2024-04-23T21:11:04,380  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:11:04,384  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:04,384  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:11:04,385  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211104_d420fc5f-a79d-4252-8f1a-7bd2575d9846); Time taken: 0.015 seconds
2024-04-23T21:11:04,385  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211104_d420fc5f-a79d-4252-8f1a-7bd2575d9846
2024-04-23T21:11:04,389  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:18
2024-04-23T21:11:04,394  INFO [main] txn.TxnHandler: Removed transactions: ([18]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:04,395  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:18
2024-04-23T21:11:04,395  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:11:04,396  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211104_c8ba7f75-8d3d-45a9-ade0-78e92aafdbbd): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:11:04,396  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:04,404  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,406  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([19]) with min_open_txn: 18
2024-04-23T21:11:04,407  INFO [main] lockmgr.DbTxnManager: Opened txnid:19
2024-04-23T21:11:04,408  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:04,417  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,417  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:11:04,417  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:11:04,417  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:11:04,417  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:11:04,417  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:04,417  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:04,418  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:04,418  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=10, getValidTxns_(long)=0, getTable_(GetTableRequest)=17, getCurrentNotificationEventId_()=1}
2024-04-23T21:11:04,418  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211104_c8ba7f75-8d3d-45a9-ade0-78e92aafdbbd); Time taken: 0.022 seconds
2024-04-23T21:11:04,418  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:19 for queryId=alex_20240423211104_c8ba7f75-8d3d-45a9-ade0-78e92aafdbbd
2024-04-23T21:11:04,419  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211104_c8ba7f75-8d3d-45a9-ade0-78e92aafdbbd
2024-04-23T21:11:04,435  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211104_c8ba7f75-8d3d-45a9-ade0-78e92aafdbbd LockResponse(lockid:13, state:ACQUIRED)
2024-04-23T21:11:04,435  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:11:04,435  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211104_c8ba7f75-8d3d-45a9-ade0-78e92aafdbbd): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2'
2024-04-23T21:11:04,435  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:11:04,435  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:11:04,435  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:11:04,435  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:11:04,435  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2
2024-04-23T21:11:04,445  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:11:04,450  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:04,450  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1}
2024-04-23T21:11:04,451  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211104_c8ba7f75-8d3d-45a9-ade0-78e92aafdbbd); Time taken: 0.015 seconds
2024-04-23T21:11:04,451  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211104_c8ba7f75-8d3d-45a9-ade0-78e92aafdbbd
2024-04-23T21:11:04,455  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:19
2024-04-23T21:11:04,460  INFO [main] txn.TxnHandler: Removed transactions: ([19]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:04,461  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:19
2024-04-23T21:11:04,461  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:11:04,462  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211104_29759bb4-84c7-42be-bc16-9e01e9a6f5d4): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:11:04,464  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([20]) with min_open_txn: 18
2024-04-23T21:11:04,465  INFO [main] lockmgr.DbTxnManager: Opened txnid:20
2024-04-23T21:11:04,465  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:11:04,473  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,482  INFO [main] txn.TxnHandler: Allocated writeId: 1 for txnId: 20
2024-04-23T21:11:04,483  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [20])
2024-04-23T21:11:04,485  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:04,485  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:04,485  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:04,485  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {allocateTableWriteId_(long, String, String)=8, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10, getTable_(GetTableRequest)=9, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:11:04,485  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211104_29759bb4-84c7-42be-bc16-9e01e9a6f5d4); Time taken: 0.024 seconds
2024-04-23T21:11:04,486  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:20 for queryId=alex_20240423211104_29759bb4-84c7-42be-bc16-9e01e9a6f5d4
2024-04-23T21:11:04,486  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211104_29759bb4-84c7-42be-bc16-9e01e9a6f5d4
2024-04-23T21:11:04,500  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211104_29759bb4-84c7-42be-bc16-9e01e9a6f5d4 LockResponse(lockid:14, state:ACQUIRED)
2024-04-23T21:11:04,500  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:11:04,504  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211104_29759bb4-84c7-42be-bc16-9e01e9a6f5d4): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data' PARTITION (p=1) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data' PARTITION (p=2)
2024-04-23T21:11:04,504  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:04,505  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:04,513  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,513  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:11:04,526  INFO [HMSHandler #0] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2
2024-04-23T21:11:04,526  INFO [HMSHandler #14] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:11:04,526  INFO [HMSHandler #2] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1
2024-04-23T21:11:04,556  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=0)
2024-04-23T21:11:04,556  INFO [main] exec.Task: Loading data to table default.t partition (p=0) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/1/data
2024-04-23T21:11:04,556  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:04,564  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,565  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:11:04,580  INFO [main] exec.MoveTask: Partition is: {p=0}
2024-04-23T21:11:04,580  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:11:04,580  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:04,589  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,589  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:11:04,598  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000
2024-04-23T21:11:04,602  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:11:04,602  INFO [main] metastore.HMSHandler: New partition values:[0]
2024-04-23T21:11:04,637  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:11:04,662  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:11:04,670  INFO [main] ql.Driver: Starting task [Stage-2:MOVE] in serial mode
Loading data to table default.t partition (p=1)
2024-04-23T21:11:04,671  INFO [main] exec.Task: Loading data to table default.t partition (p=1) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/2/data
2024-04-23T21:11:04,671  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:04,678  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,679  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:11:04,688  INFO [main] exec.MoveTask: Partition is: {p=1}
2024-04-23T21:11:04,688  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:11:04,689  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:04,697  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,697  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:11:04,706  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000
2024-04-23T21:11:04,710  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:11:04,710  INFO [main] metastore.HMSHandler: New partition values:[1]
2024-04-23T21:11:04,741  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:11:04,755  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[1]	
2024-04-23T21:11:04,764  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:04,764  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidWriteIds_(List, String)=0, getPartitionWithAuthInfo_(String, String, List, String, List)=59, validatePartitionNameCharacters_(List)=0, isCompatibleWith_(Configuration)=1, add_partitions_(List, boolean, boolean)=43, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=104, getTable_(GetTableRequest)=42}
2024-04-23T21:11:04,764  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211104_29759bb4-84c7-42be-bc16-9e01e9a6f5d4); Time taken: 0.26 seconds
2024-04-23T21:11:04,764  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211104_29759bb4-84c7-42be-bc16-9e01e9a6f5d4
2024-04-23T21:11:04,768  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:20
2024-04-23T21:11:04,774  INFO [main] txn.TxnHandler: Removed transactions: ([20]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:04,774  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:20
2024-04-23T21:11:04,775  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:04,776  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:04,779  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([21]) with min_open_txn: 18
2024-04-23T21:11:04,779  INFO [main] lockmgr.DbTxnManager: Opened txnid:21
2024-04-23T21:11:04,780  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:04,780  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:04,785  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:11:04,785  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:04,786  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:04,794  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,794  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:04,794  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:04,795  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:11:04,806  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:11:04,838  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:11:04,838  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:11:04,875  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:04,885  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:04,885  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:11:04,900  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:11:04,900  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:11:04,944  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:04,944  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:04,944  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:04,946  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-04_776_2581146528426310166-1/-mr-10001/.hive-staging_hive_2024-04-23_21-11-04_776_2581146528426310166-1
2024-04-23T21:11:04,953  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:11:04,955  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T21:11:04,956  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1], VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2]}
2024-04-23T21:11:04,956  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:11:04,957  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:11:04,965  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:11:04,966  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:11:04,966  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:11:04,966  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:04,966  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:04,966  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T21:11:04,967  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T21:11:04,967  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:04,968  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=1, commitTxn_(CommitTxnRequest)=10, getAllTableConstraints_(AllTableConstraintsRequest)=26, getTable_(GetTableRequest)=8, getValidTxns_(long)=1, flushCache_()=0, getAggrColStatsFor_(String, String, List, List, String, String)=25, getValidWriteIds_(List, String)=7, listPartitions_(String, String, short)=25, openTxn_(String, TxnType)=3}
2024-04-23T21:11:04,968  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd); Time taken: 0.191 seconds
2024-04-23T21:11:04,968  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:21 for queryId=alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd
2024-04-23T21:11:04,969  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd
2024-04-23T21:11:04,988  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd LockResponse(lockid:15, state:ACQUIRED)
2024-04-23T21:11:04,988  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:11:04,989  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:04,989  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. tez, spark) or using Hive 1.X releases.
Query ID = alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd
2024-04-23T21:11:04,989  INFO [main] ql.Driver: Query ID = alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd
Total jobs = 1
2024-04-23T21:11:04,989  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:11:04,989  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:11:05,121  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:11:05,122  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:11:05,122  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:11:05,122  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:11:05,122  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:11:05,122  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:11:05,122  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:11:05,122  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:11:05,124  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:11:05,124  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:11:05,124  INFO [main] exec.Utilities: Adding 3 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:11:05,131  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-04_776_2581146528426310166-1/-mr-10004/04053a07-8e9a-4100-96cd-ccd3343a6ee5 (false)
2024-04-23T21:11:05,140  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:11:05,141  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,90KB
2024-04-23T21:11:05,146  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:11:05,147  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T21:11:05,148  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:11:05,154  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:11:05,161  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:11:05,165  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:11:05,166  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:11:05,166  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:11:05,166  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:11:05,175  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:11:05,175  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:1:9223372036854775807:: isTransactionalTable: true txnProperties: insert_only 
2024-04-23T21:11:05,175  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:11:05,180  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 0/2
2024-04-23T21:11:05,180  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 2). duration: 5 ms
2024-04-23T21:11:05,180  INFO [main] io.HiveInputFormat: number of splits 2
2024-04-23T21:11:05,197  INFO [main] mapreduce.JobSubmitter: number of splits:2
2024-04-23T21:11:05,216  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local526771231_0016
2024-04-23T21:11:05,216  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:11:05,274  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:11:05,274  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:11:05,274  INFO [Thread-1446] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:11:05,274  INFO [Thread-1446] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:11:05,276  INFO [Thread-1446] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:11:05,276  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local526771231_0016_m_000000_0
2024-04-23T21:11:05,277  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:11:05,277  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:11:05,278  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:11:05,278  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-23T21:11:05,280  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:11:05,281  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:11:05,286  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:11:05,286  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:11:05,286  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:11:05,286  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:11:05,286  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:11:05,286  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:11:05,287  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:11:05,289  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:11:05,290  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:11:05,290  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:11:05,290  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T21:11:05,290  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:11:05,290  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:11:05,291  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:11:05,292  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:11:05,292  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:11:05,292  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:11:05,292  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:11:05,292  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T21:11:05,292  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:11:05,303  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:11:05,306  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local526771231_0016_m_000000_0 is done. And is in the process of committing
2024-04-23T21:11:05,306  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:11:05,306  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local526771231_0016_m_000000_0' done.
2024-04-23T21:11:05,306  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local526771231_0016_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=350387
		FILE: Number of bytes written=19033055
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1145569280
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7034
2024-04-23T21:11:05,306  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local526771231_0016_m_000000_0
2024-04-23T21:11:05,306  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local526771231_0016_m_000001_0
2024-04-23T21:11:05,307  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:11:05,307  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:11:05,308  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:11:05,308  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,90KB
2024-04-23T21:11:05,309  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:11:05,310  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:11:05,325  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:11:05,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:11:05,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:11:05,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:11:05,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:11:05,326  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:11:05,327  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:11:05,328  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:11:05,329  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:11:05,329  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:11:05,329  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T21:11:05,329  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:11:05,329  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:11:05,329  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_OUT_INTERMEDIATE:0, RECORDS_IN:2, DESERIALIZE_ERRORS:0, 
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:11:05,330  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:11:05,331  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:11:05,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:11:05,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:11:05,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T21:11:05,331  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:11:05,339  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:11:05,342  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local526771231_0016_m_000001_0 is done. And is in the process of committing
2024-04-23T21:11:05,343  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:11:05,343  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local526771231_0016_m_000001_0' done.
2024-04-23T21:11:05,343  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local526771231_0016_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=357976
		FILE: Number of bytes written=19033471
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=10
		Total committed heap usage (bytes)=1145569280
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7034
2024-04-23T21:11:05,343  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local526771231_0016_m_000001_0
2024-04-23T21:11:05,343  INFO [Thread-1446] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:11:05,344  INFO [Thread-1446] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:11:05,344  INFO [pool-82-thread-1] mapred.LocalJobRunner: Starting task: attempt_local526771231_0016_r_000000_0
2024-04-23T21:11:05,345  INFO [pool-82-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:11:05,345  INFO [pool-82-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@6110a65b
2024-04-23T21:11:05,345  WARN [pool-82-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:11:05,346  INFO [pool-82-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:11:05,346  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local526771231_0016_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:11:05,349  INFO [localfetcher#15] reduce.LocalFetcher: localfetcher#15 about to shuffle output of map attempt_local526771231_0016_m_000001_0 decomp: 380 len: 384 to MEMORY
2024-04-23T21:11:05,349  INFO [localfetcher#15] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local526771231_0016_m_000001_0
2024-04-23T21:11:05,349  INFO [localfetcher#15] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->380
2024-04-23T21:11:05,352  INFO [localfetcher#15] reduce.LocalFetcher: localfetcher#15 about to shuffle output of map attempt_local526771231_0016_m_000000_0 decomp: 380 len: 384 to MEMORY
2024-04-23T21:11:05,352  INFO [localfetcher#15] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local526771231_0016_m_000000_0
2024-04-23T21:11:05,352  INFO [localfetcher#15] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 2, commitMemory -> 380, usedMemory ->760
2024-04-23T21:11:05,352  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:11:05,353  INFO [pool-82-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:11:05,353  INFO [pool-82-thread-1] reduce.MergeManagerImpl: finalMerge called with 2 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:11:05,359  INFO [pool-82-thread-1] mapred.Merger: Merging 2 sorted segments
2024-04-23T21:11:05,359  INFO [pool-82-thread-1] mapred.Merger: Down to the last merge-pass, with 2 segments left of total size: 714 bytes
2024-04-23T21:11:05,362  INFO [pool-82-thread-1] reduce.MergeManagerImpl: Merged 2 segments, 760 bytes to disk to satisfy reduce memory limit
2024-04-23T21:11:05,362  INFO [pool-82-thread-1] reduce.MergeManagerImpl: Merging 1 files, 762 bytes from disk
2024-04-23T21:11:05,362  INFO [pool-82-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:11:05,362  INFO [pool-82-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:11:05,362  INFO [pool-82-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 735 bytes
2024-04-23T21:11:05,362  INFO [pool-82-thread-1] mapred.LocalJobRunner: 2 / 2 copied.
2024-04-23T21:11:05,363  INFO [pool-82-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:11:05,364  INFO [pool-82-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T21:11:05,365  INFO [pool-82-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:11:05,365  INFO [pool-82-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:11:05,365  INFO [pool-82-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<_col0:string>>
2024-04-23T21:11:05,365  INFO [pool-82-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:11:05,366  INFO [pool-82-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@4a8b0b11, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@47a2d9a9>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@4194abd5, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@76241249
2024-04-23T21:11:05,366  INFO [pool-82-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-04_776_2581146528426310166-1/-mr-10001/.hive-staging_hive_2024-04-23_21-11-04_776_2581146528426310166-1/_tmp.-ext-10002/000000_0
2024-04-23T21:11:05,366  INFO [pool-82-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-04_776_2581146528426310166-1/-mr-10001/.hive-staging_hive_2024-04-23_21-11-04_776_2581146528426310166-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:11:05,366  INFO [pool-82-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-04_776_2581146528426310166-1/-mr-10001/.hive-staging_hive_2024-04-23_21-11-04_776_2581146528426310166-1/_tmp.-ext-10002/000000_0
2024-04-23T21:11:05,373  INFO [pool-82-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:11:05,374  INFO [pool-82-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:11:05,374  INFO [pool-82-thread-1] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_3:4, 
2024-04-23T21:11:05,374  INFO [pool-82-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:11:05,374  INFO [pool-82-thread-1] exec.FileSinkOperator: FS[4]: records written - 4
2024-04-23T21:11:05,374  INFO [pool-82-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:4, RECORDS_OUT_OPERATOR_FS_4:4, 
2024-04-23T21:11:05,375  INFO [pool-82-thread-1] mapred.Task: Task:attempt_local526771231_0016_r_000000_0 is done. And is in the process of committing
2024-04-23T21:11:05,375  INFO [pool-82-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:11:05,375  INFO [pool-82-thread-1] mapred.Task: Task 'attempt_local526771231_0016_r_000000_0' done.
2024-04-23T21:11:05,375  INFO [pool-82-thread-1] mapred.Task: Final Counters for attempt_local526771231_0016_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=365519
		FILE: Number of bytes written=19035052
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=4
		Reduce shuffle bytes=768
		Reduce input records=4
		Reduce output records=0
		Spilled Records=4
		Shuffled Maps =2
		Failed Shuffles=0
		Merged Map outputs=2
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1145569280
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=4
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=4
		RECORDS_OUT_OPERATOR_SEL_3=4
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:11:05,375  INFO [pool-82-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local526771231_0016_r_000000_0
2024-04-23T21:11:05,375  INFO [Thread-1446] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:11:06,277 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:11:06,277  INFO [main] exec.Task: 2024-04-23 21:11:06,277 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local526771231_0016
2024-04-23T21:11:06,280  INFO [main] exec.Task: Ended Job = job_local526771231_0016
2024-04-23T21:11:06,282  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:06,282  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:11:06,282  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:11:06,282  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:11:06,282  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:11:06,282  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd); Time taken: 1.293 seconds
2024-04-23T21:11:06,282  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211104_aee96b37-3cfe-4703-8755-4ac190a241dd
2024-04-23T21:11:06,286  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:21
2024-04-23T21:11:06,292  INFO [main] txn.TxnHandler: Removed transactions: ([21]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:06,293  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:21
2024-04-23T21:11:06,297  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:11:06,297  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T21:11:06,298  INFO [main] exec.ListSinkOperator: RECORDS_OUT_OPERATOR_LIST_SINK_5:4, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:11:06,298  WARN [main] ql.TestTxnAddPartition: addPartitionMM: read data(add 2 parts w/data and 1 empty): 
2024-04-23T21:11:06,298  INFO [main] ql.TestTxnAddPartition: 0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0

2024-04-23T21:11:06,298  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:06,298  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-04_776_2581146528426310166-1
2024-04-23T21:11:06,299  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-04_776_2581146528426310166-1 on fs with scheme file
2024-04-23T21:11:06,299  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211106_b4ffa731-b720-4a1b-8e3f-5bbcc9b5a3a7): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:06,303  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([22]) with min_open_txn: 22
2024-04-23T21:11:06,303  INFO [main] lockmgr.DbTxnManager: Opened txnid:22
2024-04-23T21:11:06,304  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:06,307  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:11:06,307  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:06,308  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:06,317  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,317  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:06,317  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:06,317  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:11:06,330  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:11:06,341  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:11:06,343  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:11:06,366  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:06,377  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,377  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:11:06,389  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:11:06,389  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:11:06,435  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:06,435  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:06,435  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:06,437  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:11:06,441  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {VALUE._col0=Column[_col3], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:11:06,441  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey0=Column[_col0], VALUE._col0=Column[_col3], KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:11:06,442  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:11:06,459  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:11:06,469  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:11:06,470  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:11:06,470  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:11:06,471  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:06,471  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T21:11:06,471  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:06,471  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, listPartitions_(String, String, short)=12, getTable_(GetTableRequest)=9, commitTxn_(CommitTxnRequest)=10, getAggrColStatsFor_(String, String, List, List, String, String)=23, getValidTxns_(long)=1, flushCache_()=0, getValidWriteIds_(List, String)=5, isCompatibleWith_(Configuration)=1, getAllTableConstraints_(AllTableConstraintsRequest)=4}
2024-04-23T21:11:06,471  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211106_b4ffa731-b720-4a1b-8e3f-5bbcc9b5a3a7); Time taken: 0.172 seconds
2024-04-23T21:11:06,471  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211106_b4ffa731-b720-4a1b-8e3f-5bbcc9b5a3a7): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:06,472  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T21:11:06,481  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:06,481  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:11:06,481  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211106_b4ffa731-b720-4a1b-8e3f-5bbcc9b5a3a7); Time taken: 0.01 seconds
2024-04-23T21:11:06,482  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:11:06,488  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:22
2024-04-23T21:11:06,495  INFO [main] txn.TxnHandler: Removed transactions: ([22]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:06,496  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:22
2024-04-23T21:11:06,496  INFO [main] ql.TxnCommandsBaseForTests: Running the query: export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:11:06,497  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-06_299_7989174913869355675-1
2024-04-23T21:11:06,497  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-06_299_7989174913869355675-1 on fs with scheme file
2024-04-23T21:11:06,497  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211106_ab48c4c6-0c9e-4f64-bbb4-c8d4355b4380): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:11:06,498  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:06,507  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,510  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([23]) with min_open_txn: 22
2024-04-23T21:11:06,510  INFO [main] lockmgr.DbTxnManager: Opened txnid:23
2024-04-23T21:11:06,513  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.Tstage	
2024-04-23T21:11:06,522  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,522  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:11:06,522  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:11:06,523  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:11:06,523  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:11:06,523  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:06,523  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:06,523  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:06,523  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=18, flushCache_()=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, isCompatibleWith_(Configuration)=1, getCurrentNotificationEventId_()=2, commitTxn_(CommitTxnRequest)=14}
2024-04-23T21:11:06,523  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211106_ab48c4c6-0c9e-4f64-bbb4-c8d4355b4380); Time taken: 0.026 seconds
2024-04-23T21:11:06,524  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:23 for queryId=alex_20240423211106_ab48c4c6-0c9e-4f64-bbb4-c8d4355b4380
2024-04-23T21:11:06,524  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211106_ab48c4c6-0c9e-4f64-bbb4-c8d4355b4380
2024-04-23T21:11:06,540  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211106_ab48c4c6-0c9e-4f64-bbb4-c8d4355b4380 LockResponse(lockid:16, state:ACQUIRED)
2024-04-23T21:11:06,540  INFO [main] ql.Driver: Operation EXPORT obtained 1 locks
2024-04-23T21:11:06,540  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211106_ab48c4c6-0c9e-4f64-bbb4-c8d4355b4380): export table Tstage to '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3'
2024-04-23T21:11:06,540  INFO [main] ql.Driver: Starting task [Stage-0:REPL_DUMP] in serial mode
2024-04-23T21:11:06,540  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:11:06,540  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:11:06,540  INFO [main] parse.EximUtil: Path before norm :/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:11:06,540  INFO [main] parse.EximUtil: Scheme:file, authority:null, path:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3
2024-04-23T21:11:06,551  WARN [main] shims.Utils: XAttr won't be preserved since it is not supported for file system: file:///
2024-04-23T21:11:06,557  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:06,557  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0}
2024-04-23T21:11:06,557  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211106_ab48c4c6-0c9e-4f64-bbb4-c8d4355b4380); Time taken: 0.017 seconds
2024-04-23T21:11:06,557  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211106_ab48c4c6-0c9e-4f64-bbb4-c8d4355b4380
2024-04-23T21:11:06,562  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:23
2024-04-23T21:11:06,569  INFO [main] txn.TxnHandler: Removed transactions: ([23]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:06,569  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:23
2024-04-23T21:11:06,570  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211106_2b13b4d0-2b79-4842-b955-e0d84247c8b5): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:11:06,572  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([24]) with min_open_txn: 22
2024-04-23T21:11:06,573  INFO [main] lockmgr.DbTxnManager: Opened txnid:24
2024-04-23T21:11:06,574  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:11:06,583  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,595  INFO [main] txn.TxnHandler: Allocated writeId: 2 for txnId: 24
2024-04-23T21:11:06,595  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [24])
2024-04-23T21:11:06,596  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:06,596  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:06,596  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:06,596  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=12, allocateTableWriteId_(long, String, String)=11, getTable_(GetTableRequest)=10, openTxn_(String, TxnType)=3, isCompatibleWith_(Configuration)=0, flushCache_()=0, getValidTxns_(long)=1}
2024-04-23T21:11:06,596  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211106_2b13b4d0-2b79-4842-b955-e0d84247c8b5); Time taken: 0.026 seconds
2024-04-23T21:11:06,597  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:24 for queryId=alex_20240423211106_2b13b4d0-2b79-4842-b955-e0d84247c8b5
2024-04-23T21:11:06,597  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211106_2b13b4d0-2b79-4842-b955-e0d84247c8b5
2024-04-23T21:11:06,614  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211106_2b13b4d0-2b79-4842-b955-e0d84247c8b5 LockResponse(lockid:17, state:ACQUIRED)
2024-04-23T21:11:06,614  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:11:06,619  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211106_2b13b4d0-2b79-4842-b955-e0d84247c8b5): ALTER TABLE T ADD PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:11:06,619  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:06,619  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:06,628  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,628  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:11:06,818 ERROR [main] metastore.RetryingHMSHandler: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616)
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182)
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147)
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108)
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source)
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972)
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218)
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source)
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147)
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62)
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105)
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361)
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334)
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245)
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140)
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192)
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258)
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193)
	at java.util.Iterator.forEachRemaining(Iterator.java:116)
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801)
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482)
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472)
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150)
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173)
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451)

2024-04-23T21:11:06,818 ERROR [main] metadata.Hive: Failed addPartitions
org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
2024-04-23T21:11:06,819 ERROR [main] exec.Task: Failed
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
2024-04-23T21:11:06,819 ERROR [main] exec.Task: DDLTask failed, DDL Operation: class org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation
org.apache.hadoop.hive.ql.metadata.HiveException: AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3451) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitionsNoReplication(AlterTableAddPartitionOperation.java:161) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.addPartitions(AlterTableAddPartitionOperation.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.table.partition.add.AlterTableAddPartitionOperation.execute(AlterTableAddPartitionOperation.java:62) ~[classes/:?]
	at org.apache.hadoop.hive.ql.ddl.DDLTask.execute(DDLTask.java:84) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:212) ~[classes/:?]
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:105) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTask(Executor.java:361) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.launchTasks(Executor.java:334) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.runTasks(Executor.java:245) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Executor.execute(Executor.java:108) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:348) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:204) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:153) ~[classes/:?]
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:140) ~[classes/:?]
	at org.apache.hadoop.hive.ql.TxnCommandsBaseForTests.runStatementOnDriverNegative(TxnCommandsBaseForTests.java:256) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:192) ~[test-classes/:?]
	at org.apache.hadoop.hive.ql.TestTxnAddPartition.addPartitionMM(TestTxnAddPartition.java:146) ~[test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12) ~[junit-4.13.jar:4.13]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26) ~[junit-4.13.jar:4.13]
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExpectedException$ExpectedExceptionStatement.evaluate(ExpectedException.java:258) ~[junit-4.13.jar:4.13]
	at org.junit.rules.ExternalResource$1.evaluate(ExternalResource.java:54) ~[junit-4.13.jar:4.13]
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103) ~[junit-4.13.jar:4.13]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306) ~[junit-4.13.jar:4.13]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137) ~[junit-4.13.jar:4.13]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115) ~[junit-4.13.jar:4.13]
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:43) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:193) ~[?:1.8.0_402]
	at java.util.Iterator.forEachRemaining(Iterator.java:116) ~[?:1.8.0_402]
	at java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:482) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:472) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:1.8.0_402]
	at java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:1.8.0_402]
	at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:1.8.0_402]
	at java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:485) ~[?:1.8.0_402]
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:82) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:73) ~[junit-vintage-engine-5.6.2.jar:5.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:248) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$5(DefaultLauncher.java:211) ~[junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:226) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:199) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:132) [junit-platform-launcher-1.6.2.jar:1.6.2]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:154) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:123) [surefire-junit-platform-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:377) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:138) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:465) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:451) [surefire-booter-3.0.0-M4.jar:3.0.0-M4]
Caused by: org.apache.hadoop.hive.metastore.api.AlreadyExistsException: Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2)
	at org.apache.hadoop.hive.metastore.HMSHandler.startAddPartition(HMSHandler.java:4616) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.validatePartition(HMSHandler.java:4337) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_core(HMSHandler.java:4182) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.HMSHandler.add_partitions_req(HMSHandler.java:4455) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invokeInternal(RetryingHMSHandler.java:147) ~[classes/:?]
	at org.apache.hadoop.hive.metastore.RetryingHMSHandler.invoke(RetryingHMSHandler.java:108) ~[classes/:?]
	at com.sun.proxy.$Proxy40.add_partitions_req(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.add_partitions(HiveMetaStoreClient.java:972) ~[classes/:?]
	at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.add_partitions(SessionHiveMetaStoreClient.java:1090) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_402]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_402]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_402]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_402]
	at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.invoke(RetryingMetaStoreClient.java:218) ~[classes/:?]
	at com.sun.proxy.$Proxy41.add_partitions(Unknown Source) ~[?:?]
	at org.apache.hadoop.hive.ql.metadata.Hive.addPartitions(Hive.java:3448) ~[classes/:?]
	... 68 more
FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T21:11:06,821 ERROR [main] ql.Driver: FAILED: Execution Error, return code 40000 from org.apache.hadoop.hive.ql.ddl.DDLTask. AlreadyExistsException(message:Partition already exists: Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:2))
2024-04-23T21:11:06,821  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:06,821  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T21:11:06,821  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211106_2b13b4d0-2b79-4842-b955-e0d84247c8b5); Time taken: 0.202 seconds
2024-04-23T21:11:06,821  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211106_2b13b4d0-2b79-4842-b955-e0d84247c8b5
2024-04-23T21:11:06,824  INFO [main] txn.TxnHandler: Removed transactions: ([24]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:06,831  INFO [main] ql.TxnCommandsBaseForTests: Running the query: ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:11:06,831  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211106_71b44cb4-034d-4a68-8a26-7524337f750a): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:11:06,834  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([25]) with min_open_txn: 22
2024-04-23T21:11:06,834  INFO [main] lockmgr.DbTxnManager: Opened txnid:25
2024-04-23T21:11:06,835  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.T	
2024-04-23T21:11:06,846  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,848  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[0]	
2024-04-23T21:11:06,860  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[2]	
2024-04-23T21:11:06,871  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:11:06,881  INFO [main] txn.TxnHandler: Allocated writeId: 3 for txnId: 25
2024-04-23T21:11:06,881  INFO [main] txn.TxnHandler: Allocated write ids for dbName=default, tblName=t (txnIds: [25])
2024-04-23T21:11:06,882  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:06,882  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:06,882  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:06,882  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, rollbackTxn_(long)=10, allocateTableWriteId_(long, String, String)=6, flushCache_()=0, getTable_(GetTableRequest)=11, getPartitionWithAuthInfo_(String, String, List, String, List)=20}
2024-04-23T21:11:06,883  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211106_71b44cb4-034d-4a68-8a26-7524337f750a); Time taken: 0.051 seconds
2024-04-23T21:11:06,883  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:25 for queryId=alex_20240423211106_71b44cb4-034d-4a68-8a26-7524337f750a
2024-04-23T21:11:06,883  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211106_71b44cb4-034d-4a68-8a26-7524337f750a
2024-04-23T21:11:06,897  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211106_71b44cb4-034d-4a68-8a26-7524337f750a LockResponse(lockid:18, state:ACQUIRED)
2024-04-23T21:11:06,897  INFO [main] ql.Driver: Operation ALTERTABLE_ADDPARTS obtained 1 locks
2024-04-23T21:11:06,904  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211106_71b44cb4-034d-4a68-8a26-7524337f750a): ALTER TABLE T ADD IF NOT EXISTS PARTITION (p=0) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data' PARTITION (p=2) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'PARTITION (p=3) location '/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data'
2024-04-23T21:11:06,905  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:06,905  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:06,915  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,915  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=add_partitions	
2024-04-23T21:11:06,925  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[0], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T21:11:06,927  INFO [main] metastore.HMSHandler: Not adding partition Partition(values:[2], dbName:default, tableName:t, createTime:0, lastAccessTime:0, sd:StorageDescriptor(cols:[FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null)], location:file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), parameters:null, catName:hive, writeId:3) as it already exists
2024-04-23T21:11:06,928  INFO [HMSHandler #1] utils.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3
2024-04-23T21:11:06,951  INFO [main] ql.Driver: Starting task [Stage-1:MOVE] in serial mode
Loading data to table default.t partition (p=3)
2024-04-23T21:11:06,952  INFO [main] exec.Task: Loading data to table default.t partition (p=3) from /home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/3/data
2024-04-23T21:11:06,952  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:06,961  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,962  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:11:06,974  INFO [main] exec.MoveTask: Partition is: {p=3}
2024-04-23T21:11:06,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=partition_name_has_valid_characters	
2024-04-23T21:11:06,974  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:06,983  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:06,983  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:11:06,993  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000
2024-04-23T21:11:06,997  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=alter_partitions : tbl=hive.default.t	
2024-04-23T21:11:06,997  INFO [main] metastore.HMSHandler: New partition values:[3]
2024-04-23T21:11:07,035  WARN [main] utils.MetaStoreServerUtils: Not updating fast stats for a transactional table t
2024-04-23T21:11:07,060  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partition_with_auth : tbl=hive.default.t[3]	
2024-04-23T21:11:07,069  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:07,070  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=28, isCompatibleWith_(Configuration)=0, add_partitions_(List, boolean, boolean)=36, alter_partition_(String, String, String, Partition, EnvironmentContext, String)=63, getPartitionWithAuthInfo_(String, String, List, String, List)=29, validatePartitionNameCharacters_(List)=0, getValidWriteIds_(List, String)=1}
2024-04-23T21:11:07,070  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211106_71b44cb4-034d-4a68-8a26-7524337f750a); Time taken: 0.165 seconds
2024-04-23T21:11:07,070  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211106_71b44cb4-034d-4a68-8a26-7524337f750a
2024-04-23T21:11:07,073  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:25
2024-04-23T21:11:07,078  INFO [main] txn.TxnHandler: Removed transactions: ([25]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:07,078  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:25
2024-04-23T21:11:07,079  INFO [main] ql.TxnCommandsBaseForTests: Running the query: select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:07,079  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:07,082  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([26]) with min_open_txn: 22
2024-04-23T21:11:07,083  INFO [main] lockmgr.DbTxnManager: Opened txnid:26
2024-04-23T21:11:07,083  INFO [main] parse.CalcitePlanner: Starting caching scope for: 
2024-04-23T21:11:07,083  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:07,088  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:11:07,088  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:07,088  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:07,096  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:07,097  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:07,097  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:07,097  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:11:07,109  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:11:07,138  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:11:07,139  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:11:07,182  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:07,193  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:07,193  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:11:07,210  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: a, b
No Stats for default@t, Columns: a, b
2024-04-23T21:11:07,210  INFO [main] SessionState: No Stats for default@t, Columns: a, b
2024-04-23T21:11:07,252  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:07,252  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:07,252  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:07,253  INFO [main] common.FileUtils: Creating directory if it doesn't exist: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-07_079_3509055903702485531-1/-mr-10001/.hive-staging_hive_2024-04-23_21-11-07_079_3509055903702485531-1
2024-04-23T21:11:07,261  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:11:07,263  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey2=Column[_col2], VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:11:07,264  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], KEY.reducesinkkey1=Column[_col1], VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:11:07,265  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:11:07,265  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:11:07,274  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:11:07,275  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:11:07,275  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:11:07,275  INFO [main] parse.CalcitePlanner: Ending caching scope for: 
2024-04-23T21:11:07,275  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:07,275  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:p, type:int, comment:null), FieldSchema(name:a, type:int, comment:null), FieldSchema(name:b, type:int, comment:null), FieldSchema(name:input__file__name, type:string, comment:null)], properties:null)
2024-04-23T21:11:07,276  INFO [main] exec.ListSinkOperator: Initializing Operator: LIST_SINK[5]
2024-04-23T21:11:07,276  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:07,276  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {openTxn_(String, TxnType)=3, listPartitions_(String, String, short)=25, getAggrColStatsFor_(String, String, List, List, String, String)=27, getValidTxns_(long)=0, getAllTableConstraints_(AllTableConstraintsRequest)=23, getValidWriteIds_(List, String)=6, flushCache_()=0, getTable_(GetTableRequest)=9, isCompatibleWith_(Configuration)=0, commitTxn_(CommitTxnRequest)=9}
2024-04-23T21:11:07,277  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d); Time taken: 0.197 seconds
2024-04-23T21:11:07,277  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:26 for queryId=alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d
2024-04-23T21:11:07,278  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d
2024-04-23T21:11:07,294  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d LockResponse(lockid:19, state:ACQUIRED)
2024-04-23T21:11:07,294  INFO [main] ql.Driver: Operation QUERY obtained 1 locks
2024-04-23T21:11:07,295  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d): select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:07,295  WARN [main] ql.Driver: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d
2024-04-23T21:11:07,295  INFO [main] ql.Driver: Query ID = alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d
Total jobs = 1
2024-04-23T21:11:07,295  INFO [main] ql.Driver: Total jobs = 1
Launching Job 1 out of 1
2024-04-23T21:11:07,295  INFO [main] ql.Driver: Launching Job 1 out of 1
2024-04-23T21:11:07,426  INFO [main] ql.Driver: Starting task [Stage-1:MAPRED] in serial mode
Number of reduce tasks determined at compile time: 1
2024-04-23T21:11:07,426  INFO [main] exec.Task: Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
2024-04-23T21:11:07,426  INFO [main] exec.Task: In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
2024-04-23T21:11:07,426  INFO [main] exec.Task:   set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
2024-04-23T21:11:07,426  INFO [main] exec.Task: In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
2024-04-23T21:11:07,426  INFO [main] exec.Task:   set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
2024-04-23T21:11:07,426  INFO [main] exec.Task: In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
2024-04-23T21:11:07,426  INFO [main] exec.Task:   set mapreduce.job.reduces=<number>
2024-04-23T21:11:07,428  INFO [main] mr.ExecDriver: Using org.apache.hadoop.hive.ql.io.HiveInputFormat
2024-04-23T21:11:07,429  INFO [main] exec.Utilities: Processing alias t
2024-04-23T21:11:07,429  INFO [main] exec.Utilities: Adding 4 inputs; the first input is file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:11:07,436  INFO [main] exec.Utilities: Changed input file file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=2 to empty file file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-07_079_3509055903702485531-1/-mr-10004/528eeb58-a537-4cfd-8c47-598199719803 (false)
2024-04-23T21:11:07,445  INFO [main] exec.SerializationUtilities: Serializing MapWork using kryo
2024-04-23T21:11:07,446  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 6,25KB
2024-04-23T21:11:07,451  INFO [main] exec.SerializationUtilities: Serializing ReduceWork using kryo
2024-04-23T21:11:07,452  INFO [main] exec.Utilities: Serialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T21:11:07,452  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:11:07,458  WARN [main] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:11:07,465  WARN [main] mapreduce.JobResourceUploader: Hadoop command-line option parsing not performed. Implement the Tool interface and execute your application with ToolRunner to remedy this.
2024-04-23T21:11:07,469  WARN [main] mapreduce.JobResourceUploader: No job jar file set.  User classes may not be found. See Job or Job#setJar(String).
2024-04-23T21:11:07,471  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.ids = 0,1
2024-04-23T21:11:07,471  INFO [main] io.HiveInputFormat: hive.io.file.readcolumn.names = a,b
2024-04-23T21:11:07,471  INFO [main] io.HiveInputFormat: Generating splits for dirs: file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0
2024-04-23T21:11:07,480  INFO [main] orc.OrcInputFormat: getSplits started
2024-04-23T21:11:07,480  INFO [main] orc.OrcInputFormat: Context:: isAcid: false isVectorMode: false sarg: null minSplitSize: 1 maxSplitSize: 256000000 splitStrategy: HYBRID footerInSplits: false numBuckets: 0 numThreads: 10 cacheMemSize: 268435456 cacheStripeDetails: true useSoftReference: false writeIdList: default.t:3:9223372036854775807::2 isTransactionalTable: true txnProperties: insert_only 
2024-04-23T21:11:07,481  INFO [main] orc.OrcInputFormat: ORC pushdown predicate: null
2024-04-23T21:11:07,487  INFO [main] orc.OrcInputFormat: FooterCacheHitRatio: 2/3
2024-04-23T21:11:07,487  INFO [main] orc.OrcInputFormat: getSplits finished (#splits: 3). duration: 7 ms
2024-04-23T21:11:07,487  INFO [main] io.HiveInputFormat: number of splits 3
2024-04-23T21:11:07,505  INFO [main] mapreduce.JobSubmitter: number of splits:3
2024-04-23T21:11:07,524  INFO [main] mapreduce.JobSubmitter: Submitting tokens for job: job_local582874617_0017
2024-04-23T21:11:07,524  INFO [main] mapreduce.JobSubmitter: Executing with tokens: []
2024-04-23T21:11:07,586  INFO [main] mapreduce.Job: The url to track the job: http://localhost:8080/
Job running in-process (local Hadoop)
2024-04-23T21:11:07,586  INFO [main] exec.Task: Job running in-process (local Hadoop)
2024-04-23T21:11:07,586  INFO [Thread-1540] mapred.LocalJobRunner: OutputCommitter set in config org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:11:07,586  INFO [Thread-1540] mapred.LocalJobRunner: OutputCommitter is org.apache.hadoop.hive.ql.io.HiveFileFormatUtils$NullOutputCommitter
2024-04-23T21:11:07,588  INFO [Thread-1540] mapred.LocalJobRunner: Waiting for map tasks
2024-04-23T21:11:07,589  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local582874617_0017_m_000000_0
2024-04-23T21:11:07,589  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:11:07,590  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:11:07,590  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:11:07,591  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-23T21:11:07,593  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:11:07,593  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:11:07,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:11:07,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:11:07,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:11:07,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:11:07,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:11:07,598  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:11:07,599  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:11:07,600  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:11:07,601  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:11:07,601  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:11:07,601  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T21:11:07,601  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:11:07,601  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:11:07,601  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_OUT_OPERATOR_MAP_0:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, 
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:11:07,602  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-23T21:11:07,603  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:11:07,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:11:07,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:11:07,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T21:11:07,603  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:11:07,613  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:11:07,616  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local582874617_0017_m_000000_0 is done. And is in the process of committing
2024-04-23T21:11:07,617  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:11:07,617  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local582874617_0017_m_000000_0' done.
2024-04-23T21:11:07,617  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local582874617_0017_m_000000_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=380655
		FILE: Number of bytes written=20224531
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1250426880
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-23T21:11:07,617  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local582874617_0017_m_000000_0
2024-04-23T21:11:07,617  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local582874617_0017_m_000001_0
2024-04-23T21:11:07,618  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:11:07,618  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:11:07,619  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:11:07,619  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-23T21:11:07,621  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:11:07,622  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:11:07,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:11:07,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:11:07,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:11:07,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:11:07,627  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:11:07,628  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:11:07,628  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:11:07,630  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:11:07,630  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:11:07,630  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:11:07,631  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T21:11:07,631  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:11:07,631  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:11:07,631  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:11:07,631  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:11:07,631  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, DESERIALIZE_ERRORS:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_OPERATOR_TS_0:2, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:11:07,632  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_OPERATOR_RS_2:2, RECORDS_OUT_INTERMEDIATE:2, 
2024-04-23T21:11:07,633  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:11:07,633  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:11:07,633  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:11:07,633  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T21:11:07,633  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:11:07,641  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:11:07,644  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local582874617_0017_m_000001_0 is done. And is in the process of committing
2024-04-23T21:11:07,645  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:11:07,645  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local582874617_0017_m_000001_0' done.
2024-04-23T21:11:07,645  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local582874617_0017_m_000001_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=389126
		FILE: Number of bytes written=20224947
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1250426880
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-23T21:11:07,645  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local582874617_0017_m_000001_0
2024-04-23T21:11:07,645  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Starting task: attempt_local582874617_0017_m_000002_0
2024-04-23T21:11:07,646  INFO [LocalJobRunner Map Task Executor #0] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:11:07,646  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Processing split: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat:OrcSplit [file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0, start=3, length=110, isOriginal=true, fileLength=254, hasFooter=false, hasBase=true, deltas=0]
2024-04-23T21:11:07,647  INFO [LocalJobRunner Map Task Executor #0] exec.SerializationUtilities: Deserializing MapWork using kryo
2024-04-23T21:11:07,647  INFO [LocalJobRunner Map Task Executor #0] exec.Utilities: Deserialized plan (via FILE) - name: null size: 6,25KB
2024-04-23T21:11:07,648  INFO [LocalJobRunner Map Task Executor #0] orc.ReaderImpl: Reading ORC rows from file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0 with {include: [true, true, true], offset: 3, length: 110, schema: struct<a:int,b:int>, includeAcidColumns: true}
2024-04-23T21:11:07,649  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: numReduceTasks: 1
2024-04-23T21:11:07,653  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: (EQUATOR) 0 kvi 26214396(104857584)
2024-04-23T21:11:07,653  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: mapreduce.task.io.sort.mb: 100
2024-04-23T21:11:07,653  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: soft limit at 83886080
2024-04-23T21:11:07,653  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufvoid = 104857600
2024-04-23T21:11:07,653  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396; length = 6553600
2024-04-23T21:11:07,654  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Map output collector class = org.apache.hadoop.mapred.MapTask$MapOutputBuffer
2024-04-23T21:11:07,654  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Initializing Operator: MAP[0]
2024-04-23T21:11:07,656  INFO [LocalJobRunner Map Task Executor #0] mr.ExecMapper: 
<MAP>Id =0
  <Children>null
  <\Children>
  <Parent><\Parent>
<\MAP>
2024-04-23T21:11:07,657  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Initializing Operator: TS[0]
2024-04-23T21:11:07,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Initializing Operator: SEL[1]
2024-04-23T21:11:07,657  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: SELECT struct<a:int,b:int,p:int,input__file__name:string>
2024-04-23T21:11:07,657  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Initializing Operator: RS[2]
2024-04-23T21:11:07,657  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Using tag = -1
2024-04-23T21:11:07,657  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: keys are [reducesinkkey0, reducesinkkey1, reducesinkkey2] num distributions: 3
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: records written - 1
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: records read - 1
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: Closing Operator: MAP[0]
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: MAP[0]: Total records read - 2. abort - false
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.MapOperator: DESERIALIZE_ERRORS:0, RECORDS_IN:2, RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_MAP_0:0, 
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: Closing Operator: TS[0]
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.TableScanOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_TS_0:2, 
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: Closing Operator: SEL[1]
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.SelectOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_SEL_1:2, 
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: Closing Operator: RS[2]
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RS[2]: Total records written - 2. abort - false
2024-04-23T21:11:07,658  INFO [LocalJobRunner Map Task Executor #0] exec.ReduceSinkOperator: RECORDS_OUT_INTERMEDIATE:2, RECORDS_OUT_OPERATOR_RS_2:2, 
2024-04-23T21:11:07,659  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: 
2024-04-23T21:11:07,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Starting flush of map output
2024-04-23T21:11:07,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Spilling map output
2024-04-23T21:11:07,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: bufstart = 0; bufend = 372; bufvoid = 104857600
2024-04-23T21:11:07,659  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: kvstart = 26214396(104857584); kvend = 26214392(104857568); length = 5/6553600
2024-04-23T21:11:07,667  INFO [LocalJobRunner Map Task Executor #0] mapred.MapTask: Finished spill 0
2024-04-23T21:11:07,670  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task:attempt_local582874617_0017_m_000002_0 is done. And is in the process of committing
2024-04-23T21:11:07,671  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: map
2024-04-23T21:11:07,671  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Task 'attempt_local582874617_0017_m_000002_0' done.
2024-04-23T21:11:07,671  INFO [LocalJobRunner Map Task Executor #0] mapred.Task: Final Counters for attempt_local582874617_0017_m_000002_0: Counters: 24
	File System Counters
		FILE: Number of bytes read=397085
		FILE: Number of bytes written=20225363
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Map input records=2
		Map output records=2
		Map output bytes=372
		Map output materialized bytes=384
		Input split bytes=520
		Combine input records=0
		Spilled Records=2
		Failed Shuffles=0
		Merged Map outputs=0
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1250426880
	HIVE
		DESERIALIZE_ERRORS=0
		RECORDS_IN=2
		RECORDS_OUT_INTERMEDIATE=2
		RECORDS_OUT_OPERATOR_MAP_0=0
		RECORDS_OUT_OPERATOR_RS_2=2
		RECORDS_OUT_OPERATOR_SEL_1=2
		RECORDS_OUT_OPERATOR_TS_0=2
	File Input Format Counters 
		Bytes Read=7392
2024-04-23T21:11:07,671  INFO [LocalJobRunner Map Task Executor #0] mapred.LocalJobRunner: Finishing task: attempt_local582874617_0017_m_000002_0
2024-04-23T21:11:07,671  INFO [Thread-1540] mapred.LocalJobRunner: map task executor complete.
2024-04-23T21:11:07,672  INFO [Thread-1540] mapred.LocalJobRunner: Waiting for reduce tasks
2024-04-23T21:11:07,672  INFO [pool-87-thread-1] mapred.LocalJobRunner: Starting task: attempt_local582874617_0017_r_000000_0
2024-04-23T21:11:07,673  INFO [pool-87-thread-1] mapred.Task:  Using ResourceCalculatorProcessTree : [ ]
2024-04-23T21:11:07,673  INFO [pool-87-thread-1] mapred.ReduceTask: Using ShuffleConsumerPlugin: org.apache.hadoop.mapreduce.task.reduce.Shuffle@75e525f9
2024-04-23T21:11:07,673  WARN [pool-87-thread-1] impl.MetricsSystemImpl: JobTracker metrics system already initialized!
2024-04-23T21:11:07,674  INFO [pool-87-thread-1] reduce.MergeManagerImpl: MergerManager: memoryLimit=1336252800, maxSingleShuffleLimit=334063200, mergeThreshold=881926912, ioSortFactor=10, memToMemMergeOutputsThreshold=10
2024-04-23T21:11:07,675  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: attempt_local582874617_0017_r_000000_0 Thread started: EventFetcher for fetching Map Completion Events
2024-04-23T21:11:07,677  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local582874617_0017_m_000001_0 decomp: 380 len: 384 to MEMORY
2024-04-23T21:11:07,678  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local582874617_0017_m_000001_0
2024-04-23T21:11:07,678  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 1, commitMemory -> 0, usedMemory ->380
2024-04-23T21:11:07,680  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local582874617_0017_m_000000_0 decomp: 380 len: 384 to MEMORY
2024-04-23T21:11:07,680  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local582874617_0017_m_000000_0
2024-04-23T21:11:07,680  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 2, commitMemory -> 380, usedMemory ->760
2024-04-23T21:11:07,682  INFO [localfetcher#16] reduce.LocalFetcher: localfetcher#16 about to shuffle output of map attempt_local582874617_0017_m_000002_0 decomp: 380 len: 384 to MEMORY
2024-04-23T21:11:07,682  INFO [localfetcher#16] reduce.InMemoryMapOutput: Read 380 bytes from map-output for attempt_local582874617_0017_m_000002_0
2024-04-23T21:11:07,682  INFO [localfetcher#16] reduce.MergeManagerImpl: closeInMemoryFile -> map-output of size: 380, inMemoryMapOutputs.size() -> 3, commitMemory -> 760, usedMemory ->1140
2024-04-23T21:11:07,683  INFO [EventFetcher for fetching Map Completion Events] reduce.EventFetcher: EventFetcher is interrupted.. Returning
2024-04-23T21:11:07,683  INFO [pool-87-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T21:11:07,683  INFO [pool-87-thread-1] reduce.MergeManagerImpl: finalMerge called with 3 in-memory map-outputs and 0 on-disk map-outputs
2024-04-23T21:11:07,689  INFO [pool-87-thread-1] mapred.Merger: Merging 3 sorted segments
2024-04-23T21:11:07,689  INFO [pool-87-thread-1] mapred.Merger: Down to the last merge-pass, with 3 segments left of total size: 1071 bytes
2024-04-23T21:11:07,692  INFO [pool-87-thread-1] reduce.MergeManagerImpl: Merged 3 segments, 1140 bytes to disk to satisfy reduce memory limit
2024-04-23T21:11:07,692  INFO [pool-87-thread-1] reduce.MergeManagerImpl: Merging 1 files, 1140 bytes from disk
2024-04-23T21:11:07,692  INFO [pool-87-thread-1] reduce.MergeManagerImpl: Merging 0 segments, 0 bytes from memory into reduce
2024-04-23T21:11:07,692  INFO [pool-87-thread-1] mapred.Merger: Merging 1 sorted segments
2024-04-23T21:11:07,692  INFO [pool-87-thread-1] mapred.Merger: Down to the last merge-pass, with 1 segments left of total size: 1113 bytes
2024-04-23T21:11:07,692  INFO [pool-87-thread-1] mapred.LocalJobRunner: 3 / 3 copied.
2024-04-23T21:11:07,693  INFO [pool-87-thread-1] exec.SerializationUtilities: Deserializing ReduceWork using kryo
2024-04-23T21:11:07,693  INFO [pool-87-thread-1] exec.Utilities: Deserialized plan (via FILE) - name: null size: 5,89KB
2024-04-23T21:11:07,694  INFO [pool-87-thread-1] ExecReducer: 
<SEL>Id =3
  <Children>
    <FS>Id =4
      <Children>
      <\Children>
      <Parent>Id = 3 null<\Parent>
    <\FS>
  <\Children>
  <Parent><\Parent>
<\SEL>
2024-04-23T21:11:07,694  INFO [pool-87-thread-1] exec.SelectOperator: Initializing Operator: SEL[3]
2024-04-23T21:11:07,694  INFO [pool-87-thread-1] exec.SelectOperator: SELECT struct<key:struct<reducesinkkey0:int,reducesinkkey1:int,reducesinkkey2:int>,value:struct<_col0:string>>
2024-04-23T21:11:07,694  INFO [pool-87-thread-1] exec.FileSinkOperator: Initializing Operator: FS[4]
2024-04-23T21:11:07,695  INFO [pool-87-thread-1] exec.FileSinkOperator: Using serializer : class org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe [serdeParams=org.apache.hadoop.hive.serde2.lazy.LazySerDeParameters@288d4ce5, cachedObjectInspector=org.apache.hadoop.hive.serde2.lazy.objectinspector.LazySimpleStructObjectInspector<org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyIntObjectInspector@4a0161ee,org.apache.hadoop.hive.serde2.lazy.objectinspector.primitive.LazyStringObjectInspector@47a2d9a9>, serializedSize=0, stats=org.apache.hadoop.hive.serde2.SerDeStats@7db455ba, lastOperationSerialize=false, lastOperationDeserialize=false [1, 2, 3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1] : [_col0, _col1, _col2, _col3] : [int, int, int, string]] and formatter : org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat@468a2bd2
2024-04-23T21:11:07,695  INFO [pool-87-thread-1] exec.FileSinkOperator: Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-07_079_3509055903702485531-1/-mr-10001/.hive-staging_hive_2024-04-23_21-11-07_079_3509055903702485531-1/_tmp.-ext-10002/000000_0
2024-04-23T21:11:07,695  INFO [pool-87-thread-1] exec.FileSinkOperator: Writing to temp file: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-07_079_3509055903702485531-1/-mr-10001/.hive-staging_hive_2024-04-23_21-11-07_079_3509055903702485531-1/_task_tmp.-ext-10002/_tmp.000000_0
2024-04-23T21:11:07,695  INFO [pool-87-thread-1] exec.FileSinkOperator: New Final Path: FS file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-07_079_3509055903702485531-1/-mr-10001/.hive-staging_hive_2024-04-23_21-11-07_079_3509055903702485531-1/_tmp.-ext-10002/000000_0
2024-04-23T21:11:07,703  INFO [pool-87-thread-1] exec.FileSinkOperator: FS[4]: records written - 1
2024-04-23T21:11:07,703  INFO [pool-87-thread-1] exec.SelectOperator: Closing Operator: SEL[3]
2024-04-23T21:11:07,703  INFO [pool-87-thread-1] exec.SelectOperator: RECORDS_OUT_OPERATOR_SEL_3:6, RECORDS_OUT_INTERMEDIATE:0, 
2024-04-23T21:11:07,703  INFO [pool-87-thread-1] exec.FileSinkOperator: Closing Operator: FS[4]
2024-04-23T21:11:07,703  INFO [pool-87-thread-1] exec.FileSinkOperator: FS[4]: records written - 6
2024-04-23T21:11:07,704  INFO [pool-87-thread-1] exec.FileSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_0:6, RECORDS_OUT_OPERATOR_FS_4:6, 
2024-04-23T21:11:07,704  INFO [pool-87-thread-1] mapred.Task: Task:attempt_local582874617_0017_r_000000_0 is done. And is in the process of committing
2024-04-23T21:11:07,704  INFO [pool-87-thread-1] mapred.LocalJobRunner: reduce > reduce
2024-04-23T21:11:07,705  INFO [pool-87-thread-1] mapred.Task: Task 'attempt_local582874617_0017_r_000000_0' done.
2024-04-23T21:11:07,705  INFO [pool-87-thread-1] mapred.Task: Final Counters for attempt_local582874617_0017_r_000000_0: Counters: 29
	File System Counters
		FILE: Number of bytes read=405422
		FILE: Number of bytes written=20227684
		FILE: Number of read operations=0
		FILE: Number of large read operations=0
		FILE: Number of write operations=0
	Map-Reduce Framework
		Combine input records=0
		Combine output records=0
		Reduce input groups=6
		Reduce shuffle bytes=1152
		Reduce input records=6
		Reduce output records=0
		Spilled Records=6
		Shuffled Maps =3
		Failed Shuffles=0
		Merged Map outputs=3
		GC time elapsed (ms)=0
		Total committed heap usage (bytes)=1250426880
	HIVE
		CREATED_FILES=1
		RECORDS_OUT_0=6
		RECORDS_OUT_INTERMEDIATE=0
		RECORDS_OUT_OPERATOR_FS_4=6
		RECORDS_OUT_OPERATOR_SEL_3=6
	Shuffle Errors
		BAD_ID=0
		CONNECTION=0
		IO_ERROR=0
		WRONG_LENGTH=0
		WRONG_MAP=0
		WRONG_REDUCE=0
	File Output Format Counters 
		Bytes Written=0
2024-04-23T21:11:07,705  INFO [pool-87-thread-1] mapred.LocalJobRunner: Finishing task: attempt_local582874617_0017_r_000000_0
2024-04-23T21:11:07,705  INFO [Thread-1540] mapred.LocalJobRunner: reduce task executor complete.
2024-04-23 21:11:08,590 Stage-1 map = 100%,  reduce = 100%
2024-04-23T21:11:08,590  INFO [main] exec.Task: 2024-04-23 21:11:08,590 Stage-1 map = 100%,  reduce = 100%
Ended Job = job_local582874617_0017
2024-04-23T21:11:08,591  INFO [main] exec.Task: Ended Job = job_local582874617_0017
2024-04-23T21:11:08,593  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:08,593  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
MapReduce Jobs Launched: 
2024-04-23T21:11:08,593  INFO [main] ql.Driver: MapReduce Jobs Launched: 
Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
2024-04-23T21:11:08,593  INFO [main] ql.Driver: Stage-Stage-1:  HDFS Read: 0 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:11:08,593  INFO [main] ql.Driver: Total MapReduce CPU Time Spent: 0 msec
2024-04-23T21:11:08,593  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d); Time taken: 1.298 seconds
2024-04-23T21:11:08,593  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211107_5c3c44c3-ac6e-40ba-a7cf-f6fc21ea8b6d
2024-04-23T21:11:08,597  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:26
2024-04-23T21:11:08,602  INFO [main] txn.TxnHandler: Removed transactions: ([26]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:08,604  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:26
2024-04-23T21:11:08,608  INFO [main] mapred.FileInputFormat: Total input files to process : 1
2024-04-23T21:11:08,610  INFO [main] exec.ListSinkOperator: Closing Operator: LIST_SINK[5]
2024-04-23T21:11:08,610  INFO [main] exec.ListSinkOperator: RECORDS_OUT_INTERMEDIATE:0, RECORDS_OUT_OPERATOR_LIST_SINK_5:6, 
2024-04-23T21:11:08,610  WARN [main] ql.TestTxnAddPartition: addPartitionMM: read data(add 2 existing parts and 1 empty): 
2024-04-23T21:11:08,610  INFO [main] ql.TestTxnAddPartition: 0	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
0	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=0/delta_0000001_0000001_0000/000000_0
1	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
1	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=1/delta_0000001_0000001_0000/000000_0
3	0	2	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0
3	0	4	file:/home/alex/Repositories/hive/ql/target/tmp/org.apache.hadoop.hive.ql.TestTxnAddPartition-1713931810633/warehouse/t/p=3/delta_0000003_0000003_0000/000000_0

2024-04-23T21:11:08,610  INFO [main] ql.TxnCommandsBaseForTests: Running the query: EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:08,610  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-07_079_3509055903702485531-1
2024-04-23T21:11:08,612  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-07_079_3509055903702485531-1 on fs with scheme file
2024-04-23T21:11:08,612  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211108_dbb5034d-7ae2-4ce7-82dc-a6dc5c407bb3): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:08,623  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([27]) with min_open_txn: 27
2024-04-23T21:11:08,624  INFO [main] lockmgr.DbTxnManager: Opened txnid:27
2024-04-23T21:11:08,625  INFO [main] parse.CalcitePlanner: Starting Semantic Analysis
2024-04-23T21:11:08,628  INFO [main] parse.CalcitePlanner: Completed phase 1 of Semantic Analysis
2024-04-23T21:11:08,628  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:08,629  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:08,639  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:08,640  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:08,640  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:08,640  INFO [main] parse.CalcitePlanner: Completed getting MetaData in Semantic Analysis
2024-04-23T21:11:08,653  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_all_table_constraints : tbl=hive.default.t	
2024-04-23T21:11:08,662  INFO [main] calcite.RelOptHiveTable: Calculating column statistics for default.t, projIndxSet: [0, 1, 2], allowMissingStats: true
2024-04-23T21:11:08,662  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_partitions : tbl=hive.default.t	
2024-04-23T21:11:08,690  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.t	
2024-04-23T21:11:08,701  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:08,702  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_aggr_stats_for: table=hive.default.t	
2024-04-23T21:11:08,714  WARN [main] calcite.RelOptHiveTable: No Stats for default@t, Columns: b, a
No Stats for default@t, Columns: b, a
2024-04-23T21:11:08,714  INFO [main] SessionState: No Stats for default@t, Columns: b, a
2024-04-23T21:11:08,755  INFO [main] parse.CalcitePlanner: Get metadata for source tables
2024-04-23T21:11:08,755  INFO [main] parse.CalcitePlanner: Get metadata for subqueries
2024-04-23T21:11:08,755  INFO [main] parse.CalcitePlanner: Get metadata for destination tables
2024-04-23T21:11:08,757  INFO [main] parse.CalcitePlanner: CBO Succeeded; optimized logical plan.
2024-04-23T21:11:08,760  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 oldColExprMap: {KEY.reducesinkkey2=Column[_col2], VALUE._col0=Column[_col3], KEY.reducesinkkey0=Column[_col0], KEY.reducesinkkey1=Column[_col1]}
2024-04-23T21:11:08,760  INFO [main] optimizer.ColumnPrunerProcFactory: RS 2 newColExprMap: {KEY.reducesinkkey2=Column[_col2], VALUE._col0=Column[_col3], KEY.reducesinkkey1=Column[_col1], KEY.reducesinkkey0=Column[_col0]}
2024-04-23T21:11:08,761  INFO [main] optimizer.BucketVersionPopulator: not considering bucketingVersion for: TS[0] because it has -1<2 buckets 
2024-04-23T21:11:08,781  INFO [main] optimizer.SortedDynPartitionOptimizer: Sorted dynamic partitioning optimization kicked in..
2024-04-23T21:11:08,789  INFO [main] physical.Vectorizer: Examining input format to see if vectorization is enabled.
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Vectorization is enabled for input format(s) [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Validating and vectorizing MapWork... (vectorizedVertexNum 0)
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Map vectorization enabled: true
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Map vectorized: false
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Map notVectorizedReason: Select expression for SELECT operator: Virtual column INPUT__FILE__NAME is not supported
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Map vectorizedVertexNum: 0
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Map enabledConditionsMet: [hive.vectorized.use.vectorized.input.format IS true]
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Map inputFileFormatClassNameSet: [org.apache.hadoop.hive.ql.io.orc.OrcInputFormat]
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Reduce vectorization enabled: false
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Reduce vectorized: false
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Reduce vectorizedVertexNum: 1
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Reducer hive.vectorized.execution.reduce.enabled: true
2024-04-23T21:11:08,790  INFO [main] physical.Vectorizer: Reducer engine: mr
2024-04-23T21:11:08,790  INFO [main] parse.CalcitePlanner: Completed plan generation
2024-04-23T21:11:08,791  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:08,791  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:[FieldSchema(name:Explain, type:string, comment:null)], properties:null)
2024-04-23T21:11:08,791  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:08,791  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getAggrColStatsFor_(String, String, List, List, String, String)=23, commitTxn_(CommitTxnRequest)=11, getTable_(GetTableRequest)=11, flushCache_()=0, getValidTxns_(long)=0, isCompatibleWith_(Configuration)=0, getAllTableConstraints_(AllTableConstraintsRequest)=6, getValidWriteIds_(List, String)=4, openTxn_(String, TxnType)=11, listPartitions_(String, String, short)=9}
2024-04-23T21:11:08,791  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211108_dbb5034d-7ae2-4ce7-82dc-a6dc5c407bb3); Time taken: 0.179 seconds
2024-04-23T21:11:08,791  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211108_dbb5034d-7ae2-4ce7-82dc-a6dc5c407bb3): EXPLAIN VECTORIZATION DETAIL select p, a, b, INPUT__FILE__NAME from T order by p, a, b
2024-04-23T21:11:08,792  INFO [main] ql.Driver: Starting task [Stage-2:EXPLAIN] in serial mode
2024-04-23T21:11:08,802  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:08,802  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {}
2024-04-23T21:11:08,802  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211108_dbb5034d-7ae2-4ce7-82dc-a6dc5c407bb3); Time taken: 0.011 seconds
2024-04-23T21:11:08,802  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: null
2024-04-23T21:11:08,807  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:27
2024-04-23T21:11:08,811  INFO [main] txn.TxnHandler: Removed transactions: ([27]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:08,811  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:27
2024-04-23T21:11:08,812  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl
2024-04-23T21:11:08,812  INFO [main] ql.Context: Deleting scratch dir: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-08_612_5122362537398291287-1
2024-04-23T21:11:08,813  INFO [main] cleanup.SyncCleanupService: Deleted directory: file:/home/alex/Repositories/hive/ql/target/tmp/localscratchdir/1b56dd34-1895-41e7-abc9-e1cc47c2ae7e/hive_2024-04-23_21-11-08_612_5122362537398291287-1 on fs with scheme file
2024-04-23T21:11:08,813  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211108_ae310b12-0437-4396-8583-5983faecef3f): drop table if exists acidTbl
2024-04-23T21:11:08,815  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([28]) with min_open_txn: 27
2024-04-23T21:11:08,815  INFO [main] lockmgr.DbTxnManager: Opened txnid:28
2024-04-23T21:11:08,816  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:08,822  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:08,822  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:08,822  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:08,822  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:08,823  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getValidTxns_(long)=1, getTable_(GetTableRequest)=6, openTxn_(String, TxnType)=2, commitTxn_(CommitTxnRequest)=10, flushCache_()=0}
2024-04-23T21:11:08,823  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211108_ae310b12-0437-4396-8583-5983faecef3f); Time taken: 0.009 seconds
2024-04-23T21:11:08,823  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:28 for queryId=alex_20240423211108_ae310b12-0437-4396-8583-5983faecef3f
2024-04-23T21:11:08,824  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211108_ae310b12-0437-4396-8583-5983faecef3f
2024-04-23T21:11:08,836  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211108_ae310b12-0437-4396-8583-5983faecef3f LockResponse(lockid:20, state:ACQUIRED)
2024-04-23T21:11:08,836  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:08,836  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211108_ae310b12-0437-4396-8583-5983faecef3f): drop table if exists acidTbl
2024-04-23T21:11:08,836  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:08,837  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:08,843  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:08,843  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:08,850  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:08,850  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTbl	
2024-04-23T21:11:08,930  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:08,930  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=87, getTable_(GetTableRequest)=7}
2024-04-23T21:11:08,931  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211108_ae310b12-0437-4396-8583-5983faecef3f); Time taken: 0.094 seconds
2024-04-23T21:11:08,931  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211108_ae310b12-0437-4396-8583-5983faecef3f
2024-04-23T21:11:08,934  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:28
2024-04-23T21:11:08,939  INFO [main] txn.TxnHandler: Removed transactions: ([28]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:08,939  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:28
2024-04-23T21:11:08,940  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTblPart
2024-04-23T21:11:08,940  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211108_93b125d0-ab80-4fa6-9c29-35da14d685ce): drop table if exists acidTblPart
2024-04-23T21:11:08,943  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([29]) with min_open_txn: 27
2024-04-23T21:11:08,943  INFO [main] lockmgr.DbTxnManager: Opened txnid:29
2024-04-23T21:11:08,944  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:08,954  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:08,954  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:08,954  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:08,954  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:08,954  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=1, commitTxn_(CommitTxnRequest)=9, getTable_(GetTableRequest)=10, openTxn_(String, TxnType)=2, isCompatibleWith_(Configuration)=0, flushCache_()=0}
2024-04-23T21:11:08,955  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211108_93b125d0-ab80-4fa6-9c29-35da14d685ce); Time taken: 0.014 seconds
2024-04-23T21:11:08,955  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:29 for queryId=alex_20240423211108_93b125d0-ab80-4fa6-9c29-35da14d685ce
2024-04-23T21:11:08,955  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211108_93b125d0-ab80-4fa6-9c29-35da14d685ce
2024-04-23T21:11:08,972  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211108_93b125d0-ab80-4fa6-9c29-35da14d685ce LockResponse(lockid:21, state:ACQUIRED)
2024-04-23T21:11:08,972  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:08,972  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211108_93b125d0-ab80-4fa6-9c29-35da14d685ce): drop table if exists acidTblPart
2024-04-23T21:11:08,972  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:08,973  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:08,980  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:08,980  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:08,987  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:08,987  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.acidTblPart	
2024-04-23T21:11:09,030  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:09,030  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=8, dropTable_(String, String, boolean, boolean, boolean)=49}
2024-04-23T21:11:09,030  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211108_93b125d0-ab80-4fa6-9c29-35da14d685ce); Time taken: 0.058 seconds
2024-04-23T21:11:09,030  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211108_93b125d0-ab80-4fa6-9c29-35da14d685ce
2024-04-23T21:11:09,035  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:29
2024-04-23T21:11:09,043  INFO [main] txn.TxnHandler: Removed transactions: ([29]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:09,043  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:29
2024-04-23T21:11:09,044  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists acidTbl2
2024-04-23T21:11:09,044  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211109_e9b96979-2546-4d1f-8607-21789d9cc674): drop table if exists acidTbl2
2024-04-23T21:11:09,046  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([30]) with min_open_txn: 27
2024-04-23T21:11:09,047  INFO [main] lockmgr.DbTxnManager: Opened txnid:30
2024-04-23T21:11:09,048  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:09,048  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:09,048  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:09,048  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, commitTxn_(CommitTxnRequest)=14, isCompatibleWith_(Configuration)=0, openTxn_(String, TxnType)=2, getValidTxns_(long)=1, getTable_(GetTableRequest)=0}
2024-04-23T21:11:09,048  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211109_e9b96979-2546-4d1f-8607-21789d9cc674); Time taken: 0.004 seconds
2024-04-23T21:11:09,048  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:30 for queryId=alex_20240423211109_e9b96979-2546-4d1f-8607-21789d9cc674
2024-04-23T21:11:09,048  INFO [main] ql.Driver: Operation DROPTABLE obtained 0 locks
2024-04-23T21:11:09,049  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211109_e9b96979-2546-4d1f-8607-21789d9cc674): drop table if exists acidTbl2
2024-04-23T21:11:09,049  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:09,049  INFO [main] metadata.SessionHiveMetaStoreClient: Column stats doesn't exist for db=default temp table=acidTbl2
2024-04-23T21:11:09,049  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:09,050  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getTable_(GetTableRequest)=0, isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=0}
2024-04-23T21:11:09,050  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211109_e9b96979-2546-4d1f-8607-21789d9cc674); Time taken: 0.0 seconds
2024-04-23T21:11:09,050  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211109_e9b96979-2546-4d1f-8607-21789d9cc674
2024-04-23T21:11:09,054  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:30
2024-04-23T21:11:09,059  INFO [main] txn.TxnHandler: Removed transactions: ([30]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:09,059  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:30
2024-04-23T21:11:09,060  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl
2024-04-23T21:11:09,060  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211109_fe078e8d-2f0c-433a-ae2c-6a29cb3ca7d7): drop table if exists nonAcidOrcTbl
2024-04-23T21:11:09,062  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([31]) with min_open_txn: 27
2024-04-23T21:11:09,063  INFO [main] lockmgr.DbTxnManager: Opened txnid:31
2024-04-23T21:11:09,064  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:09,084  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,084  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:09,084  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:09,085  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:09,085  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {commitTxn_(CommitTxnRequest)=10, isCompatibleWith_(Configuration)=0, getValidTxns_(long)=0, getTable_(GetTableRequest)=21, openTxn_(String, TxnType)=2, flushCache_()=0}
2024-04-23T21:11:09,085  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211109_fe078e8d-2f0c-433a-ae2c-6a29cb3ca7d7); Time taken: 0.024 seconds
2024-04-23T21:11:09,085  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:31 for queryId=alex_20240423211109_fe078e8d-2f0c-433a-ae2c-6a29cb3ca7d7
2024-04-23T21:11:09,086  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211109_fe078e8d-2f0c-433a-ae2c-6a29cb3ca7d7
2024-04-23T21:11:09,100  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211109_fe078e8d-2f0c-433a-ae2c-6a29cb3ca7d7 LockResponse(lockid:22, state:ACQUIRED)
2024-04-23T21:11:09,100  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:09,100  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211109_fe078e8d-2f0c-433a-ae2c-6a29cb3ca7d7): drop table if exists nonAcidOrcTbl
2024-04-23T21:11:09,100  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:09,100  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:09,114  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,114  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:09,123  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,124  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl	
2024-04-23T21:11:09,185  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:09,185  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, dropTable_(String, String, boolean, boolean, boolean)=71, getTable_(GetTableRequest)=14}
2024-04-23T21:11:09,185  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211109_fe078e8d-2f0c-433a-ae2c-6a29cb3ca7d7); Time taken: 0.085 seconds
2024-04-23T21:11:09,185  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211109_fe078e8d-2f0c-433a-ae2c-6a29cb3ca7d7
2024-04-23T21:11:09,189  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:31
2024-04-23T21:11:09,196  INFO [main] txn.TxnHandler: Removed transactions: ([31]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:09,196  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:31
2024-04-23T21:11:09,197  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:09,197  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211109_b5979c0d-3a6e-4976-bec7-197a0431578e): drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:09,199  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([32]) with min_open_txn: 27
2024-04-23T21:11:09,199  INFO [main] lockmgr.DbTxnManager: Opened txnid:32
2024-04-23T21:11:09,200  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:09,209  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,209  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:09,209  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:09,209  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:09,209  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=11, openTxn_(String, TxnType)=2, flushCache_()=0, isCompatibleWith_(Configuration)=1, getTable_(GetTableRequest)=9}
2024-04-23T21:11:09,210  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211109_b5979c0d-3a6e-4976-bec7-197a0431578e); Time taken: 0.012 seconds
2024-04-23T21:11:09,210  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:32 for queryId=alex_20240423211109_b5979c0d-3a6e-4976-bec7-197a0431578e
2024-04-23T21:11:09,210  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211109_b5979c0d-3a6e-4976-bec7-197a0431578e
2024-04-23T21:11:09,224  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211109_b5979c0d-3a6e-4976-bec7-197a0431578e LockResponse(lockid:23, state:ACQUIRED)
2024-04-23T21:11:09,224  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:09,225  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211109_b5979c0d-3a6e-4976-bec7-197a0431578e): drop table if exists nonAcidOrcTbl2
2024-04-23T21:11:09,225  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:09,225  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:09,234  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,234  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:09,243  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,243  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidOrcTbl2	
2024-04-23T21:11:09,281  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:09,281  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9, dropTable_(String, String, boolean, boolean, boolean)=47}
2024-04-23T21:11:09,281  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211109_b5979c0d-3a6e-4976-bec7-197a0431578e); Time taken: 0.056 seconds
2024-04-23T21:11:09,281  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211109_b5979c0d-3a6e-4976-bec7-197a0431578e
2024-04-23T21:11:09,285  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:32
2024-04-23T21:11:09,292  INFO [main] txn.TxnHandler: Removed transactions: ([32]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:09,292  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:32
2024-04-23T21:11:09,292  INFO [main] ql.TxnCommandsBaseForTests: Running the query: drop table if exists nonAcidNonBucket
2024-04-23T21:11:09,293  INFO [main] ql.Driver: Compiling command(queryId=alex_20240423211109_5de3a0e7-03fd-4a74-91ab-8f668cb4d0f8): drop table if exists nonAcidNonBucket
2024-04-23T21:11:09,295  INFO [main] txn.TxnHandler: Added entries to MIN_HISTORY_LEVEL for current txns: ([33]) with min_open_txn: 27
2024-04-23T21:11:09,295  INFO [main] lockmgr.DbTxnManager: Opened txnid:33
2024-04-23T21:11:09,296  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:09,306  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,306  INFO [main] ql.Driver: Semantic Analysis Completed (retrial = false)
2024-04-23T21:11:09,306  INFO [main] ql.Driver: Created Hive schema: Schema(fieldSchemas:null, properties:null)
2024-04-23T21:11:09,306  INFO [main] metadata.Hive: Dumping metastore api call timing information for : compilation phase
2024-04-23T21:11:09,306  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {flushCache_()=0, openTxn_(String, TxnType)=2, getTable_(GetTableRequest)=10, isCompatibleWith_(Configuration)=1, getValidTxns_(long)=0, commitTxn_(CommitTxnRequest)=10}
2024-04-23T21:11:09,306  INFO [main] ql.Driver: Completed compiling command(queryId=alex_20240423211109_5de3a0e7-03fd-4a74-91ab-8f668cb4d0f8); Time taken: 0.013 seconds
2024-04-23T21:11:09,307  INFO [main] lockmgr.DbTxnManager: Setting lock request transaction to txnid:33 for queryId=alex_20240423211109_5de3a0e7-03fd-4a74-91ab-8f668cb4d0f8
2024-04-23T21:11:09,307  INFO [main] lockmgr.DbLockManager: Requesting lock for queryId=alex_20240423211109_5de3a0e7-03fd-4a74-91ab-8f668cb4d0f8
2024-04-23T21:11:09,321  INFO [main] lockmgr.DbLockManager: Response to queryId=alex_20240423211109_5de3a0e7-03fd-4a74-91ab-8f668cb4d0f8 LockResponse(lockid:24, state:ACQUIRED)
2024-04-23T21:11:09,321  INFO [main] ql.Driver: Operation DROPTABLE obtained 1 locks
2024-04-23T21:11:09,321  INFO [main] ql.Driver: Executing command(queryId=alex_20240423211109_5de3a0e7-03fd-4a74-91ab-8f668cb4d0f8): drop table if exists nonAcidNonBucket
2024-04-23T21:11:09,321  INFO [main] ql.Driver: Starting task [Stage-0:DDL] in serial mode
2024-04-23T21:11:09,322  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:09,331  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,331  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=get_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:09,340  INFO [main] metastore.HMSHandler: Skipping translation for processor with null
2024-04-23T21:11:09,340  INFO [main] HiveMetaStore.audit: ugi=alex	ip=unknown-ip-addr	cmd=drop_table : tbl=hive.default.nonAcidNonBucket	
2024-04-23T21:11:09,374  INFO [main] metadata.Hive: Dumping metastore api call timing information for : execution phase
2024-04-23T21:11:09,374  INFO [main] metadata.Hive: Total time spent in each metastore function (ms): {dropTable_(String, String, boolean, boolean, boolean)=42, isCompatibleWith_(Configuration)=0, getTable_(GetTableRequest)=9}
2024-04-23T21:11:09,374  INFO [main] ql.Driver: Completed executing command(queryId=alex_20240423211109_5de3a0e7-03fd-4a74-91ab-8f668cb4d0f8); Time taken: 0.053 seconds
2024-04-23T21:11:09,374  INFO [main] lockmgr.DbTxnManager: Stopped heartbeat for query: alex_20240423211109_5de3a0e7-03fd-4a74-91ab-8f668cb4d0f8
2024-04-23T21:11:09,378  INFO [main] txn.TxnHandler: Expected to move at least one record from txn_components to completed_txn_components when committing txn! txnid:33
2024-04-23T21:11:09,385  INFO [main] txn.TxnHandler: Removed transactions: ([33]) from MIN_HISTORY_LEVEL
2024-04-23T21:11:09,385  WARN [main] txn.CompactionTxnHandler: No compaction queue record found for Compaction type transaction commit. txnId:33
2024-04-23T21:11:09,386  INFO [main] utils.TestTxnDbUtil: Cleaning transactional tables
2024-04-23T21:11:09,428  INFO [pool-2-thread-1] lockmgr.DbTxnManager: Shutting down Heartbeater thread pool.
